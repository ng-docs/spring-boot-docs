<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>“操作方法”指南</title>
<link rel="stylesheet" href="css/site.css">
<script src="js/setup.js"></script><script defer="" src="js/site.js"></script>
<script type="application/json" id="anchor-rewrite">
{
"actuator-properties":"application-properties.actuator",
"auto-configuration-classes-from-actuator":"auto-configuration-classes.actuator",
"auto-configuration-classes-from-autoconfigure-module":"auto-configuration-classes.core",
"boot-documentation":"documentation",
"boot-documentation-about":"documentation.about",
"boot-documentation-advanced":"documentation.advanced",
"boot-documentation-first-steps":"documentation.first-steps",
"boot-documentation-getting-help":"documentation.getting-help",
"boot-documentation-learning":"documentation.features",
"boot-documentation-production":"documentation.actuator",
"boot-documentation-upgrading":"documentation.upgrading",
"boot-documentation-workingwith":"documentation.using",
"boot-features":"features",
"boot-features-activemq":"features.messaging.jms.activemq",
"boot-features-adding-active-profiles":"features.profiles.adding-active-profiles",
"boot-features-amqp":"features.messaging.amqp",
"boot-features-application-admin":"features.spring-application.admin",
"boot-features-application-arguments":"features.spring-application.application-arguments",
"boot-features-application-availability":"features.spring-application.application-availability",
"boot-features-application-availability-liveness-state":"features.spring-application.application-availability.liveness",
"boot-features-application-availability-managing":"features.spring-application.application-availability.managing",
"boot-features-application-availability-readiness-state":"features.spring-application.application-availability.readiness",
"boot-features-application-events-and-listeners":"features.spring-application.application-events-and-listeners",
"boot-features-application-exit":"features.spring-application.application-exit",
"boot-features-application-startup-tracking":"features.spring-application.startup-tracking",
"boot-features-artemis":"features.messaging.jms.artemis",
"boot-features-banner":"features.spring-application.banner",
"boot-features-bean-conditions":"features.developing-auto-configuration.condition-annotations.bean-conditions",
"boot-features-caching":"features.caching",
"boot-features-caching-provider":"features.caching.provider",
"boot-features-caching-provider-caffeine":"features.caching.provider.caffeine",
"boot-features-caching-provider-couchbase":"features.caching.provider.couchbase",
"boot-features-caching-provider-ehcache2":"features.caching.provider.ehcache2",
"boot-features-caching-provider-generic":"features.caching.provider.generic",
"boot-features-caching-provider-hazelcast":"features.caching.provider.hazelcast",
"boot-features-caching-provider-infinispan":"features.caching.provider.infinispan",
"boot-features-caching-provider-jcache":"features.caching.provider.jcache",
"boot-features-caching-provider-none":"features.caching.provider.none",
"boot-features-caching-provider-redis":"features.caching.provider.redis",
"boot-features-caching-provider-simple":"features.caching.provider.simple",
"boot-features-cassandra":"features.nosql.cassandra",
"boot-features-class-conditions":"features.developing-auto-configuration.condition-annotations.class-conditions",
"boot-features-command-line-runner":"features.spring-application.command-line-runner",
"boot-features-condition-annotations":"features.developing-auto-configuration.condition-annotations",
"boot-features-configfileapplicationcontextinitializer-test-utility":"features.testing.utilities.config-data-application-context-initializer",
"boot-features-configure-datasource":"features.sql.datasource",
"boot-features-connect-to-production-database":"features.sql.datasource.production",
"boot-features-connect-to-production-database-configuration":"features.sql.datasource.configuration",
"boot-features-connect-to-production-database-connection-pool":"features.sql.datasource.connection-pool",
"boot-features-connecting-to-a-jndi-datasource":"features.sql.datasource.jndi",
"boot-features-connecting-to-cassandra":"features.nosql.cassandra.connecting",
"boot-features-connecting-to-couchbase":"features.nosql.couchbase.connecting",
"boot-features-connecting-to-elasticsearch-reactive-rest":"features.nosql.elasticsearch.connecting-using-reactive-rest",
"boot-features-connecting-to-elasticsearch-rest":"features.nosql.elasticsearch.connecting-using-rest",
"boot-features-connecting-to-elasticsearch-spring-data":"features.nosql.elasticsearch.connecting-using-spring-data",
"boot-features-connecting-to-influxdb":"features.nosql.influxdb.connecting",
"boot-features-connecting-to-mongodb":"features.nosql.mongodb.connecting",
"boot-features-connecting-to-neo4j":"features.nosql.neo4j.connecting",
"boot-features-connecting-to-redis":"features.nosql.redis.connecting",
"boot-features-connecting-to-solr":"features.nosql.solr.connecting",
"boot-features-container-images":"features.container-images",
"boot-features-container-images-building":"features.container-images.building",
"boot-features-container-images-buildpacks":"features.container-images.building.buildpacks",
"boot-features-container-images-docker":"features.container-images.building.dockerfiles",
"boot-features-cors":"features.developing-web-applications.spring-mvc.cors",
"boot-features-couchbase":"features.nosql.couchbase",
"boot-features-creating-and-dropping-jpa-databases":"features.sql.jpa-and-spring-data.creating-and-dropping",
"boot-features-custom-log-configuration":"features.logging.custom-log-configuration",
"boot-features-custom-log-groups":"features.logging.log-groups",
"boot-features-custom-log-levels":"features.logging.log-levels",
"boot-features-custom-starter":"features.developing-auto-configuration.custom-starter",
"boot-features-custom-starter-configuration-keys":"features.developing-auto-configuration.custom-starter.configuration-keys",
"boot-features-custom-starter-module-autoconfigure":"features.developing-auto-configuration.custom-starter.autoconfigure-module",
"boot-features-custom-starter-module-starter":"features.developing-auto-configuration.custom-starter.starter-module",
"boot-features-custom-starter-naming":"features.developing-auto-configuration.custom-starter.naming",
"boot-features-customizing-configurableservletwebserverfactory-directly":"features.developing-web-applications.embedded-container.customizing.direct",
"boot-features-customizing-embedded-containers":"features.developing-web-applications.embedded-container.customizing",
"boot-features-customizing-spring-application":"features.spring-application.customizing-spring-application",
"boot-features-data-jdbc":"features.sql.jdbc",
"boot-features-developing-auto-configuration":"features.developing-auto-configuration",
"boot-features-developing-web-applications":"features.developing-web-applications",
"boot-features-elasticsearch":"features.nosql.elasticsearch",
"boot-features-email":"features.email",
"boot-features-embedded-container":"features.developing-web-applications.embedded-container",
"boot-features-embedded-container-application-context":"features.developing-web-applications.embedded-container.application-context",
"boot-features-embedded-container-context-initializer":"features.developing-web-applications.embedded-container.context-initializer",
"boot-features-embedded-container-servlets-filters-listeners":"features.developing-web-applications.embedded-container.servlets-filters-listeners",
"boot-features-embedded-container-servlets-filters-listeners-beans":"features.developing-web-applications.embedded-container.servlets-filters-listeners.beans",
"boot-features-embedded-container-servlets-filters-listeners-scanning":"features.developing-web-applications.embedded-container.context-initializer.scanning",
"boot-features-embedded-database-support":"features.sql.datasource.embedded",
"boot-features-embedded-kafka":"features.messaging.kafka.embedded",
"boot-features-encrypting-properties":"features.external-config.encrypting",
"boot-features-entity-classes":"features.sql.jpa-and-spring-data.entity-classes",
"boot-features-error-handling":"features.developing-web-applications.spring-mvc.error-handling",
"boot-features-error-handling-custom-error-pages":"features.developing-web-applications.spring-mvc.error-handling.error-pages",
"boot-features-error-handling-mapping-error-pages-without-mvc":"features.developing-web-applications.spring-mvc.error-handling.error-pages-without-spring-mvc",
"boot-features-error-handling-war-deployment":"features.developing-web-applications.spring-mvc.error-handling.in-a-war-deployment",
"boot-features-external-config":"features.external-config",
"boot-features-external-config-3rd-party-configuration":"features.external-config.typesafe-configuration-properties.third-party-configuration",
"boot-features-external-config-application-json":"features.external-config.application-json",
"boot-features-external-config-application-property-files":"features.external-config.files",
"boot-features-external-config-command-line-args":"features.external-config.command-line-args",
"boot-features-external-config-complex-type-merge":"features.external-config.typesafe-configuration-properties.merging-complex-types",
"boot-features-external-config-constructor-binding":"features.external-config.typesafe-configuration-properties.constructor-binding",
"boot-features-external-config-conversion":"features.external-config.typesafe-configuration-properties.conversion",
"boot-features-external-config-conversion-datasize":"features.external-config.typesafe-configuration-properties.conversion.data-sizes",
"boot-features-external-config-conversion-duration":"features.external-config.typesafe-configuration-properties.conversion.durations",
"boot-features-external-config-conversion-period":"features.external-config.typesafe-configuration-properties.conversion.periods",
"boot-features-external-config-enabling":"features.external-config.typesafe-configuration-properties.enabling-annotated-types",
"boot-features-external-config-exposing-yaml-to-spring":"features.external-config.yaml.directly-loading",
"boot-features-external-config-file-activation-properties":"features.external-config.files.activation-properties",
"boot-features-external-config-files":"features.external-config.files",
"boot-features-external-config-files-configtree":"features.external-config.files.configtree",
"boot-features-external-config-files-importing":"features.external-config.files.importing",
"boot-features-external-config-files-importing-extensionless":"features.external-config.file.importing-extensionless",
"boot-features-external-config-files-multi-document":"features.external-config.files.multi-document",
"boot-features-external-config-files-profile-specific":"features.external-config.files.profile-specific",
"boot-features-external-config-files-wildcards":"features.external-config.files.wildcard-locations",
"boot-features-external-config-java-bean-binding":"features.external-config.typesafe-configuration-properties.java-bean-binding",
"boot-features-external-config-loading-yaml":"features.external-config.yaml.directly-loading",
"boot-features-external-config-optional-prefix":"features.external-config.files.optional-prefix",
"boot-features-external-config-placeholders-in-properties":"features.external-config.files.property-placeholders",
"boot-features-external-config-random-values":"features.external-config.random-values",
"boot-features-external-config-relaxed-binding":"features.external-config.typesafe-configuration-properties.relaxed-binding",
"boot-features-external-config-relaxed-binding-from-environment-variables":"features.external-config.typesafe-configuration-properties.relaxed-binding.environment-variables",
"boot-features-external-config-relaxed-binding-maps":"features.external-config.typesafe-configuration-properties.relaxed-binding.maps",
"boot-features-external-config-system-environment":"features.external-config.system-environment",
"boot-features-external-config-typesafe-configuration-properties":"features.external-config.typesafe-configuration-properties",
"boot-features-external-config-using":"features.external-config.typesafe-configuration-properties.using-annotated-types",
"boot-features-external-config-validation":"features.external-config.typesafe-configuration-properties.validation",
"boot-features-external-config-vs-value":"features.external-config.typesafe-configuration-properties.vs-value-annotation",
"boot-features-external-config-yaml":"features.external-config.yaml",
"boot-features-external-config-yaml-to-properties":"features.external-config.yaml.mapping-to-properties",
"boot-features-fluent-builder-api":"features.spring-application.fluent-builder-api",
"boot-features-graceful-shutdown":"features.graceful-shutdown",
"boot-features-hazelcast":"features.hazelcast",
"boot-features-influxdb":"features.nosql.influxdb",
"boot-features-integration":"features.spring-integration",
"boot-features-internationalization":"features.internationalization",
"boot-features-jersey":"features.developing-web-applications.jersey",
"boot-features-jms":"features.messaging.jms",
"boot-features-jms-jndi":"features.messaging.jms.jndi",
"boot-features-jmx":"features.jmx",
"boot-features-jooq":"features.sql.jooq",
"boot-features-jooq-codegen":"features.sql.jooq.codegen",
"boot-features-jooq-customizing":"features.sql.jooq.customizing",
"boot-features-jooq-dslcontext":"features.sql.jooq.dslcontext",
"boot-features-jooq-sqldialect":"features.sql.jooq.sqldialect",
"boot-features-jpa-and-spring-data":"features.sql.jpa-and-spring-data",
"boot-features-jpa-in-web-environment":"features.sql.jpa-and-spring-data.open-entity-manager-in-view",
"boot-features-json":"features.json",
"boot-features-json-components":"features.developing-web-applications.spring-mvc.json",
"boot-features-json-gson":"features.json.gson",
"boot-features-json-jackson":"features.json.jackson",
"boot-features-json-json-b":"features.json.json-b",
"boot-features-jsp-limitations":"features.developing-web-applications.embedded-container.jsp-limitations",
"boot-features-jta":"features.jta",
"boot-features-jta-atomikos":"features.jta.atomikos",
"boot-features-jta-javaee":"features.jta.javaee",
"boot-features-jta-mixed-jms":"features.jta.mixing-xa-and-non-xa-connections",
"boot-features-jta-supporting-alternative-embedded":"features.jta.supporting-alternative-embedded-transaction-manager",
"boot-features-kafka":"features.messaging.kafka",
"boot-features-kafka-extra-props":"features.messaging.kafka.additional-properties",
"boot-features-kafka-receiving-a-message":"features.messaging.kafka.receiving",
"boot-features-kafka-sending-a-message":"features.messaging.kafka.sending",
"boot-features-kafka-streams":"features.messaging.kafka.streams",
"boot-features-kotlin":"features.kotlin",
"boot-features-kotlin-api":"features.kotlin.api",
"boot-features-kotlin-api-extensions":"features.kotlin.api.extensions",
"boot-features-kotlin-api-runapplication":"features.kotlin.api.run-application",
"boot-features-kotlin-configuration-properties":"features.kotlin.configuration-properties",
"boot-features-kotlin-dependency-management":"features.kotlin.dependency-management",
"boot-features-kotlin-null-safety":"features.kotlin.null-safety",
"boot-features-kotlin-requirements":"features.kotlin.requirements",
"boot-features-kotlin-resources":"features.kotlin.resources",
"boot-features-kotlin-resources-examples":"features.kotlin.resources.examples",
"boot-features-kotlin-resources-further-reading":"features.kotlin.resources.further-reading",
"boot-features-kotlin-testing":"features.kotlin.testing",
"boot-features-lazy-initialization":"features.spring-application.lazy-initialization",
"boot-features-ldap":"features.nosql.ldap",
"boot-features-ldap-connecting":"features.nosql.ldap.connecting",
"boot-features-ldap-embedded":"features.nosql.ldap.embedded",
"boot-features-ldap-spring-data-repositories":"features.nosql.ldap.repositories",
"boot-features-locating-auto-configuration-candidates":"features.developing-auto-configuration.locating-auto-configuration-candidates",
"boot-features-log-shutdown-hook":"features.logging.shutdown-hook",
"boot-features-logback-environment-properties":"features.logging.logback-extensions.environment-properties",
"boot-features-logback-extensions":"features.logging.logback-extensions",
"boot-features-logback-extensions-profile-specific":"features.logging.logback-extensions.profile-specific",
"boot-features-logging":"features.logging",
"boot-features-logging-color-coded-output":"features.logging.console-output.color-coded",
"boot-features-logging-console-output":"features.logging.console-output",
"boot-features-logging-file-output":"features.logging.file-output",
"boot-features-logging-file-rotation":"features.logging.file-rotation",
"boot-features-logging-format":"features.logging.log-format",
"boot-features-messaging":"features.messaging",
"boot-features-mongo-embedded":"features.nosql.mongodb.embedded",
"boot-features-mongo-template":"features.nosql.mongodb.template",
"boot-features-mongodb":"features.nosql.mongodb",
"boot-features-neo4j":"features.nosql.neo4j",
"boot-features-nosql":"features.nosql",
"boot-features-output-capture-test-utility":"features.testing.utilities.output-capture",
"boot-features-profile-specific-configuration":"features.profiles.profile-specific-configuration-files",
"boot-features-profiles":"features.profiles",
"boot-features-profiles-groups":"features.profiles.groups",
"boot-features-programmatic-embedded-container-customization":"features.developing-web-applications.embedded-container.customizing.programmatic",
"boot-features-programmatically-setting-profiles":"features.profiles.programmatically-setting-profiles",
"boot-features-property-conditions":"features.developing-auto-configuration.condition-annotations.property-conditions",
"boot-features-quartz":"features.quartz",
"boot-features-r2dbc":"features.sql.r2dbc",
"boot-features-r2dbc-embedded-database":"features.sql.r2dbc.embedded",
"boot-features-r2dbc-using-database-client":"features.sql.r2dbc.using-database-client",
"boot-features-rabbitmq":"features.messaging.amqp.rabbitmq",
"boot-features-reactive-server":"features.developing-web-applications.reactive-server",
"boot-features-reactive-server-resources":"features.developing-web-applications.reactive-server-resources-configuration",
"boot-features-redis":"features.nosql.redis",
"boot-features-resource-conditions":"features.developing-auto-configuration.condition-annotations.resource-conditions",
"boot-features-rest-templates-test-utility":"features.testing.utilities.test-rest-template",
"boot-features-resttemplate":"features.resttemplate",
"boot-features-resttemplate-customization":"features.resttemplate.customization",
"boot-features-rsocket":"features.rsocket",
"boot-features-rsocket-messaging":"features.rsocket.messaging",
"boot-features-rsocket-requester":"features.rsocket.requester",
"boot-features-rsocket-server-auto-configuration":"features.rsocket.server-auto-configuration",
"boot-features-rsocket-strategies-auto-configuration":"features.rsocket.strategies-auto-configuration",
"boot-features-security":"features.security",
"boot-features-security-actuator":"features.security.actuator",
"boot-features-security-authorization-server":"features.security.oauth2.authorization-server",
"boot-features-security-csrf":"features.security.actuator.csrf",
"boot-features-security-mvc":"features.security.spring-mvc",
"boot-features-security-oauth2":"features.security.oauth2",
"boot-features-security-oauth2-client":"features.security.oauth2.client",
"boot-features-security-oauth2-common-providers":"features.security.oauth2.client.common-providers",
"boot-features-security-oauth2-server":"features.security.oauth2.server",
"boot-features-security-saml":"features.security.saml2",
"boot-features-security-saml2-relying-party":"features.security.saml2.relying-party",
"boot-features-security-webflux":"features.security.spring-webflux",
"boot-features-session":"features.spring-session",
"boot-features-solr":"features.nosql.solr",
"boot-features-spel-conditions":"features.developing-auto-configuration.condition-annotations.spel-conditions",
"boot-features-spring-application":"features.spring-application",
"boot-features-spring-data-cassandra-repositories":"features.nosql.cassandra.repositories",
"boot-features-spring-data-couchbase-repositories":"features.nosql.couchbase.repositories",
"boot-features-spring-data-elasticsearch-repositories":"features.nosql.elasticsearch.repositories",
"boot-features-spring-data-jpa-repositories":"features.sql.jpa-and-spring-data.repositories",
"boot-features-spring-data-mongo-repositories":"features.nosql.mongodb.repositories",
"boot-features-spring-data-mongodb-repositories":"features.nosql.mongodb.repositories",
"boot-features-spring-data-neo4j-repositories":"features.nosql.neo4j.repositories",
"boot-features-spring-data-r2dbc-repositories":"features.sql.r2dbc.repositories",
"boot-features-spring-hateoas":"features.developing-web-applications.spring-mvc.spring-hateoas",
"boot-features-spring-message-codes":"features.developing-web-applications.spring-mvc.message-codes",
"boot-features-spring-mvc":"features.developing-web-applications.spring-mvc",
"boot-features-spring-mvc-auto-configuration":"features.developing-web-applications.spring-mvc.auto-configuration",
"boot-features-spring-mvc-message-converters":"features.developing-web-applications.spring-mvc.message-converters",
"boot-features-spring-mvc-pathmatch":"features.developing-web-applications.spring-mvc.content-negotiation",
"boot-features-spring-mvc-static-content":"features.developing-web-applications.spring-mvc.static-content",
"boot-features-spring-mvc-template-engines":"features.developing-web-applications.spring-mvc.template-engines",
"boot-features-spring-mvc-web-binding-initializer":"features.developing-web-applications.spring-mvc.binding-initializer",
"boot-features-spring-mvc-welcome-page":"features.developing-web-applications.spring-mvc.welcome-page",
"boot-features-sql":"features.sql",
"boot-features-sql-h2-console":"features.sql.h2-web-console",
"boot-features-sql-h2-console-custom-path":"features.sql.h2-web-console.custom-path",
"boot-features-startup-failure":"features.spring-application.startup-failure",
"boot-features-task-execution-scheduling":"features.task-execution-and-scheduling",
"boot-features-test-autoconfig":"features.developing-auto-configuration.testing",
"boot-features-test-autoconfig-overriding-classpath":"features.developing-auto-configuration.testing.overriding-classpath",
"boot-features-test-autoconfig-simulating-web-context":"features.developing-auto-configuration.testing.simulating-a-web-context",
"boot-features-test-property-values":"features.testing.utilities.test-property-values",
"boot-features-test-scope-dependencies":"features.testing.test-scope-dependencies",
"boot-features-test-utilities":"features.testing.utilities",
"boot-features-testing":"features.testing",
"boot-features-testing-spring-applications":"features.testing.spring-applications",
"boot-features-testing-spring-boot-application-arguments":"features.testing.spring-boot-applications.using-application-arguments",
"boot-features-testing-spring-boot-applications":"features.testing.spring-boot-applications",
"boot-features-testing-spring-boot-applications-customizing-web-test-client":"features.testing.spring-boot-applications.customizing-web-test-client",
"boot-features-testing-spring-boot-applications-detecting-config":"features.testing.spring-boot-applications.detecting-configuration",
"boot-features-testing-spring-boot-applications-detecting-web-app-type":"features.testing.spring-boot-applications.detecting-web-app-type",
"boot-features-testing-spring-boot-applications-excluding-config":"features.testing.spring-boot-applications.excluding-configuration",
"boot-features-testing-spring-boot-applications-jmx":"features.testing.spring-boot-applications.jmx",
"boot-features-testing-spring-boot-applications-metrics":"features.testing.spring-boot-applications.metrics",
"boot-features-testing-spring-boot-applications-mocking-beans":"features.testing.spring-boot-applications.mocking-beans",
"boot-features-testing-spring-boot-applications-testing-auto-configured-additional-auto-config":"features.testing.spring-boot-applications.additional-autoconfiguration-and-slicing",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-cassandra-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-cassandra",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-data-jdbc-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-jdbc",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-jdbc-test":"features.testing.spring-boot-applications.autoconfigured-jdbc",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-jooq-test":"features.testing.spring-boot-applications.autoconfigured-jooq",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-jpa-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-jpa",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-json-tests":"features.testing.spring-boot-applications.json-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-ldap-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-ldap",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-mongo-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-mongodb",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-mvc-tests":"features.testing.spring-boot-applications.spring-mvc-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-neo4j-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-neo4j",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-redis-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-redis",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-client":"features.testing.spring-boot-applications.autoconfigured-rest-client",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs-mock-mvc":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-mock-mvc",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs-rest-assured":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-rest-assured",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs-web-test-client":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-web-test-client",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-tests":"features.testing.spring-boot-applications.autoconfigured-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-webflux-tests":"features.testing.spring-boot-applications.spring-webflux-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-webservices":"features.testing.spring-boot-applications.autoconfigured-webservices",
"boot-features-testing-spring-boot-applications-testing-user-configuration":"features.testing.spring-boot-applications.user-configuration-and-slicing",
"boot-features-testing-spring-boot-applications-testing-with-mock-environment":"features.testing.spring-boot-applications.with-mock-environment",
"boot-features-testing-spring-boot-applications-testing-with-running-server":"features.testing.spring-boot-applications.with-running-server",
"boot-features-testing-spring-boot-applications-with-spock":"features.testing.spring-boot-applications.spock",
"boot-features-understanding-auto-configured-beans":"features.developing-auto-configuration.understanding-auto-configured-beans",
"boot-features-using-amqp-receiving":"features.messaging.amqp.receiving",
"boot-features-using-amqp-sending":"features.messaging.amqp.sending",
"boot-features-using-jdbc-template":"features.sql.jdbc-template",
"boot-features-using-jms-receiving":"features.messaging.jms.receiving",
"boot-features-using-jms-sending":"features.messaging.jms.sending",
"boot-features-validation":"features.validation",
"boot-features-web-application-conditions":"features.developing-auto-configuration.condition-annotations.web-application-conditions",
"boot-features-web-environment":"features.spring-application.web-environment",
"boot-features-webclient":"features.webclient",
"boot-features-webclient-customization":"features.webclient.customization",
"boot-features-webclient-runtime":"features.webclient.runtime",
"boot-features-webflux":"features.developing-web-applications.spring-webflux",
"boot-features-webflux-auto-configuration":"features.developing-web-applications.spring-webflux.auto-configuration",
"boot-features-webflux-error-handling":"features.developing-web-applications.spring-webflux.error-handling",
"boot-features-webflux-error-handling-custom-error-pages":"features.developing-web-applications.spring-webflux.error-handling.error-pages",
"boot-features-webflux-httpcodecs":"features.developing-web-applications.spring-webflux.httpcodecs",
"boot-features-webflux-static-content":"features.developing-web-applications.spring-webflux.static-content",
"boot-features-webflux-template-engines":"features.developing-web-applications.spring-webflux.template-engines",
"boot-features-webflux-web-filters":"features.developing-web-applications.spring-webflux.web-filters",
"boot-features-webflux-welcome-page":"features.developing-web-applications.spring-webflux.welcome-page",
"boot-features-webservices":"features.webservices",
"boot-features-webservices-template":"features.webservices.template",
"boot-features-websockets":"features.websockets",
"boot-features-whats-next":"features.whats-next",
"boot-layering-docker-images":"features.container-images.layering",
"build-tool-plugins-antlib":"build-tool-plugins.antlib",
"build-tool-plugins-find-a-main-class":"build-tool-plugins.other-build-systems.finding-main-class",
"build-tool-plugins-gradle-plugin":"build-tool-plugins.gradle",
"build-tool-plugins-maven-plugin":"build-tool-plugins.maven",
"build-tool-plugins-nested-libraries":"build-tool-plugins.other-build-systems.nested-libraries",
"build-tool-plugins-other-build-systems":"build-tool-plugins.other-build-systems",
"build-tool-plugins-repackage-implementation":"build-tool-plugins.other-build-systems.example-repackage-implementation",
"build-tool-plugins-repackaging-archives":"build-tool-plugins.other-build-systems.repackaging-archives",
"build-tool-plugins-whats-next":"build-tool-plugins.whats-next",
"cache-properties":"application-properties.cache",
"cli-automatic-main-method":"cli.using-the-cli.run.automatic-main-method",
"cli-deduced-grab-annotations":"cli.using-the-cli.run.deduced-grab-annotations",
"cli-default-grab-deduced-coordinates":"cli.using-the-cli.run.deduced-grab-coordinates",
"cli-default-grab-deduced-coordinates-custom-dependency-management":"cli.using-the-cli.run.custom-dependency-management",
"cli-default-import-statements":"cli.using-the-cli.run.default-import-statements",
"cli-groovy-beans-dsl":"cli.groovy-beans-dsl",
"cli-init":"cli.using-the-cli.initialize-new-project",
"cli-install-uninstall":"cli.using-the-cli.extensions",
"cli-installation":"cli.installation",
"cli-jar":"cli.using-the-cli.packaging",
"cli-maven-settings":"cli.maven-setting",
"cli-multiple-source-files":"cli.using-the-cli.multiple-source-files",
"cli-run":"cli.using-the-cli.run",
"cli-shell":"cli.using-the-cli.embedded-shell",
"cli-using-the-cli":"cli.using-the-cli",
"cli-whats-next":"cli.whats-next",
"cloud-deployment":"deployment.cloud",
"cloud-deployment-aws":"deployment.cloud.aws",
"cloud-deployment-aws-beanstalk":"deployment.cloud.aws.beanstalk",
"cloud-deployment-aws-java-se-platform":"deployment.cloud.aws.beanstalk.java-se-platform",
"cloud-deployment-aws-summary":"deployment.cloud.aws.summary",
"cloud-deployment-aws-tomcat-platform":"deployment.cloud.aws.beanstalk.tomcat-platform",
"cloud-deployment-boxfuse":"deployment.cloud.boxfuse",
"cloud-deployment-cloud-foundry":"deployment.cloud.cloud-foundry",
"cloud-deployment-cloud-foundry-services":"deployment.cloud.cloud-foundry.binding-to-services",
"cloud-deployment-gae":"deployment.cloud.google",
"cloud-deployment-heroku":"deployment.cloud.heroku",
"cloud-deployment-kubernetes":"deployment.cloud.kubernetes",
"cloud-deployment-kubernetes-container-lifecycle":"deployment.cloud.kubernetes.container-lifecycle",
"cloud-deployment-openshift":"deployment.cloud.openshift",
"common-application-properties":"application-properties",
"common-application-properties-actuator":"application-properties.actuator",
"common-application-properties-cache":"application-properties.cache",
"common-application-properties-core":"application-properties.core",
"common-application-properties-data":"application-properties.data",
"common-application-properties-data-migration":"application-properties.data-migration",
"common-application-properties-devtools":"application-properties.devtools",
"common-application-properties-integration":"application-properties.integration",
"common-application-properties-json":"application-properties.json",
"common-application-properties-mail":"application-properties.mail",
"common-application-properties-rsocket":"application-properties.rsocket",
"common-application-properties-security":"application-properties.security",
"common-application-properties-server":"application-properties.server",
"common-application-properties-templating":"application-properties.templating",
"common-application-properties-testing":"application-properties.testing",
"common-application-properties-transaction":"application-properties.transaction",
"common-application-properties-web":"application-properties.web",
"configuration-metadata-additional-metadata":"configuration-metadata.annotation-processor.adding-additional-metadata",
"configuration-metadata-annotation-processor":"configuration-metadata.annotation-processor",
"configuration-metadata-annotation-processor-metadata-generation":"configuration-metadata.annotation-processor.automatic-metadata-generation",
"configuration-metadata-annotation-processor-metadata-generation-nested":"configuration-metadata.annotation-processor.automatic-metadata-generation.nested-properties",
"configuration-metadata-annotation-processor-setup":"configuration-metadata.annotation-processor.configuring",
"configuration-metadata-format":"configuration-metadata.format",
"configuration-metadata-group-attributes":"configuration-metadata.format.group",
"configuration-metadata-hints-attributes":"configuration-metadata.format.hints",
"configuration-metadata-property-attributes":"configuration-metadata.format.property",
"configuration-metadata-providing-manual-hints":"configuration-metadata.manual-hints",
"configuration-metadata-providing-manual-hints-any":"configuration-metadata.manual-hints.value-providers.any",
"configuration-metadata-providing-manual-hints-class-reference":"configuration-metadata.manual-hints.value-providers.class-reference",
"configuration-metadata-providing-manual-hints-handle-as":"configuration-metadata.manual-hints.value-providers.handle-as",
"configuration-metadata-providing-manual-hints-logger-name":"configuration-metadata.manual-hints.value-providers.logger-name",
"configuration-metadata-providing-manual-hints-spring-bean-reference":"configuration-metadata.manual-hints.value-providers.spring-bean-reference",
"configuration-metadata-providing-manual-hints-spring-profile-name":"configuration-metadata.manual-hints.value-providers.spring-profile-name",
"configuration-metadata-providing-manual-hints-value-hint":"configuration-metadata.manual-hints.value-hint",
"configuration-metadata-providing-manual-hints-value-providers":"configuration-metadata.manual-hints.value-providers",
"configuration-metadata-repeated-items":"configuration-metadata.format.repeated-items",
"configuring-file-system-watcher":"using.devtools.globalsettings.configuring-file-system-watcher",
"containers-deployment":"deployment.containers",
"core-properties":"application-properties.core",
"data-migration-properties":"application-properties.data-migration",
"data-properties":"application-properties.data",
"dependency-versions-coordinates":"dependency-versions.coordinates",
"dependency-versions-properties":"dependency-versions.properties",
"deployment-initd-service":"deployment.installing.nix-services.init-d",
"deployment-initd-service-securing":"deployment.installing.nix-services.init-d.securing",
"deployment-install":"deployment.installing",
"deployment-install-supported-operating-systems":"deployment.installing.supported-operating-systems",
"deployment-script-customization":"deployment.installing.nix-services.script-customization",
"deployment-script-customization-when-it-runs":"deployment.installing.nix-services.script-customization.when-running",
"deployment-script-customization-when-it-written":"deployment.installing.nix-services.script-customization.when-written",
"deployment-service":"deployment.installing.nix-services",
"deployment-systemd-service":"deployment.installing.nix-services.system-d",
"deployment-whats-next":"deployment.whats-next",
"deployment-windows":"deployment.installing.windows-services",
"deployment.containers":"container-images.efficient-images.unpacking",
"devtools-properties":"application-properties.devtools",
"executable-jar-alternatives":"executable-jar.alternatives",
"executable-jar-jar-file-structure":"executable-jar.nested-jars.jar-structure",
"executable-jar-jarfile":"executable-jar.jarfile-class",
"executable-jar-jarfile-compatibility":"executable-jar.jarfile-class.compatibility",
"executable-jar-launcher-manifest":"executable-jar.launching.manifest",
"executable-jar-launching":"executable-jar.launching",
"executable-jar-nested-jars":"executable-jar.nested-jars",
"executable-jar-property-launcher-features":"executable-jar.property-launcher",
"executable-jar-restrictions":"executable-jar.restrictions",
"executable-jar-war-file-structure":"executable-jar.nested-jars.war-structure",
"executable-jar-war-index-files":"executable-jar.nested-jars.index-files",
"executable-jar-war-index-files-classpath":"executable-jar.nested-jars.classpath-index",
"executable-jar-war-index-files-layers":"executable-jar.nested-jars.layer-index",
"features.caching":"io.caching",
"features.caching.provider":"io.caching.provider",
"features.caching.provider.caffeine":"io.caching.provider.caffeine",
"features.caching.provider.couchbase":"io.caching.provider.couchbase",
"features.caching.provider.ehcache2":"io.caching.provider.ehcache2",
"features.caching.provider.generic":"io.caching.provider.generic",
"features.caching.provider.hazelcast":"io.caching.provider.hazelcast",
"features.caching.provider.infinispan":"io.caching.provider.infinispan",
"features.caching.provider.jcache":"io.caching.provider.jcache",
"features.caching.provider.none":"io.caching.provider.none",
"features.caching.provider.redis":"io.caching.provider.redis",
"features.caching.provider.simple":"io.caching.provider.simple",
"features.container-images":"container-images.efficient-images",
"features.container-images.building":"container-images.efficient-images",
"features.container-images.building.buildpacks":"container-images.buildpacks",
"features.container-images.building.dockerfiles":"container-images.dockerfiles",
"features.container-images.layering":"container-images.efficient-images.layering",
"features.developing-web-applications":"web",
"features.developing-web-applications.embedded-container":"web.servlet.embedded-container",
"features.developing-web-applications.embedded-container.application-context":"web.servlet.embedded-container.application-context",
"features.developing-web-applications.embedded-container.context-initializer":"web.servlet.embedded-container.context-initializer",
"features.developing-web-applications.embedded-container.context-initializer.scanning":"web.servlet.embedded-container.context-initializer.scanning",
"features.developing-web-applications.embedded-container.customizing":"web.servlet.embedded-container.customizing",
"features.developing-web-applications.embedded-container.customizing.direct":"web.servlet.embedded-container.customizing.direct",
"features.developing-web-applications.embedded-container.customizing.programmatic":"web.servlet.embedded-container.customizing.programmatic",
"features.developing-web-applications.embedded-container.jsp-limitations":"web.servlet.embedded-container.jsp-limitations",
"features.developing-web-applications.embedded-container.servlets-filters-listeners":"web.servlet.embedded-container.servlets-filters-listeners",
"features.developing-web-applications.embedded-container.servlets-filters-listeners.beans":"web.servlet.embedded-container.servlets-filters-listeners.beans",
"features.developing-web-applications.jersey":"web.servlet.jersey",
"features.developing-web-applications.reactive-server":"web.reactive.reactive-server",
"features.developing-web-applications.reactive-server-resources-configuration":"web.reactive.reactive-server-resources-configuration",
"features.developing-web-applications.spring-mvc":"web.servlet.spring-mvc",
"features.developing-web-applications.spring-mvc.auto-configuration":"web.servlet.spring-mvc.auto-configuration",
"features.developing-web-applications.spring-mvc.binding-initializer":"web.servlet.spring-mvc.binding-initializer",
"features.developing-web-applications.spring-mvc.content-negotiation":"web.servlet.spring-mvc.content-negotiation",
"features.developing-web-applications.spring-mvc.cors":"web.servlet.spring-mvc.cors",
"features.developing-web-applications.spring-mvc.error-handling":"web.servlet.spring-mvc.error-handling",
"features.developing-web-applications.spring-mvc.error-handling.error-pages":"web.servlet.spring-mvc.error-handling.error-pages",
"features.developing-web-applications.spring-mvc.error-handling.error-pages-without-spring-mvc":"web.servlet.spring-mvc.error-handling.error-pages-without-spring-mvc",
"features.developing-web-applications.spring-mvc.error-handling.in-a-war-deployment":"web.servlet.spring-mvc.error-handling.in-a-war-deployment",
"features.developing-web-applications.spring-mvc.json":"web.servlet.spring-mvc.json",
"features.developing-web-applications.spring-mvc.message-codes":"web.servlet.spring-mvc.message-codes",
"features.developing-web-applications.spring-mvc.message-converters":"web.servlet.spring-mvc.message-converters",
"features.developing-web-applications.spring-mvc.static-content":"web.servlet.spring-mvc.static-content",
"features.developing-web-applications.spring-mvc.template-engines":"web.servlet.spring-mvc.template-engines",
"features.developing-web-applications.spring-mvc.welcome-page":"web.servlet.spring-mvc.welcome-page",
"features.developing-web-applications.spring-webflux":"web.reactive.webflux",
"features.developing-web-applications.spring-webflux.auto-configuration":"web.reactive.webflux.auto-configuration",
"features.developing-web-applications.spring-webflux.error-handling":"web.reactive.webflux.error-handling",
"features.developing-web-applications.spring-webflux.error-pages":"web.reactive.webflux.error-handling.error-pages",
"features.developing-web-applications.spring-webflux.httpcodecs":"web.reactive.webflux.httpcodecs",
"features.developing-web-applications.spring-webflux.static-context":"web.reactive.webflux.static-content",
"features.developing-web-applications.spring-webflux.template-engines":"web.reactive.webflux.template-engines",
"features.developing-web-applications.spring-webflux.web-filters":"web.reactive.webflux.web-filters",
"features.developing-web-applications.spring-webflux.welcome-page":"web.reactive.webflux.welcome-page",
"features.email":"io.email",
"features.graceful-shutdown":"web.graceful-shutdown",
"features.jmx":"actuator.jmx",
"features.jta":"io.jta",
"features.jta.atomikos":"io.jta.atomikos",
"features.jta.javaee":"io.jta.javaee",
"features.jta.mixing-xa-and-non-xa-connections":"io.jta.mixing-xa-and-non-xa-connections",
"features.jta.supporting-alternative-embedded-transaction-manager":"io.jta.supporting-alternative-embedded-transaction-manager",
"features.messaging":"messaging",
"features.messaging.amqp":"messaging.amqp",
"features.messaging.amqp.rabbit":"messaging.amqp.rabbit",
"features.messaging.amqp.receiving":"messaging.amqp.receiving",
"features.messaging.amqp.sending":"messaging.amqp.sending",
"features.messaging.jms.activemq":"messaging.jms.activemq",
"features.messaging.jms.artemis":"messaging.jms.artemis",
"features.messaging.jms.jndi":"messaging.jms.jndi",
"features.messaging.jms.receiving":"messaging.jms.receiving",
"features.messaging.jms.sending":"messaging.jms.sending",
"features.messaging.kafka":"messaging.kafka",
"features.messaging.kafka.additional-properties":"messaging.kafka.additional-properties",
"features.messaging.kafka.embedded":"messaging.kafka.embedded",
"features.messaging.kafka.receiving":"messaging.kafka.receiving",
"features.messaging.kafka.sending":"messaging.kafka.sending",
"features.messaging.kafka.streams":"messaging.kafka.streams",
"features.nosql":"data.nosql",
"features.nosql.cassandra":"data.nosql.cassandra",
"features.nosql.cassandra.connecting":"data.nosql.cassandra.connecting",
"features.nosql.cassandra.repositories":"data.nosql.cassandra.repositories",
"features.nosql.couchbase":"data.nosql.couchbase",
"features.nosql.couchbase.connecting":"data.nosql.couchbase.connecting",
"features.nosql.couchbase.repositories":"data.nosql.couchbase.repositories",
"features.nosql.elasticsearch":"data.nosql.elasticsearch",
"features.nosql.elasticsearch.connecting-using-reactive-rest":"data.nosql.elasticsearch.connecting-using-reactive-rest",
"features.nosql.elasticsearch.connecting-using-rest":"data.nosql.elasticsearch.connecting-using-rest",
"features.nosql.elasticsearch.connecting-using-spring-data":"data.nosql.elasticsearch.connecting-using-spring-data",
"features.nosql.elasticsearch.repositories":"data.nosql.elasticsearch.repositories",
"features.nosql.influxdb":"data.nosql.influxdb",
"features.nosql.influxdb.connecting":"data.nosql.influxdb.connecting",
"features.nosql.ldap":"data.nosql.ldap",
"features.nosql.ldap.connecting":"data.nosql.ldap.connecting",
"features.nosql.ldap.embedded":"data.nosql.ldap.embedded",
"features.nosql.ldap.repositories":"data.nosql.ldap.repositories",
"features.nosql.mongodb":"data.nosql.mongodb",
"features.nosql.mongodb.connecting":"data.nosql.mongodb.connecting",
"features.nosql.mongodb.embedded":"data.nosql.mongodb.embedded",
"features.nosql.mongodb.repositories":"data.nosql.mongodb.repositories",
"features.nosql.mongodb.template":"data.nosql.mongodb.template",
"features.nosql.neo4j":"data.nosql.neo4j",
"features.nosql.neo4j.connecting":"data.nosql.neo4j.connecting",
"features.nosql.neo4j.repositories":"data.nosql.neo4j.repositories",
"features.nosql.redis":"data.nosql.redis",
"features.nosql.redis.connecting":"data.nosql.redis.connecting",
"features.nosql.solr":"data.nosql.solr",
"features.nosql.solr.connecting":"data.nosql.solr.connecting",
"features.quartz":"io.quartz",
"features.resttemplate":"io.rest-client.resttemplate",
"features.resttemplate.customization":"io.rest-client.resttemplate.customization",
"features.rsocket":"messaging.rsocket",
"features.rsocket.messaging":"messaging.rsocket.messaging",
"features.rsocket.requester":"messaging.rsocket.requester",
"features.rsocket.server-auto-configuration":"messaging.rsocket.server-auto-configuration",
"features.rsocket.strategies-auto-configuration":"messaging.rsocket.strategies-auto-configuration",
"features.security":"web.security",
"features.security.actuator":"actuator.endpoints.security",
"features.security.actuator.csrf":"actuator.endpoints.security.csrf",
"features.security.authorization-server":"web.security.oauth2.authorization-server",
"features.security.oauth2":"web.security.oauth2",
"features.security.oauth2.client":"web.security.oauth2.client",
"features.security.oauth2.client.common-providers":"web.security.oauth2.client.common-providers",
"features.security.oauth2.server":"web.security.oauth2.server",
"features.security.saml2":"web.security.saml2",
"features.security.saml2.relying-party":"web.security.saml2.relying-party",
"features.security.spring-mvc":"web.security.spring-mvc",
"features.security.spring-webflux":"web.security.spring-webflux",
"features.spring-hateoas":"web.spring-hateoas",
"features.spring-integration":"messaging.spring-integration",
"features.spring-session":"web.spring-session",
"features.sql":"data.sql",
"features.sql.datasource":"data.sql.datasource",
"features.sql.datasource.configuration":"data.sql.datasource.configuration",
"features.sql.datasource.connection-pool":"data.sql.datasource.connection-pool",
"features.sql.datasource.embedded":"data.sql.datasource.embedded",
"features.sql.datasource.jndi":"data.sql.datasource.jndi",
"features.sql.datasource.production":"data.sql.datasource.production",
"features.sql.h2-web-console":"data.sql.h2-web-console",
"features.sql.h2-web-console.custom-path":"data.sql.h2-web-console.custom-path",
"features.sql.jdbc":"data.sql.jdbc",
"features.sql.jdbc-template":"data.sql.jdbc-template",
"features.sql.jooq":"data.sql.jooq",
"features.sql.jooq.codegen":"data.sql.jooq.codegen",
"features.sql.jooq.customizing":"data.sql.jooq.customizing",
"features.sql.jooq.dslcontext":"data.sql.jooq.dslcontext",
"features.sql.jooq.sqldialect":"data.sql.jooq.sqldialect",
"features.sql.jpa-and-spring-data":"data.sql.jpa-and-spring-data",
"features.sql.jpa-and-spring-data.creating-and-dropping":"data.sql.jpa-and-spring-data.creating-and-dropping",
"features.sql.jpa-and-spring-data.entity-classes":"data.sql.jpa-and-spring-data.entity-classes",
"features.sql.jpa-and-spring-data.envers-repositories":"data.sql.jpa-and-spring-data.envers-repositories",
"features.sql.jpa-and-spring-data.open-entity-manager-in-view":"data.sql.jpa-and-spring-data.open-entity-manager-in-view",
"features.sql.jpa-and-spring-data.repositories":"data.sql.jpa-and-spring-data.repositories",
"features.sql.r2dbc":"data.sql.r2dbc",
"features.sql.r2dbc.embedded":"data.sql.r2dbc.embedded",
"features.sql.r2dbc.repositories":"data.sql.r2dbc.repositories",
"features.sql.r2dbc.using-database-client":"data.sql.r2dbc.using-database-client",
"features.validation":"io.validation",
"features.webclient":"io.rest-client.webclient",
"features.webclient.customization":"io.rest-client.webclient.customization",
"features.webclient.runtime":"io.rest-client.webclient.runtime",
"features.webservices":"io.webservices",
"features.webservices.template":"io.webservices.template",
"features.websockets":"messaging.websockets",
"getting-started-cli-command-line-completion":"getting-started.installing.cli.completion",
"getting-started-cli-example":"getting-started.installing.cli.quick-start",
"getting-started-first-application":"getting-started.first-application",
"getting-started-first-application-annotations":"getting-started.first-application.code.mvc-annotations",
"getting-started-first-application-auto-configuration":"getting-started.first-application.code.enable-auto-configuration",
"getting-started-first-application-code":"getting-started.first-application.code",
"getting-started-first-application-dependencies":"getting-started.first-application.dependencies",
"getting-started-first-application-executable-jar":"getting-started.first-application.executable-jar",
"getting-started-first-application-main-method":"getting-started.first-application.code.main-method",
"getting-started-first-application-pom":"getting-started.first-application.pom",
"getting-started-first-application-run":"getting-started.first-application.run",
"getting-started-gradle-installation":"getting-started.installing.java.gradle",
"getting-started-homebrew-cli-installation":"getting-started.installing.cli.homebrew",
"getting-started-installation-instructions-for-java":"getting-started.installing.java",
"getting-started-installing-spring-boot":"getting-started.installing",
"getting-started-installing-the-cli":"getting-started.installing.cli",
"getting-started-introducing-spring-boot":"getting-started.introducing-spring-boot",
"getting-started-macports-cli-installation":"getting-started.installing.cli.macports",
"getting-started-manual-cli-installation":"getting-started.installing.cli.manual-installation",
"getting-started-maven-installation":"getting-started.installing.java.maven",
"getting-started-scoop-cli-installation":"getting-started.installing.cli.scoop",
"getting-started-sdkman-cli-installation":"getting-started.installing.cli.sdkman",
"getting-started-system-requirements":"getting-started.system-requirements",
"getting-started-system-requirements-servlet-containers":"getting-started.system-requirements.servlet-containers",
"getting-started-upgrading-from-an-earlier-version":"getting-started.installing.upgrading",
"getting-started-whats-next":"getting-started.whats-next",
"how-to-enable-http-response-compression":"howto.webserver.enable-response-compression",
"howto-actuator":"howto.actuator",
"howto-add-a-servlet-filter-or-listener":"howto.webserver.add-servlet-filter-listener",
"howto-add-a-servlet-filter-or-listener-as-spring-bean":"howto.webserver.add-servlet-filter-listener.spring-bean",
"howto-add-a-servlet-filter-or-listener-using-scanning":"howto.webserver.add-servlet-filter-listener.using-scanning",
"howto-automatic-expansion":"howto.properties-and-configuration.expand-properties",
"howto-automatic-expansion-gradle":"howto.properties-and-configuration.expand-properties.gradle",
"howto-automatic-expansion-maven":"howto.properties-and-configuration.expand-properties.maven",
"howto-batch-applications":"howto.batch",
"howto-build":"howto.build",
"howto-build-an-application-context-hierarchy":"howto.application.context-hierarchy",
"howto-build-an-executable-archive-with-ant":"howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib",
"howto-build-info":"howto.build.generate-info",
"howto-change-configuration-depending-on-the-environment":"howto.properties-and-configuration.change-configuration-depending-on-the-environment",
"howto-change-the-http-port":"howto.webserver.change-port",
"howto-change-the-http-port-or-address-of-the-actuator-endpoints":"howto.actuator.change-http-port-or-address",
"howto-change-the-location-of-external-properties":"howto.properties-and-configuration.external-properties-location",
"howto-change-the-user-details-service-and-add-user-accounts":"howto.security.change-user-details-service-and-add-user-accounts",
"howto-configure-a-component-that-is-used-by-JPA":"howto.data-access.configure-a-component-that-is-used-by-jpa",
"howto-configure-a-datasource":"howto.data-access.configure-custom-datasource",
"howto-configure-accesslogs":"howto.webserver.configure-access-logs",
"howto-configure-hibernate-naming-strategy":"howto.data-access.configure-hibernate-naming-strategy",
"howto-configure-hibernate-second-level-caching":"howto.data-access.configure-hibernate-second-level-caching",
"howto-configure-http2":"howto.webserver.configure-http2",
"howto-configure-http2-jetty":"howto.webserver.configure-http2.jetty",
"howto-configure-http2-netty":"howto.webserver.configure-http2.netty",
"howto-configure-http2-tomcat":"howto.webserver.configure-http2.tomcat",
"howto-configure-http2-undertow":"howto.webserver.configure-http2.undertow",
"howto-configure-jOOQ-with-multiple-datasources":"howto.data-access.configure-jooq-with-multiple-datasources",
"howto-configure-jpa-properties":"howto.data-access.jpa-properties",
"howto-configure-log4j-for-logging":"howto.logging.log4j",
"howto-configure-log4j-for-logging-yaml-or-json-config":"howto.logging.log4j.yaml-or-json-config",
"howto-configure-logback-for-logging":"howto.logging.logback",
"howto-configure-logback-for-logging-fileonly":"howto.logging.logback.file-only-output",
"howto-configure-ssl":"howto.webserver.configure-ssl",
"howto-configure-webserver":"howto.webserver.configure",
"howto-convert-an-existing-application-to-spring-boot":"howto.traditional-deployment.convert-existing-application",
"howto-create-a-deployable-war-file":"howto.traditional-deployment.war",
"howto-create-a-non-web-application":"howto.application.non-web-application",
"howto-create-a-nonexecutable-jar":"howto.build.create-a-nonexecutable-jar",
"howto-create-an-additional-executable-jar":"howto.build.use-a-spring-boot-application-as-dependency",
"howto-create-an-executable-jar-with-maven":"howto.build.create-an-executable-jar-with-maven",
"howto-create-websocket-endpoints-using-serverendpoint":"howto.webserver.create-websocket-endpoints-using-serverendpoint",
"howto-customize-dependency-versions":"howto.build.customize-dependency-versions",
"howto-customize-the-environment-or-application-context":"howto.application.customize-the-environment-or-application-context",
"howto-customize-the-jackson-objectmapper":"howto.spring-mvc.customize-jackson-objectmapper",
"howto-customize-the-responsebody-rendering":"howto.spring-mvc.customize-responsebody-rendering",
"howto-customize-the-whitelabel-error-page":"howto.actuator.customize-whitelabel-error-page",
"howto-customize-tomcat-behind-a-proxy-server":"howto.webserver.use-behind-a-proxy-server.tomcat",
"howto-customize-view-resolvers":"howto.spring-mvc.customize-view-resolvers",
"howto-data-access":"howto.data-access",
"howto-database-initialization":"howto.data-initialization",
"howto-disable-registration-of-a-servlet-or-filter":"howto.webserver.add-servlet-filter-listener.spring-bean.disable",
"howto-disable-web-server":"howto.webserver.disable",
"howto-discover-build-in-options-for-external-properties":"howto.properties-and-configuration.discover-build-in-options-for-external-properties",
"howto-discover-the-http-port-at-runtime":"howto.webserver.discover-port",
"howto-embedded-web-servers":"howto.webserver",
"howto-enable-https":"howto.security.enable-https",
"howto-enable-multiple-connectors-in-tomcat":"howto.webserver.enable-multiple-connectors-in-tomcat",
"howto-enable-multiple-listeners-in-undertow":"howto.webserver.enable-multiple-listeners-in-undertow",
"howto-enable-tomcat-mbean-registry":"howto.webserver.enable-tomcat-mbean-registry",
"howto-execute-flyway-database-migrations-on-startup":"howto.data-initialization.migration-tool.flyway",
"howto-execute-liquibase-database-migrations-on-startup":"howto.data-initialization.migration-tool.liquibase",
"howto-externalize-configuration":"howto.properties-and-configuration.externalize-configuration",
"howto-extract-specific-libraries-when-an-executable-jar-runs":"howto.build.extract-specific-libraries-when-an-executable-jar-runs",
"howto-failure-analyzer":"howto.application.failure-analyzer",
"howto-git-info":"howto.build.generate-git-info",
"howto-hotswapping":"howto.hotswapping",
"howto-http-clients":"howto.http-clients",
"howto-http-clients-proxy-configuration":"howto.http-clients.rest-template-proxy-configuration",
"howto-initialize-a-database-configuring-dependencies":"howto.data-initialization.dependencies",
"howto-initialize-a-database-configuring-dependencies-depends-on-initialization-detection":"howto.data-initialization.dependencies.depends-on-initialization-detection",
"howto-initialize-a-database-configuring-dependencies-initializer-detection":"howto.data-initialization.dependencies.initializer-detection",
"howto-initialize-a-database-using-basic-scripts":"howto.data-initialization.using-basic-sql-scripts",
"howto-initialize-a-database-using-hibernate":"howto.data-initialization.using-hibernate",
"howto-initialize-a-database-using-jpa":"howto.data-initialization.using-jpa",
"howto-initialize-a-spring-batch-database":"howto.data-initialization.batch",
"howto-jersey":"howto.jersey",
"howto-jersey-alongside-another-web-framework":"howto.jersey.alongside-another-web-framework",
"howto-jersey-spring-security":"howto.jersey.spring-security",
"howto-jms-disable-transaction":"howto.messaging.disable-transacted-jms-session",
"howto-logging":"howto.logging",
"howto-map-health-indicators-to-metrics":"howto.actuator.map-health-indicators-to-metrics",
"howto-messaging":"howto.messaging",
"howto-multipart-file-upload-configuration":"howto.spring-mvc.multipart-file-uploads",
"howto-properties-and-configuration":"howto.properties-and-configuration",
"howto-reload-fast-restart":"howto.hotswapping.fast-application-restarts",
"howto-reload-freemarker-content":"howto.hotswapping.reload-templates.freemarker",
"howto-reload-groovy-template-content":"howto.hotswapping.reload-templates.groovy",
"howto-reload-java-classes-without-restarting":"howto.hotswapping.reload-java-classes-without-restarting",
"howto-reload-static-content":"howto.hotswapping.reload-static-content",
"howto-reload-thymeleaf-content":"howto.hotswapping.reload-templates.thymeleaf",
"howto-reload-thymeleaf-template-content":"howto.hotswapping.reload-templates",
"howto-remote-debug-maven-run":"howto.build.remote-debug-maven",
"howto-sanitize-sensible-values":"howto.actuator.sanitize-sensitive-values",
"howto-sanitize-sensitive-values":"howto.actuator.sanitize-sensitive-values",
"howto-security":"howto.security",
"howto-separate-entity-definitions-from-spring-configuration":"howto.data-access.separate-entity-definitions-from-spring-configuration",
"howto-set-active-spring-profiles":"howto.properties-and-configuration.set-active-spring-profiles",
"howto-spring-batch-running-command-line":"howto.batch.running-from-the-command-line",
"howto-spring-batch-running-jobs-on-startup":"howto.batch.running-jobs-on-startup",
"howto-spring-batch-specifying-a-data-source":"howto.batch.specifying-a-data-source",
"howto-spring-batch-storing-job-repository":"howto.batch.storing-job-repository",
"howto-spring-boot-application":"howto.application",
"howto-spring-mvc":"howto.spring-mvc",
"howto-switch-off-default-mvc-configuration":"howto.spring-mvc.switch-off-default-configuration",
"howto-switch-off-spring-boot-security-configuration":"howto.security.switch-off-spring-boot-configuration",
"howto-switch-off-the-spring-mvc-dispatcherservlet":"howto.spring-mvc.switch-off-dispatcherservlet",
"howto-testcontainers":"howto.testing.testcontainers",
"howto-traditional-deployment":"howto.traditional-deployment",
"howto-troubleshoot-auto-configuration":"howto.application.troubleshoot-auto-configuration",
"howto-two-datasources":"howto.data-access.configure-two-datasources",
"howto-use-a-higher-level-database-migration-tool":"howto.data-initialization.migration-tool",
"howto-use-another-web-server":"howto.webserver.use-another",
"howto-use-behind-a-proxy-server":"howto.webserver.use-behind-a-proxy-server",
"howto-use-custom-entity-manager":"howto.data-access.use-custom-entity-manager",
"howto-use-customize-spring-datas-web-support":"howto.data-access.customize-spring-data-web-support",
"howto-use-dependency-injection-hibernate-components":"howto.data-access.dependency-injection-in-hibernate-components",
"howto-use-exposing-spring-data-repositories-rest-endpoint":"howto.data-access.exposing-spring-data-repositories-as-rest",
"howto-use-jedis-instead-of-lettuce":"howto.nosql.jedis-instead-of-lettuce",
"howto-use-multiple-entity-managers":"howto.data-access.use-multiple-entity-managers",
"howto-use-short-command-line-arguments":"howto.properties-and-configuration.short-command-line-arguments",
"howto-use-spring-data-jpa--and-mongo-repositories":"howto.data-access.use-spring-data-jpa-and-mongo-repositories",
"howto-use-spring-data-repositories":"howto.data-access.spring-data-repositories",
"howto-use-test-with-spring-security":"howto.spring-mvc.testing.with-spring-security",
"howto-use-tomcat-legacycookieprocessor":"howto.webserver.use-tomcat-legacycookieprocessor",
"howto-use-traditional-persistence-xml":"howto.data-access.use-traditional-persistence-xml",
"howto-use-two-entity-managers":"howto.data-access.use-multiple-entity-managers",
"howto-use-yaml-for-external-properties":"howto.properties-and-configuration.yaml",
"howto-user-a-random-unassigned-http-port":"howto.webserver.use-random-port",
"howto-webclient-reactor-netty-customization":"howto.http-clients.webclient-reactor-netty-customization",
"howto-weblogic":"howto.traditional-deployment.weblogic",
"howto-write-a-json-rest-service":"howto.spring-mvc.write-json-rest-service",
"howto-write-an-xml-rest-service":"howto.spring-mvc.write-xml-rest-service",
"integration-properties":"application-properties.integration",
"json-properties":"application-properties.json",
"mail-properties":"application-properties.mail",
"production-ready":"actuator",
"production-ready-application-info":"actuator.endpoints.info",
"production-ready-application-info-autoconfigure":"actuator.endpoints.info.auto-configured-info-contributors",
"production-ready-application-info-build":"actuator.endpoints.info.build-information",
"production-ready-application-info-custom":"actuator.endpoints.info.writing-custom-info-contributors",
"production-ready-application-info-env":"actuator.endpoints.info.custom-application-information",
"production-ready-application-info-git":"actuator.endpoints.info.git-commit-information",
"production-ready-auditing":"actuator.auditing",
"production-ready-auditing-custom":"actuator.auditing.custom",
"production-ready-cloudfoundry":"actuator.cloud-foundry",
"production-ready-cloudfoundry-disable":"actuator.cloud-foundry.disable",
"production-ready-cloudfoundry-ssl":"actuator.cloud-foundry.ssl",
"production-ready-custom-context-path":"actuator.cloud-foundry.custom-context-path",
"production-ready-custom-mbean-names":"actuator.jmx.custom-mbean-names",
"production-ready-customizing-jolokia":"actuator.jmx.jolokia.customizing",
"production-ready-customizing-management-server-address":"actuator.monitoring.customizing-management-server-address",
"production-ready-customizing-management-server-context-path":"actuator.monitoring.customizing-management-server-context-path",
"production-ready-customizing-management-server-port":"actuator.monitoring.customizing-management-server-port",
"production-ready-disable-jmx-endpoints":"actuator.jmx.disable-jmx-endpoints",
"production-ready-disabling-http-endpoints":"actuator.monitoring.disabling-http-endpoints",
"production-ready-disabling-jolokia":"actuator.jmx.jolokia.disabling",
"production-ready-enabling":"actuator.enabling",
"production-ready-endpoints":"actuator.endpoints",
"production-ready-endpoints-caching":"actuator.endpoints.caching",
"production-ready-endpoints-cors":"actuator.endpoints.cors",
"production-ready-endpoints-custom":"actuator.endpoints.implementing-custom",
"production-ready-endpoints-custom-controller":"actuator.endpoints.implementing-custom.controller",
"production-ready-endpoints-custom-input":"actuator.endpoints.implementing-custom.input",
"production-ready-endpoints-custom-input-conversion":"actuator.endpoints.implementing-custom.input.conversion",
"production-ready-endpoints-custom-servlet":"actuator.endpoints.implementing-custom.servlet",
"production-ready-endpoints-custom-web":"actuator.endpoints.implementing-custom.web",
"production-ready-endpoints-custom-web-predicate":"actuator.endpoints.implementing-custom.web.request-predicates",
"production-ready-endpoints-custom-web-predicate-consumes":"actuator.endpoints.implementing-custom.web.consumes-predicates",
"production-ready-endpoints-custom-web-predicate-http-method":"actuator.endpoints.implementing-custom.web.method-predicates",
"production-ready-endpoints-custom-web-predicate-path":"actuator.endpoints.implementing-custom.web.path-predicates",
"production-ready-endpoints-custom-web-predicate-produces":"actuator.endpoints.implementing-custom.web.produces-predicates",
"production-ready-endpoints-custom-web-range-requests":"actuator.endpoints.implementing-custom.web.range-requests",
"production-ready-endpoints-custom-web-response-status":"actuator.endpoints.implementing-custom.web.response-status",
"production-ready-endpoints-custom-web-security":"actuator.endpoints.implementing-custom.web.security",
"production-ready-endpoints-enabling-endpoints":"actuator.endpoints.enabling",
"production-ready-endpoints-exposing-endpoints":"actuator.endpoints.exposing",
"production-ready-endpoints-hypermedia":"actuator.endpoints.hypermedia",
"production-ready-endpoints-security":"actuator.endpoints.security",
"production-ready-health":"actuator.endpoints.health",
"production-ready-health-datasource":"actuator.endpoints.health.datasource",
"production-ready-health-groups":"actuator.endpoints.health.groups",
"production-ready-health-indicators":"actuator.endpoints.health.auto-configured-health-indicators",
"production-ready-health-indicators-writing":"actuator.endpoints.health.writing-custom-health-indicators",
"production-ready-http-tracing":"actuator.tracing",
"production-ready-http-tracing-custom":"actuator.tracing.custom",
"production-ready-jmx":"actuator.jmx",
"production-ready-jolokia":"actuator.jmx.jolokia",
"production-ready-kubernetes-probes":"actuator.endpoints.kubernetes-probes",
"production-ready-kubernetes-probes-external-state":"actuator.endpoints.kubernetes-probes.external-state",
"production-ready-kubernetes-probes-lifecycle":"actuator.endpoints.kubernetes-probes.lifecycle",
"production-ready-logger-configuration":"actuator.loggers.configure",
"production-ready-loggers":"actuator.loggers",
"production-ready-management-specific-ssl":"actuator.monitoring.management-specific-ssl",
"production-ready-metrics":"actuator.metrics",
"production-ready-metrics-cache":"actuator.metrics.supported.cache",
"production-ready-metrics-common-tags":"actuator.metrics.customizing.common-tags",
"production-ready-metrics-custom":"actuator.metrics.registering-custom",
"production-ready-metrics-customizing":"actuator.metrics.customizing",
"production-ready-metrics-data-repository":"actuator.metrics.supported.spring-data-repository",
"production-ready-metrics-endpoint":"actuator.metrics.endpoint",
"production-ready-metrics-export":"actuator.metrics.export",
"production-ready-metrics-export-appoptics":"actuator.metrics.export.appoptics",
"production-ready-metrics-export-atlas":"actuator.metrics.export.atlas",
"production-ready-metrics-export-datadog":"actuator.metrics.export.datadog",
"production-ready-metrics-export-dynatrace":"actuator.metrics.export.dynatrace",
"production-ready-metrics-export-elastic":"actuator.metrics.export.elastic",
"production-ready-metrics-export-ganglia":"actuator.metrics.export.ganglia",
"production-ready-metrics-export-graphite":"actuator.metrics.export.graphite",
"production-ready-metrics-export-humio":"actuator.metrics.export.humio",
"production-ready-metrics-export-influx":"actuator.metrics.export.influx",
"production-ready-metrics-export-jmx":"actuator.metrics.export.jmx",
"production-ready-metrics-export-kairos":"actuator.metrics.export.kairos",
"production-ready-metrics-export-newrelic":"actuator.metrics.export.newrelic",
"production-ready-metrics-export-prometheus":"actuator.metrics.export.prometheus",
"production-ready-metrics-export-signalfx":"actuator.metrics.export.signalfx",
"production-ready-metrics-export-simple":"actuator.metrics.export.simple",
"production-ready-metrics-export-stackdriver":"actuator.metrics.export.stackdriver",
"production-ready-metrics-export-statsd":"actuator.metrics.export.statsd",
"production-ready-metrics-export-wavefront":"actuator.metrics.export.wavefront",
"production-ready-metrics-getting-started":"actuator.metrics.getting-started",
"production-ready-metrics-hibernate":"actuator.metrics.supported.hibernate",
"production-ready-metrics-http-clients":"actuator.metrics.supported.http-clients",
"production-ready-metrics-integration":"actuator.metrics.supported.spring-integration",
"production-ready-metrics-jdbc":"actuator.metrics.supported.jdbc",
"production-ready-metrics-jersey-server":"actuator.metrics.supported.jersey",
"production-ready-metrics-jvm":"actuator.metrics.supported.jvm",
"production-ready-metrics-kafka":"actuator.metrics.supported.kafka",
"production-ready-metrics-logger":"actuator.metrics.supported.logger",
"production-ready-metrics-meter":"actuator.metrics.supported",
"production-ready-metrics-mongodb":"actuator.metrics.supported.mongodb",
"production-ready-metrics-mongodb-command":"actuator.metrics.supported.mongodb.command",
"production-ready-metrics-mongodb-connectionpool":"actuator.metrics.supported.mongodb.connection-pool",
"production-ready-metrics-per-meter-properties":"actuator.metrics.customizing.per-meter-properties",
"production-ready-metrics-rabbitmq":"actuator.metrics.supported.rabbitmq",
"production-ready-metrics-spring-mvc":"actuator.metrics.supported.spring-mvc",
"production-ready-metrics-system":"actuator.metrics.supported.system",
"production-ready-metrics-timed-annotation":"actuator.metrics.supported.timed-annotation",
"production-ready-metrics-tomcat":"actuator.metrics.supported.tomcat",
"production-ready-metrics-web-flux":"actuator.metrics.supported.spring-webflux",
"production-ready-monitoring":"actuator.monitoring",
"production-ready-process-monitoring":"actuator.process-monitoring",
"production-ready-process-monitoring-configuration":"actuator.process-monitoring.configuration",
"production-ready-process-monitoring-programmatically":"actuator.process-monitoring.programmatically",
"production-ready-whats-next":"actuator.whats-next",
"reactive-health-indicators":"actuator.endpoints.health.reactive-health-indicators",
"reactive-health-indicators-autoconfigured":"actuator.endpoints.health.auto-configured-reactive-health-indicators",
"rsocket-properties":"application-properties.rsocket",
"running-remote-client-application":"using.devtools.remote-applications.client",
"security-properties":"application-properties.security",
"server-properties":"application-properties.server",
"spring-boot-ant-exejar":"build-tool-plugins.antlib.tasks.exejar",
"spring-boot-ant-exejar-examples":"build-tool-plugins.antlib.tasks.examples",
"spring-boot-ant-findmainclass":"build-tool-plugins.antlib.findmainclass",
"spring-boot-ant-findmainclass-examples":"build-tool-plugins.antlib.findmainclass.examples",
"spring-boot-ant-tasks":"build-tool-plugins.antlib.tasks",
"spring-boot-reference-documentation":"index",
"templating-properties":"application-properties.templating",
"test-auto-configuration-slices":"test-auto-configuration.slices",
"testing-properties":"application-properties.testing",
"transaction-properties":"application-properties.transaction",
"using-boot":"using",
"using-boot-ant":"using.build-systems.ant",
"using-boot-auto-configuration":"using.auto-configuration",
"using-boot-build-systems":"using.build-systems",
"using-boot-configuration-classes":"using.configuration-classes",
"using-boot-dependency-management":"using.build-systems.dependency-management",
"using-boot-devtools":"using.devtools",
"using-boot-devtools-customizing-classload":"using.devtools.restart.customizing-the-classload",
"using-boot-devtools-globalsettings":"using.devtools.globalsettings",
"using-boot-devtools-known-restart-limitations":"using.devtools.restart.limitations",
"using-boot-devtools-livereload":"using.devtools.livereload",
"using-boot-devtools-property-defaults":"using.devtools.property-defaults",
"using-boot-devtools-remote":"using.devtools.remote-applications",
"using-boot-devtools-remote-update":"using.devtools.remote-applications.update",
"using-boot-devtools-restart":"using.devtools.restart",
"using-boot-devtools-restart-additional-paths":"using.devtools.restart.watching-additional-paths",
"using-boot-devtools-restart-disable":"using.devtools.restart.disable",
"using-boot-devtools-restart-exclude":"using.devtools.restart.excluding-resources",
"using-boot-devtools-restart-logging-condition-delta":"using.devtools.restart.logging-condition-delta",
"using-boot-devtools-restart-triggerfile":"using.devtools.restart.triggerfile",
"using-boot-disabling-specific-auto-configuration":"using.auto-configuration.disabling-specific",
"using-boot-gradle":"using.build-systems.gradle",
"using-boot-hot-swapping":"using.running-your-application.hot-swapping",
"using-boot-importing-configuration":"using.configuration-classes.importing-additional-configuration",
"using-boot-importing-xml-configuration":"using.configuration-classes.importing-xml-configuration",
"using-boot-locating-the-main-class":"using.structuring-your-code.locating-the-main-class",
"using-boot-maven":"using.build-systems.maven",
"using-boot-packaging-for-production":"using.packaging-for-production",
"using-boot-replacing-auto-configuration":"using.auto-configuration.replacing",
"using-boot-running-as-a-packaged-application":"using.running-your-application.as-a-packaged-application",
"using-boot-running-from-an-ide":"using.running-your-application.from-an-ide",
"using-boot-running-with-the-gradle-plugin":"using.running-your-application.with-the-gradle-plugin",
"using-boot-running-with-the-maven-plugin":"using.running-your-application.with-the-maven-plugin",
"using-boot-running-your-application":"using.running-your-application",
"using-boot-spring-beans-and-dependency-injection":"using.spring-beans-and-dependency-injection",
"using-boot-starter":"using.build-systems.starters",
"using-boot-structuring-your-code":"using.structuring-your-code",
"using-boot-using-springbootapplication-annotation":"using.using-the-springbootapplication-annotation",
"using-boot-using-the-default-package":"using.structuring-your-code.using-the-default-package",
"using-boot-whats-next":"using.whats-next",
"using-spring-boot-restart-vs-reload":"using.devtools.restart.restart-vs-reload",
"web-properties":"application-properties.web"
}
</script>
</head>
<body id="howto" class="book toc2 toc-left"><div id="banner-container" class="container" role="banner">
<div id="banner" class="contained" role="banner">
<div id="switch-theme">
<input type="checkbox" id="switch-theme-checkbox">
<label for="switch-theme-checkbox">暗黑模式</label>
</div>
</div>
</div>
<div id="tocbar-container" class="container" role="navigation">
<div id="tocbar" class="contained" role="navigation">
<button id="toggle-toc"></button>
</div>
</div>
<div id="main-container" class="container">
<div id="main" class="contained">
<div id="doc" class="doc">
<div id="header">
<h1 translation-result="on">“操作方法”指南</h1>
<h1 translation-origin="off">“How-to” Guides</h1>
<div id="toc" class="toc2">
<div id="toctitle">目录</div>
<span id="back-to-index"><a href="index.html">返回索引页</a></span><ul class="sectlevel1">
<li>
  <p translation-result="on"><a href="howto.html#howto.application">1. Spring Boot 应用程序</a></p>
  <p translation-origin="off"><a href="howto.html#howto.application">1. Spring Boot Application</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.application.failure-analyzer">1.1. 创建你自己的故障分析器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.application.failure-analyzer">1.1. Create Your Own FailureAnalyzer</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.application.troubleshoot-auto-configuration">1.2. 自动配置故障排除</a></p>
  <p translation-origin="off"><a href="howto.html#howto.application.troubleshoot-auto-configuration">1.2. Troubleshoot Auto-configuration</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.application.customize-the-environment-or-application-context">1.3. 在启动之前自定义环境或 ApplicationContext</a></p>
  <p translation-origin="off"><a href="howto.html#howto.application.customize-the-environment-or-application-context">1.3. Customize the Environment or ApplicationContext Before It Starts</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.application.context-hierarchy">1.4. 构建 ApplicationContext 层次结构（添加父上下文或根上下文）</a></p>
  <p translation-origin="off"><a href="howto.html#howto.application.context-hierarchy">1.4. Build an ApplicationContext Hierarchy (Adding a Parent or Root Context)</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.application.non-web-application">1.5. 创建非 Web 应用程序</a></p>
  <p translation-origin="off"><a href="howto.html#howto.application.non-web-application">1.5. Create a Non-web Application</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration">2. 属性和配置</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration">2. Properties and Configuration</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.expand-properties">2.1. 在构建时自动展开属性</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.expand-properties">2.1. Automatically Expand Properties at Build Time</a></p>
<ul class="sectlevel3">
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.expand-properties.maven">2.1.1. 使用 Maven 自动扩展属性</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.expand-properties.maven">2.1.1. Automatic Property Expansion Using Maven</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.expand-properties.gradle">2.1.2. 使用 Gradle 自动扩展属性</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.expand-properties.gradle">2.1.2. Automatic Property Expansion Using Gradle</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.externalize-configuration">2.2. 外化 SpringApplication 的配置</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.externalize-configuration">2.2. Externalize the Configuration of SpringApplication</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.external-properties-location">2.3. 更改应用程序外部属性的位置</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.external-properties-location">2.3. Change the Location of External Properties of an Application</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.short-command-line-arguments">2.4. 使用“短”命令行参数</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.short-command-line-arguments">2.4. Use ‘Short’ Command Line Arguments</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.yaml">2.5. 将 YAML 用于外部属性</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.yaml">2.5. Use YAML for External Properties</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.set-active-spring-profiles">2.6. 设置活动 Spring 配置文件</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.set-active-spring-profiles">2.6. Set the Active Spring Profiles</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.set-default-spring-profile-name">2.7. 设置默认配置文件名称</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.set-default-spring-profile-name">2.7. Set the Default Profile Name</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.change-configuration-depending-on-the-environment">2.8. 根据环境更改配置</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.change-configuration-depending-on-the-environment">2.8. Change Configuration Depending on the Environment</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.properties-and-configuration.discover-build-in-options-for-external-properties">2.9. 发现外部属性的内置选项</a></p>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.discover-build-in-options-for-external-properties">2.9. Discover Built-in Options for External Properties</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver">3. 嵌入式 Web 服务器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver">3. Embedded Web Servers</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.use-another">3.1. 使用另一个 Web 服务器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-another">3.1. Use Another Web Server</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.disable">3.2. 禁用 Web 服务器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.disable">3.2. Disabling the Web Server</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.change-port">3.3. 更改 HTTP 端口</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.change-port">3.3. Change the HTTP Port</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.use-random-port">3.4. 使用随机未分配的 HTTP 端口</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-random-port">3.4. Use a Random Unassigned HTTP Port</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.discover-port">3.5. 在运行时发现 HTTP 端口</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.discover-port">3.5. Discover the HTTP Port at Runtime</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.enable-response-compression">3.6. 启用 HTTP 响应压缩</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.enable-response-compression">3.6. Enable HTTP Response Compression</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.configure-ssl">3.7. 配置 SSL</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-ssl">3.7. Configure SSL</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.configure-http2">3.8. 配置 HTTP/2</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2">3.8. Configure HTTP/2</a></p>
<ul class="sectlevel3">
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.configure-http2.tomcat">3.8.1. HTTP/2 与 Tomcat</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2.tomcat">3.8.1. HTTP/2 with Tomcat</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.configure-http2.jetty">3.8.2. HTTP/2 与 Jetty</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2.jetty">3.8.2. HTTP/2 with Jetty</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.configure-http2.netty">3.8.3. 带有 Reactor Netty 的 HTTP/2</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2.netty">3.8.3. HTTP/2 with Reactor Netty</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.configure-http2.undertow">3.8.4. HTTP/2 与 Undertow</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2.undertow">3.8.4. HTTP/2 with Undertow</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.configure">3.9. 配置 Web 服务器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure">3.9. Configure the Web Server</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener">3.10. 向应用程序添加 Servlet、过滤器或侦听器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener">3.10. Add a Servlet, Filter, or Listener to an Application</a></p>
<ul class="sectlevel3">
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean">3.10.1. 使用 Spring Bean 添加 Servlet、过滤器或侦听器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean">3.10.1. Add a Servlet, Filter, or Listener by Using a Spring Bean</a></p>
<ul class="sectlevel4">
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean.disable">禁用 Servlet 或过滤器的注册</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean.disable">Disable Registration of a Servlet or Filter</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener.using-scanning">3.10.2. 使用类路径扫描添加 Servlet、过滤器和侦听器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.using-scanning">3.10.2. Add Servlets, Filters, and Listeners by Using Classpath Scanning</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.configure-access-logs">3.11. 配置访问日志</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-access-logs">3.11. Configure Access Logging</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.use-behind-a-proxy-server">3.12. 在前端代理服务器后面运行</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-behind-a-proxy-server">3.12. Running Behind a Front-end Proxy Server</a></p>
<ul class="sectlevel3">
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.use-behind-a-proxy-server.tomcat">3.12.1. 自定义 Tomcat 的代理配置</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-behind-a-proxy-server.tomcat">3.12.1. Customize Tomcat’s Proxy Configuration</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.enable-multiple-connectors-in-tomcat">3.13. 使用 Tomcat 启用多个连接器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.enable-multiple-connectors-in-tomcat">3.13. Enable Multiple Connectors with Tomcat</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.use-tomcat-legacycookieprocessor">3.14. 使用 Tomcat 的 LegacyCookieProcessor</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-tomcat-legacycookieprocessor">3.14. Use Tomcat’s LegacyCookieProcessor</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.enable-tomcat-mbean-registry">3.15. 启用 Tomcat 的 MBean 注册表</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.enable-tomcat-mbean-registry">3.15. Enable Tomcat’s MBean Registry</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.enable-multiple-listeners-in-undertow">3.16. 使用 Undertow 启用多个侦听器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.enable-multiple-listeners-in-undertow">3.16. Enable Multiple Listeners with Undertow</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.webserver.create-websocket-endpoints-using-serverendpoint">3.17. 使用 @ServerEndpoint 创建 WebSocket 端点</a></p>
  <p translation-origin="off"><a href="howto.html#howto.webserver.create-websocket-endpoints-using-serverendpoint">3.17. Create WebSocket Endpoints Using @ServerEndpoint</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.spring-mvc">4. SpringMVC</a></p>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc">4. Spring MVC</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.spring-mvc.write-json-rest-service">4.1. 编写 JSON REST 服务</a></p>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.write-json-rest-service">4.1. Write a JSON REST Service</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.spring-mvc.write-xml-rest-service">4.2. 编写 XML REST 服务</a></p>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.write-xml-rest-service">4.2. Write an XML REST Service</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.spring-mvc.customize-jackson-objectmapper">4.3. 自定义 Jackson ObjectMapper</a></p>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.customize-jackson-objectmapper">4.3. Customize the Jackson ObjectMapper</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.spring-mvc.customize-responsebody-rendering">4.4. 自定义 @ResponseBody 渲染</a></p>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.customize-responsebody-rendering">4.4. Customize the @ResponseBody Rendering</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.spring-mvc.multipart-file-uploads">4.5. 处理多部分文件上传</a></p>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.multipart-file-uploads">4.5. Handling Multipart File Uploads</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.spring-mvc.switch-off-dispatcherservlet">4.6. 关闭 Spring MVC DispatcherServlet</a></p>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.switch-off-dispatcherservlet">4.6. Switch Off the Spring MVC DispatcherServlet</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.spring-mvc.switch-off-default-configuration">4.7. 关闭默认 MVC 配置</a></p>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.switch-off-default-configuration">4.7. Switch off the Default MVC Configuration</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.spring-mvc.customize-view-resolvers">4.8. 自定义 ViewResolver</a></p>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.customize-view-resolvers">4.8. Customize ViewResolvers</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.jersey">5. 泽西岛</a></p>
  <p translation-origin="off"><a href="howto.html#howto.jersey">5. Jersey</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.jersey.spring-security">5.1. 使用 Spring Security 保护 Jersey 端点</a></p>
  <p translation-origin="off"><a href="howto.html#howto.jersey.spring-security">5.1. Secure Jersey endpoints with Spring Security</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.jersey.alongside-another-web-framework">5.2. 将 Jersey 与另一个 Web 框架一起使用</a></p>
  <p translation-origin="off"><a href="howto.html#howto.jersey.alongside-another-web-framework">5.2. Use Jersey Alongside Another Web Framework</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.http-clients">6. HTTP 客户端</a></p>
  <p translation-origin="off"><a href="howto.html#howto.http-clients">6. HTTP Clients</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.http-clients.rest-template-proxy-configuration">6.1. 配置 RestTemplate 以使用代理</a></p>
  <p translation-origin="off"><a href="howto.html#howto.http-clients.rest-template-proxy-configuration">6.1. Configure RestTemplate to Use a Proxy</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.http-clients.webclient-reactor-netty-customization">6.2. 配置基于 Reactor Netty 的 WebClient 使用的 TcpClient</a></p>
  <p translation-origin="off"><a href="howto.html#howto.http-clients.webclient-reactor-netty-customization">6.2. Configure the TcpClient used by a Reactor Netty-based WebClient</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.logging">7. 记录</a></p>
  <p translation-origin="off"><a href="howto.html#howto.logging">7. Logging</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.logging.logback">7.1. 为日志配置 Logback</a></p>
  <p translation-origin="off"><a href="howto.html#howto.logging.logback">7.1. Configure Logback for Logging</a></p>
<ul class="sectlevel3">
<li>
  <p translation-result="on"><a href="howto.html#howto.logging.logback.file-only-output">7.1.1. 为仅文件输出配置 Logback</a></p>
  <p translation-origin="off"><a href="howto.html#howto.logging.logback.file-only-output">7.1.1. Configure Logback for File-only Output</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.logging.log4j">7.2. 为日志配置 Log4j</a></p>
  <p translation-origin="off"><a href="howto.html#howto.logging.log4j">7.2. Configure Log4j for Logging</a></p>
<ul class="sectlevel3">
<li>
  <p translation-result="on"><a href="howto.html#howto.logging.log4j.yaml-or-json-config">7.2.1. 使用 YAML 或 JSON 配置 Log4j 2</a></p>
  <p translation-origin="off"><a href="howto.html#howto.logging.log4j.yaml-or-json-config">7.2.1. Use YAML or JSON to Configure Log4j 2</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.logging.log4j.composite-configuration">7.2.2. 使用复合配置来配置 Log4j 2</a></p>
  <p translation-origin="off"><a href="howto.html#howto.logging.log4j.composite-configuration">7.2.2. Use Composite Configuration to Configure Log4j 2</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access">8. 数据访问</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access">8. Data Access</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.configure-custom-datasource">8.1. 配置自定义数据源</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-custom-datasource">8.1. Configure a Custom DataSource</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.configure-two-datasources">8.2. 配置两个数据源</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-two-datasources">8.2. Configure Two DataSources</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.spring-data-repositories">8.3. 使用 Spring 数据存储库</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.spring-data-repositories">8.3. Use Spring Data Repositories</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.separate-entity-definitions-from-spring-configuration">8.4. 将 @Entity 定义与 Spring 配置分开</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.separate-entity-definitions-from-spring-configuration">8.4. Separate @Entity Definitions from Spring Configuration</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.jpa-properties">8.5. 配置 JPA 属性</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.jpa-properties">8.5. Configure JPA Properties</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.configure-hibernate-naming-strategy">8.6. 配置休眠命名策略</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-hibernate-naming-strategy">8.6. Configure Hibernate Naming Strategy</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.configure-hibernate-second-level-caching">8.7. 配置 Hibernate 二级缓存</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-hibernate-second-level-caching">8.7. Configure Hibernate Second-Level Caching</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.dependency-injection-in-hibernate-components">8.8. 在 Hibernate 组件中使用依赖注入</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.dependency-injection-in-hibernate-components">8.8. Use Dependency Injection in Hibernate Components</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.use-custom-entity-manager">8.9. 使用自定义 EntityManagerFactory</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.use-custom-entity-manager">8.9. Use a Custom EntityManagerFactory</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.use-multiple-entity-managers">8.10. 使用多个 EntityManagerFactories</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.use-multiple-entity-managers">8.10. Using Multiple EntityManagerFactories</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.use-traditional-persistence-xml">8.11. 使用传统的 persistence.xml 文件</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.use-traditional-persistence-xml">8.11. Use a Traditional persistence.xml File</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.use-spring-data-jpa-and-mongo-repositories">8.12. 使用 Spring Data JPA 和 Mongo 存储库</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.use-spring-data-jpa-and-mongo-repositories">8.12. Use Spring Data JPA and Mongo Repositories</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.customize-spring-data-web-support">8.13. 自定义 Spring Data 的 Web 支持</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.customize-spring-data-web-support">8.13. Customize Spring Data’s Web Support</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.exposing-spring-data-repositories-as-rest">8.14. 将 Spring 数据存储库公开为 REST 端点</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.exposing-spring-data-repositories-as-rest">8.14. Expose Spring Data Repositories as REST Endpoint</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.configure-a-component-that-is-used-by-jpa">8.15. 配置 JPA 使用的组件</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-a-component-that-is-used-by-jpa">8.15. Configure a Component that is Used by JPA</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-access.configure-jooq-with-multiple-datasources">8.16. 使用两个数据源配置 jOOQ</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-jooq-with-multiple-datasources">8.16. Configure jOOQ with Two DataSources</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization">9. 数据库初始化</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization">9. Database Initialization</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.using-jpa">9.1. 使用 JPA 初始化数据库</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.using-jpa">9.1. Initialize a Database Using JPA</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.using-hibernate">9.2. 使用 Hibernate 初始化数据库</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.using-hibernate">9.2. Initialize a Database Using Hibernate</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.using-basic-sql-scripts">9.3. 使用基本 SQL 脚本初始化数据库</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.using-basic-sql-scripts">9.3. Initialize a Database Using Basic SQL Scripts</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.batch">9.4. 初始化 Spring Batch 数据库</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.batch">9.4. Initialize a Spring Batch Database</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.migration-tool">9.5. 使用更高级别的数据库迁移工具</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.migration-tool">9.5. Use a Higher-level Database Migration Tool</a></p>
<ul class="sectlevel3">
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.migration-tool.flyway">9.5.1. 在启动时执行 Flyway 数据库迁移</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.migration-tool.flyway">9.5.1. Execute Flyway Database Migrations on Startup</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.migration-tool.liquibase">9.5.2. 在启动时执行 Liquibase 数据库迁移</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.migration-tool.liquibase">9.5.2. Execute Liquibase Database Migrations on Startup</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.dependencies">9.6. 依赖于一个初始化的数据库</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.dependencies">9.6. Depend Upon an Initialized Database</a></p>
<ul class="sectlevel3">
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.dependencies.initializer-detection">9.6.1. 检测数据库初始化器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.dependencies.initializer-detection">9.6.1. Detect a Database Initializer</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.data-initialization.dependencies.depends-on-initialization-detection">9.6.2. 检测依赖于数据库初始化的 Bean</a></p>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.dependencies.depends-on-initialization-detection">9.6.2. Detect a Bean That Depends On Database Initialization</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.messaging">10. 消息传递</a></p>
  <p translation-origin="off"><a href="howto.html#howto.messaging">10. Messaging</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.messaging.disable-transacted-jms-session">10.1. 禁用事务处理的 JMS 会话</a></p>
  <p translation-origin="off"><a href="howto.html#howto.messaging.disable-transacted-jms-session">10.1. Disable Transacted JMS Session</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.batch">11. 批量申请</a></p>
  <p translation-origin="off"><a href="howto.html#howto.batch">11. Batch Applications</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.batch.specifying-a-data-source">11.1. 指定批处理数据源</a></p>
  <p translation-origin="off"><a href="howto.html#howto.batch.specifying-a-data-source">11.1. Specifying a Batch Data Source</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.batch.running-jobs-on-startup">11.2. 在启动时运行 Spring Batch 作业</a></p>
  <p translation-origin="off"><a href="howto.html#howto.batch.running-jobs-on-startup">11.2. Running Spring Batch Jobs on Startup</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.batch.running-from-the-command-line">11.3. 从命令行运行</a></p>
  <p translation-origin="off"><a href="howto.html#howto.batch.running-from-the-command-line">11.3. Running from the Command Line</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.batch.storing-job-repository">11.4. 存储作业存储库</a></p>
  <p translation-origin="off"><a href="howto.html#howto.batch.storing-job-repository">11.4. Storing the Job Repository</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.actuator">12. 执行器</a></p>
  <p translation-origin="off"><a href="howto.html#howto.actuator">12. Actuator</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.actuator.change-http-port-or-address">12.1. 更改执行器端点的 HTTP 端口或地址</a></p>
  <p translation-origin="off"><a href="howto.html#howto.actuator.change-http-port-or-address">12.1. Change the HTTP Port or Address of the Actuator Endpoints</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.actuator.customize-whitelabel-error-page">12.2. 自定义“whitelabel”错误页面</a></p>
  <p translation-origin="off"><a href="howto.html#howto.actuator.customize-whitelabel-error-page">12.2. Customize the ‘whitelabel’ Error Page</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.actuator.sanitize-sensitive-values">12.3. 清理敏感值</a></p>
  <p translation-origin="off"><a href="howto.html#howto.actuator.sanitize-sensitive-values">12.3. Sanitize Sensitive Values</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.actuator.map-health-indicators-to-metrics">12.4. 将健康度量映射到千分尺度量</a></p>
  <p translation-origin="off"><a href="howto.html#howto.actuator.map-health-indicators-to-metrics">12.4. Map Health Indicators to Micrometer Metrics</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.security">13. 安全</a></p>
  <p translation-origin="off"><a href="howto.html#howto.security">13. Security</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.security.switch-off-spring-boot-configuration">13.1. 关闭 Spring Boot 安全配置</a></p>
  <p translation-origin="off"><a href="howto.html#howto.security.switch-off-spring-boot-configuration">13.1. Switch off the Spring Boot Security Configuration</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.security.change-user-details-service-and-add-user-accounts">13.2. 更改 UserDetailsService 并添加用户帐户</a></p>
  <p translation-origin="off"><a href="howto.html#howto.security.change-user-details-service-and-add-user-accounts">13.2. Change the UserDetailsService and Add User Accounts</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.security.enable-https">13.3. 在代理服务器后面运行时启用 HTTPS</a></p>
  <p translation-origin="off"><a href="howto.html#howto.security.enable-https">13.3. Enable HTTPS When Running behind a Proxy Server</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.hotswapping">14. 热插拔</a></p>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping">14. Hot Swapping</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.hotswapping.reload-static-content">14.1. 重新加载静态内容</a></p>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-static-content">14.1. Reload Static Content</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.hotswapping.reload-templates">14.2. 在不重启容器的情况下重新加载模板</a></p>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-templates">14.2. Reload Templates without Restarting the Container</a></p>
<ul class="sectlevel3">
<li>
  <p translation-result="on"><a href="howto.html#howto.hotswapping.reload-templates.thymeleaf">14.2.1. 百里香模板</a></p>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-templates.thymeleaf">14.2.1. Thymeleaf Templates</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.hotswapping.reload-templates.freemarker">14.2.2. FreeMarker 模板</a></p>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-templates.freemarker">14.2.2. FreeMarker Templates</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.hotswapping.reload-templates.groovy">14.2.3. Groovy 模板</a></p>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-templates.groovy">14.2.3. Groovy Templates</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.hotswapping.fast-application-restarts">14.3. 快速应用程序重启</a></p>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.fast-application-restarts">14.3. Fast Application Restarts</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.hotswapping.reload-java-classes-without-restarting">14.4. 在不重新启动容器的情况下重新加载 Java 类</a></p>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-java-classes-without-restarting">14.4. Reload Java Classes without Restarting the Container</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.testing">15. 测试</a></p>
  <p translation-origin="off"><a href="howto.html#howto.testing">15. Testing</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.testing.with-spring-security">15.1. 使用 Spring Security 进行测试</a></p>
  <p translation-origin="off"><a href="howto.html#howto.testing.with-spring-security">15.1. Testing With Spring Security</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.testing.testcontainers">15.2. 使用测试容器进行集成测试</a></p>
  <p translation-origin="off"><a href="howto.html#howto.testing.testcontainers">15.2. Use Testcontainers for Integration Testing</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.build">16. 建造</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build">16. Build</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.build.generate-info">16.1. 生成构建信息</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build.generate-info">16.1. Generate Build Information</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.build.generate-git-info">16.2. 生成 Git 信息</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build.generate-git-info">16.2. Generate Git Information</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.build.customize-dependency-versions">16.3. 自定义依赖版本</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build.customize-dependency-versions">16.3. Customize Dependency Versions</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.build.create-an-executable-jar-with-maven">16.4. 使用 Maven 创建可执行 JAR</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build.create-an-executable-jar-with-maven">16.4. Create an Executable JAR with Maven</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.build.use-a-spring-boot-application-as-dependency">16.5. 使用 Spring Boot 应用程序作为依赖项</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build.use-a-spring-boot-application-as-dependency">16.5. Use a Spring Boot Application as a Dependency</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.build.extract-specific-libraries-when-an-executable-jar-runs">16.6. 可执行 Jar 运行时提取特定库</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build.extract-specific-libraries-when-an-executable-jar-runs">16.6. Extract Specific Libraries When an Executable Jar Runs</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.build.create-a-nonexecutable-jar">16.7. 创建具有排除项的不可执行 JAR</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build.create-a-nonexecutable-jar">16.7. Create a Non-executable JAR with Exclusions</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.build.remote-debug-maven">16.8. 远程调试使用 Maven 启动的 Spring Boot 应用程序</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build.remote-debug-maven">16.8. Remote Debug a Spring Boot Application Started with Maven</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib">16.9. 在不使用 spring-boot-antlib 的情况下从 Ant 构建可执行存档</a></p>
  <p translation-origin="off"><a href="howto.html#howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib">16.9. Build an Executable Archive from Ant without Using spring-boot-antlib</a></p>
</li>
</ul>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.traditional-deployment">17. 传统部署</a></p>
  <p translation-origin="off"><a href="howto.html#howto.traditional-deployment">17. Traditional Deployment</a></p>
<ul class="sectlevel2">
<li>
  <p translation-result="on"><a href="howto.html#howto.traditional-deployment.war">17.1. 创建可部署的战争文件</a></p>
  <p translation-origin="off"><a href="howto.html#howto.traditional-deployment.war">17.1. Create a Deployable War File</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.traditional-deployment.convert-existing-application">17.2. 将现有应用程序转换为 Spring Boot</a></p>
  <p translation-origin="off"><a href="howto.html#howto.traditional-deployment.convert-existing-application">17.2. Convert an Existing Application to Spring Boot</a></p>
</li>
<li>
  <p translation-result="on"><a href="howto.html#howto.traditional-deployment.weblogic">17.3. 将 WAR 部署到 WebLogic</a></p>
  <p translation-origin="off"><a href="howto.html#howto.traditional-deployment.weblogic">17.3. Deploying a WAR to WebLogic</a></p>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">本节提供了使用 Spring Boot 时经常出现的一些常见“我该怎么做……”问题的答案。它的覆盖范围并不详尽，但确实涵盖了很多。</p>
<p translation-origin="off">This section provides answers to some common ‘how do I do that…​’ questions that often arise when using Spring Boot.
Its coverage is not exhaustive, but it does cover quite a lot.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果你有我们未在此处介绍的特定问题，你可能需要检查 <a href="https://stackoverflow.com/tags/spring-boot">stackoverflow.com</a> 以查看是否有人已经提供了答案。这也是提出新问题的好地方（请使用 <code>spring-boot</code> 标签）。</p>
<p translation-origin="off">If you have a specific problem that we do not cover here, you might want to check <a href="https://stackoverflow.com/tags/spring-boot">stackoverflow.com</a> to see if someone has already provided an answer.
This is also a great place to ask new questions (please use the <code>spring-boot</code> tag).</p>
</div>
<div class="paragraph">
<p translation-result="on">我们也非常乐意扩展本节。如果你想添加“操作方法”，请向我们发送<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3">拉取请求</a>。</p>
<p translation-origin="off">We are also more than happy to extend this section.
If you want to add a ‘how-to’, send us a <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3">pull request</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.application" translation-result="on"><a href="howto.html#howto.application"></a>1. Spring Boot 应用程序</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.application"></a>1. Spring Boot Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">本节包括与 Spring Boot 应用程序直接相关的主题。</p>
<p translation-origin="off">This section includes topics relating directly to Spring Boot applications.</p>
</div>
<div class="sect2">
<h3 id="howto.application.failure-analyzer" translation-result="on"><a href="howto.html#howto.application.failure-analyzer"></a>1.1. 创建你自己的故障分析器</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.application.failure-analyzer"></a>1.1. Create Your Own FailureAnalyzer</h3>
<div class="paragraph">
<p translation-result="on"><a href="https://docs.spring.io/spring-boot/docs/2.6.3/api/org/springframework/boot/diagnostics/FailureAnalyzer.html"><code>FailureAnalyzer</code></a>是一种在启动时拦截异常并将其转换为人类可读消息的好方法，并包装在<a href="https://docs.spring.io/spring-boot/docs/2.6.3/api/org/springframework/boot/diagnostics/FailureAnalysis.html"><code>FailureAnalysis</code></a>中。Spring Boot 为应用程序上下文相关的异常、JSR-303 验证等提供了这样的分析器。你也可以创建自己的。</p>
<p translation-origin="off"><a href="https://docs.spring.io/spring-boot/docs/2.6.3/api/org/springframework/boot/diagnostics/FailureAnalyzer.html"><code>FailureAnalyzer</code></a> is a great way to intercept an exception on startup and turn it into a human-readable message, wrapped in a <a href="https://docs.spring.io/spring-boot/docs/2.6.3/api/org/springframework/boot/diagnostics/FailureAnalysis.html"><code>FailureAnalysis</code></a>.
Spring Boot provides such an analyzer for application-context-related exceptions, JSR-303 validations, and more.
You can also create your own.</p>
</div>
<div class="paragraph">
<p translation-result="on"><code>AbstractFailureAnalyzer</code> 是 <code>FailureAnalyzer</code> 的一个方便扩展，它检查要处理的异常中是否存在指定的异常类型。你可以从中进行扩展，以便你的实现只有在异常实际存在时才有机会处理异常。如果由于某种原因无法处理异常，请返回 <code>null</code> 以让另一个实现有机会处理异常。</p>
<p translation-origin="off"><code>AbstractFailureAnalyzer</code> is a convenient extension of <code>FailureAnalyzer</code> that checks the presence of a specified exception type in the exception to handle.
You can extend from that so that your implementation gets a chance to handle the exception only when it is actually present.
If, for whatever reason, you cannot handle the exception, return <code>null</code> to give another implementation a chance to handle the exception.</p>
</div>
<div class="paragraph">
<p translation-result="on"><code>FailureAnalyzer</code> 实现必须在 <code>META-INF/spring.factories</code> 中注册。以下示例注册 <code>ProjectConstraintViolationFailureAnalyzer</code> ：</p>
<p translation-origin="off"><code>FailureAnalyzer</code> implementations must be registered in <code>META-INF/spring.factories</code>.
The following example registers <code>ProjectConstraintViolationFailureAnalyzer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">org.springframework.boot.diagnostics.FailureAnalyzer=\
com.example.ProjectConstraintViolationFailureAnalyzer</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">如果你需要访问 <code>BeanFactory</code> 或 <code>Environment</code> ，你的 <code>FailureAnalyzer</code> 可以分别实现 <code>BeanFactoryAware</code> 或 <code>EnvironmentAware</code> 。</p>
<p translation-origin="off">If you need access to the <code>BeanFactory</code> or the <code>Environment</code>, your <code>FailureAnalyzer</code> can implement <code>BeanFactoryAware</code> or <code>EnvironmentAware</code> respectively.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.application.troubleshoot-auto-configuration" translation-result="on"><a href="howto.html#howto.application.troubleshoot-auto-configuration"></a>1.2. 自动配置故障排除</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.application.troubleshoot-auto-configuration"></a>1.2. Troubleshoot Auto-configuration</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 自动配置尽最大努力“做正确的事”，但有时事情会失败，而且很难说出原因。</p>
<p translation-origin="off">The Spring Boot auto-configuration tries its best to “do the right thing”, but sometimes things fail, and it can be hard to tell why.</p>
</div>
<div class="paragraph">
<p translation-result="on">在任何 Spring Boot <code>ApplicationContext</code> 中都有一个非常有用的 <code>ConditionEvaluationReport</code> 可用。如果启用 <code>DEBUG</code> 日志输出，你可以看到它。如果你使用 <code>spring-boot-actuator</code> （请参阅 <a href="actuator.html#actuator">Actuator 章节</a>），还有一个 <code>conditions</code> 端点以 JSON 格式呈现报告。使用该端点来调试应用程序，并查看 Spring Boot 在运行时添加了哪些功能（哪些还没有添加）。</p>
<p translation-origin="off">There is a really useful <code>ConditionEvaluationReport</code> available in any Spring Boot <code>ApplicationContext</code>.
You can see it if you enable <code>DEBUG</code> logging output.
If you use the <code>spring-boot-actuator</code> (see <a href="actuator.html#actuator">the Actuator chapter</a>), there is also a <code>conditions</code> endpoint that renders the report in JSON.
Use that endpoint to debug the application and see what features have been added (and which have not been added) by Spring Boot at runtime.</p>
</div>
<div class="paragraph">
<p translation-result="on">通过查看源代码和 Javadoc 可以回答更多问题。阅读代码时，请记住以下经验法则：</p>
<p translation-origin="off">Many more questions can be answered by looking at the source code and the Javadoc.
When reading the code, remember the following rules of thumb:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on">查找名为 <code>*AutoConfiguration</code> 的类并阅读它们的源代码。请特别注意 <code>@Conditional*</code> 注解，以了解它们启用了哪些功能以及何时启用。将 <code>--debug</code> 添加到命令行或系统属性 <code>-Ddebug</code> 以在控制台上获取在你的应用程序中做出的所有自动配置决策的日志。在启用了执行器的正在运行的应用程序中，查看 <code>conditions</code> 端点（ <code>/actuator/conditions</code> 或 JMX 等效项）以获取相同的信息。</p>
<p translation-origin="off">Look for classes called <code>*AutoConfiguration</code> and read their sources.
Pay special attention to the <code>@Conditional*</code> annotations to find out what features they enable and when.
Add <code>--debug</code> to the command line or a System property <code>-Ddebug</code> to get a log on the console of all the auto-configuration decisions that were made in your app.
In a running application with actuator enabled, look at the <code>conditions</code> endpoint (<code>/actuator/conditions</code> or the JMX equivalent) for the same information.</p>
</li>
<li>
<p translation-result="on">查找属于 <code>@ConfigurationProperties</code> 的类（例如<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ServerProperties.java"><code>ServerProperties</code></a> ）并从那里读取可用的外部配置选项。<code>@ConfigurationProperties</code> 注解有一个 <code>name</code> 属性，作为外部属性的前缀。因此，<code>ServerProperties</code> 具有 <code>prefix="server"</code> ，其配置属性是 <code>server.port</code> 、 <code>server.address</code> 等。在启用执行器的运行应用程序中，查看 <code>configprops</code> 端点。</p>
<p translation-origin="off">Look for classes that are <code>@ConfigurationProperties</code> (such as <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ServerProperties.java"><code>ServerProperties</code></a>) and read from there the available external configuration options.
The <code>@ConfigurationProperties</code> annotation has a <code>name</code> attribute that acts as a prefix to external properties.
Thus, <code>ServerProperties</code> has <code>prefix="server"</code> and its configuration properties are <code>server.port</code>, <code>server.address</code>, and others.
In a running application with actuator enabled, look at the <code>configprops</code> endpoint.</p>
</li>
<li>
<p translation-result="on">寻找在 <code>Binder</code> 上使用 <code>bind</code> 方法以轻松的方式将配置值显式地从 <code>Environment</code> 中提取出来。它通常与前缀一起使用。</p>
<p translation-origin="off">Look for uses of the <code>bind</code> method on the <code>Binder</code> to pull configuration values explicitly out of the <code>Environment</code> in a relaxed manner.
It is often used with a prefix.</p>
</li>
<li>
<p translation-result="on">寻找直接绑定到 <code>Environment</code> 的 <code>@Value</code> 注解。</p>
<p translation-origin="off">Look for <code>@Value</code> annotations that bind directly to the <code>Environment</code>.</p>
</li>
<li>
<p translation-result="on">查找 <code>@ConditionalOnExpression</code> 注解，这些注解会根据 SpEL 表达式打开和关闭功能，通常使用从 <code>Environment</code> 解析的占位符进行评估。</p>
<p translation-origin="off">Look for <code>@ConditionalOnExpression</code> annotations that switch features on and off in response to SpEL expressions, normally evaluated with placeholders resolved from the <code>Environment</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="howto.application.customize-the-environment-or-application-context" translation-result="on"><a href="howto.html#howto.application.customize-the-environment-or-application-context"></a>1.3. 在启动之前自定义环境或 ApplicationContext</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.application.customize-the-environment-or-application-context"></a>1.3. Customize the Environment or ApplicationContext Before It Starts</h3>
<div class="paragraph">
<p translation-result="on"><code>SpringApplication</code> 具有 <code>ApplicationListeners</code> 和 <code>ApplicationContextInitializers</code> 用于将自定义应用到上下文或环境。Spring Boot 会从 <code>META-INF/spring.factories</code> 加载许多此类自定义项以供内部使用。注册附加自定义的方法不止一种：</p>
<p translation-origin="off">A <code>SpringApplication</code> has <code>ApplicationListeners</code> and <code>ApplicationContextInitializers</code> that are used to apply customizations to the context or environment.
Spring Boot loads a number of such customizations for use internally from <code>META-INF/spring.factories</code>.
There is more than one way to register additional customizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on">以编程方式，每个应用程序，在运行之前调用 <code>SpringApplication</code> 上的 <code>addListeners</code> 和 <code>addInitializers</code> 方法。</p>
<p translation-origin="off">Programmatically, per application, by calling the <code>addListeners</code> and <code>addInitializers</code> methods on <code>SpringApplication</code> before you run it.</p>
</li>
<li>
<p translation-result="on">以声明方式，通过设置 <code>context.initializer.classes</code> 或 <code>context.listener.classes</code> 属性，每个应用程序。</p>
<p translation-origin="off">Declaratively, per application, by setting the <code>context.initializer.classes</code> or <code>context.listener.classes</code> properties.</p>
</li>
<li>
<p translation-result="on">声明式地，对于所有应用程序，通过添加 <code>META-INF/spring.factories</code> 并打包应用程序都用作库的 jar 文件。</p>
<p translation-origin="off">Declaratively, for all applications, by adding a <code>META-INF/spring.factories</code> and packaging a jar file that the applications all use as a library.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on"><code>SpringApplication</code> 将一些特殊的 <code>ApplicationEvents</code> 发送到侦听器（有些甚至在创建上下文之前），然后也为 <code>ApplicationContext</code> 发布的事件注册侦听器。有关完整列表，请参阅“Spring Boot 特性”部分中的“<a href="features.html#features.spring-application.application-events-and-listeners">应用程序事件和侦听器</a>”。</p>
<p translation-origin="off">The <code>SpringApplication</code> sends some special <code>ApplicationEvents</code> to the listeners (some even before the context is created) and then registers the listeners for events published by the <code>ApplicationContext</code> as well.
See “<a href="features.html#features.spring-application.application-events-and-listeners">Application Events and Listeners</a>” in the ‘Spring Boot features’ section for a complete list.</p>
</div>
<div class="paragraph">
<p translation-result="on">还可以用 <code>EnvironmentPostProcessor</code> 在刷新应用程序上下文之前自定义 <code>Environment</code> 。每个实现都应该在 <code>META-INF/spring.factories</code> 中注册，如下例所示：</p>
<p translation-origin="off">It is also possible to customize the <code>Environment</code> before the application context is refreshed by using <code>EnvironmentPostProcessor</code>.
Each implementation should be registered in <code>META-INF/spring.factories</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.springframework.boot.env.EnvironmentPostProcessor=com.example.YourEnvironmentPostProcessor</pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">该实现可以加载任意文件并将它们添加到 <code>Environment</code> 。例如，以下示例从类路径加载 YAML 配置文件：</p>
<p translation-origin="off">The implementation can load arbitrary files and add them to the <code>Environment</code>.
For instance, the following example loads a YAML configuration file from the classpath:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.io.IOException;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.env.EnvironmentPostProcessor;
import org.springframework.boot.env.YamlPropertySourceLoader;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.core.env.PropertySource;
import org.springframework.core.io.ClassPathResource;
import org.springframework.core.io.Resource;
import org.springframework.util.Assert;

</span><span class="fold-block">public class MyEnvironmentPostProcessor implements EnvironmentPostProcessor {

    private final YamlPropertySourceLoader loader = new YamlPropertySourceLoader();

    @Override
    public void postProcessEnvironment(ConfigurableEnvironment environment, SpringApplication application) {
        Resource path = new ClassPathResource("com/example/myapp/config.yml");
        PropertySource&lt;?&gt; propertySource = loadYaml(path);
        environment.getPropertySources().addLast(propertySource);
    }

    private PropertySource&lt;?&gt; loadYaml(Resource path) {
        Assert.isTrue(path.exists(), () -&gt; "Resource " + path + " does not exist");
        try {
            return this.loader.load("custom-resource", path).get(0);
        }
        catch (IOException ex) {
            throw new IllegalStateException("Failed to load yaml configuration from " + path, ex);
        }
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on"><code>Environment</code> 已经准备好 Spring Boot 默认加载的所有常用属性源。因此，可以从环境中获取文件的位置。前面的示例在列表末尾添加了 <code>custom-resource</code> 属性源，以便在任何通常的其他位置定义的键优先。自定义实现可以定义另一个顺序。</p>
<p translation-origin="off">The <code>Environment</code> has already been prepared with all the usual property sources that Spring Boot loads by default.
It is therefore possible to get the location of the file from the environment.
The preceding example adds the <code>custom-resource</code> property source at the end of the list so that a key defined in any of the usual other locations takes precedence.
A custom implementation may define another order.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="小心"></i>
</td>
<td class="content">
<p translation-result="on">虽然在 <code>@SpringBootApplication</code> 上使用 <code>@PropertySource</code> 似乎是一种在 <code>Environment</code> 中加载自定义资源的便捷方式，但我们不建议这样做。在刷新应用程序上下文之前，不会将此类属性源添加到 <code>Environment</code> 中。配置某些属性（例如 <code>logging.*</code> 和 <code>spring.main.*</code> 在刷新开始之前读取）为时已晚。</p>
<p translation-origin="off">While using <code>@PropertySource</code> on your <code>@SpringBootApplication</code> may seem to be a convenient way to load a custom resource in the <code>Environment</code>, we do not recommend it.
Such property sources are not added to the <code>Environment</code> until the application context is being refreshed.
This is too late to configure certain properties such as <code>logging.*</code> and <code>spring.main.*</code> which are read before refresh begins.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.application.context-hierarchy" translation-result="on"><a href="howto.html#howto.application.context-hierarchy"></a>1.4. 构建 ApplicationContext 层次结构（添加父上下文或根上下文）</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.application.context-hierarchy"></a>1.4. Build an ApplicationContext Hierarchy (Adding a Parent or Root Context)</h3>
<div class="paragraph">
<p translation-result="on">你可以用 <code>ApplicationBuilder</code> 类来创建父/子 <code>ApplicationContext</code> 层次结构。有关更多信息，请参阅“Spring Boot 特性”部分中的“ <a href="features.html#features.spring-application.fluent-builder-api">features.html</a> ”。</p>
<p translation-origin="off">You can use the <code>ApplicationBuilder</code> class to create parent/child <code>ApplicationContext</code> hierarchies.
See “<a href="features.html#features.spring-application.fluent-builder-api">features.html</a>” in the ‘Spring Boot features’ section for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.application.non-web-application" translation-result="on"><a href="howto.html#howto.application.non-web-application"></a>1.5. 创建非 Web 应用程序</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.application.non-web-application"></a>1.5. Create a Non-web Application</h3>
<div class="paragraph">
<p translation-result="on">并非所有 Spring 应用程序都必须是 Web 应用程序（或 Web 服务）。如果你想在 <code>main</code> 方法中执行一些代码，同时还要引导一个 Spring 应用程序来设置要使用的基础设施，你可以用 Spring Boot 的 <code>SpringApplication</code> 特性。<code>SpringApplication</code> 改变它的 <code>ApplicationContext</code> 类，这取决于它是否认为它需要一个 Web 应用程序。你可以做的第一件事就是将与服务器相关的依赖项（例如 servlet API）从类路径中移除。如果你不能这样做（例如，你从同一代码库运行两个应用程序），那么你可以在 <code>SpringApplication</code> 实例上显式调用 <code>setWebApplicationType(WebApplicationType.NONE)</code> 或设置 <code>applicationContextClass</code> 属性（通过 Java API 或使用外部属性）。你希望作为业务逻辑运行的应用程序代码可以实现为 <code>CommandLineRunner</code> 并作为 <code>@Bean</code> 定义放入上下文中。</p>
<p translation-origin="off">Not all Spring applications have to be web applications (or web services).
If you want to execute some code in a <code>main</code> method but also bootstrap a Spring application to set up the infrastructure to use, you can use the <code>SpringApplication</code> features of Spring Boot.
A <code>SpringApplication</code> changes its <code>ApplicationContext</code> class, depending on whether it thinks it needs a web application or not.
The first thing you can do to help it is to leave server-related dependencies (such as the servlet API) off the classpath.
If you cannot do that (for example, you run two applications from the same code base) then you can explicitly call <code>setWebApplicationType(WebApplicationType.NONE)</code> on your <code>SpringApplication</code> instance or set the <code>applicationContextClass</code> property (through the Java API or with external properties).
Application code that you want to run as your business logic can be implemented as a <code>CommandLineRunner</code> and dropped into the context as a <code>@Bean</code> definition.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.properties-and-configuration" translation-result="on"><a href="howto.html#howto.properties-and-configuration"></a>2. 属性和配置</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration"></a>2. Properties and Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">本节包括有关设置和读取属性和配置设置以及它们与 Spring Boot 应用程序交互的主题。</p>
<p translation-origin="off">This section includes topics about setting and reading properties and configuration settings and their interaction with Spring Boot applications.</p>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.expand-properties" translation-result="on"><a href="howto.html#howto.properties-and-configuration.expand-properties"></a>2.1. 在构建时自动展开属性</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.expand-properties"></a>2.1. Automatically Expand Properties at Build Time</h3>
<div class="paragraph">
<p translation-result="on">你无需对项目的构建配置中也指定的某些属性进行硬编码，而是使用现有的构建配置来自动扩展它们。这在 Maven 和 Gradle 中都是可能的。</p>
<p translation-origin="off">Rather than hardcoding some properties that are also specified in your project’s build configuration, you can automatically expand them by instead using the existing build configuration.
This is possible in both Maven and Gradle.</p>
</div>
<div class="sect3">
<h4 id="howto.properties-and-configuration.expand-properties.maven" translation-result="on"><a href="howto.html#howto.properties-and-configuration.expand-properties.maven"></a>2.1.1. 使用 Maven 自动扩展属性</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.expand-properties.maven"></a>2.1.1. Automatic Property Expansion Using Maven</h4>
<div class="paragraph">
<p translation-result="on">你可以用资源过滤自动扩展 Maven 项目的属性。如果你使用 <code>spring-boot-starter-parent</code> ，则可以用 <code>@[email protected]</code> 占位符引用你的 Maven '项目属性'，如下例所示：</p>
<p translation-origin="off">You can automatically expand properties from the Maven project by using resource filtering.
If you use the <code>spring-boot-starter-parent</code>, you can then refer to your Maven ‘project properties’ with <code>@<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d0fefe90">[email&nbsp;protected]</a></code> placeholders, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"><a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d1b0a1a1ffb4bfb2beb5b8bfb6ec91a1a3bebbb4b2a5ffb3a4b8bdb5ffa2bea4a3b2b494bfb2beb5b8bfb6">[email&nbsp;protected]</a>@
<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="84e5f4f4aaeee5f2e5aaf2e1f6f7edebeab9c4eee5f2e5aaf2e1f6f7edebea">[email&nbsp;protected]</a>@</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  encoding: "@<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b8c8cad7d2dddbcc96dacdd1d4dc96cbd7cdcadbddfdd6dbd7dcd1d6dff8">[email&nbsp;protected]</a>"
  java:
    version: "@<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="93f9f2e5f2bde5f6e1e0fafcfdd3">[email&nbsp;protected]</a>"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">只有生产配置会以这种方式过滤（换句话说，不会对 <code>src/test/resources</code> 应用过滤）。</p>
<p translation-origin="off">Only production configuration is filtered that way (in other words, no filtering is applied on <code>src/test/resources</code>).</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">如果启用 <code>addResources</code> 标志，<code>spring-boot:run</code> 目标可以将 <code>src/main/resources</code> 直接添加到类路径（用于热重载目的）。这样做会绕过资源过滤和此功能。相反，你可以用 <code>exec:java</code> 目标或自定义插件的配置。有关更多详细信息，请参阅<a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#getting-started">插件使用页面</a>。</p>
<p translation-origin="off">If you enable the <code>addResources</code> flag, the <code>spring-boot:run</code> goal can add <code>src/main/resources</code> directly to the classpath (for hot reloading purposes).
Doing so circumvents the resource filtering and this feature.
Instead, you can use the <code>exec:java</code> goal or customize the plugin’s configuration.
See the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#getting-started">plugin usage page</a> for more details.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">如果不使用 starter 父级，则需要在 <code>pom.xml</code> 的 <code>&lt;build/&gt;</code> 元素中包含以下元素：</p>
<p translation-origin="off">If you do not use the starter parent, you need to include the following element inside the <code>&lt;build/&gt;</code> element of your <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;resources&gt;
    &lt;resource&gt;
        &lt;directory&gt;src/main/resources&lt;/directory&gt;
        &lt;filtering&gt;true&lt;/filtering&gt;
    &lt;/resource&gt;
&lt;/resources&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">你还需要在 <code>&lt;plugins/&gt;</code> 中包含以下元素：</p>
<p translation-origin="off">You also need to include the following element inside <code>&lt;plugins/&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.7&lt;/version&gt;
    &lt;configuration&gt;
        &lt;delimiters&gt;
            &lt;delimiter&gt;@&lt;/delimiter&gt;
        &lt;/delimiters&gt;
        &lt;useDefaultDelimiters&gt;false&lt;/useDefaultDelimiters&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">如果你在配置中使用标准 Spring 占位符（例如 <code>${placeholder}</code> ），则 <code>useDefaultDelimiters</code> 属性很重要。如果该属性未设置为 <code>false</code> ，则可以通过构建扩展这些属性。</p>
<p translation-origin="off">The <code>useDefaultDelimiters</code> property is important if you use standard Spring placeholders (such as <code>${placeholder}</code>) in your configuration.
If that property is not set to <code>false</code>, these may be expanded by the build.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="howto.properties-and-configuration.expand-properties.gradle" translation-result="on"><a href="howto.html#howto.properties-and-configuration.expand-properties.gradle"></a>2.1.2. 使用 Gradle 自动扩展属性</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.expand-properties.gradle"></a>2.1.2. Automatic Property Expansion Using Gradle</h4>
<div class="paragraph">
<p translation-result="on">你可以通过配置 Java 插件的 <code>processResources</code> 任务来自动扩展 Gradle 项目的属性，如下例所示：</p>
<p translation-origin="off">You can automatically expand properties from the Gradle project by configuring the Java plugin’s <code>processResources</code> task to do so, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">processResources {
    expand(project.properties)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">然后，你可以用占位符来引用 Gradle 项目的属性，如以下示例所示：</p>
<p translation-origin="off">You can then refer to your Gradle project’s properties by using placeholders, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.name=${name}
app.description=${description}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  name: "${name}"
  description: "${description}"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">Gradle 的 <code>expand</code> 方法使用 Groovy 的 <code>SimpleTemplateEngine</code> ，它转换 <code>${..}</code> 标记。<code>${..}</code> 样式与 Spring 自己的属性占位符机制冲突。要将 Spring 属性占位符与自动扩展一起使用，请按如下方式转义 Spring 属性占位符： <code>\${..}</code> 。</p>
<p translation-origin="off">Gradle’s <code>expand</code> method uses Groovy’s <code>SimpleTemplateEngine</code>, which transforms <code>${..}</code> tokens.
The <code>${..}</code> style conflicts with Spring’s own property placeholder mechanism.
To use Spring property placeholders together with automatic expansion, escape the Spring property placeholders as follows: <code>\${..}</code>.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.externalize-configuration" translation-result="on"><a href="howto.html#howto.properties-and-configuration.externalize-configuration"></a>2.2. 外化 SpringApplication 的配置</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.externalize-configuration"></a>2.2. Externalize the Configuration of SpringApplication</h3>
<div class="paragraph">
<p translation-result="on"><code>SpringApplication</code> 具有 bean 属性设置器，因此你可以在创建应用程序时使用其 Java API 来修改其行为。或者，你可以通过在 <code>spring.main.*</code> 中设置属性来外部化配置。例如，在 <code>application.properties</code> 中，你可能有以下设置：</p>
<p translation-origin="off">A <code>SpringApplication</code> has bean property setters, so you can use its Java API as you create the application to modify its behavior.
Alternatively, you can externalize the configuration by setting properties in <code>spring.main.*</code>.
For example, in <code>application.properties</code>, you might have the following settings:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.main.web-application-type=none
spring.main.banner-mode=off</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  main:
    web-application-type: "none"
    banner-mode: "off"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">然后启动时不打印 Spring Boot 横幅，并且应用程序未启动嵌入式 Web 服务器。</p>
<p translation-origin="off">Then the Spring Boot banner is not printed on startup, and the application is not starting an embedded web server.</p>
</div>
<div class="paragraph">
<p translation-result="on">外部配置中定义的属性会覆盖并替换使用 Java API 指定的值，主要来源除外。主要来源是提供给 <code>SpringApplication</code> 构造函数的来源：</p>
<p translation-origin="off">Properties defined in external configuration override and replace the values specified with the Java API, with the notable exception of the primary sources.
Primary sources are those provided to the <code>SpringApplication</code> constructor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.Banner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication {

    public static void main(String[] args) {
        SpringApplication application = new SpringApplication(MyApplication.class);
        application.setBannerMode(Banner.Mode.OFF);
        application.run(args);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">或者 <code>SpringApplicationBuilder</code> 的 <code>sources(…​)</code> 方法：</p>
<p translation-origin="off">Or to <code>sources(…​)</code> method of a <code>SpringApplicationBuilder</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.Banner;
import org.springframework.boot.builder.SpringApplicationBuilder;

</span><span class="fold-block">public class MyApplication {

    public static void main(String[] args) {
        new SpringApplicationBuilder()
            .bannerMode(Banner.Mode.OFF)
            .sources(MyApplication.class)
            .run(args);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">给定上面的例子，如果我们有以下配置：</p>
<p translation-origin="off">Given the examples above, if we have the following configuration:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.main.sources=com.example.MyDatabaseConfig,com.example.MyJmsConfig
spring.main.banner-mode=console</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  main:
    sources: "com.example.MyDatabaseConfig,com.example.MyJmsConfig"
    banner-mode: "console"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">实际的应用程序将显示横幅（被配置覆盖）并为 <code>ApplicationContext</code> 使用三个源。应用程序来源是：</p>
<p translation-origin="off">The actual application will show the banner (as overridden by configuration) and uses three sources for the <code>ApplicationContext</code>.
The application sources are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p translation-result="on"><code>MyApplication</code> （来自代码）</p>
<p translation-origin="off"><code>MyApplication</code> (from the code)</p>
</li>
<li>
<p translation-result="on"><code>MyDatabaseConfig</code> （来自外部配置）</p>
<p translation-origin="off"><code>MyDatabaseConfig</code> (from the external config)</p>
</li>
<li>
<p translation-result="on"><code>MyJmsConfig</code> （来自外部配置）</p>
<p translation-origin="off"><code>MyJmsConfig</code>(from the external config)</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.external-properties-location" translation-result="on"><a href="howto.html#howto.properties-and-configuration.external-properties-location"></a>2.3. 更改应用程序外部属性的位置</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.external-properties-location"></a>2.3. Change the Location of External Properties of an Application</h3>
<div class="paragraph">
<p translation-result="on">默认情况下，来自不同来源的属性以定义的顺序添加到 Spring <code>Environment</code> 中（确切顺序请参见“Spring Boot 特性”部分中的“ <a href="features.html#features.external-config">features.html</a> ”）。</p>
<p translation-origin="off">By default, properties from different sources are added to the Spring <code>Environment</code> in a defined order (see “<a href="features.html#features.external-config">features.html</a>” in the ‘Spring Boot features’ section for the exact order).</p>
</div>
<div class="paragraph">
<p translation-result="on">你还可以提供以下系统属性（或环境变量）来更改行为：</p>
<p translation-origin="off">You can also provide the following System properties (or environment variables) to change the behavior:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on"><code>spring.config.name</code> ( <code>SPRING_CONFIG_NAME</code> )：默认 <code>application</code> 作为文件名的根。</p>
<p translation-origin="off"><code>spring.config.name</code> (<code>SPRING_CONFIG_NAME</code>): Defaults to <code>application</code> as the root of the file name.</p>
</li>
<li>
<p translation-result="on"><code>spring.config.location</code> ( <code>SPRING_CONFIG_LOCATION</code> )：要加载的文件（例如类路径资源或 URL）。为该文档设置了一个单独的 <code>Environment</code> 属性源，它可以被系统属性、环境变量或命令行覆盖。</p>
<p translation-origin="off"><code>spring.config.location</code> (<code>SPRING_CONFIG_LOCATION</code>): The file to load (such as a classpath resource or a URL).
A separate <code>Environment</code> property source is set up for this document and it can be overridden by system properties, environment variables, or the command line.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">无论你在环境中设置什么，Spring Boot 总是如上所述加载 <code>application.properties</code> 。默认情况下，如果使用 YAML，则扩展名为 '.yml' 的文件也会添加到列表中。</p>
<p translation-origin="off">No matter what you set in the environment, Spring Boot always loads <code>application.properties</code> as described above.
By default, if YAML is used, then files with the ‘.yml’ extension are also added to the list.</p>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 记录在 <code>DEBUG</code> 级别加载的配置文件以及在 <code>TRACE</code> 级别未找到的候选文件。</p>
<p translation-origin="off">Spring Boot logs the configuration files that are loaded at the <code>DEBUG</code> level and the candidates it has not found at <code>TRACE</code> level.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/context/config/ConfigFileApplicationListener.java"><code>ConfigFileApplicationListener</code></a> 。</p>
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/context/config/ConfigFileApplicationListener.java"><code>ConfigFileApplicationListener</code></a> for more detail.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.short-command-line-arguments" translation-result="on"><a href="howto.html#howto.properties-and-configuration.short-command-line-arguments"></a>2.4. 使用“短”命令行参数</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.short-command-line-arguments"></a>2.4. Use ‘Short’ Command Line Arguments</h3>
<div class="paragraph">
<p translation-result="on">有些人喜欢使用（例如）-- <code>--port=9000</code> 而不是 <code>--server.port=9000</code> 在命令行上设置配置属性。你可以通过在 <code>application.properties</code> 中使用占位符来启用此行为，如以下示例所示：</p>
<p translation-origin="off">Some people like to use (for example) <code>--port=9000</code> instead of <code>--server.port=9000</code> to set configuration properties on the command line.
You can enable this behavior by using placeholders in <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.port=${port:8080}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  port: "${port:8080}"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">如果从 <code>spring-boot-starter-parent</code> POM 继承，<code>maven-resources-plugins</code> 的默认过滤器令牌已从 <code>${*}</code> 更改为 <code>@</code> （即 <code>@[email protected]</code> 而不是 <code>${maven.token}</code> ) 以防止与 Spring 样式的占位符发生冲突。如果你已直接为 <code>application.properties</code> 启用 Maven 过滤，你可能还需要更改默认过滤器令牌以使用<a href="https://maven.apache.org/plugins/maven-resources-plugin/resources-mojo.html#delimiters">其他分隔符</a>。</p>
<p translation-origin="off">If you inherit from the <code>spring-boot-starter-parent</code> POM, the default filter token of the <code>maven-resources-plugins</code> has been changed from <code>${*}</code> to <code>@</code> (that is, <code>@<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5b363a2d3e35752f34303e351b">[email&nbsp;protected]</a></code> instead of <code>${maven.token}</code>) to prevent conflicts with Spring-style placeholders.
If you have enabled Maven filtering for the <code>application.properties</code> directly, you may want to also change the default filter token to use <a href="https://maven.apache.org/plugins/maven-resources-plugin/resources-mojo.html#delimiters">other delimiters</a>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">在这种特定情况下，端口绑定在 Heroku 或 Cloud Foundry 等 PaaS 环境中工作。在这两个平台中，<code>PORT</code> 环境变量是自动设置的，Spring 可以绑定到 <code>Environment</code> 属性的大写同义词。</p>
<p translation-origin="off">In this specific case, the port binding works in a PaaS environment such as Heroku or Cloud Foundry.
In those two platforms, the <code>PORT</code> environment variable is set automatically and Spring can bind to capitalized synonyms for <code>Environment</code> properties.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.yaml" translation-result="on"><a href="howto.html#howto.properties-and-configuration.yaml"></a>2.5. 将 YAML 用于外部属性</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.yaml"></a>2.5. Use YAML for External Properties</h3>
<div class="paragraph">
<p translation-result="on">YAML 是 JSON 的超集，因此，它是一种以分层格式存储外部属性的便捷语法，如下例所示：</p>
<p translation-origin="off">YAML is a superset of JSON and, as such, is a convenient syntax for storing external properties in a hierarchical format, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  application:
    name: "cruncher"
  datasource:
    driver-class-name: "com.mysql.jdbc.Driver"
    url: "jdbc:mysql://localhost/test"
server:
  port: 9000</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">创建一个名为 <code>application.yml</code> 的文件并将其放在类路径的根目录中。然后将 <code>snakeyaml</code> 添加到你的依赖项中（Maven 坐标 <code>org.yaml:snakeyaml</code> ，如果你使用 <code>spring-boot-starter</code> 则已包含）。YAML 文件被解析为 Java <code>Map&lt;String,Object&gt;</code> （如 JSON 对象），Spring Boot 将映射展平，使其具有一层深度并具有以句点分隔的键，正如许多人习惯于使用 <code>Properties</code> 文件一样在爪哇。</p>
<p translation-origin="off">Create a file called <code>application.yml</code> and put it in the root of your classpath.
Then add <code>snakeyaml</code> to your dependencies (Maven coordinates <code>org.yaml:snakeyaml</code>, already included if you use the <code>spring-boot-starter</code>).
A YAML file is parsed to a Java <code>Map&lt;String,Object&gt;</code> (like a JSON object), and Spring Boot flattens the map so that it is one level deep and has period-separated keys, as many people are used to with <code>Properties</code> files in Java.</p>
</div>
<div class="paragraph">
<p translation-result="on">前面的 YAML 示例对应于以下 <code>application.properties</code> 文件：</p>
<p translation-origin="off">The preceding example YAML corresponds to the following <code>application.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.application.name=cruncher
spring.datasource.driver-class-name=com.mysql.jdbc.Driver
spring.datasource.url=jdbc:mysql://localhost/test
server.port=9000</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">有关 YAML 的更多信息，请参阅“Spring Boot 功能”部分中的“ <a href="features.html#features.external-config.yaml">features.html</a> ”。</p>
<p translation-origin="off">See “<a href="features.html#features.external-config.yaml">features.html</a>” in the ‘Spring Boot features’ section for more information about YAML.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.set-active-spring-profiles" translation-result="on"><a href="howto.html#howto.properties-and-configuration.set-active-spring-profiles"></a>2.6. 设置活动 Spring 配置文件</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.set-active-spring-profiles"></a>2.6. Set the Active Spring Profiles</h3>
<div class="paragraph">
<p translation-result="on">Spring <code>Environment</code> 为此提供了一个 API，但你通常会设置系统属性 ( <code>spring.profiles.active</code> ) 或 OS 环境变量 ( <code>SPRING_PROFILES_ACTIVE</code> )。此外，你可以用 <code>-D</code> 参数启动应用程序（记住将其放在主类或 jar 存档之前），如下所示：</p>
<p translation-origin="off">The Spring <code>Environment</code> has an API for this, but you would normally set a System property (<code>spring.profiles.active</code>) or an OS environment variable (<code>SPRING_PROFILES_ACTIVE</code>).
Also, you can launch your application with a <code>-D</code> argument (remember to put it before the main class or jar archive), as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar -Dspring.profiles.active=production demo-0.0.1-SNAPSHOT.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">在 Spring Boot 中，你还可以在 <code>application.properties</code> 中设置活动配置文件，如下例所示：</p>
<p translation-origin="off">In Spring Boot, you can also set the active profile in <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.profiles.active=production</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  profiles:
    active: "production"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">以这种方式设置的值将被系统属性或环境变量设置替换，但不会被 <code>SpringApplicationBuilder.profiles()</code> 方法替换。因此，后一种 Java API 可用于在不更改默认值的情况下扩充配置文件。</p>
<p translation-origin="off">A value set this way is replaced by the System property or environment variable setting but not by the <code>SpringApplicationBuilder.profiles()</code> method.
Thus, the latter Java API can be used to augment the profiles without changing the defaults.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多信息，请参阅“Spring Boot<a href="features.html#features.profiles">特性</a>”部分中的“features.html”。</p>
<p translation-origin="off">See “<a href="features.html#features.profiles">features.html</a>” in the “Spring Boot features” section for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.set-default-spring-profile-name" translation-result="on"><a href="howto.html#howto.properties-and-configuration.set-default-spring-profile-name"></a>2.7. 设置默认配置文件名称</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.set-default-spring-profile-name"></a>2.7. Set the Default Profile Name</h3>
<div class="paragraph">
<p translation-result="on">默认配置文件是在没有配置文件处于活动状态时启用的配置文件。默认情况下，默认配置文件的名称是 <code>default</code> ，但可以用系统属性 ( <code>spring.profiles.default</code> ) 或操作系统环境变量 ( <code>SPRING_PROFILES_DEFAULT</code> ) 更改它。</p>
<p translation-origin="off">The default profile is a profile that is enabled if no profile is active.
By default, the name of the default profile is <code>default</code>, but it could be changed using a System property (<code>spring.profiles.default</code>) or an OS environment variable (<code>SPRING_PROFILES_DEFAULT</code>).</p>
</div>
<div class="paragraph">
<p translation-result="on">在 Spring Boot 中，你还可以在 <code>application.properties</code> 中设置默认配置文件名称，如下例所示：</p>
<p translation-origin="off">In Spring Boot, you can also set the default profile name in <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.profiles.default=dev</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  profiles:
    default: "dev"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">有关更多信息，请参阅“Spring Boot<a href="features.html#features.profiles">特性</a>”部分中的“features.html”。</p>
<p translation-origin="off">See “<a href="features.html#features.profiles">features.html</a>” in the “Spring Boot features” section for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.change-configuration-depending-on-the-environment" translation-result="on"><a href="howto.html#howto.properties-and-configuration.change-configuration-depending-on-the-environment"></a> 2.8.根据环境更改配置</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.change-configuration-depending-on-the-environment"></a>2.8. Change Configuration Depending on the Environment</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 支持多文档 YAML 和 Properties 文件（有关详细信息，请参阅 <a href="features.html#features.external-config.files.multi-document">features.html</a> ），这些文件可以根据活动配置文件有条件地激活。</p>
<p translation-origin="off">Spring Boot supports multi-document YAML and Properties files (see <a href="features.html#features.external-config.files.multi-document">features.html</a> for details) which can be activated conditionally based on the active profiles.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果文档包含 <code>spring.config.activate.on-profile</code> 键，则将配置文件值（以逗号分隔的配置文件列表或配置文件表达式）输入 Spring <code>Environment.acceptsProfiles()</code> 方法。如果配置文件表达式匹配，则该文档将包含在最终合并中（否则不包含），如以下示例所示：</p>
<p translation-origin="off">If a document contains a <code>spring.config.activate.on-profile</code> key, then the profiles value (a comma-separated list of profiles or a profile expression) is fed into the Spring <code>Environment.acceptsProfiles()</code> method.
If the profile expression matches then that document is included in the final merge (otherwise, it is not), as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.port=9000
#---
spring.config.activate.on-profile=development
server.port=9001
#---
spring.config.activate.on-profile=production
server.port=0</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  port: 9000
---
spring:
  config:
    activate:
      on-profile: "development"
server:
  port: 9001
---
spring:
  config:
    activate:
      on-profile: "production"
server:
  port: 0</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">在前面的示例中，默认端口为 9000。但是，如果名为“开发”的 Spring 配置文件处于活动状态，则端口为 9001。如果“生产”处于活动状态，则端口为 0。</p>
<p translation-origin="off">In the preceding example, the default port is 9000.
However, if the Spring profile called ‘development’ is active, then the port is 9001.
If ‘production’ is active, then the port is 0.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">文档按照遇到的顺序合并。后面的值会覆盖前面的值。</p>
<p translation-origin="off">The documents are merged in the order in which they are encountered.
Later values override earlier values.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.discover-build-in-options-for-external-properties" translation-result="on"><a href="howto.html#howto.properties-and-configuration.discover-build-in-options-for-external-properties"></a> 2.9. 发现外部属性的内置选项</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.discover-build-in-options-for-external-properties"></a>2.9. Discover Built-in Options for External Properties</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 在运行时将来自 <code>application.properties</code> （或 <code>.yml</code> 文件和其他地方）的外部属性绑定到应用程序中。没有（技术上也不可能）一个位置中所有受支持属性的详尽列表，因为贡献可能来自类路径上的其他 jar 文件。</p>
<p translation-origin="off">Spring Boot binds external properties from <code>application.properties</code> (or <code>.yml</code> files and other places) into an application at runtime.
There is not (and technically cannot be) an exhaustive list of all supported properties in a single location, because contributions can come from additional jar files on your classpath.</p>
</div>
<div class="paragraph">
<p translation-result="on">具有 Actuator 功能的正在运行的应用程序具有一个 <code>configprops</code> 端点，该端点显示通过 <code>@ConfigurationProperties</code> 可用的所有绑定和可绑定属性。</p>
<p translation-origin="off">A running application with the Actuator features has a <code>configprops</code> endpoint that shows all the bound and bindable properties available through <code>@ConfigurationProperties</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">附录包括一个<a href="application-properties.html#application-properties"><code>application.properties</code></a>示例，其中列出了 Spring Boot 支持的最常见属性。最终列表来自搜索 <code>@ConfigurationProperties</code> 和 <code>@Value</code> 注解的源代码以及偶尔使用 <code>Binder</code> 。有关加载属性的确切顺序的更多信息，请参阅“ <a href="features.html#features.external-config">features.html</a> ”。</p>
<p translation-origin="off">The appendix includes an <a href="application-properties.html#application-properties"><code>application.properties</code></a> example with a list of the most common properties supported by Spring Boot.
The definitive list comes from searching the source code for <code>@ConfigurationProperties</code> and <code>@Value</code> annotations as well as the occasional use of <code>Binder</code>.
For more about the exact ordering of loading properties, see "<a href="features.html#features.external-config">features.html</a>".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.webserver" translation-result="on"><a href="howto.html#howto.webserver"></a>3. 嵌入式 Web 服务器</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver"></a>3. Embedded Web Servers</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">每个 Spring Boot Web 应用程序都包含一个嵌入式 Web 服务器。此功能会导致许多操作方法问题，包括如何更改嵌入式服务器以及如何配置嵌入式服务器。本节回答了这些问题。</p>
<p translation-origin="off">Each Spring Boot web application includes an embedded web server.
This feature leads to a number of how-to questions, including how to change the embedded server and how to configure the embedded server.
This section answers those questions.</p>
</div>
<div class="sect2">
<h3 id="howto.webserver.use-another" translation-result="on"><a href="howto.html#howto.webserver.use-another"></a>3.1. 使用另一个 Web 服务器</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-another"></a>3.1. Use Another Web Server</h3>
<div class="paragraph">
<p translation-result="on">许多 Spring Boot 启动器包含默认的嵌入式容器。</p>
<p translation-origin="off">Many Spring Boot starters include default embedded containers.</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on">对于 servlet 堆栈应用程序，<code>spring-boot-starter-web</code> 通过包含 <code>spring-boot-starter-tomcat</code> 来包含 Tomcat，但你可以用 <code>spring-boot-starter-jetty</code> 或 <code>spring-boot-starter-undertow</code> 代替。</p>
<p translation-origin="off">For servlet stack applications, the <code>spring-boot-starter-web</code> includes Tomcat by including <code>spring-boot-starter-tomcat</code>, but you can use <code>spring-boot-starter-jetty</code> or <code>spring-boot-starter-undertow</code> instead.</p>
</li>
<li>
<p translation-result="on">对于响应式堆栈应用程序，<code>spring-boot-starter-webflux</code> 通过包含 <code>spring-boot-starter-reactor-netty</code> netty 来包含 Reactor Netty，但你可以用 <code>spring-boot-starter-tomcat</code> 、 <code>spring-boot-starter-jetty</code> 或 <code>spring-boot-starter-undertow</code> 代替。</p>
<p translation-origin="off">For reactive stack applications, the <code>spring-boot-starter-webflux</code> includes Reactor Netty by including <code>spring-boot-starter-reactor-netty</code>, but you can use <code>spring-boot-starter-tomcat</code>, <code>spring-boot-starter-jetty</code>, or <code>spring-boot-starter-undertow</code> instead.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">当切换到不同的 HTTP 服务器时，你需要将默认依赖项换成你需要的那些。为了帮助完成这个过程，Spring Boot 为每个受支持的 HTTP 服务器提供了一个单独的启动器。</p>
<p translation-origin="off">When switching to a different HTTP server, you need to swap the default dependencies for those that you need instead.
To help with this process, Spring Boot provides a separate starter for each of the supported HTTP servers.</p>
</div>
<div class="paragraph">
<p translation-result="on">以下 Maven 示例展示了如何排除 Tomcat 并包含 Spring MVC 的 Jetty：</p>
<p translation-origin="off">The following Maven example shows how to exclude Tomcat and include Jetty for Spring MVC:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;properties&gt;
    &lt;servlet-api.version&gt;3.1.0&lt;/servlet-api.version&gt;
&lt;/properties&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;!-- Exclude the Tomcat dependency --&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;!-- Use Jetty instead --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">servlet API 的版本已被覆盖，因为与 Tomcat 9 和 Undertow 2 不同，Jetty 9.4 不支持 servlet 4.0。如果你希望使用支持 servlet 4.0 的 Jetty 10，请覆盖 <code>jetty.version</code> 属性而不是 <code>servlet-api.version</code> 属性。</p>
<p translation-origin="off">The version of the servlet API has been overridden as, unlike Tomcat 9 and Undertow 2, Jetty 9.4 does not support servlet 4.0.
If you wish to use Jetty 10, which does support servlet 4.0, override the <code>jetty.version</code> property rather than the <code>servlet-api.version</code> property.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">以下 Gradle 示例配置了必要的依赖项和<a href="https://docs.gradle.org/current/userguide/resolution_rules.html#sec:module_replacement">模块替换</a>，以使用 Undertow 代替 Spring WebFlux 的 Reactor Netty：</p>
<p translation-origin="off">The following Gradle example configures the necessary dependencies and a <a href="https://docs.gradle.org/current/userguide/resolution_rules.html#sec:module_replacement">module replacement</a> to use Undertow in place of Reactor Netty for Spring WebFlux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">dependencies {
    implementation "org.springframework.boot:spring-boot-starter-undertow"
    implementation "org.springframework.boot:spring-boot-starter-webflux"
    modules {
        module("org.springframework.boot:spring-boot-starter-reactor-netty") {
            replacedBy("org.springframework.boot:spring-boot-starter-undertow", "Use Undertow instead of Reactor Netty")
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">使用 <code>WebClient</code> 类需要 <code>spring-boot-starter-reactor-netty</code> ，因此即使你需要包含不同的 HTTP 服务器，你也可能需要保持对 Netty 的依赖。</p>
<p translation-origin="off"><code>spring-boot-starter-reactor-netty</code> is required to use the <code>WebClient</code> class, so you may need to keep a dependency on Netty even when you need to include a different HTTP server.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.disable" translation-result="on"><a href="howto.html#howto.webserver.disable"></a>3.2. 禁用 Web 服务器</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.disable"></a>3.2. Disabling the Web Server</h3>
<div class="paragraph">
<p translation-result="on">如果你的类路径包含启动 Web 服务器所需的位，Spring Boot 将自动启动它。要禁用此行为，请在 <code>application.properties</code> 中配置 <code>WebApplicationType</code> ，如下例所示：</p>
<p translation-origin="off">If your classpath contains the necessary bits to start a web server, Spring Boot will automatically start it.
To disable this behavior configure the <code>WebApplicationType</code> in your <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.main.web-application-type=none</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  main:
    web-application-type: "none"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.change-port" translation-result="on"><a href="howto.html#howto.webserver.change-port"></a>3.3. 更改 HTTP 端口</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.change-port"></a>3.3. Change the HTTP Port</h3>
<div class="paragraph">
<p translation-result="on">在独立应用程序中，主 HTTP 端口默认为 <code>8080</code> ，但可以用 <code>server.port</code> 设置（例如，在 <code>application.properties</code> 中或作为系统属性）。由于 <code>Environment</code> 值的轻松绑定，你还可以用 <code>SERVER_PORT</code> （例如，作为 OS 环境变量）。</p>
<p translation-origin="off">In a standalone application, the main HTTP port defaults to <code>8080</code> but can be set with <code>server.port</code> (for example, in <code>application.properties</code> or as a System property).
Thanks to relaxed binding of <code>Environment</code> values, you can also use <code>SERVER_PORT</code> (for example, as an OS environment variable).</p>
</div>
<div class="paragraph">
<p translation-result="on">要完全关闭 HTTP 端点但仍然创建 <code>WebApplicationContext</code> ，请使用 <code>server.port=-1</code> （这样做有时对测试很有用）。</p>
<p translation-origin="off">To switch off the HTTP endpoints completely but still create a <code>WebApplicationContext</code>, use <code>server.port=-1</code> (doing so is sometimes useful for testing).</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅“Spring Boot 特性”部分中的“ <a href="web.html#web.servlet.embedded-container.customizing">web.html</a> ”或<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ServerProperties.java"><code>ServerProperties</code></a>源代码。</p>
<p translation-origin="off">For more details, see “<a href="web.html#web.servlet.embedded-container.customizing">web.html</a>” in the ‘Spring Boot Features’ section, or the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ServerProperties.java"><code>ServerProperties</code></a> source code.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.use-random-port" translation-result="on"><a href="howto.html#howto.webserver.use-random-port"></a>3.4. 使用随机未分配的 HTTP 端口</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-random-port"></a>3.4. Use a Random Unassigned HTTP Port</h3>
<div class="paragraph">
<p translation-result="on">要扫描空闲端口（使用 OS 本机来防止冲突），请使用 <code>server.port=0</code> 。</p>
<p translation-origin="off">To scan for a free port (using OS natives to prevent clashes) use <code>server.port=0</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.discover-port" translation-result="on"><a href="howto.html#howto.webserver.discover-port"></a>3.5. 在运行时发现 HTTP 端口</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.discover-port"></a>3.5. Discover the HTTP Port at Runtime</h3>
<div class="paragraph">
<p translation-result="on">你可以从日志输出或通过 <code>WebServer</code> 从 <code>WebServerApplicationContext</code> 访问服务器正在运行的端口。获得它并确保它已被初始化的最佳方法是添加一个 <code>ApplicationListener&lt;WebServerInitializedEvent&gt;</code> 类型的 <code>@Bean</code> 并在发布时将容器从事件中拉出。</p>
<p translation-origin="off">You can access the port the server is running on from log output or from the <code>WebServerApplicationContext</code> through its <code>WebServer</code>.
The best way to get that and be sure it has been initialized is to add a <code>@Bean</code> of type <code>ApplicationListener&lt;WebServerInitializedEvent&gt;</code> and pull the container out of the event when it is published.</p>
</div>
<div class="paragraph">
<p translation-result="on">使用 <code>@SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT)</code> 的测试也可以用 <code>@LocalServerPort</code> 注解将实际端口注入到字段中，如下例所示：</p>
<p translation-origin="off">Tests that use <code>@SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT)</code> can also inject the actual port into a field by using the <code>@LocalServerPort</code> annotation, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.SpringBootTest.WebEnvironment;
import org.springframework.boot.web.server.LocalServerPort;

</span><span class="fold-block">@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
public class MyWebIntegrationTests {

    @LocalServerPort
    int port;

    // ...

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-result="on"><code>@LocalServerPort</code> 是 <code>@Value("${local.server.port}")</code> 的元注解。不要尝试在常规应用程序中注入端口。正如我们刚刚看到的，只有在容器初始化之后才设置该值。与测试相反，应用程序代码回调被提前处理（在值实际可用之前）。</p>
<p translation-origin="off"><code>@LocalServerPort</code> is a meta-annotation for <code>@Value("${local.server.port}")</code>.
Do not try to inject the port in a regular application.
As we just saw, the value is set only after the container has been initialized.
Contrary to a test, application code callbacks are processed early (before the value is actually available).</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.enable-response-compression" translation-result="on"><a href="howto.html#howto.webserver.enable-response-compression"></a>3.6. 启用 HTTP 响应压缩</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.enable-response-compression"></a>3.6. Enable HTTP Response Compression</h3>
<div class="paragraph">
<p translation-result="on">Jetty、Tomcat 和 Undertow 支持 HTTP 响应压缩。可以在 <code>application.properties</code> 中启用，如下：</p>
<p translation-origin="off">HTTP response compression is supported by Jetty, Tomcat, and Undertow.
It can be enabled in <code>application.properties</code>, as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.compression.enabled=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  compression:
    enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">默认情况下，响应的长度必须至少为 2048 字节才能执行压缩。你可以通过设置 <code>server.compression.min-response-size</code> 属性来配置此行为。</p>
<p translation-origin="off">By default, responses must be at least 2048 bytes in length for compression to be performed.
You can configure this behavior by setting the <code>server.compression.min-response-size</code> property.</p>
</div>
<div class="paragraph">
<p translation-result="on">默认情况下，仅当响应的内容类型为以下之一时才会压缩响应：</p>
<p translation-origin="off">By default, responses are compressed only if their content type is one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>text/html</code></p>
</li>
<li>
<p><code>text/xml</code></p>
</li>
<li>
<p><code>text/plain</code></p>
</li>
<li>
<p><code>text/css</code></p>
</li>
<li>
<p><code>text/javascript</code></p>
</li>
<li>
<p><code>application/javascript</code></p>
</li>
<li>
<p><code>application/json</code></p>
</li>
<li>
<p><code>application/xml</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">你可以通过设置 <code>server.compression.mime-types</code> 属性来配置此行为。</p>
<p translation-origin="off">You can configure this behavior by setting the <code>server.compression.mime-types</code> property.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.configure-ssl" translation-result="on"><a href="howto.html#howto.webserver.configure-ssl"></a>3.7. 配置 SSL</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-ssl"></a>3.7. Configure SSL</h3>
<div class="paragraph">
<p translation-result="on">可以通过设置各种 <code>server.ssl.*</code> 属性以声明方式配置 SSL，通常在 <code>application.properties</code> 或 <code>application.yml</code> 中。以下示例显示在 <code>application.properties</code> 中设置 SSL 属性：</p>
<p translation-origin="off">SSL can be configured declaratively by setting the various <code>server.ssl.*</code> properties, typically in <code>application.properties</code> or <code>application.yml</code>.
The following example shows setting SSL properties in <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.port=8443
server.ssl.key-store=classpath:keystore.jks
server.ssl.key-store-password=secret
server.ssl.key-password=another-secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  port: 8443
  ssl:
    key-store: "classpath:keystore.jks"
    key-store-password: "secret"
    key-password: "another-secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">有关所有受支持属性的详细信息，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/web/server/Ssl.java"><code>Ssl</code></a> 。</p>
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/web/server/Ssl.java"><code>Ssl</code></a> for details of all of the supported properties.</p>
</div>
<div class="paragraph">
<p translation-result="on">使用上述示例的配置意味着应用程序不再支持端口 8080 上的普通 HTTP 连接器。Spring Boot 不支持通过 <code>application.properties</code> 配置 HTTP 连接器和 HTTPS 连接器。如果你想同时拥有两者，则需要以编程方式配置其中之一。我们建议使用 <code>application.properties</code> 来配置 HTTPS，因为 HTTP 连接器是两者中更容易以编程方式配置的。</p>
<p translation-origin="off">Using configuration such as the preceding example means the application no longer supports a plain HTTP connector at port 8080.
Spring Boot does not support the configuration of both an HTTP connector and an HTTPS connector through <code>application.properties</code>.
If you want to have both, you need to configure one of them programmatically.
We recommend using <code>application.properties</code> to configure HTTPS, as the HTTP connector is the easier of the two to configure programmatically.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.configure-http2" translation-result="on"><a href="howto.html#howto.webserver.configure-http2"></a>3.8. 配置 HTTP/2</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2"></a>3.8. Configure HTTP/2</h3>
<div class="paragraph">
<p translation-result="on">你可以用 <code>server.http2.enabled</code> 配置属性在 Spring Boot 应用程序中启用 HTTP/2 支持。支持 <code>h2</code> （基于 TLS 的 HTTP/2）和 <code>h2c</code> （基于 TCP 的 HTTP/2）。要使用 <code>h2</code> ，还必须启用 SSL。未启用 SSL 时，将使用 <code>h2c</code> 。<code>h2</code> 支持的详细信息取决于所选的 Web 服务器和应用程序环境，因为并非所有 JDK 8 版本都支持开箱即用的协议。</p>
<p translation-origin="off">You can enable HTTP/2 support in your Spring Boot application with the <code>server.http2.enabled</code> configuration property.
Both <code>h2</code> (HTTP/2 over TLS) and <code>h2c</code> (HTTP/2 over TCP) are supported.
To use <code>h2</code>, SSL must also be enabled.
When SSL is not enabled, <code>h2c</code> will be used.
The details of the <code>h2</code> support depend on the chosen web server and the application environment, since that protocol is not supported out-of-the-box by all JDK 8 releases.</p>
</div>
<div class="sect3">
<h4 id="howto.webserver.configure-http2.tomcat" translation-result="on"><a href="howto.html#howto.webserver.configure-http2.tomcat"></a>3.8.1. HTTP/2 与 Tomcat</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2.tomcat"></a>3.8.1. HTTP/2 with Tomcat</h4>
<div class="paragraph">
<p translation-result="on">Spring Boot 默认随 Tomcat 9.0.x 一起提供，当使用 JDK 9 或更高版本时，它支持开箱即用的 <code>h2c</code> 和开箱即用的 <code>h2</code> 。或者，如果 <code>libtcnative</code> 库及其依赖项安装在主机操作系统上，则可以在 JDK 8 上使用 <code>h2</code> 。</p>
<p translation-origin="off">Spring Boot ships by default with Tomcat 9.0.x which supports <code>h2c</code> out of the box and <code>h2</code> out of the box when using JDK 9 or later.
Alternatively, <code>h2</code> can be used on JDK 8 if the <code>libtcnative</code> library and its dependencies are installed on the host operating system.</p>
</div>
<div class="paragraph">
<p translation-result="on">库目录必须对 JVM 库路径可用（如果还没有的话）。你可以用 JVM 参数来执行此操作，例如 <code>-Djava.library.path=/usr/local/opt/tomcat-native/lib</code> 。更多信息请参阅 <a href="https://tomcat.apache.org/tomcat-9.0-doc/apr.html">Tomcat 官方文档</a>。</p>
<p translation-origin="off">The library directory must be made available, if not already, to the JVM library path.
You can do so with a JVM argument such as <code>-Djava.library.path=/usr/local/opt/tomcat-native/lib</code>.
More on this in the <a href="https://tomcat.apache.org/tomcat-9.0-doc/apr.html">official Tomcat documentation</a>.</p>
</div>
<div class="paragraph">
<p translation-result="on">在启用了 HTTP/2 和 SSL 但没有本机支持的情况下在 JDK 8 上启动 Tomcat 9.0.x 会记录以下错误：</p>
<p translation-origin="off">Starting Tomcat 9.0.x on JDK 8 with HTTP/2 and SSL enabled but without that native support logs the following error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ERROR 8787 --- [           main] o.a.coyote.http11.Http11NioProtocol      : The upgrade handler [org.apache.coyote.http2.Http2Protocol] for [h2] only supports upgrade via ALPN but has been configured for the ["https-jsse-nio-8443"] connector that does not support ALPN.</pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">这个错误不是致命的，应用程序仍然以 HTTP/1.1 SSL 支持启动。</p>
<p translation-origin="off">This error is not fatal, and the application still starts with HTTP/1.1 SSL support.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.webserver.configure-http2.jetty" translation-result="on"><a href="howto.html#howto.webserver.configure-http2.jetty"></a>3.8.2. HTTP/2 与 Jetty</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2.jetty"></a>3.8.2. HTTP/2 with Jetty</h4>
<div class="paragraph">
<p translation-result="on">对于 HTTP/2 支持，Jetty 需要额外的 <code>org.eclipse.jetty.http2:http2-server</code> 依赖项。要使用 <code>h2c</code> ，不需要其他依赖项。要使用 <code>h2</code> ，你还需要根据你的部署选择以下依赖项之一：</p>
<p translation-origin="off">For HTTP/2 support, Jetty requires the additional <code>org.eclipse.jetty.http2:http2-server</code> dependency.
To use <code>h2c</code> no other dependencies are required.
To use <code>h2</code>, you also need to choose one of the following dependencies, depending on your deployment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on"><code>org.eclipse.jetty:jetty-alpn-java-server</code> 用于在 JDK9+ 上运行的应用程序</p>
<p translation-origin="off"><code>org.eclipse.jetty:jetty-alpn-java-server</code> for applications running on JDK9+</p>
</li>
<li>
<p translation-result="on"><code>org.eclipse.jetty:jetty-alpn-openjdk8-server</code> 用于在 JDK8u252+ 上运行的应用程序</p>
<p translation-origin="off"><code>org.eclipse.jetty:jetty-alpn-openjdk8-server</code> for applications running on JDK8u252+</p>
</li>
<li>
<p translation-result="on"><code>org.eclipse.jetty:jetty-alpn-conscrypt-server</code> 和没有 JDK 要求的 <a href="https://www.conscrypt.org/">Conscrypt 库</a></p>
<p translation-origin="off"><code>org.eclipse.jetty:jetty-alpn-conscrypt-server</code> and the <a href="https://www.conscrypt.org/">Conscrypt library</a> with no JDK requirement</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="howto.webserver.configure-http2.netty" translation-result="on"><a href="howto.html#howto.webserver.configure-http2.netty"></a>3.8.3. 带有 Reactor Netty 的 HTTP/2</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2.netty"></a>3.8.3. HTTP/2 with Reactor Netty</h4>
<div class="paragraph">
<p translation-result="on"><code>spring-boot-webflux-starter</code> 默认使用 Reactor Netty 作为服务器。Reactor Netty 支持使用 JDK 8 或更高版本的 <code>h2c</code> ，无需额外依赖。Reactor Netty 使用 JDK 9 或更高版本的 JDK 支持来支持 <code>h2</code> 。对于 JDK 8 环境，或为了获得最佳运行时性能，该服务器还支持带有本机库的 <code>h2</code> 。要启用它，你的应用程序需要有一个额外的依赖项。</p>
<p translation-origin="off">The <code>spring-boot-webflux-starter</code> is using by default Reactor Netty as a server.
Reactor Netty supports <code>h2c</code> using JDK 8 or later with no additional dependencies.
Reactor Netty supports <code>h2</code> using the JDK support with JDK 9 or later.
For JDK 8 environments, or for optimal runtime performance, this server also supports <code>h2</code> with native libraries.
To enable that, your application needs to have an additional dependency.</p>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 管理 <code>io.netty:netty-tcnative-boringssl-static</code> “uber jar”的版本，包含所有平台的原生库。开发人员可以选择使用分类器仅导入所需的依赖项（参见 <a href="https://netty.io/wiki/forked-tomcat-native.html">Netty 官方文档</a>）。</p>
<p translation-origin="off">Spring Boot manages the version for the <code>io.netty:netty-tcnative-boringssl-static</code> "uber jar", containing native libraries for all platforms.
Developers can choose to import only the required dependencies using a classifier (see <a href="https://netty.io/wiki/forked-tomcat-native.html">the Netty official documentation</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.webserver.configure-http2.undertow" translation-result="on"><a href="howto.html#howto.webserver.configure-http2.undertow"></a>3.8.4. HTTP/2 与 Undertow</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2.undertow"></a>3.8.4. HTTP/2 with Undertow</h4>
<div class="paragraph">
<p translation-result="on">从 Undertow 1.4.0+ 开始，JDK 8 支持 <code>h2</code> 和 <code>h2c</code> ，无需任何额外的依赖。</p>
<p translation-origin="off">As of Undertow 1.4.0+, both <code>h2</code> and <code>h2c</code> are supported on JDK 8 without any additional dependencies.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.configure" translation-result="on"><a href="howto.html#howto.webserver.configure"></a>3.9. 配置 Web 服务器</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure"></a>3.9. Configure the Web Server</h3>
<div class="paragraph">
<p translation-result="on">通常，你应该首先考虑使用许多可用配置键之一，并通过在 <code>application.properties</code> 或 <code>application.yml</code> 文件中添加新条目来自定义你的 Web 服务器。请参阅“ <a href="howto.html#howto.properties-and-configuration.discover-build-in-options-for-external-properties">发现外部属性的内置选项</a>”）。<code>server.*</code> 命名空间在这里非常有用，它包括 <code>server.tomcat.*</code> 、 <code>server.jetty.*</code> 等命名空间，用于特定于服务器的功能。请参阅 <a href="application-properties.html#application-properties">application-properties.html</a> 列表。</p>
<p translation-origin="off">Generally, you should first consider using one of the many available configuration keys and customize your web server by adding new entries in your <code>application.properties</code> or <code>application.yml</code> file.
See “<a href="howto.html#howto.properties-and-configuration.discover-build-in-options-for-external-properties">Discover Built-in Options for External Properties</a>”).
The <code>server.*</code> namespace is quite useful here, and it includes namespaces like <code>server.tomcat.*</code>, <code>server.jetty.*</code> and others, for server-specific features.
See the list of <a href="application-properties.html#application-properties">application-properties.html</a>.</p>
</div>
<div class="paragraph">
<p translation-result="on">前面的部分已经涵盖了许多常见用例，例如压缩、SSL 或 HTTP/2。但是，如果你的用例不存在配置键，则应查看<a href="https://docs.spring.io/spring-boot/docs/2.6.3/api/org/springframework/boot/web/server/WebServerFactoryCustomizer.html"><code>WebServerFactoryCustomizer</code></a> 。你可以声明这样一个组件并访问与你的选择相关的服务器工厂：你应该为所选服务器（Tomcat、Jetty、Reactor Netty、Undertow）和所选 Web 堆栈（servlet 或响应式）选择变体。</p>
<p translation-origin="off">The previous sections covered already many common use cases, such as compression, SSL or HTTP/2.
However, if a configuration key does not exist for your use case, you should then look at <a href="https://docs.spring.io/spring-boot/docs/2.6.3/api/org/springframework/boot/web/server/WebServerFactoryCustomizer.html"><code>WebServerFactoryCustomizer</code></a>.
You can declare such a component and get access to the server factory relevant to your choice: you should select the variant for the chosen Server (Tomcat, Jetty, Reactor Netty, Undertow) and the chosen web stack (servlet or reactive).</p>
</div>
<div class="paragraph">
<p translation-result="on">下面的示例适用于带有 <code>spring-boot-starter-web</code> （servlet 堆栈）的 Tomcat：</p>
<p translation-origin="off">The example below is for Tomcat with the <code>spring-boot-starter-web</code> (servlet stack):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;
import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyTomcatWebServerCustomizer implements WebServerFactoryCustomizer&lt;TomcatServletWebServerFactory&gt; {

    @Override
    public void customize(TomcatServletWebServerFactory factory) {
        // customize the factory here
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">Spring Boot 在内部使用该基础架构来自动配置服务器。自动配置的 <code>WebServerFactoryCustomizer</code> bean 的顺序为 <code>0</code> ，并且将在任何用户定义的定制器之前处理，除非它有明确的顺序说明。</p>
<p translation-origin="off">Spring Boot uses that infrastructure internally to auto-configure the server.
Auto-configured <code>WebServerFactoryCustomizer</code> beans have an order of <code>0</code> and will be processed before any user-defined customizers, unless it has an explicit order that states otherwise.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">使用定制器访问 <code>WebServerFactory</code> 后，你可以用它来配置特定部分，例如连接器、服务器资源或服务器本身——所有这些都使用特定于服务器的 API。</p>
<p translation-origin="off">Once you have got access to a <code>WebServerFactory</code> using the customizer, you can use it to configure specific parts, like connectors, server resources, or the server itself - all using server-specific APIs.</p>
</div>
<div class="paragraph">
<p translation-result="on">此外，Spring Boot 还提供：</p>
<p translation-origin="off">In addition Spring Boot provides:</p>
</div>
<table id="howto-configure-webserver-customizers" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">
  <p translation-result="on">服务器</p>
  <p translation-origin="off">Server</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-result="on">Servlet 堆栈</p>
  <p translation-origin="off">Servlet stack</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-result="on">反应堆</p>
  <p translation-origin="off">Reactive stack</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p translation-result="on">Tomcat</p><p class="tableblock" translation-origin="off">Tomcat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TomcatServletWebServerFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TomcatReactiveWebServerFactory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p translation-result="on">Jetty</p><p class="tableblock" translation-origin="off">Jetty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JettyServletWebServerFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JettyReactiveWebServerFactory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p translation-result="on">暗流</p><p class="tableblock" translation-origin="off">Undertow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UndertowServletWebServerFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UndertowReactiveWebServerFactory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p translation-result="on">反应堆</p><p class="tableblock" translation-origin="off">Reactor</p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on">不适用</p><p class="tableblock" translation-origin="off">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NettyReactiveWebServerFactory</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p translation-result="on">作为最后的手段，你还可以声明自己的 <code>WebServerFactory</code> bean，它将覆盖 Spring Boot 提供的那个。当你这样做时，自动配置的定制器仍会应用于你的自定义工厂，因此请谨慎使用该选项。</p>
<p translation-origin="off">As a last resort, you can also declare your own <code>WebServerFactory</code> bean, which will override the one provided by Spring Boot.
When you do so, auto-configured customizers are still applied on your custom factory, so use that option carefully.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.add-servlet-filter-listener" translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener"></a>3.10. 向应用程序添加 Servlet、过滤器或侦听器</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.add-servlet-filter-listener"></a>3.10. Add a Servlet, Filter, or Listener to an Application</h3>
<div class="paragraph">
<p translation-result="on">在 servlet 堆栈应用程序中，即使用 <code>spring-boot-starter-web</code> ，有两种方法可以将 <code>Servlet</code> 、 <code>Filter</code> 、 <code>ServletContextListener</code> 和 Servlet API 支持的其他侦听器添加到你的应用程序中：</p>
<p translation-origin="off">In a servlet stack application, that is with the <code>spring-boot-starter-web</code>, there are two ways to add <code>Servlet</code>, <code>Filter</code>, <code>ServletContextListener</code>, and the other listeners supported by the Servlet API to your application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean">使用 Spring Bean 添加 Servlet、过滤器或侦听器</a></p>
<p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean">Add a Servlet, Filter, or Listener by Using a Spring Bean</a></p>
</li>
<li>
<p translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener.using-scanning">使用类路径扫描添加 Servlet、过滤器和侦听器</a></p>
<p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.using-scanning">Add Servlets, Filters, and Listeners by Using Classpath Scanning</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="howto.webserver.add-servlet-filter-listener.spring-bean" translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean"></a>3.10.1. 使用 Spring Bean 添加 Servlet、过滤器或侦听器</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean"></a>3.10.1. Add a Servlet, Filter, or Listener by Using a Spring Bean</h4>
<div class="paragraph">
<p translation-result="on">要使用 Spring bean 添加 <code>Servlet</code> 、 <code>Filter</code> 或 servlet <code>*Listener</code> ，你必须为其提供 <code>@Bean</code> 定义。当你想要注入配置或依赖项时，这样做会非常有用。但是，你必须非常小心，它们不会导致太多其他 bean 的急切初始化，因为它们必须在应用程序生命周期的早期安装到容器中。（例如，让它们依赖于你的 <code>DataSource</code> 或 JPA 配置并不是一个好主意。）你可以通过在第一次使用而不是初始化时懒惰地初始化 bean 来解决这些限制。</p>
<p translation-origin="off">To add a <code>Servlet</code>, <code>Filter</code>, or servlet <code>*Listener</code> by using a Spring bean, you must provide a <code>@Bean</code> definition for it.
Doing so can be very useful when you want to inject configuration or dependencies.
However, you must be very careful that they do not cause eager initialization of too many other beans, because they have to be installed in the container very early in the application lifecycle.
(For example, it is not a good idea to have them depend on your <code>DataSource</code> or JPA configuration.)
You can work around such restrictions by initializing the beans lazily when first used instead of on initialization.</p>
</div>
<div class="paragraph">
<p translation-result="on">在过滤器和 servlet 的情况下，你还可以通过添加 <code>FilterRegistrationBean</code> 或 <code>ServletRegistrationBean</code> 来添加映射和初始化参数，而不是添加或添加到底层组件。</p>
<p translation-origin="off">In the case of filters and servlets, you can also add mappings and init parameters by adding a <code>FilterRegistrationBean</code> or a <code>ServletRegistrationBean</code> instead of or in addition to the underlying component.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-result="on">如果没有在过滤器注册上指定 <code>dispatcherType</code> ，则使用 <code>REQUEST</code> 。这与 servlet 规范的默认调度程序类型一致。</p>
<p translation-origin="off">If no <code>dispatcherType</code> is specified on a filter registration, <code>REQUEST</code> is used.
This aligns with the servlet specification’s default dispatcher type.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">像任何其他 Spring bean 一样，你可以定义 servlet 过滤器 bean 的顺序；请务必检查“ <a href="web.html#web.servlet.embedded-container.servlets-filters-listeners.beans">web.html</a> ”部分。</p>
<p translation-origin="off">Like any other Spring bean, you can define the order of servlet filter beans; please make sure to check the “<a href="web.html#web.servlet.embedded-container.servlets-filters-listeners.beans">web.html</a>” section.</p>
</div>
<div class="sect4">
<h5 id="howto.webserver.add-servlet-filter-listener.spring-bean.disable" translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean.disable"></a>禁用 Servlet 或过滤器的注册</h5>
<h5 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean.disable"></a>Disable Registration of a Servlet or Filter</h5>
<div class="paragraph">
<p translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean">如前所述</a>，任何 <code>Servlet</code> 或 <code>Filter</code> bean 都会自动注册到 servlet 容器中。要禁用特定 <code>Filter</code> 或 <code>Servlet</code> bean 的注册，请为其创建一个注册 bean 并将其标记为禁用，如以下示例所示：</p>
<p translation-origin="off">As <a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean">described earlier</a>, any <code>Servlet</code> or <code>Filter</code> beans are registered with the servlet container automatically.
To disable registration of a particular <code>Filter</code> or <code>Servlet</code> bean, create a registration bean for it and mark it as disabled, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyFilterConfiguration {

    @Bean
    public FilterRegistrationBean&lt;MyFilter&gt; registration(MyFilter filter) {
        FilterRegistrationBean&lt;MyFilter&gt; registration = new FilterRegistrationBean&lt;&gt;(filter);
        registration.setEnabled(false);
        return registration;
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="howto.webserver.add-servlet-filter-listener.using-scanning" translation-result="on"><a href="howto.html#howto.webserver.add-servlet-filter-listener.using-scanning"></a>3.10.2. 使用类路径扫描添加 Servlet、过滤器和侦听器</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.add-servlet-filter-listener.using-scanning"></a>3.10.2. Add Servlets, Filters, and Listeners by Using Classpath Scanning</h4>
<div class="paragraph">
<p translation-result="on"><code>@WebServlet</code> 、 <code>@WebFilter</code> 和 <code>@WebListener</code> 注解的类可以通过使用 <code>@ServletComponentScan</code> 注解 <code>@Configuration</code> 类并指定包含要注册的组件的包来自动注册到嵌入式 servlet 容器。默认情况下，<code>@ServletComponentScan</code> 从注解类的包中扫描。</p>
<p translation-origin="off"><code>@WebServlet</code>, <code>@WebFilter</code>, and <code>@WebListener</code> annotated classes can be automatically registered with an embedded servlet container by annotating a <code>@Configuration</code> class with <code>@ServletComponentScan</code> and specifying the package(s) containing the components that you want to register.
By default, <code>@ServletComponentScan</code> scans from the package of the annotated class.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.configure-access-logs" translation-result="on"><a href="howto.html#howto.webserver.configure-access-logs"></a>3.11. 配置访问日志</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-access-logs"></a>3.11. Configure Access Logging</h3>
<div class="paragraph">
<p translation-result="on">可以通过各自的命名空间为 Tomcat、Undertow 和 Jetty 配置访问日志。</p>
<p translation-origin="off">Access logs can be configured for Tomcat, Undertow, and Jetty through their respective namespaces.</p>
</div>
<div class="paragraph">
<p translation-result="on">例如，以下设置使用<a href="https://tomcat.apache.org/tomcat-9.0-doc/config/valve.html#Access_Logging">自定义模式</a>在 Tomcat 上记录访问。</p>
<p translation-origin="off">For instance, the following settings log access on Tomcat with a <a href="https://tomcat.apache.org/tomcat-9.0-doc/config/valve.html#Access_Logging">custom pattern</a>.</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.basedir=my-tomcat
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.pattern=%t %a %r %s (%D ms)</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    basedir: "my-tomcat"
    accesslog:
      enabled: true
      pattern: "%t %a %r %s (%D ms)"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">日志的默认位置是相对于 Tomcat 基本目录的 <code>logs</code> 目录。默认情况下，<code>logs</code> 目录是一个临时目录，因此你可能需要修复 Tomcat 的基本目录或使用日志的绝对路径。在前面的示例中，日志位于相对于应用程序工作目录的 <code>my-tomcat/logs</code> 中。</p>
<p translation-origin="off">The default location for logs is a <code>logs</code> directory relative to the Tomcat base directory.
By default, the <code>logs</code> directory is a temporary directory, so you may want to fix Tomcat’s base directory or use an absolute path for the logs.
In the preceding example, the logs are available in <code>my-tomcat/logs</code> relative to the working directory of the application.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">Undertow 的访问日志可以以类似的方式配置，如以下示例所示：</p>
<p translation-origin="off">Access logging for Undertow can be configured in a similar fashion, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.undertow.accesslog.enabled=true
server.undertow.accesslog.pattern=%t %a %r %s (%D ms)</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  undertow:
    accesslog:
      enabled: true
      pattern: "%t %a %r %s (%D ms)"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">日志存储在相对于应用程序工作目录的 <code>logs</code> 目录中。你可以通过设置 <code>server.undertow.accesslog.dir</code> 属性来自定义此位置。</p>
<p translation-origin="off">Logs are stored in a <code>logs</code> directory relative to the working directory of the application.
You can customize this location by setting the <code>server.undertow.accesslog.dir</code> property.</p>
</div>
<div class="paragraph">
<p translation-result="on">最后，Jetty 的访问日志也可以配置如下：</p>
<p translation-origin="off">Finally, access logging for Jetty can also be configured as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.jetty.accesslog.enabled=true
server.jetty.accesslog.filename=/var/log/jetty-access.log</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  jetty:
    accesslog:
      enabled: true
      filename: "/var/log/jetty-access.log"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">默认情况下，日志被重定向到 <code>System.err</code> 。有关更多详细信息，请参阅 Jetty 文档。</p>
<p translation-origin="off">By default, logs are redirected to <code>System.err</code>.
For more details, see the Jetty documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.use-behind-a-proxy-server" translation-result="on"><a href="howto.html#howto.webserver.use-behind-a-proxy-server"></a>3.12. 在前端代理服务器后面运行</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-behind-a-proxy-server"></a>3.12. Running Behind a Front-end Proxy Server</h3>
<div class="paragraph">
<p translation-result="on">如果你的应用程序在代理、负载均衡器或云中运行，请求信息（如主机、端口、方案……）可能会在此过程中发生变化。你的应用程序可能在 <code>10.10.10.10:8080</code> 上运行，但 HTTP 客户端应该只能看到 <code>example.org</code> 。</p>
<p translation-origin="off">If your application is running behind a proxy, a load-balancer or in the cloud, the request information (like the host, port, scheme…​) might change along the way.
Your application may be running on <code>10.10.10.10:8080</code>, but HTTP clients should only see <code>example.org</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on"><a href="https://tools.ietf.org/html/rfc7239">RFC7239“Forwarded Headers”</a>定义了 <code>Forwarded</code> HTTP 标头；代理可以用此标头来提供有关原始请求的信息。你可以将应用程序配置为读取这些标头，并在创建链接并将其发送到 HTTP 302 响应、JSON 文档或 HTML 页面中的客户端时自动使用该信息。还有非标准的标头，例如 <code>X-Forwarded-Host</code> 、 <code>X-Forwarded-Port</code> 、 <code>X-Forwarded-Proto</code> 、 <code>X-Forwarded-Ssl</code> 和 <code>X-Forwarded-Prefix</code> 。</p>
<p translation-origin="off"><a href="https://tools.ietf.org/html/rfc7239">RFC7239 "Forwarded Headers"</a> defines the <code>Forwarded</code> HTTP header; proxies can use this header to provide information about the original request.
You can configure your application to read those headers and automatically use that information when creating links and sending them to clients in HTTP 302 responses, JSON documents or HTML pages.
There are also non-standard headers, like <code>X-Forwarded-Host</code>, <code>X-Forwarded-Port</code>, <code>X-Forwarded-Proto</code>, <code>X-Forwarded-Ssl</code>, and <code>X-Forwarded-Prefix</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果代理添加了常用的 <code>X-Forwarded-For</code> 和 <code>X-Forwarded-Proto</code> 标头，<code>server.forward-headers-strategy</code> 设置为 <code>NATIVE</code> 就足以支持这些标头。有了这个选项，Web 服务器本身就支持这个特性；你可以查看他们的特定文档以了解特定行为。</p>
<p translation-origin="off">If the proxy adds the commonly used <code>X-Forwarded-For</code> and <code>X-Forwarded-Proto</code> headers, setting <code>server.forward-headers-strategy</code> to <code>NATIVE</code> is enough to support those.
With this option, the Web servers themselves natively support this feature; you can check their specific documentation to learn about specific behavior.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果这还不够，Spring Framework 提供了一个 <a href="https://docs.spring.io/spring-framework/docs/5.3.15/reference/html/web.html#filters-forwarded-headers">ForwardedHeaderFilter</a> 。你可以通过将 <code>server.forward-headers-strategy</code> 设置为 <code>FRAMEWORK</code> 将其注册为应用程序中的 servlet 过滤器。</p>
<p translation-origin="off">If this is not enough, Spring Framework provides a <a href="https://docs.spring.io/spring-framework/docs/5.3.15/reference/html/web.html#filters-forwarded-headers">ForwardedHeaderFilter</a>.
You can register it as a servlet filter in your application by setting <code>server.forward-headers-strategy</code> is set to <code>FRAMEWORK</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">如果你使用 Tomcat 并在代理上终止 SSL，则 <code>server.tomcat.redirect-context-root</code> 应设置为 <code>false</code> 。这允许在执行任何重定向之前遵守 <code>X-Forwarded-Proto</code> 标头。</p>
<p translation-origin="off">If you are using Tomcat and terminating SSL at the proxy, <code>server.tomcat.redirect-context-root</code> should be set to <code>false</code>.
This allows the <code>X-Forwarded-Proto</code> header to be honored before any redirects are performed.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">如果你的应用程序在 Cloud Foundry 或 Heroku 中运行，则 <code>server.forward-headers-strategy</code> 属性默认为 <code>NATIVE</code> 。在所有其他情况下，它默认为 <code>NONE</code> 。</p>
<p translation-origin="off">If your application runs in Cloud Foundry or Heroku, the <code>server.forward-headers-strategy</code> property defaults to <code>NATIVE</code>.
In all other instances, it defaults to <code>NONE</code>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="howto.webserver.use-behind-a-proxy-server.tomcat" translation-result="on"><a href="howto.html#howto.webserver.use-behind-a-proxy-server.tomcat"></a>3.12.1. 自定义 Tomcat 的代理配置</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-behind-a-proxy-server.tomcat"></a>3.12.1. Customize Tomcat’s Proxy Configuration</h4>
<div class="paragraph">
<p translation-result="on">如果你使用 Tomcat，你可以额外配置用于携带“转发”信息的标头名称，如下例所示：</p>
<p translation-origin="off">If you use Tomcat, you can additionally configure the names of the headers used to carry “forwarded” information, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.remoteip.remote-ip-header=x-your-remote-ip-header
server.tomcat.remoteip.protocol-header=x-your-protocol-header</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    remoteip:
      remote-ip-header: "x-your-remote-ip-header"
      protocol-header: "x-your-protocol-header"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">Tomcat 还配置了一个默认的正则表达式，该表达式匹配要信任的内部代理。默认情况下，信任 <code>10/8</code> 、 <code>192.168/16</code> 、 <code>169.254/16</code> 和 <code>127/8</code> 中的 IP 地址。你可以通过向 <code>application.properties</code> 添加条目来自定义阀门的配置，如以下示例所示：</p>
<p translation-origin="off">Tomcat is also configured with a default regular expression that matches internal proxies that are to be trusted.
By default, IP addresses in <code>10/8</code>, <code>192.168/16</code>, <code>169.254/16</code> and <code>127/8</code> are trusted.
You can customize the valve’s configuration by adding an entry to <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.remoteip.internal-proxies=192\\.168\\.\\d{1,3}\\.\\d{1,3}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    remoteip:
      internal-proxies: "192\\.168\\.\\d{1,3}\\.\\d{1,3}"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">你可以通过将 <code>internal-proxies</code> 设置为空来信任所有代理（但不要在生产中这样做）。</p>
<p translation-origin="off">You can trust all proxies by setting the <code>internal-proxies</code> to empty (but do not do so in production).</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">你可以通过关闭自动配置（为此，设置 <code>server.forward-headers-strategy=NONE</code> ）并使用 <code>WebServerFactoryCustomizer</code> bean 添加新的 Valve 实例来完全控制 Tomcat 的 <code>RemoteIpValve</code> 的配置。</p>
<p translation-origin="off">You can take complete control of the configuration of Tomcat’s <code>RemoteIpValve</code> by switching the automatic one off (to do so, set <code>server.forward-headers-strategy=NONE</code>) and adding a new valve instance using a <code>WebServerFactoryCustomizer</code> bean.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.enable-multiple-connectors-in-tomcat" translation-result="on"><a href="howto.html#howto.webserver.enable-multiple-connectors-in-tomcat"></a>3.13. 使用 Tomcat 启用多个连接器</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.enable-multiple-connectors-in-tomcat"></a>3.13. Enable Multiple Connectors with Tomcat</h3>
<div class="paragraph">
<p translation-result="on">你可以将 <code>org.apache.catalina.connector.Connector</code> 添加到 <code>TomcatServletWebServerFactory</code> ，它可以允许多个连接器，包括 HTTP 和 HTTPS 连接器，如下例所示：</p>
<p translation-origin="off">You can add an <code>org.apache.catalina.connector.Connector</code> to the <code>TomcatServletWebServerFactory</code>, which can allow multiple connectors, including HTTP and HTTPS connectors, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.io.IOException;
import java.net.URL;

import org.apache.catalina.connector.Connector;
import org.apache.coyote.http11.Http11NioProtocol;

import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;
import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.util.ResourceUtils;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyTomcatConfiguration {

    @Bean
    public WebServerFactoryCustomizer&lt;TomcatServletWebServerFactory&gt; sslConnectorCustomizer() {
        return (tomcat) -&gt; tomcat.addAdditionalTomcatConnectors(createSslConnector());
    }

    private Connector createSslConnector() {
        Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");
        Http11NioProtocol protocol = (Http11NioProtocol) connector.getProtocolHandler();
        try {
            URL keystore = ResourceUtils.getURL("keystore");
            URL truststore = ResourceUtils.getURL("truststore");
            connector.setScheme("https");
            connector.setSecure(true);
            connector.setPort(8443);
            protocol.setSSLEnabled(true);
            protocol.setKeystoreFile(keystore.toString());
            protocol.setKeystorePass("changeit");
            protocol.setTruststoreFile(truststore.toString());
            protocol.setTruststorePass("changeit");
            protocol.setKeyAlias("apitester");
            return connector;
        }
        catch (IOException ex) {
            throw new IllegalStateException("Fail to create ssl connector", ex);
        }
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.use-tomcat-legacycookieprocessor" translation-result="on"><a href="howto.html#howto.webserver.use-tomcat-legacycookieprocessor"></a>3.14. 使用 Tomcat 的 LegacyCookieProcessor</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-tomcat-legacycookieprocessor"></a>3.14. Use Tomcat’s LegacyCookieProcessor</h3>
<div class="paragraph">
<p translation-result="on">默认情况下，Spring Boot 使用的嵌入式 Tomcat 不支持 Cookie 格式的“Version 0”，所以你可能会看到如下错误：</p>
<p translation-origin="off">By default, the embedded Tomcat used by Spring Boot does not support "Version 0" of the Cookie format, so you may see the following error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java.lang.IllegalArgumentException: An invalid character [32] was present in the Cookie value</pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">如果可能的话，你应该考虑更新你的代码以仅存储符合以后 Cookie 规范的值。但是，如果你无法更改 cookie 的写入方式，则可以将 Tomcat 配置为使用 <code>LegacyCookieProcessor</code> 。要切换到 <code>LegacyCookieProcessor</code> ，请使用添加 <code>TomcatContextCustomizer</code> 的 <code>WebServerFactoryCustomizer</code> bean，如以下示例所示：</p>
<p translation-origin="off">If at all possible, you should consider updating your code to only store values compliant with later Cookie specifications.
If, however, you cannot change the way that cookies are written, you can instead configure Tomcat to use a <code>LegacyCookieProcessor</code>.
To switch to the <code>LegacyCookieProcessor</code>, use an <code>WebServerFactoryCustomizer</code> bean that adds a <code>TomcatContextCustomizer</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.apache.tomcat.util.http.LegacyCookieProcessor;

import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;
import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyLegacyCookieProcessorConfiguration {

    @Bean
    public WebServerFactoryCustomizer&lt;TomcatServletWebServerFactory&gt; cookieProcessorCustomizer() {
        return (factory) -&gt; factory
                .addContextCustomizers((context) -&gt; context.setCookieProcessor(new LegacyCookieProcessor()));
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.enable-tomcat-mbean-registry" translation-result="on"><a href="howto.html#howto.webserver.enable-tomcat-mbean-registry"></a>3.15. 启用 Tomcat 的 MBean 注册表</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.enable-tomcat-mbean-registry"></a>3.15. Enable Tomcat’s MBean Registry</h3>
<div class="paragraph">
<p translation-result="on">默认情况下禁用嵌入式 Tomcat 的 MBean 注册表。这最大限度地减少了 Tomcat 的内存占用。例如，如果要使用 Tomcat 的 MBean，以便 Micrometer 可以用它们来公开度量，则必须使用 <code>server.tomcat.mbeanregistry.enabled</code> 属性来执行此操作，如下例所示：</p>
<p translation-origin="off">Embedded Tomcat’s MBean registry is disabled by default.
This minimizes Tomcat’s memory footprint.
If you want to use Tomcat’s MBeans, for example so that they can be used by Micrometer to expose metrics, you must use the <code>server.tomcat.mbeanregistry.enabled</code> property to do so, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.mbeanregistry.enabled=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    mbeanregistry:
      enabled: true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.enable-multiple-listeners-in-undertow" translation-result="on"><a href="howto.html#howto.webserver.enable-multiple-listeners-in-undertow"></a>3.16. 使用 Undertow 启用多个侦听器</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.enable-multiple-listeners-in-undertow"></a>3.16. Enable Multiple Listeners with Undertow</h3>
<div class="paragraph">
<p translation-result="on">将 <code>UndertowBuilderCustomizer</code> 添加到 <code>UndertowServletWebServerFactory</code> 并将侦听器添加到 <code>Builder</code> ，如以下示例所示：</p>
<p translation-origin="off">Add an <code>UndertowBuilderCustomizer</code> to the <code>UndertowServletWebServerFactory</code> and add a listener to the <code>Builder</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.undertow.Undertow.Builder;

import org.springframework.boot.web.embedded.undertow.UndertowServletWebServerFactory;
import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyUndertowConfiguration {

    @Bean
    public WebServerFactoryCustomizer&lt;UndertowServletWebServerFactory&gt; undertowListenerCustomizer() {
        return (factory) -&gt; factory.addBuilderCustomizers(this::addHttpListener);
    }

    private Builder addHttpListener(Builder builder) {
        return builder.addHttpListener(8080, "0.0.0.0");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.create-websocket-endpoints-using-serverendpoint" translation-result="on"><a href="howto.html#howto.webserver.create-websocket-endpoints-using-serverendpoint"></a>3.17. 使用 @ServerEndpoint 创建 WebSocket 端点</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.create-websocket-endpoints-using-serverendpoint"></a>3.17. Create WebSocket Endpoints Using @ServerEndpoint</h3>
<div class="paragraph">
<p translation-result="on">如果要在使用嵌入式容器的 Spring Boot 应用程序中使用 <code>@ServerEndpoint</code> ，则必须声明单个 <code>ServerEndpointExporter</code> <code>@Bean</code> ，如以下示例所示：</p>
<p translation-origin="off">If you want to use <code>@ServerEndpoint</code> in a Spring Boot application that used an embedded container, you must declare a single <code>ServerEndpointExporter</code> <code>@Bean</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.socket.server.standard.ServerEndpointExporter;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyWebSocketConfiguration {

    @Bean
    public ServerEndpointExporter serverEndpointExporter() {
        return new ServerEndpointExporter();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">前面示例中显示的 bean 将任何 <code>@ServerEndpoint</code> 注解的 bean 注册到底层 WebSocket 容器。当部署到独立的 servlet 容器时，此角色由 servlet 容器初始化程序执行，并且不需要 <code>ServerEndpointExporter</code> bean。</p>
<p translation-origin="off">The bean shown in the preceding example registers any <code>@ServerEndpoint</code> annotated beans with the underlying WebSocket container.
When deployed to a standalone servlet container, this role is performed by a servlet container initializer, and the <code>ServerEndpointExporter</code> bean is not required.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.spring-mvc" translation-result="on"><a href="howto.html#howto.spring-mvc"></a>4. SpringMVC</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc"></a>4. Spring MVC</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 有许多启动器，包括 Spring MVC。请注意，一些启动器包含对 Spring MVC 的依赖项，而不是直接包含它。本节回答有关 Spring MVC 和 Spring Boot 的常见问题。</p>
<p translation-origin="off">Spring Boot has a number of starters that include Spring MVC.
Note that some starters include a dependency on Spring MVC rather than include it directly.
This section answers common questions about Spring MVC and Spring Boot.</p>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.write-json-rest-service" translation-result="on"><a href="howto.html#howto.spring-mvc.write-json-rest-service"></a>4.1. 编写 JSON REST 服务</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.write-json-rest-service"></a>4.1. Write a JSON REST Service</h3>
<div class="paragraph">
<p translation-result="on">只要 Jackson2 在类路径上，Spring Boot 应用程序中的任何 Spring <code>@RestController</code> 都应该默认呈现 JSON 响应，如下例所示：</p>
<p translation-origin="off">Any Spring <code>@RestController</code> in a Spring Boot application should render JSON response by default as long as Jackson2 is on the classpath, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

</span><span class="fold-block">@RestController
public class MyController {

    @RequestMapping("/thing")
    public MyThing thing() {
        return new MyThing();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">只要 <code>MyThing</code> 可以被 Jackson2 序列化（对于普通的 POJO 或 Groovy 对象为真），那么 <code>localhost:8080/thing</code> 默认提供它的 JSON 表示。请注意，在浏览器中，你有时可能会看到 XML 响应，因为浏览器倾向于发送更喜欢 XML 的接受标头。</p>
<p translation-origin="off">As long as <code>MyThing</code> can be serialized by Jackson2 (true for a normal POJO or Groovy object), then <code><a href="http://localhost:8080/thing" class="bare">localhost:8080/thing</a></code> serves a JSON representation of it by default.
Note that, in a browser, you might sometimes see XML responses, because browsers tend to send accept headers that prefer XML.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.write-xml-rest-service" translation-result="on"><a href="howto.html#howto.spring-mvc.write-xml-rest-service"></a>4.2. 编写 XML REST 服务</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.write-xml-rest-service"></a>4.2. Write an XML REST Service</h3>
<div class="paragraph">
<p translation-result="on">如果类路径上有 Jackson XML 扩展 ( <code>jackson-dataformat-xml</code> )，则可以用它来呈现 XML 响应。我们之前用于 JSON 的示例可以工作。要使用 Jackson XML 渲染器，请将以下依赖项添加到你的项目中：</p>
<p translation-origin="off">If you have the Jackson XML extension (<code>jackson-dataformat-xml</code>) on the classpath, you can use it to render XML responses.
The previous example that we used for JSON would work.
To use the Jackson XML renderer, add the following dependency to your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;
    &lt;artifactId&gt;jackson-dataformat-xml&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">如果 Jackson 的 XML 扩展不可用而 JAXB 可用，则可以呈现 XML，但需要将 <code>MyThing</code> 注解为 <code>@XmlRootElement</code> ，如下例所示：</p>
<p translation-origin="off">If Jackson’s XML extension is not available and JAXB is available, XML can be rendered with the additional requirement of having <code>MyThing</code> annotated as <code>@XmlRootElement</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.xml.bind.annotation.XmlRootElement;

</span><span class="fold-block">@XmlRootElement
public class MyThing {

    private String name;

</span><span class="fold-block hide-when-unfolded">    // getters/setters ...

</span><span class="fold-block hide-when-folded">    public String getName() {
        return this.name;
    }

    public void setName(String name) {
        this.name = name;
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">JAXB 仅适用于 Java 8。如果你使用较新的 Java 代，请将以下依赖项添加到你的项目中：</p>
<p translation-origin="off">JAXB is only available out of the box with Java 8.
If you use a more recent Java generation, add the following dependency to your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish.jaxb&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb-runtime&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">要让服务器呈现 XML 而不是 JSON，你可能必须发送 <code>Accept: text/xml</code> 标头（或使用浏览器）。</p>
<p translation-origin="off">To get the server to render XML instead of JSON, you might have to send an <code>Accept: text/xml</code> header (or use a browser).</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.customize-jackson-objectmapper" translation-result="on"><a href="howto.html#howto.spring-mvc.customize-jackson-objectmapper"></a>4.3. 自定义 Jackson ObjectMapper</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.customize-jackson-objectmapper"></a>4.3. Customize the Jackson ObjectMapper</h3>
<div class="paragraph">
<p translation-result="on">Spring MVC（客户端和服务器端）使用 <code>HttpMessageConverters</code> 在 HTTP 交换中协商内容转换。如果 Jackson 在类路径上，你已经获得了 <code>Jackson2ObjectMapperBuilder</code> 提供的默认转换器，它的一个实例是为你自动配置的。</p>
<p translation-origin="off">Spring MVC (client and server side) uses <code>HttpMessageConverters</code> to negotiate content conversion in an HTTP exchange.
If Jackson is on the classpath, you already get the default converter(s) provided by <code>Jackson2ObjectMapperBuilder</code>, an instance of which is auto-configured for you.</p>
</div>
<div class="paragraph">
<p translation-result="on"><code>ObjectMapper</code> （或 Jackson XML 转换器的 <code>XmlMapper</code> ）实例（默认创建）具有以下自定义属性：</p>
<p translation-origin="off">The <code>ObjectMapper</code> (or <code>XmlMapper</code> for Jackson XML converter) instance (created by default) has the following customized properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on"><code>MapperFeature.DEFAULT_VIEW_INCLUSION</code> 已禁用</p>
<p translation-origin="off"><code>MapperFeature.DEFAULT_VIEW_INCLUSION</code> is disabled</p>
</li>
<li>
<p translation-result="on"><code>DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES</code> 被禁用</p>
<p translation-origin="off"><code>DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES</code> is disabled</p>
</li>
<li>
<p translation-result="on"><code>SerializationFeature.WRITE_DATES_AS_TIMESTAMPS</code> 已禁用</p>
<p translation-origin="off"><code>SerializationFeature.WRITE_DATES_AS_TIMESTAMPS</code> is disabled</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 还具有一些功能，可以更轻松地自定义此行为。</p>
<p translation-origin="off">Spring Boot also has some features to make it easier to customize this behavior.</p>
</div>
<div class="paragraph">
<p translation-result="on">你可以用环境配置 <code>ObjectMapper</code> 和 <code>XmlMapper</code> 实例。Jackson 提供了一套广泛的开/关功能，可用于配置其处理的各个方面。这些特性在六个枚举（在 Jackson 中）中描述，它们映射到环境中的属性：</p>
<p translation-origin="off">You can configure the <code>ObjectMapper</code> and <code>XmlMapper</code> instances by using the environment.
Jackson provides an extensive suite of on/off features that can be used to configure various aspects of its processing.
These features are described in six enums (in Jackson) that map onto properties in the environment:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">
  <p translation-result="on">枚举</p>
  <p translation-origin="off">Enum</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-result="on">财产</p>
  <p translation-origin="off">Property</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-result="on">价值观</p>
  <p translation-origin="off">Values</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.fasterxml.jackson.databind.DeserializationFeature</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>spring.jackson.deserialization.&lt;feature_name&gt;</code></p><p translation-result="on" translation-origin="off"><code>spring.jackson.deserialization.&lt;feature_name&gt;</code></p><p class="tableblock" translation-origin="off"><code>spring.jackson.deserialization.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>true</code> <code>false</code></p><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.fasterxml.jackson.core.JsonGenerator.Feature</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>spring.jackson.generator.&lt;feature_name&gt;</code></p><p translation-result="on" translation-origin="off"><code>spring.jackson.generator.&lt;feature_name&gt;</code></p><p class="tableblock" translation-origin="off"><code>spring.jackson.generator.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>true</code> <code>false</code></p><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.fasterxml.jackson.databind.MapperFeature</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>spring.jackson.mapper.&lt;feature_name&gt;</code></p><p translation-result="on" translation-origin="off"><code>spring.jackson.mapper.&lt;feature_name&gt;</code></p><p class="tableblock" translation-origin="off"><code>spring.jackson.mapper.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>true</code> <code>false</code></p><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.fasterxml.jackson.core.JsonParser.Feature</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>spring.jackson.parser.&lt;feature_name&gt;</code></p><p translation-result="on" translation-origin="off"><code>spring.jackson.parser.&lt;feature_name&gt;</code></p><p class="tableblock" translation-origin="off"><code>spring.jackson.parser.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>true</code> <code>false</code></p><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.fasterxml.jackson.databind.SerializationFeature</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>spring.jackson.serialization.&lt;feature_name&gt;</code></p><p translation-result="on" translation-origin="off"><code>spring.jackson.serialization.&lt;feature_name&gt;</code></p><p class="tableblock" translation-origin="off"><code>spring.jackson.serialization.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>true</code> <code>false</code></p><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.fasterxml.jackson.annotation.JsonInclude.Include</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spring.jackson.default-property-inclusion</code></p></td>
<td class="tableblock halign-left valign-top"><p translation-result="on"><code>always</code> ，<code>non_null</code> ，<code>non_absent</code> ，<code>non_default</code> ，<code>non_empty</code></p><p class="tableblock" translation-origin="off"><code>always</code>, <code>non_null</code>, <code>non_absent</code>, <code>non_default</code>, <code>non_empty</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p translation-result="on">例如，要启用漂亮打印，请设置 <code>spring.jackson.serialization.indent_output=true</code> 。请注意，由于使用了 <a href="features.html#features.external-config.typesafe-configuration-properties.relaxed-binding">宽松的绑定</a>，<code>indent_output</code> 的大小写不必与相应的枚举常量（即 <code>INDENT_OUTPUT</code> ）的大小写匹配。</p>
<p translation-origin="off">For example, to enable pretty print, set <code>spring.jackson.serialization.indent_output=true</code>.
Note that, thanks to the use of <a href="features.html#features.external-config.typesafe-configuration-properties.relaxed-binding">relaxed binding</a>, the case of <code>indent_output</code> does not have to match the case of the corresponding enum constant, which is <code>INDENT_OUTPUT</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">此基于环境的配置应用于自动配置的 <code>Jackson2ObjectMapperBuilder</code> bean，并应用于使用构建器创建的任何映射器，包括自动配置的 <code>ObjectMapper</code> bean。</p>
<p translation-origin="off">This environment-based configuration is applied to the auto-configured <code>Jackson2ObjectMapperBuilder</code> bean and applies to any mappers created by using the builder, including the auto-configured <code>ObjectMapper</code> bean.</p>
</div>
<div class="paragraph">
<p translation-result="on">上下文的 <code>Jackson2ObjectMapperBuilder</code> 可以由一个或多个 <code>Jackson2ObjectMapperBuilderCustomizer</code> bean 自定义。可以订购此类定制器 bean（Boot 自己的定制器的顺序为 0），允许在 Boot 定制之前和之后应用额外的定制。</p>
<p translation-origin="off">The context’s <code>Jackson2ObjectMapperBuilder</code> can be customized by one or more <code>Jackson2ObjectMapperBuilderCustomizer</code> beans.
Such customizer beans can be ordered (Boot’s own customizer has an order of 0), letting additional customization be applied both before and after Boot’s customization.</p>
</div>
<div class="paragraph">
<p translation-result="on"><code>com.fasterxml.jackson.databind.Module</code> 类型的任何 bean 都会自动注册到自动配置的 <code>Jackson2ObjectMapperBuilder</code> 并应用于它创建的任何 <code>ObjectMapper</code> 实例。当你向应用程序添加新功能时，这提供了一种用于贡献自定义模块的全局机制。</p>
<p translation-origin="off">Any beans of type <code>com.fasterxml.jackson.databind.Module</code> are automatically registered with the auto-configured <code>Jackson2ObjectMapperBuilder</code> and are applied to any <code>ObjectMapper</code> instances that it creates.
This provides a global mechanism for contributing custom modules when you add new features to your application.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果你想完全替换默认 <code>ObjectMapper</code> ，请定义该类型的 <code>@Bean</code> 并将其标记为 <code>@Primary</code> ，或者，如果你更喜欢基于构建器的方法，请定义 <code>Jackson2ObjectMapperBuilder</code> <code>@Bean</code> 。请注意，在任何一种情况下，这样做都会禁用 <code>ObjectMapper</code> 的所有自动配置。</p>
<p translation-origin="off">If you want to replace the default <code>ObjectMapper</code> completely, either define a <code>@Bean</code> of that type and mark it as <code>@Primary</code> or, if you prefer the builder-based approach, define a <code>Jackson2ObjectMapperBuilder</code> <code>@Bean</code>.
Note that, in either case, doing so disables all auto-configuration of the <code>ObjectMapper</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果你提供 <code>@Beans</code> <code>MappingJackson2HttpMessageConverter</code> 它们将替换 MVC 配置中的默认值。此外，还提供了一个 <code>HttpMessageConverters</code> 类型的便利 bean（如果你使用默认 MVC 配置，则始终可用）。它有一些有用的方法来访问默认和用户增强的消息转换器。</p>
<p translation-origin="off">If you provide any <code>@Beans</code> of type <code>MappingJackson2HttpMessageConverter</code>, they replace the default value in the MVC configuration.
Also, a convenience bean of type <code>HttpMessageConverters</code> is provided (and is always available if you use the default MVC configuration).
It has some useful methods to access the default and user-enhanced message converters.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅“<a href="howto.html#howto.spring-mvc.customize-responsebody-rendering">自定义 @ResponseBody 渲染</a>”部分和<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java"><code>WebMvcAutoConfiguration</code></a>源代码。</p>
<p translation-origin="off">See the “<a href="howto.html#howto.spring-mvc.customize-responsebody-rendering">Customize the @ResponseBody Rendering</a>” section and the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java"><code>WebMvcAutoConfiguration</code></a> source code for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.customize-responsebody-rendering" translation-result="on"><a href="howto.html#howto.spring-mvc.customize-responsebody-rendering"></a>4.4. 自定义 @ResponseBody 渲染</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.customize-responsebody-rendering"></a>4.4. Customize the @ResponseBody Rendering</h3>
<div class="paragraph">
<p translation-result="on">Spring 使用 <code>HttpMessageConverters</code> 来呈现 <code>@ResponseBody</code> （或来自 <code>@RestController</code> 的响应）。你可以通过在 Spring Boot 上下文中添加适当类型的 bean 来贡献其他转换器。如果你添加的 bean 是默认包含的类型（例如用于 JSON 转换的 <code>MappingJackson2HttpMessageConverter</code> ），它将替换默认值。提供了一个 <code>HttpMessageConverters</code> 类型的便利 bean，如果你使用默认 MVC 配置，它始终可用。它有一些有用的方法来访问默认和用户增强的消息转换器（例如，如果你想手动将它们注入自定义 <code>RestTemplate</code> ，它会很有用）。</p>
<p translation-origin="off">Spring uses <code>HttpMessageConverters</code> to render <code>@ResponseBody</code> (or responses from <code>@RestController</code>).
You can contribute additional converters by adding beans of the appropriate type in a Spring Boot context.
If a bean you add is of a type that would have been included by default anyway (such as <code>MappingJackson2HttpMessageConverter</code> for JSON conversions), it replaces the default value.
A convenience bean of type <code>HttpMessageConverters</code> is provided and is always available if you use the default MVC configuration.
It has some useful methods to access the default and user-enhanced message converters (For example, it can be useful if you want to manually inject them into a custom <code>RestTemplate</code>).</p>
</div>
<div class="paragraph">
<p translation-result="on">与正常的 MVC 用法一样，你提供的任何 <code>WebMvcConfigurer</code> bean 也可以通过覆盖 <code>configureMessageConverters</code> 方法来贡献转换器。但是，与普通 MVC 不同，你只能提供你需要的其他转换器（因为 Spring Boot 使用相同的机制来贡献其默认值）。最后，如果你通过提供自己的 <code>@EnableWebMvc</code> 配置来选择退出 Spring Boot 默认 MVC 配置，则可以完全控制并使用 <code>WebMvcConfigurationSupport</code> 中的 <code>getMessageConverters</code> 手动完成所有操作。</p>
<p translation-origin="off">As in normal MVC usage, any <code>WebMvcConfigurer</code> beans that you provide can also contribute converters by overriding the <code>configureMessageConverters</code> method.
However, unlike with normal MVC, you can supply only additional converters that you need (because Spring Boot uses the same mechanism to contribute its defaults).
Finally, if you opt out of the Spring Boot default MVC configuration by providing your own <code>@EnableWebMvc</code> configuration, you can take control completely and do everything manually by using <code>getMessageConverters</code> from <code>WebMvcConfigurationSupport</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java"><code>WebMvcAutoConfiguration</code></a>源代码。</p>
<p translation-origin="off">See the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java"><code>WebMvcAutoConfiguration</code></a> source code for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.multipart-file-uploads" translation-result="on"><a href="howto.html#howto.spring-mvc.multipart-file-uploads"></a>4.5. 处理多部分文件上传</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.multipart-file-uploads"></a>4.5. Handling Multipart File Uploads</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 包含 servlet 3 <code>javax.servlet.http.Part</code> API 以支持上传文件。默认情况下，Spring Boot 将 Spring MVC 配置为每个文件的最大大小为 1MB，单个请求中的文件数据最大为 10MB。你可以用 <code>MultipartProperties</code> 类中公开的属性覆盖这些值、存储中间数据的位置（例如，存储到 <code>/tmp</code> 目录）以及数据刷新到磁盘的阈值。例如，如果要指定文件不受限制，请将 <code>spring.servlet.multipart.max-file-size</code> 属性设置为 <code>-1</code> 。</p>
<p translation-origin="off">Spring Boot embraces the servlet 3 <code>javax.servlet.http.Part</code> API to support uploading files.
By default, Spring Boot configures Spring MVC with a maximum size of 1MB per file and a maximum of 10MB of file data in a single request.
You may override these values, the location to which intermediate data is stored (for example, to the <code>/tmp</code> directory), and the threshold past which data is flushed to disk by using the properties exposed in the <code>MultipartProperties</code> class.
For example, if you want to specify that files be unlimited, set the <code>spring.servlet.multipart.max-file-size</code> property to <code>-1</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">当你希望在 Spring MVC 控制器处理程序方法中接收多部分编码文件数据作为 <code>MultipartFile</code> 类型的 <code>@RequestParam</code> -annotated 参数时，多部分支持很有帮助。</p>
<p translation-origin="off">The multipart support is helpful when you want to receive multipart encoded file data as a <code>@RequestParam</code>-annotated parameter of type <code>MultipartFile</code> in a Spring MVC controller handler method.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/MultipartAutoConfiguration.java"><code>MultipartAutoConfiguration</code></a>源。</p>
<p translation-origin="off">See the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/MultipartAutoConfiguration.java"><code>MultipartAutoConfiguration</code></a> source for more details.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">建议使用容器对分段上传的内置支持，而不是引入额外的依赖项，例如 Apache Commons File Upload。</p>
<p translation-origin="off">It is recommended to use the container’s built-in support for multipart uploads rather than introducing an additional dependency such as Apache Commons File Upload.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.switch-off-dispatcherservlet" translation-result="on"><a href="howto.html#howto.spring-mvc.switch-off-dispatcherservlet"></a>4.6. 关闭 Spring MVC DispatcherServlet</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.switch-off-dispatcherservlet"></a>4.6. Switch Off the Spring MVC DispatcherServlet</h3>
<div class="paragraph">
<p translation-result="on">默认情况下，所有内容都从应用程序的根目录 ( <code>/</code> ) 提供。如果你希望映射到不同的路径，你可以配置如下：</p>
<p translation-origin="off">By default, all content is served from the root of your application (<code>/</code>).
If you would rather map to a different path, you can configure one as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mvc.servlet.path=/mypath</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mvc:
    servlet:
      path: "/mypath"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">如果你有其他 servlet，你可以为每个 <code>Servlet</code> 或 <code>ServletRegistrationBean</code> 类型声明一个 <code>@Bean</code> ，Spring Boot 会将它们透明地注册到容器中。因为 servlet 是以这种方式注册的，所以它们可以映射到 <code>DispatcherServlet</code> 的子上下文而不调用它。</p>
<p translation-origin="off">If you have additional servlets you can declare a <code>@Bean</code> of type <code>Servlet</code> or <code>ServletRegistrationBean</code> for each and Spring Boot will register them transparently to the container.
Because servlets are registered that way, they can be mapped to a sub-context of the <code>DispatcherServlet</code> without invoking it.</p>
</div>
<div class="paragraph">
<p translation-result="on">自己配置 <code>DispatcherServlet</code> 是不寻常的，但如果你真的需要这样做，还必须提供类型为 <code>DispatcherServletPath</code> 的 <code>@Bean</code> 以提供自定义 <code>DispatcherServlet</code> 的路径。</p>
<p translation-origin="off">Configuring the <code>DispatcherServlet</code> yourself is unusual but if you really need to do it, a <code>@Bean</code> of type <code>DispatcherServletPath</code> must be provided as well to provide the path of your custom <code>DispatcherServlet</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.switch-off-default-configuration" translation-result="on"><a href="howto.html#howto.spring-mvc.switch-off-default-configuration"></a>4.7. 关闭默认 MVC 配置</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.switch-off-default-configuration"></a>4.7. Switch off the Default MVC Configuration</h3>
<div class="paragraph">
<p translation-result="on">完全控制 MVC 配置的最简单方法是为你自己的 <code>@Configuration</code> 提供 <code>@EnableWebMvc</code> 注解。这样做会将所有 MVC 配置留在你的手中。</p>
<p translation-origin="off">The easiest way to take complete control over MVC configuration is to provide your own <code>@Configuration</code> with the <code>@EnableWebMvc</code> annotation.
Doing so leaves all MVC configuration in your hands.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.customize-view-resolvers" translation-result="on"><a href="howto.html#howto.spring-mvc.customize-view-resolvers"></a>4.8. 自定义 ViewResolver</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.customize-view-resolvers"></a>4.8. Customize ViewResolvers</h3>
<div class="paragraph">
<p translation-result="on"><code>ViewResolver</code> 是 Spring MVC 的核心组件，将 <code>@Controller</code> 中的视图名称转换为实际的 <code>View</code> 实现。请注意，<code>ViewResolvers</code> 主要用于 UI 应用程序，而不是 REST 样式的服务（ <code>View</code> 不用于呈现 <code>@ResponseBody</code> ）。有许多 <code>ViewResolver</code> 实现可供选择，Spring 本身并没有决定你应该使用哪些实现。另一方面，Spring Boot 会为你安装一个或两个，具体取决于它在类路径和应用程序上下文中找到的内容。<code>DispatcherServlet</code> 使用它在应用程序上下文中找到的所有解析器，依次尝试每个解析器，直到得到结果。如果你添加自己的，则必须了解添加解析器的顺序和位置。</p>
<p translation-origin="off">A <code>ViewResolver</code> is a core component of Spring MVC, translating view names in <code>@Controller</code> to actual <code>View</code> implementations.
Note that <code>ViewResolvers</code> are mainly used in UI applications, rather than REST-style services (a <code>View</code> is not used to render a <code>@ResponseBody</code>).
There are many implementations of <code>ViewResolver</code> to choose from, and Spring on its own is not opinionated about which ones you should use.
Spring Boot, on the other hand, installs one or two for you, depending on what it finds on the classpath and in the application context.
The <code>DispatcherServlet</code> uses all the resolvers it finds in the application context, trying each one in turn until it gets a result.
If you add your own, you have to be aware of the order and in which position your resolver is added.</p>
</div>
<div class="paragraph">
<p translation-result="on"><code>WebMvcAutoConfiguration</code> 将以下 <code>ViewResolvers</code> 添加到你的上下文中：</p>
<p translation-origin="off"><code>WebMvcAutoConfiguration</code> adds the following <code>ViewResolvers</code> to your context:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on">一个名为“defaultViewResolver”的 <code>InternalResourceViewResolver</code> 。这个定位可以用 <code>DefaultServlet</code> 呈现的物理资源（包括静态资源和 JSP 页面，如果你使用它们）。它将前缀和后缀应用于视图名称，然后在 servlet 上下文中查找具有该路径的物理资源（默认均为空，但可通过 <code>spring.mvc.view.prefix</code> 和 <code>spring.mvc.view.suffix</code> ）。你可以通过提供相同类型的 bean 来覆盖它。</p>
<p translation-origin="off">An <code>InternalResourceViewResolver</code> named ‘defaultViewResolver’.
This one locates physical resources that can be rendered by using the <code>DefaultServlet</code> (including static resources and JSP pages, if you use those).
It applies a prefix and a suffix to the view name and then looks for a physical resource with that path in the servlet context (the defaults are both empty but are accessible for external configuration through <code>spring.mvc.view.prefix</code> and <code>spring.mvc.view.suffix</code>).
You can override it by providing a bean of the same type.</p>
</li>
<li>
<p translation-result="on">一个名为“beanNameViewResolver”的 <code>BeanNameViewResolver</code> 。这是视图解析器链中一个有用的成员，它会拾取与正在解析的 <code>View</code> 同名的任何 bean。没有必要覆盖或替换它。</p>
<p translation-origin="off">A <code>BeanNameViewResolver</code> named ‘beanNameViewResolver’.
This is a useful member of the view resolver chain and picks up any beans with the same name as the <code>View</code> being resolved.
It should not be necessary to override or replace it.</p>
</li>
<li>
<p translation-result="on">仅当实际<strong>存在</strong><code>View</code> 类型的 bean 时，才会添加名为“viewResolver”的 <code>ContentNegotiatingViewResolver</code> 。这是一个复合解析器，委托给所有其他解析器并尝试找到与客户端发送的“接受”HTTP 标头的匹配项。有一个<a href="https://spring.io/blog/2013/06/03/content-negotiation-using-views">关于 <code>ContentNegotiatingViewResolver</code> 的有用博客</a>，你可能想学习以了解更多信息，你还可以查看源代码了解详细信息。你可以通过定义一个名为“viewResolver”的 bean 来关闭自动配置的 <code>ContentNegotiatingViewResolver</code> 。</p>
<p translation-origin="off">A <code>ContentNegotiatingViewResolver</code> named ‘viewResolver’ is added only if there <strong>are</strong> actually beans of type <code>View</code> present.
This is a composite resolver, delegating to all the others and attempting to find a match to the ‘Accept’ HTTP header sent by the client.
There is a useful <a href="https://spring.io/blog/2013/06/03/content-negotiation-using-views">blog about <code>ContentNegotiatingViewResolver</code></a> that you might like to study to learn more, and you might also look at the source code for detail.
You can switch off the auto-configured <code>ContentNegotiatingViewResolver</code> by defining a bean named ‘viewResolver’.</p>
</li>
<li>
<p translation-result="on">如果你使用 Thymeleaf，你还有一个名为“ <code>ThymeleafViewResolver</code> ”的 ThymeleafViewResolver。它通过用前缀和后缀包围视图名称来查找资源。前缀是 <code>spring.thymeleaf.prefix</code> ，后缀是 <code>spring.thymeleaf.suffix</code> 。前缀和后缀的值分别默认为 'classpath:/templates/' 和 '.html'。你可以通过提供同名 bean 来覆盖 <code>ThymeleafViewResolver</code> 。</p>
<p translation-origin="off">If you use Thymeleaf, you also have a <code>ThymeleafViewResolver</code> named ‘thymeleafViewResolver’.
It looks for resources by surrounding the view name with a prefix and suffix.
The prefix is <code>spring.thymeleaf.prefix</code>, and the suffix is <code>spring.thymeleaf.suffix</code>.
The values of the prefix and suffix default to ‘classpath:/templates/’ and ‘.html’, respectively.
You can override <code>ThymeleafViewResolver</code> by providing a bean of the same name.</p>
</li>
<li>
<p translation-result="on">如果你使用 FreeMarker，你还有一个名为“freeMarkerViewResolver”的 <code>FreeMarkerViewResolver</code> 。它通过用前缀和后缀包围视图名称来在加载器路径（外部 <code>spring.freemarker.templateLoaderPath</code> 并具有默认值'classpath:/templates/'）中查找资源。前缀外部 <code>spring.freemarker.prefix</code> ，后缀外部 <code>spring.freemarker.suffix</code> 。前缀和后缀的默认值分别为空和“.ftlh”。你可以通过提供同名 bean 来覆盖 <code>FreeMarkerViewResolver</code> 。</p>
<p translation-origin="off">If you use FreeMarker, you also have a <code>FreeMarkerViewResolver</code> named ‘freeMarkerViewResolver’.
It looks for resources in a loader path (which is externalized to <code>spring.freemarker.templateLoaderPath</code> and has a default value of ‘classpath:/templates/’) by surrounding the view name with a prefix and a suffix.
The prefix is externalized to <code>spring.freemarker.prefix</code>, and the suffix is externalized to <code>spring.freemarker.suffix</code>.
The default values of the prefix and suffix are empty and ‘.ftlh’, respectively.
You can override <code>FreeMarkerViewResolver</code> by providing a bean of the same name.</p>
</li>
<li>
<p translation-result="on">如果你使用 Groovy 模板（实际上，如果 <code>groovy-templates</code> 在你的类路径中），你还有一个名为“ <code>GroovyMarkupViewResolver</code> ”的 GroovyMarkupViewResolver。它通过用前缀和后缀（外部 <code>spring.groovy.template.prefix</code> 和 <code>spring.groovy.template.suffix</code> ）包围视图名称来在加载器路径中查找资源。前缀和后缀的默认值分别为“classpath:/templates/”和“.tpl”。你可以通过提供同名的 bean 来覆盖 <code>GroovyMarkupViewResolver</code> 。</p>
<p translation-origin="off">If you use Groovy templates (actually, if <code>groovy-templates</code> is on your classpath), you also have a <code>GroovyMarkupViewResolver</code> named ‘groovyMarkupViewResolver’.
It looks for resources in a loader path by surrounding the view name with a prefix and suffix (externalized to <code>spring.groovy.template.prefix</code> and <code>spring.groovy.template.suffix</code>).
The prefix and suffix have default values of ‘classpath:/templates/’ and ‘.tpl’, respectively.
You can override <code>GroovyMarkupViewResolver</code> by providing a bean of the same name.</p>
</li>
<li>
<p translation-result="on">如果你使用 Mustache，你还有一个名为“mustacheViewResolver”的 <code>MustacheViewResolver</code> 。它通过用前缀和后缀包围视图名称来查找资源。前缀是 <code>spring.mustache.prefix</code> ，后缀是 <code>spring.mustache.suffix</code> 。前缀和后缀的值分别默认为“classpath:/templates/”和“.mustache”。你可以通过提供同名的 bean 来覆盖 <code>MustacheViewResolver</code> 。</p>
<p translation-origin="off">If you use Mustache, you also have a <code>MustacheViewResolver</code> named ‘mustacheViewResolver’.
It looks for resources by surrounding the view name with a prefix and suffix.
The prefix is <code>spring.mustache.prefix</code>, and the suffix is <code>spring.mustache.suffix</code>.
The values of the prefix and suffix default to ‘classpath:/templates/’ and ‘.mustache’, respectively.
You can override <code>MustacheViewResolver</code> by providing a bean of the same name.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅以下部分：</p>
<p translation-origin="off">For more detail, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java"><code>WebMvcAutoConfiguration</code></a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java"><code>ThymeleafAutoConfiguration</code></a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/freemarker/FreeMarkerAutoConfiguration.java"><code>FreeMarkerAutoConfiguration</code></a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/groovy/template/GroovyTemplateAutoConfiguration.java"><code>GroovyTemplateAutoConfiguration</code></a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.jersey" translation-result="on"><a href="howto.html#howto.jersey"></a>5. 泽西岛</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.jersey"></a>5. Jersey</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="howto.jersey.spring-security" translation-result="on"><a href="howto.html#howto.jersey.spring-security"></a>5.1. 使用 Spring Security 保护 Jersey 端点</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.jersey.spring-security"></a>5.1. Secure Jersey endpoints with Spring Security</h3>
<div class="paragraph">
<p translation-result="on">Spring Security 可用于保护基于 Jersey 的 Web 应用程序，就像它可用于保护基于 Spring MVC 的 Web 应用程序一样。但是，如果你想在 Jersey 中使用 Spring Security 的方法级安全性，则必须将 Jersey 配置为使用 <code>setStatus(int)</code> 而不是 <code>sendError(int)</code> 。这可以防止 Jersey 在 Spring Security 有机会向客户端报告身份验证或授权失败之前提交响应。</p>
<p translation-origin="off">Spring Security can be used to secure a Jersey-based web application in much the same way as it can be used to secure a Spring MVC-based web application.
However, if you want to use Spring Security’s method-level security with Jersey, you must configure Jersey to use <code>setStatus(int)</code> rather <code>sendError(int)</code>.
This prevents Jersey from committing the response before Spring Security has had an opportunity to report an authentication or authorization failure to the client.</p>
</div>
<div class="paragraph">
<p translation-result="on"><code>jersey.config.server.response.setStatusOverSendError</code> 属性必须在应用程序的 <code>ResourceConfig</code> bean 上设置为 <code>true</code> ，如以下示例所示：</p>
<p translation-origin="off">The <code>jersey.config.server.response.setStatusOverSendError</code> property must be set to <code>true</code> on the application’s <code>ResourceConfig</code> bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.Collections;

import org.glassfish.jersey.server.ResourceConfig;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class JerseySetStatusOverSendErrorConfig extends ResourceConfig {

    public JerseySetStatusOverSendErrorConfig() {
        register(Endpoint.class);
        setProperties(Collections.singletonMap("jersey.config.server.response.setStatusOverSendError", true));
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.jersey.alongside-another-web-framework" translation-result="on"><a href="howto.html#howto.jersey.alongside-another-web-framework"></a>5.2. 将 Jersey 与另一个 Web 框架一起使用</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.jersey.alongside-another-web-framework"></a>5.2. Use Jersey Alongside Another Web Framework</h3>
<div class="paragraph">
<p translation-result="on">要将 Jersey 与另一个 Web 框架（例如 Spring MVC）一起使用，应将其配置为允许另一个框架处理它无法处理的请求。首先，通过将 <code>spring.jersey.type</code> 应用程序属性配置为 <code>filter</code> ，将 Jersey 配置为使用过滤器而不是 servlet。其次，将你的 <code>ResourceConfig</code> 配置为转发可能导致 404 的请求，如以下示例所示。</p>
<p translation-origin="off">To use Jersey alongside another web framework, such as Spring MVC, it should be configured so that it will allow the other framework to handle requests that it cannot handle.
First, configure Jersey to use a filter rather than a servlet by configuring the <code>spring.jersey.type</code> application property with a value of <code>filter</code>.
Second, configure your <code>ResourceConfig</code> to forward requests that would have resulted in a 404, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.glassfish.jersey.server.ResourceConfig;
import org.glassfish.jersey.servlet.ServletProperties;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class JerseyConfig extends ResourceConfig {

    public JerseyConfig() {
        register(Endpoint.class);
        property(ServletProperties.FILTER_FORWARD_ON_404, true);
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.http-clients" translation-result="on"><a href="howto.html#howto.http-clients"></a>6. HTTP 客户端</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.http-clients"></a>6. HTTP Clients</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 提供了许多与 HTTP 客户端一起使用的启动器。本节回答与使用它们相关的问题。</p>
<p translation-origin="off">Spring Boot offers a number of starters that work with HTTP clients.
This section answers questions related to using them.</p>
</div>
<div class="sect2">
<h3 id="howto.http-clients.rest-template-proxy-configuration" translation-result="on"><a href="howto.html#howto.http-clients.rest-template-proxy-configuration"></a>6.1. 配置 RestTemplate 以使用代理</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.http-clients.rest-template-proxy-configuration"></a>6.1. Configure RestTemplate to Use a Proxy</h3>
<div class="paragraph">
<p translation-result="on">如 <a href="io.html#io.rest-client.resttemplate.customization">io.html</a> 中所述，你可以将 <code>RestTemplateCustomizer</code> 与 <code>RestTemplateBuilder</code> 一起使用来构建自定义的 <code>RestTemplate</code> 。这是创建配置为使用代理的 <code>RestTemplate</code> 的推荐方法。</p>
<p translation-origin="off">As described in <a href="io.html#io.rest-client.resttemplate.customization">io.html</a>, you can use a <code>RestTemplateCustomizer</code> with <code>RestTemplateBuilder</code> to build a customized <code>RestTemplate</code>.
This is the recommended approach for creating a <code>RestTemplate</code> configured to use a proxy.</p>
</div>
<div class="paragraph">
<p translation-result="on">代理配置的确切细节取决于正在使用的底层客户端请求工厂。</p>
<p translation-origin="off">The exact details of the proxy configuration depend on the underlying client request factory that is being used.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.http-clients.webclient-reactor-netty-customization" translation-result="on"><a href="howto.html#howto.http-clients.webclient-reactor-netty-customization"></a>6.2. 配置基于 Reactor Netty 的 WebClient 使用的 TcpClient</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.http-clients.webclient-reactor-netty-customization"></a>6.2. Configure the TcpClient used by a Reactor Netty-based WebClient</h3>
<div class="paragraph">
<p translation-result="on">当 Reactor Netty 在类路径上时，会自动配置一个基于 Reactor Netty 的 <code>WebClient</code> 。要自定义客户端对网络连接的处理，请提供 <code>ClientHttpConnector</code> bean。以下示例配置了 60 秒的连接超时并添加了 <code>ReadTimeoutHandler</code> ：</p>
<p translation-origin="off">When Reactor Netty is on the classpath a Reactor Netty-based <code>WebClient</code> is auto-configured.
To customize the client’s handling of network connections, provide a <code>ClientHttpConnector</code> bean.
The following example configures a 60 second connect timeout and adds a <code>ReadTimeoutHandler</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.netty.channel.ChannelOption;
import io.netty.handler.timeout.ReadTimeoutHandler;
import reactor.netty.http.client.HttpClient;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.client.reactive.ClientHttpConnector;
import org.springframework.http.client.reactive.ReactorClientHttpConnector;
import org.springframework.http.client.reactive.ReactorResourceFactory;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyReactorNettyClientConfiguration {

    @Bean
    ClientHttpConnector clientHttpConnector(ReactorResourceFactory resourceFactory) {
        HttpClient httpClient = HttpClient.create(resourceFactory.getConnectionProvider())
                .runOn(resourceFactory.getLoopResources())
                .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, 60000)
                .doOnConnected((connection) -&gt; connection.addHandlerLast(new ReadTimeoutHandler(60)));
        return new ReactorClientHttpConnector(httpClient);
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">注意 <code>ReactorResourceFactory</code> 用于连接提供者和事件循环资源。这确保了接收请求的服务器和发出请求的客户端有效地共享资源。</p>
<p translation-origin="off">Note the use of <code>ReactorResourceFactory</code> for the connection provider and event loop resources.
This ensures efficient sharing of resources for the server receiving requests and the client making requests.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.logging" translation-result="on"><a href="howto.html#howto.logging"></a>7. 记录</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.logging"></a>7. Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 没有强制的日志依赖，除了 Commons Logging API，它通常由 Spring Framework 的 <code>spring-jcl</code> 模块提供。要使用 <a href="https://logback.qos.ch">Logback</a> ，你需要在类路径中包含它和 <code>spring-jcl</code> 。推荐的方法是通过启动器，它们都依赖于 <code>spring-boot-starter-logging</code> 。对于 Web 应用程序，你只需要 <code>spring-boot-starter-web</code> ，因为它传递地依赖于日志记录启动器。如果你使用 Maven，以下依赖项会为你添加日志记录：</p>
<p translation-origin="off">Spring Boot has no mandatory logging dependency, except for the Commons Logging API, which is typically provided by Spring Framework’s <code>spring-jcl</code> module.
To use <a href="https://logback.qos.ch">Logback</a>, you need to include it and <code>spring-jcl</code> on the classpath.
The recommended way to do that is through the starters, which all depend on <code>spring-boot-starter-logging</code>.
For a web application, you need only <code>spring-boot-starter-web</code>, since it depends transitively on the logging starter.
If you use Maven, the following dependency adds logging for you:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 有一个 <code>LoggingSystem</code> 抽象，它尝试根据类路径的内容配置日志记录。如果 Logback 可用，它是首选。</p>
<p translation-origin="off">Spring Boot has a <code>LoggingSystem</code> abstraction that attempts to configure logging based on the content of the classpath.
If Logback is available, it is the first choice.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果你需要对日志记录进行的唯一更改是设置各种记录器的级别，则可以在 <code>application.properties</code> 中使用“logging.level”前缀进行设置，如下例所示：</p>
<p translation-origin="off">If the only change you need to make to logging is to set the levels of various loggers, you can do so in <code>application.properties</code> by using the "logging.level" prefix, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logging.level.org.springframework.web=debug
logging.level.org.hibernate=error</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">logging:
  level:
    org.springframework.web: "debug"
    org.hibernate: "error"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">你还可以用 <code>logging.file.name</code> 设置要写入日志的文件的位置（除了控制台）。</p>
<p translation-origin="off">You can also set the location of a file to which to write the log (in addition to the console) by using <code>logging.file.name</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">要配置日志系统的更细粒度的设置，你需要使用相关 <code>LoggingSystem</code> 支持的本机配置格式。默认情况下，Spring Boot 从系统的默认位置获取本机配置（例如 Logback 的 <code>classpath:logback.xml</code> ），但你可以用 <code>logging.config</code> 属性设置配置文件的位置。</p>
<p translation-origin="off">To configure the more fine-grained settings of a logging system, you need to use the native configuration format supported by the <code>LoggingSystem</code> in question.
By default, Spring Boot picks up the native configuration from its default location for the system (such as <code>classpath:logback.xml</code> for Logback), but you can set the location of the config file by using the <code>logging.config</code> property.</p>
</div>
<div class="sect2">
<h3 id="howto.logging.logback" translation-result="on"><a href="howto.html#howto.logging.logback"></a>7.1. 为日志配置 Logback</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.logging.logback"></a>7.1. Configure Logback for Logging</h3>
<div class="paragraph">
<p translation-result="on">如果你需要对 logback 应用超出 <code>application.properties</code> 可以实现的自定义，你将需要添加一个标准的 logback 配置文件。你可以将 <code>logback.xml</code> 文件添加到类路径的根目录以供 logback 查找。如果你想使用 <a href="features.html#features.logging.logback-extensions">Spring Boot Logback 扩展</a>，你也可以用 <code>logback-spring.xml</code> 。</p>
<p translation-origin="off">If you need to apply customizations to logback beyond those that can be achieved with <code>application.properties</code>, you will need to add a standard logback configuration file.
You can add a <code>logback.xml</code> file to the root of your classpath for logback to find.
You can also use <code>logback-spring.xml</code> if you want to use the <a href="features.html#features.logging.logback-extensions">Spring Boot Logback extensions</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">Logback 文档有一个<a href="https://logback.qos.ch/manual/configuration.html">专门的部分详细介绍了配置</a>。</p>
<p translation-origin="off">The Logback documentation has a <a href="https://logback.qos.ch/manual/configuration.html">dedicated section that covers configuration</a> in some detail.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 提供了许多 logback 配置，这些配置 <code>included</code> 在你自己的配置中。这些包括旨在允许重新应用某些常见的 Spring Boot 约定。</p>
<p translation-origin="off">Spring Boot provides a number of logback configurations that be <code>included</code> from your own configuration.
These includes are designed to allow certain common Spring Boot conventions to be re-applied.</p>
</div>
<div class="paragraph">
<p translation-result="on"><code>org/springframework/boot/logging/logback/</code> 下提供了以下文件：</p>
<p translation-origin="off">The following files are provided under <code>org/springframework/boot/logging/logback/</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on"><code>defaults.xml</code> - 提供转换规则、模式属性和常用记录器配置。</p>
<p translation-origin="off"><code>defaults.xml</code> - Provides conversion rules, pattern properties and common logger configurations.</p>
</li>
<li>
<p translation-result="on"><code>console-appender.xml</code> - 使用 <code>CONSOLE_LOG_PATTERN</code> 添加一个 <code>ConsoleAppender</code> 。</p>
<p translation-origin="off"><code>console-appender.xml</code> - Adds a <code>ConsoleAppender</code> using the <code>CONSOLE_LOG_PATTERN</code>.</p>
</li>
<li>
<p translation-result="on"><code>file-appender.xml</code> - 使用具有适当设置的 <code>FILE_LOG_PATTERN</code> 和 <code>ROLLING_FILE_NAME_PATTERN</code> 添加 <code>RollingFileAppender</code> 。</p>
<p translation-origin="off"><code>file-appender.xml</code> - Adds a <code>RollingFileAppender</code> using the <code>FILE_LOG_PATTERN</code> and <code>ROLLING_FILE_NAME_PATTERN</code> with appropriate settings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">此外，还提供了一个遗留的 <code>base.xml</code> 文件以与早期版本的 Spring Boot 兼容。</p>
<p translation-origin="off">In addition, a legacy <code>base.xml</code> file is provided for compatibility with earlier versions of Spring Boot.</p>
</div>
<div class="paragraph">
<p translation-result="on">典型的自定义 <code>logback.xml</code> 文件如下所示：</p>
<p translation-origin="off">A typical custom <code>logback.xml</code> file would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;include resource="org/springframework/boot/logging/logback/defaults.xml"/&gt;
    &lt;include resource="org/springframework/boot/logging/logback/console-appender.xml" /&gt;
    &lt;root level="INFO"&gt;
        &lt;appender-ref ref="CONSOLE" /&gt;
    &lt;/root&gt;
    &lt;logger name="org.springframework.web" level="DEBUG"/&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">你的 logback 配置文件还可以用 <code>LoggingSystem</code> 为你创建的系统属性：</p>
<p translation-origin="off">Your logback configuration file can also make use of System properties that the <code>LoggingSystem</code> takes care of creating for you:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on"><code>${PID}</code> ：当前进程 ID。</p>
<p translation-origin="off"><code>${PID}</code>: The current process ID.</p>
</li>
<li>
<p translation-result="on"><code>${LOG_FILE}</code> ：是否在 Boot 的外部配置中设置了 <code>logging.file.name</code> 。</p>
<p translation-origin="off"><code>${LOG_FILE}</code>: Whether <code>logging.file.name</code> was set in Boot’s external configuration.</p>
</li>
<li>
<p translation-result="on"><code>${LOG_PATH}</code> ：是否在 Boot 的外部配置中设置了 <code>logging.file.path</code> （代表日志文件所在的目录）。</p>
<p translation-origin="off"><code>${LOG_PATH}</code>: Whether <code>logging.file.path</code> (representing a directory for log files to live in) was set in Boot’s external configuration.</p>
</li>
<li>
<p translation-result="on"><code>${LOG_EXCEPTION_CONVERSION_WORD}</code> ：是否在 Boot 的外部配置中设置了 <code>logging.exception-conversion-word</code> 。</p>
<p translation-origin="off"><code>${LOG_EXCEPTION_CONVERSION_WORD}</code>: Whether <code>logging.exception-conversion-word</code> was set in Boot’s external configuration.</p>
</li>
<li>
<p translation-result="on"><code>${ROLLING_FILE_NAME_PATTERN}</code> ：是否在 Boot 的外部配置中设置了 <code>logging.pattern.rolling-file-name</code> 。</p>
<p translation-origin="off"><code>${ROLLING_FILE_NAME_PATTERN}</code>: Whether <code>logging.pattern.rolling-file-name</code> was set in Boot’s external configuration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 还通过使用自定义 Logback 转换器在控制台（但不在日志文件中）提供了一些不错的 ANSI 颜色终端输出。有关示例，请参阅 <code>defaults.xml</code> 配置中的 <code>CONSOLE_LOG_PATTERN</code> 。</p>
<p translation-origin="off">Spring Boot also provides some nice ANSI color terminal output on a console (but not in a log file) by using a custom Logback converter.
See the <code>CONSOLE_LOG_PATTERN</code> in the <code>defaults.xml</code> configuration for an example.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果 Groovy 在类路径上，你应该也可以用 <code>logback.groovy</code> 配置 Logback。如果存在，则优先考虑此设置。</p>
<p translation-origin="off">If Groovy is on the classpath, you should be able to configure Logback with <code>logback.groovy</code> as well.
If present, this setting is given preference.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">Groovy 配置不支持 Spring 扩展。不会检测到任何 <code>logback-spring.groovy</code> 文件。</p>
<p translation-origin="off">Spring extensions are not supported with Groovy configuration.
Any <code>logback-spring.groovy</code> files will not be detected.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="howto.logging.logback.file-only-output" translation-result="on"><a href="howto.html#howto.logging.logback.file-only-output"></a>7.1.1. 为仅文件输出配置 Logback</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.logging.logback.file-only-output"></a>7.1.1. Configure Logback for File-only Output</h4>
<div class="paragraph">
<p translation-result="on">如果要禁用控制台日志记录并仅将输出写入文件，则需要一个自定义 <code>logback-spring.xml</code> 导入 <code>file-appender.xml</code> 但不导入 <code>console-appender.xml</code> ，如以下示例所示：</p>
<p translation-origin="off">If you want to disable console logging and write output only to a file, you need a custom <code>logback-spring.xml</code> that imports <code>file-appender.xml</code> but not <code>console-appender.xml</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;include resource="org/springframework/boot/logging/logback/defaults.xml" /&gt;
    &lt;property name="LOG_FILE" value="${LOG_FILE:-${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}/}spring.log}"/&gt;
    &lt;include resource="org/springframework/boot/logging/logback/file-appender.xml" /&gt;
    &lt;root level="INFO"&gt;
        &lt;appender-ref ref="FILE" /&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">你还需要将 <code>logging.file.name</code> 添加到你的 <code>application.properties</code> 或 <code>application.yaml</code> 中，如以下示例所示：</p>
<p translation-origin="off">You also need to add <code>logging.file.name</code> to your <code>application.properties</code> or <code>application.yaml</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logging.file.name=myapplication.log</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">logging:
  file:
    name: "myapplication.log"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.logging.log4j" translation-result="on"><a href="howto.html#howto.logging.log4j"></a>7.2. 为日志配置 Log4j</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.logging.log4j"></a>7.2. Configure Log4j for Logging</h3>
<div class="paragraph">
<p translation-result="on">如果 Spring Boot 在类路径上，则支持 <a href="https://logging.apache.org/log4j/2.x/">Log4j 2</a> 进行日志记录配置。如果你使用启动器来组装依赖项，则必须排除 Logback，然后改为包含 log4j 2。如果不使用启动器，除了 Log4j 2 之外，还需要（至少）提供 <code>spring-jcl</code> 。</p>
<p translation-origin="off">Spring Boot supports <a href="https://logging.apache.org/log4j/2.x/">Log4j 2</a> for logging configuration if it is on the classpath.
If you use the starters for assembling dependencies, you have to exclude Logback and then include log4j 2 instead.
If you do not use the starters, you need to provide (at least) <code>spring-jcl</code> in addition to Log4j 2.</p>
</div>
<div class="paragraph">
<p translation-result="on">推荐的路径是通过启动器，即使它需要一些摇晃。以下示例显示了如何在 Maven 中设置启动器：</p>
<p translation-origin="off">The recommended path is through the starters, even though it requires some jiggling.
The following example shows how to set up the starters in Maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-log4j2&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">Gradle 提供了几种不同的方法来设置启动器。一种方法是使用<a href="https://docs.gradle.org/current/userguide/resolution_rules.html#sec:module_replacement">模块更换</a>。为此，请声明对 Log4j 2 启动器的依赖，并告诉 Gradle 任何出现的默认日志记录启动器都应替换为 Log4j 2 启动器，如以下示例所示：</p>
<p translation-origin="off">Gradle provides a few different ways to set up the starters.
One way is to use a <a href="https://docs.gradle.org/current/userguide/resolution_rules.html#sec:module_replacement">module replacement</a>.
To do so, declare a dependency on the Log4j 2 starter and tell Gradle that any occurrences of the default logging starter should be replaced by the Log4j 2 starter, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">dependencies {
    implementation "org.springframework.boot:spring-boot-starter-log4j2"
    modules {
        module("org.springframework.boot:spring-boot-starter-logging") {
            replacedBy("org.springframework.boot:spring-boot-starter-log4j2", "Use Log4j2 instead of Logback")
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">Log4j 启动器收集常见日志记录要求的依赖项（例如让 Tomcat 使用 <code>java.util.logging</code> 但使用 Log4j 2 配置输出）。</p>
<p translation-origin="off">The Log4j starters gather together the dependencies for common logging requirements (such as having Tomcat use <code>java.util.logging</code> but configuring the output using Log4j 2).</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">要确保使用 <code>java.util.logging</code> 执行的调试日志记录被路由到 Log4j 2，请通过将 <code>java.util.logging.manager</code> 系统属性设置为 <code>org.apache.logging.log4j.jul.LogManager</code> 来配置其 <a href="https://logging.apache.org/log4j/2.x/log4j-jul/index.html">JDK 日志记录适配器</a>。</p>
<p translation-origin="off">To ensure that debug logging performed using <code>java.util.logging</code> is routed into Log4j 2, configure its <a href="https://logging.apache.org/log4j/2.x/log4j-jul/index.html">JDK logging adapter</a> by setting the <code>java.util.logging.manager</code> system property to <code>org.apache.logging.log4j.jul.LogManager</code>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="howto.logging.log4j.yaml-or-json-config" translation-result="on"><a href="howto.html#howto.logging.log4j.yaml-or-json-config"></a>7.2.1. 使用 YAML 或 JSON 配置 Log4j 2</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.logging.log4j.yaml-or-json-config"></a>7.2.1. Use YAML or JSON to Configure Log4j 2</h4>
<div class="paragraph">
<p translation-result="on">除了默认的 XML 配置格式，Log4j 2 还支持 YAML 和 JSON 配置文件。要将 Log4j 2 配置为使用替代配置文件格式，请将适当的依赖项添加到类路径并命名配置文件以匹配你选择的文件格式，如以下示例所示：</p>
<p translation-origin="off">In addition to its default XML configuration format, Log4j 2 also supports YAML and JSON configuration files.
To configure Log4j 2 to use an alternative configuration file format, add the appropriate dependencies to the classpath and name your configuration files to match your chosen file format, as shown in the following example:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 75%;">
<col style="width: 15%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">
  <p translation-result="on">格式</p>
  <p translation-origin="off">Format</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-result="on">依赖项</p>
  <p translation-origin="off">Dependencies</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-result="on">文件名</p>
  <p translation-origin="off">File names</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">YAML</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>com.fasterxml.jackson.core:jackson-databind</code> + <code>com.fasterxml.jackson.dataformat:jackson-dataformat-yaml</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>log4j2.yaml</code> + <code>log4j2.yml</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>com.fasterxml.jackson.core:jackson-databind</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>log4j2.json</code> + <code>log4j2.jsn</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="howto.logging.log4j.composite-configuration" translation-result="on"><a href="howto.html#howto.logging.log4j.composite-configuration"></a>7.2.2. 使用复合配置来配置 Log4j 2</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.logging.log4j.composite-configuration"></a>7.2.2. Use Composite Configuration to Configure Log4j 2</h4>
<div class="paragraph">
<p translation-result="on">Log4j 2 支持将多个配置文件组合成一个复合配置。要在 Spring Boot 中使用此支持，请使用一个或多个辅助配置文件的位置配置 <code>logging.log4j2.config.override</code> 。辅助配置文件将与主配置合并，无论主配置的源是 Spring Boot 的默认值、标准位置（如 <code>log4j.xml</code> 还是 <code>logging.config</code> 属性配置的位置）。</p>
<p translation-origin="off">Log4j 2 has support for combining multiple configuration files into a single composite configuration.
To use this support in Spring Boot, configure <code>logging.log4j2.config.override</code> with the locations of one or more secondary configuration files.
The secondary configuration files will be merged with the primary configuration, whether the primary’s source is Spring Boot’s defaults, a standard location such as <code>log4j.xml</code>, or the location configured by the <code>logging.config</code> property.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.data-access" translation-result="on"><a href="howto.html#howto.data-access"></a>8. 数据访问</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access"></a>8. Data Access</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 包含许多用于处理数据源的启动器。本节回答与此相关的问题。</p>
<p translation-origin="off">Spring Boot includes a number of starters for working with data sources.
This section answers questions related to doing so.</p>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-custom-datasource" translation-result="on"><a href="howto.html#howto.data-access.configure-custom-datasource"></a>8.1. 配置自定义数据源</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-custom-datasource"></a>8.1. Configure a Custom DataSource</h3>
<div class="paragraph">
<p translation-result="on">要配置你自己的 <code>DataSource</code> ，请在配置中定义该类型的 <code>@Bean</code> 。Spring Boot 在任何需要的地方重用你的 <code>DataSource</code> ，包括数据库初始化。如果你需要外部化一些设置，你可以将你的 <code>DataSource</code> 绑定到环境（请参阅“ <a href="features.html#features.external-config.typesafe-configuration-properties.third-party-configuration">features.html</a> ”）。</p>
<p translation-origin="off">To configure your own <code>DataSource</code>, define a <code>@Bean</code> of that type in your configuration.
Spring Boot reuses your <code>DataSource</code> anywhere one is required, including database initialization.
If you need to externalize some settings, you can bind your <code>DataSource</code> to the environment (see “<a href="features.html#features.external-config.typesafe-configuration-properties.third-party-configuration">features.html</a>”).</p>
</div>
<div class="paragraph">
<p translation-result="on">以下示例显示了如何在 bean 中定义数据源：</p>
<p translation-origin="off">The following example shows how to define a data source in a bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourceConfiguration {

    @Bean
    @ConfigurationProperties(prefix = "app.datasource")
    public SomeDataSource dataSource() {
        return new SomeDataSource();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">以下示例显示了如何通过设置属性来定义数据源：</p>
<p translation-origin="off">The following example shows how to define a data source by setting properties:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.url=jdbc:h2:mem:mydb
app.datasource.username=sa
app.datasource.pool-size=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    url: "jdbc:h2:mem:mydb"
    username: "sa"
    pool-size: 30</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">假设 <code>SomeDataSource</code> 具有 URL、用户名和池大小的常规 JavaBean 属性，这些设置会在 <code>DataSource</code> 可用于其他组件之前自动绑定。</p>
<p translation-origin="off">Assuming that <code>SomeDataSource</code> has regular JavaBean properties for the URL, the username, and the pool size, these settings are bound automatically before the <code>DataSource</code> is made available to other components.</p>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 还提供了一个名为 <code>DataSourceBuilder</code> 的实用程序构建器类，可用于创建标准数据源之一（如果它位于类路径上）。构建器可以根据类路径上可用的内容来检测要使用的内容。它还根据 JDBC URL 自动检测驱动程序。</p>
<p translation-origin="off">Spring Boot also provides a utility builder class, called <code>DataSourceBuilder</code>, that can be used to create one of the standard data sources (if it is on the classpath).
The builder can detect the one to use based on what is available on the classpath.
It also auto-detects the driver based on the JDBC URL.</p>
</div>
<div class="paragraph">
<p translation-result="on">以下示例显示了如何使用 <code>DataSourceBuilder</code> 创建数据源：</p>
<p translation-origin="off">The following example shows how to create a data source by using a <code>DataSourceBuilder</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.sql.DataSource;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourceConfiguration {

    @Bean
    @ConfigurationProperties("app.datasource")
    public DataSource dataSource() {
        return DataSourceBuilder.create().build();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">要使用该 <code>DataSource</code> 运行应用程序，你只需要连接信息即可。还可以提供特定于池的设置。检查将在运行时使用的实现以获取更多详细信息。</p>
<p translation-origin="off">To run an app with that <code>DataSource</code>, all you need is the connection information.
Pool-specific settings can also be provided.
Check the implementation that is going to be used at runtime for more details.</p>
</div>
<div class="paragraph">
<p translation-result="on">以下示例显示如何通过设置属性来定义 JDBC 数据源：</p>
<p translation-origin="off">The following example shows how to define a JDBC data source by setting properties:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.url=jdbc:mysql://localhost/test
app.datasource.username=dbuser
app.datasource.password=dbpass
app.datasource.pool-size=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    url: "jdbc:mysql://localhost/test"
    username: "dbuser"
    password: "dbpass"
    pool-size: 30</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">但是，有一个问题。因为未公开连接池的实际类型，所以不会在元数据中为你的自定义 <code>DataSource</code> 生成任何键，并且你的 IDE 中没有可用的完成（因为 <code>DataSource</code> 接口未公开任何属性）。此外，如果你碰巧在类路径中有 Hikari，则此基本设置不起作用，因为 Hikari 没有 <code>url</code> 属性（但有 <code>jdbcUrl</code> 属性）。在这种情况下，你必须按如下方式重写你的配置：</p>
<p translation-origin="off">However, there is a catch.
Because the actual type of the connection pool is not exposed, no keys are generated in the metadata for your custom <code>DataSource</code> and no completion is available in your IDE (because the <code>DataSource</code> interface exposes no properties).
Also, if you happen to have Hikari on the classpath, this basic setup does not work, because Hikari has no <code>url</code> property (but does have a <code>jdbcUrl</code> property).
In that case, you must rewrite your configuration as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.jdbc-url=jdbc:mysql://localhost/test
app.datasource.username=dbuser
app.datasource.password=dbpass
app.datasource.pool-size=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    jdbc-url: "jdbc:mysql://localhost/test"
    username: "dbuser"
    password: "dbpass"
    pool-size: 30</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">你可以通过强制连接池使用并返回专用实现而不是 <code>DataSource</code> 来解决此问题。你不能在运行时更改实现，但选项列表将是明确的。</p>
<p translation-origin="off">You can fix that by forcing the connection pool to use and return a dedicated implementation rather than <code>DataSource</code>.
You cannot change the implementation at runtime, but the list of options will be explicit.</p>
</div>
<div class="paragraph">
<p translation-result="on">以下示例显示了如何使用 <code>DataSourceBuilder</code> 创建 <code>HikariDataSource</code> ：</p>
<p translation-origin="off">The following example shows how create a <code>HikariDataSource</code> with <code>DataSourceBuilder</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.zaxxer.hikari.HikariDataSource;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourceConfiguration {

    @Bean
    @ConfigurationProperties("app.datasource")
    public HikariDataSource dataSource() {
        return DataSourceBuilder.create().type(HikariDataSource.class).build();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">你甚至可以利用 <code>DataSourceProperties</code> 为你做的事情走得更远——也就是说，如果没有提供 URL，则通过提供具有合理用户名和密码的默认嵌入式数据库。你可以轻松地从任何 <code>DataSourceProperties</code> 对象的状态初始化 <code>DataSourceBuilder</code> ，因此你还可以注入 Spring Boot 自动创建的 DataSource。但是，这会将你的配置拆分为两个命名空间： <code>app.datasource</code> 上的 <code>url</code> 、 <code>username</code> 、 <code>password</code> 、 <code>type</code> 和 <code>driver</code> ，以及自定义命名空间（ <code>spring.datasource</code> ）上的其余部分。为避免这种情况，你可以在自定义命名空间上重新定义自定义 <code>DataSourceProperties</code> ，如以下示例所示：</p>
<p translation-origin="off">You can even go further by leveraging what <code>DataSourceProperties</code> does for you — that is, by providing a default embedded database with a sensible username and password if no URL is provided.
You can easily initialize a <code>DataSourceBuilder</code> from the state of any <code>DataSourceProperties</code> object, so you could also inject the DataSource that Spring Boot creates automatically.
However, that would split your configuration into two namespaces: <code>url</code>, <code>username</code>, <code>password</code>, <code>type</code>, and <code>driver</code> on <code>spring.datasource</code> and the rest on your custom namespace (<code>app.datasource</code>).
To avoid that, you can redefine a custom <code>DataSourceProperties</code> on your custom namespace, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.zaxxer.hikari.HikariDataSource;

import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourceConfiguration {

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource")
    public DataSourceProperties dataSourceProperties() {
        return new DataSourceProperties();
    }

    @Bean
    @ConfigurationProperties("app.datasource.configuration")
    public HikariDataSource dataSource(DataSourceProperties properties) {
        return properties.initializeDataSourceBuilder().type(HikariDataSource.class).build();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">此设置使你与默认情况下 Spring Boot 为你所做<em>的同步</em>，除了选择专用连接池（在代码中）并且其设置在 <code>app.datasource.configuration</code> 子命名空间中公开。因为 <code>DataSourceProperties</code> 正在为你处理 <code>url</code> / <code>jdbcUrl</code> 翻译，你可以按如下方式配置它：</p>
<p translation-origin="off">This setup puts you <em>in sync</em> with what Spring Boot does for you by default, except that a dedicated connection pool is chosen (in code) and its settings are exposed in the <code>app.datasource.configuration</code> sub namespace.
Because <code>DataSourceProperties</code> is taking care of the <code>url</code>/<code>jdbcUrl</code> translation for you, you can configure it as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.url=jdbc:mysql://localhost/test
app.datasource.username=dbuser
app.datasource.password=dbpass
app.datasource.configuration.maximum-pool-size=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    url: "jdbc:mysql://localhost/test"
    username: "dbuser"
    password: "dbpass"
    configuration:
      maximum-pool-size: 30</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">Spring Boot 将向 <code>spring.datasource.hikari</code> 公开 Hikari 特定的设置。此示例使用更通用的 <code>configuration</code> 子命名空间，因为该示例不支持多个数据源实现。</p>
<p translation-origin="off">Spring Boot will expose Hikari-specific settings to <code>spring.datasource.hikari</code>.
This example uses a more generic <code>configuration</code> sub namespace as the example does not support multiple datasource implementations.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">因为你的自定义配置选择与 Hikari 一起使用，<code>app.datasource.type</code> 无效。在实践中，构建器会使用你可能在其中设置的任何值进行初始化，然后通过调用 <code>.type()</code> 来覆盖。</p>
<p translation-origin="off">Because your custom configuration chooses to go with Hikari, <code>app.datasource.type</code> has no effect.
In practice, the builder is initialized with whatever value you might set there and then overridden by the call to <code>.type()</code>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">有关详细信息，请参阅“Spring Boot 特性”部分中的“ <a href="data.html#data.sql.datasource">data.html</a> ”和<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jdbc/DataSourceAutoConfiguration.java"><code>DataSourceAutoConfiguration</code></a>类。</p>
<p translation-origin="off">See “<a href="data.html#data.sql.datasource">data.html</a>” in the “Spring Boot features” section and the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jdbc/DataSourceAutoConfiguration.java"><code>DataSourceAutoConfiguration</code></a> class for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-two-datasources" translation-result="on"><a href="howto.html#howto.data-access.configure-two-datasources"></a>8.2. 配置两个数据源</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-two-datasources"></a>8.2. Configure Two DataSources</h3>
<div class="paragraph">
<p translation-result="on">如果你需要配置多个数据源，你可以应用上一节中描述的相同技巧。但是，你必须将其中一个 <code>DataSource</code> 实例标记为 <code>@Primary</code> ，因为未来的各种自动配置都希望能够按类型获得一个。</p>
<p translation-origin="off">If you need to configure multiple data sources, you can apply the same tricks that are described in the previous section.
You must, however, mark one of the <code>DataSource</code> instances as <code>@Primary</code>, because various auto-configurations down the road expect to be able to get one by type.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果你创建自己的 <code>DataSource</code> ，则自动配置会退出。在以下示例中，我们提供了与自动配置在主数据源上提供的<em>完全相同的</em>功能集：</p>
<p translation-origin="off">If you create your own <code>DataSource</code>, the auto-configuration backs off.
In the following example, we provide the <em>exact</em> same feature set as the auto-configuration provides on the primary data source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.zaxxer.hikari.HikariDataSource;
import org.apache.commons.dbcp2.BasicDataSource;

import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourcesConfiguration {

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource.first")
    public DataSourceProperties firstDataSourceProperties() {
        return new DataSourceProperties();
    }

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource.first.configuration")
    public HikariDataSource firstDataSource(DataSourceProperties firstDataSourceProperties) {
        return firstDataSourceProperties.initializeDataSourceBuilder().type(HikariDataSource.class).build();
    }

    @Bean
    @ConfigurationProperties("app.datasource.second")
    public BasicDataSource secondDataSource() {
        return DataSourceBuilder.create().type(BasicDataSource.class).build();
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on"><code>firstDataSourceProperties</code> 必须标记为 <code>@Primary</code> 以便数据库初始化程序功能使用你的副本（如果你使用初始化程序）。</p>
<p translation-origin="off"><code>firstDataSourceProperties</code> has to be flagged as <code>@Primary</code> so that the database initializer feature uses your copy (if you use the initializer).</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">这两个数据源也都需要进行高级定制。例如，你可以按如下方式配置它们：</p>
<p translation-origin="off">Both data sources are also bound for advanced customizations.
For instance, you could configure them as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.first.url=jdbc:mysql://localhost/first
app.datasource.first.username=dbuser
app.datasource.first.password=dbpass
app.datasource.first.configuration.maximum-pool-size=30

app.datasource.second.url=jdbc:mysql://localhost/second
app.datasource.second.username=dbuser
app.datasource.second.password=dbpass
app.datasource.second.max-total=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    first:
      url: "jdbc:mysql://localhost/first"
      username: "dbuser"
      password: "dbpass"
      configuration:
        maximum-pool-size: 30

    second:
      url: "jdbc:mysql://localhost/second"
      username: "dbuser"
      password: "dbpass"
      max-total: 30</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">你也可以将相同的概念应用于辅助 <code>DataSource</code> ，如以下示例所示：</p>
<p translation-origin="off">You can apply the same concept to the secondary <code>DataSource</code> as well, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.zaxxer.hikari.HikariDataSource;
import org.apache.commons.dbcp2.BasicDataSource;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyCompleteDataSourcesConfiguration {

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource.first")
    public DataSourceProperties firstDataSourceProperties() {
        return new DataSourceProperties();
    }

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource.first.configuration")
    public HikariDataSource firstDataSource(DataSourceProperties firstDataSourceProperties) {
        return firstDataSourceProperties.initializeDataSourceBuilder().type(HikariDataSource.class).build();
    }

    @Bean
    @ConfigurationProperties("app.datasource.second")
    public DataSourceProperties secondDataSourceProperties() {
        return new DataSourceProperties();
    }

    @Bean
    @ConfigurationProperties("app.datasource.second.configuration")
    public BasicDataSource secondDataSource(
            @Qualifier("secondDataSourceProperties") DataSourceProperties secondDataSourceProperties) {
        return secondDataSourceProperties.initializeDataSourceBuilder().type(BasicDataSource.class).build();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">前面的示例在自定义命名空间上配置两个数据源，其逻辑与 Spring Boot 在自动配置中使用的逻辑相同。请注意，每个 <code>configuration</code> 子命名空间都提供基于所选实现的高级设置。</p>
<p translation-origin="off">The preceding example configures two data sources on custom namespaces with the same logic as Spring Boot would use in auto-configuration.
Note that each <code>configuration</code> sub namespace provides advanced settings based on the chosen implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.spring-data-repositories" translation-result="on"><a href="howto.html#howto.data-access.spring-data-repositories"></a>8.3. 使用 Spring 数据存储库</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.spring-data-repositories"></a>8.3. Use Spring Data Repositories</h3>
<div class="paragraph">
<p translation-result="on">Spring Data 可以创建各种风格的 <code>@Repository</code> 接口的实现。只要这些 <code>@Repositories</code> 包含在 <code>@EnableAutoConfiguration</code> 类的同一个包（或子包）中，Spring Boot 就会为你处理所有这些。</p>
<p translation-origin="off">Spring Data can create implementations of <code>@Repository</code> interfaces of various flavors.
Spring Boot handles all of that for you, as long as those <code>@Repositories</code> are included in the same package (or a sub-package) of your <code>@EnableAutoConfiguration</code> class.</p>
</div>
<div class="paragraph">
<p translation-result="on">对于许多应用程序，你只需将正确的 Spring Data 依赖项放在你的类路径中。有一个用于 JPA 的 <code>spring-boot-starter-data-jpa</code> ，用于 Mongodb <code>spring-boot-starter-data-mongodb</code> ，以及用于支持技术的各种其他启动器。首先，创建一些存储库接口来处理你的 <code>@Entity</code> 对象。</p>
<p translation-origin="off">For many applications, all you need is to put the right Spring Data dependencies on your classpath.
There is a <code>spring-boot-starter-data-jpa</code> for JPA, <code>spring-boot-starter-data-mongodb</code> for Mongodb, and various other starters for supported technologies.
To get started, create some repository interfaces to handle your <code>@Entity</code> objects.</p>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 尝试根据找到的 <code>@EnableAutoConfiguration</code> 来猜测你的 <code>@Repository</code> 定义的位置。要获得更多控制，请使用 <code>@EnableJpaRepositories</code> 注解（来自 Spring Data JPA）。</p>
<p translation-origin="off">Spring Boot tries to guess the location of your <code>@Repository</code> definitions, based on the <code>@EnableAutoConfiguration</code> it finds.
To get more control, use the <code>@EnableJpaRepositories</code> annotation (from Spring Data JPA).</p>
</div>
<div class="paragraph">
<p translation-result="on">有关 Spring Data 的更多信息，请参阅 <a href="https://spring.io/projects/spring-data">Spring Data 项目页面</a>。</p>
<p translation-origin="off">For more about Spring Data, see the <a href="https://spring.io/projects/spring-data">Spring Data project page</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.separate-entity-definitions-from-spring-configuration" translation-result="on"><a href="howto.html#howto.data-access.separate-entity-definitions-from-spring-configuration"></a> 8.4.将 @Entity 定义与 Spring 配置分开</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.separate-entity-definitions-from-spring-configuration"></a>8.4. Separate @Entity Definitions from Spring Configuration</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 尝试根据它找到的 <code>@EnableAutoConfiguration</code> 来猜测你的 <code>@Entity</code> 定义的位置。要获得更多控制，你可以用 <code>@EntityScan</code> 注解，如下例所示：</p>
<p translation-origin="off">Spring Boot tries to guess the location of your <code>@Entity</code> definitions, based on the <code>@EnableAutoConfiguration</code> it finds.
To get more control, you can use the <code>@EntityScan</code> annotation, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.domain.EntityScan;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableAutoConfiguration
@EntityScan(basePackageClasses = City.class)
public class MyApplication {

    // ...

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.jpa-properties" translation-result="on"><a href="howto.html#howto.data-access.jpa-properties"></a>8.5. 配置 JPA 属性</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.jpa-properties"></a>8.5. Configure JPA Properties</h3>
<div class="paragraph">
<p translation-result="on">Spring Data JPA 已经提供了一些与供应商无关的配置选项（例如那些用于 SQL 日志记录的配置选项），并且 Spring Boot 公开了这些选项以及 Hibernate 的更多选项作为外部配置属性。其中一些是根据上下文自动检测的，因此你不必设置它们。</p>
<p translation-origin="off">Spring Data JPA already provides some vendor-independent configuration options (such as those for SQL logging), and Spring Boot exposes those options and a few more for Hibernate as external configuration properties.
Some of them are automatically detected according to the context so you should not have to set them.</p>
</div>
<div class="paragraph">
<p translation-result="on"><code>spring.jpa.hibernate.ddl-auto</code> 是一种特殊情况，因为根据运行时条件，它具有不同的默认值。如果使用嵌入式数据库并且没有模式管理器（例如 Liquibase 或 Flyway）正在处理 <code>DataSource</code> ，则默认为 <code>create-drop</code> 。在所有其他情况下，它默认为 <code>none</code> 。</p>
<p translation-origin="off">The <code>spring.jpa.hibernate.ddl-auto</code> is a special case, because, depending on runtime conditions, it has different defaults.
If an embedded database is used and no schema manager (such as Liquibase or Flyway) is handling the <code>DataSource</code>, it defaults to <code>create-drop</code>.
In all other cases, it defaults to <code>none</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">JPA 提供程序检测到要使用的方言。如果你更喜欢自己设置方言，请设置 <code>spring.jpa.database-platform</code> 属性。</p>
<p translation-origin="off">The dialect to use is detected by the JPA provider.
If you prefer to set the dialect yourself, set the <code>spring.jpa.database-platform</code> property.</p>
</div>
<div class="paragraph">
<p translation-result="on">最常见的设置选项如下例所示：</p>
<p translation-origin="off">The most common options to set are shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jpa.hibernate.naming.physical-strategy=com.example.MyPhysicalNamingStrategy
spring.jpa.show-sql=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  jpa:
    hibernate:
      naming:
        physical-strategy: "com.example.MyPhysicalNamingStrategy"
    show-sql: true</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">此外，当创建本地 <code>EntityManagerFactory</code> 时，<code>spring.jpa.properties.*</code> 中的所有属性都作为普通 JPA 属性（去除前缀）传递。</p>
<p translation-origin="off">In addition, all properties in <code>spring.jpa.properties.*</code> are passed through as normal JPA properties (with the prefix stripped) when the local <code>EntityManagerFactory</code> is created.</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-result="on">你需要确保 <code>spring.jpa.properties.*</code> 下定义的名称与你的 JPA 提供者所期望的名称完全匹配。Spring Boot 不会尝试对这些条目进行任何类型的宽松绑定。</p>
<p translation-origin="off">You need to ensure that names defined under <code>spring.jpa.properties.*</code> exactly match those expected by your JPA provider.
Spring Boot will not attempt any kind of relaxed binding for these entries.</p>
</div>
<div class="paragraph">
<p translation-result="on">例如，如果要配置 Hibernate 的批量大小，则必须使用 <code>spring.jpa.properties.hibernate.jdbc.batch_size</code> 。如果你使用其他形式，例如 <code>batchSize</code> 或 <code>batch-size</code> ，Hibernate 将不会应用该设置。</p>
<p translation-origin="off">For example, if you want to configure Hibernate’s batch size you must use <code>spring.jpa.properties.hibernate.jdbc.batch_size</code>.
If you use other forms, such as <code>batchSize</code> or <code>batch-size</code>, Hibernate will not apply the setting.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">如果你需要对 Hibernate 属性应用高级定制，请考虑注册将在创建 <code>EntityManagerFactory</code> 之前调用的 <code>HibernatePropertiesCustomizer</code> bean。这优先于自动配置应用的任何内容。</p>
<p translation-origin="off">If you need to apply advanced customization to Hibernate properties, consider registering a <code>HibernatePropertiesCustomizer</code> bean that will be invoked prior to creating the <code>EntityManagerFactory</code>.
This takes precedence to anything that is applied by the auto-configuration.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-hibernate-naming-strategy" translation-result="on"><a href="howto.html#howto.data-access.configure-hibernate-naming-strategy"></a>8.6. 配置休眠命名策略</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-hibernate-naming-strategy"></a>8.6. Configure Hibernate Naming Strategy</h3>
<div class="paragraph">
<p translation-result="on">Hibernate 使用<a href="https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#naming">两种不同的命名策略</a>将名称从对象模型映射到相应的数据库名称。物理和隐式策略实现的完全限定类名可以通过分别设置 <code>spring.jpa.hibernate.naming.physical-strategy</code> 和 <code>spring.jpa.hibernate.naming.implicit-strategy</code> 属性来配置。或者，如果 <code>ImplicitNamingStrategy</code> 或 <code>PhysicalNamingStrategy</code> bean 在应用程序上下文中可用，Hibernate 将自动配置为使用它们。</p>
<p translation-origin="off">Hibernate uses <a href="https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#naming">two different naming strategies</a> to map names from the object model to the corresponding database names.
The fully qualified class name of the physical and the implicit strategy implementations can be configured by setting the <code>spring.jpa.hibernate.naming.physical-strategy</code> and <code>spring.jpa.hibernate.naming.implicit-strategy</code> properties, respectively.
Alternatively, if <code>ImplicitNamingStrategy</code> or <code>PhysicalNamingStrategy</code> beans are available in the application context, Hibernate will be automatically configured to use them.</p>
</div>
<div class="paragraph">
<p translation-result="on">默认情况下，Spring Boot 使用 <code>SpringPhysicalNamingStrategy</code> 配置物理命名策略。此实现提供与 Hibernate 4 相同的表结构：所有点都被下划线替换，驼峰式大小写也被下划线替换。此外，默认情况下，所有表名都以小写形式生成。例如，<code>TelephoneNumber</code> 实体映射到 <code>telephone_number</code> 表。如果你的架构需要混合大小写的标识符，请定义一个自定义 <code>SpringPhysicalNamingStrategy</code> bean，如以下示例所示：</p>
<p translation-origin="off">By default, Spring Boot configures the physical naming strategy with <code>SpringPhysicalNamingStrategy</code>.
This implementation provides the same table structure as Hibernate 4: all dots are replaced by underscores and camel casing is replaced by underscores as well. Additionally, by default, all table names are generated in lower case. For example, a <code>TelephoneNumber</code> entity is mapped to the <code>telephone_number</code> table. If your schema requires mixed-case identifiers, define a custom <code>SpringPhysicalNamingStrategy</code> bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy;
import org.hibernate.engine.jdbc.env.spi.JdbcEnvironment;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyHibernateConfiguration {

    @Bean
    public CamelCaseToUnderscoresNamingStrategy caseSensitivePhysicalNamingStrategy() {
        return new CamelCaseToUnderscoresNamingStrategy() {

            @Override
            protected boolean isCaseInsensitive(JdbcEnvironment jdbcEnvironment) {
                return false;
            }

        };
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">如果你更喜欢使用 Hibernate 5 的默认值，请设置以下属性：</p>
<p translation-origin="off">If you prefer to use Hibernate 5’s default instead, set the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">或者，你可以配置以下 bean：</p>
<p translation-origin="off">Alternatively, you can configure the following bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyHibernateConfiguration {

    @Bean
    PhysicalNamingStrategyStandardImpl caseSensitivePhysicalNamingStrategy() {
        return new PhysicalNamingStrategyStandardImpl();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaAutoConfiguration.java"><code>HibernateJpaAutoConfiguration</code></a>和<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java"><code>JpaBaseConfiguration</code></a> 。</p>
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaAutoConfiguration.java"><code>HibernateJpaAutoConfiguration</code></a> and <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java"><code>JpaBaseConfiguration</code></a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-hibernate-second-level-caching" translation-result="on"><a href="howto.html#howto.data-access.configure-hibernate-second-level-caching"></a>8.7. 配置 Hibernate 二级缓存</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-hibernate-second-level-caching"></a>8.7. Configure Hibernate Second-Level Caching</h3>
<div class="paragraph">
<p translation-result="on">可以为一系列缓存提供程序配置 Hibernate <a href="https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#caching">二级</a>缓存。与其将 Hibernate 配置为再次查找缓存提供程序，不如尽可能提供在上下文中可用的提供程序。</p>
<p translation-origin="off">Hibernate <a href="https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#caching">second-level cache</a> can be configured for a range of cache providers.
Rather than configuring Hibernate to lookup the cache provider again, it is better to provide the one that is available in the context whenever possible.</p>
</div>
<div class="paragraph">
<p translation-result="on">要使用 JCache 执行此操作，首先确保 <code>org.hibernate:hibernate-jcache</code> 在类路径中可用。然后，添加一个 <code>HibernatePropertiesCustomizer</code> bean，如以下示例所示：</p>
<p translation-origin="off">To do this with JCache, first make sure that <code>org.hibernate:hibernate-jcache</code> is available on the classpath.
Then, add a <code>HibernatePropertiesCustomizer</code> bean as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.hibernate.cache.jcache.ConfigSettings;

import org.springframework.boot.autoconfigure.orm.jpa.HibernatePropertiesCustomizer;
import org.springframework.cache.jcache.JCacheCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyHibernateSecondLevelCacheConfiguration {

    @Bean
    public HibernatePropertiesCustomizer hibernateSecondLevelCacheCustomizer(JCacheCacheManager cacheManager) {
        return (properties) -&gt; properties.put(ConfigSettings.CACHE_MANAGER, cacheManager.getCacheManager());
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">这个定制器会将 Hibernate 配置为使用与应用程序使用的相同的 <code>CacheManager</code> 。也可以用单独的 <code>CacheManager</code> 实例。有关详细信息，请参阅 <a href="https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#caching-provider-jcache">Hibernate 用户指南</a>。</p>
<p translation-origin="off">This customizer will configure Hibernate to use the same <code>CacheManager</code> as the one that the application uses.
It is also possible to use separate <code>CacheManager</code> instances.
For details, see <a href="https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#caching-provider-jcache">the Hibernate user guide</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.dependency-injection-in-hibernate-components" translation-result="on"><a href="howto.html#howto.data-access.dependency-injection-in-hibernate-components"></a>8.8. 在 Hibernate 组件中使用依赖注入</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.dependency-injection-in-hibernate-components"></a>8.8. Use Dependency Injection in Hibernate Components</h3>
<div class="paragraph">
<p translation-result="on">默认情况下，Spring Boot 注册一个使用 <code>BeanFactory</code> 的 <code>BeanContainer</code> 实现，以便转换器和实体侦听器可以用常规依赖注入。</p>
<p translation-origin="off">By default, Spring Boot registers a <code>BeanContainer</code> implementation that uses the <code>BeanFactory</code> so that converters and entity listeners can use regular dependency injection.</p>
</div>
<div class="paragraph">
<p translation-result="on">你可以通过注册删除或更改 <code>hibernate.resource.beans.container</code> 属性的 <code>HibernatePropertiesCustomizer</code> 来禁用或调整此行为。</p>
<p translation-origin="off">You can disable or tune this behavior by registering a <code>HibernatePropertiesCustomizer</code> that removes or changes the <code>hibernate.resource.beans.container</code> property.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.use-custom-entity-manager" translation-result="on"><a href="howto.html#howto.data-access.use-custom-entity-manager"></a>8.9. 使用自定义 EntityManagerFactory</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.use-custom-entity-manager"></a>8.9. Use a Custom EntityManagerFactory</h3>
<div class="paragraph">
<p translation-result="on">要完全控制 <code>EntityManagerFactory</code> 的配置，你需要添加一个名为“entityManagerFactory”的 <code>@Bean</code> 。Spring Boot 自动配置在存在该类型的 bean 时关闭其实体管理器。</p>
<p translation-origin="off">To take full control of the configuration of the <code>EntityManagerFactory</code>, you need to add a <code>@Bean</code> named ‘entityManagerFactory’.
Spring Boot auto-configuration switches off its entity manager in the presence of a bean of that type.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.use-multiple-entity-managers" translation-result="on"><a href="howto.html#howto.data-access.use-multiple-entity-managers"></a>8.10. 使用多个 EntityManagerFactories</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.use-multiple-entity-managers"></a>8.10. Using Multiple EntityManagerFactories</h3>
<div class="paragraph">
<p translation-result="on">如果你需要对多个数据源使用 JPA，则每个数据源可能需要一个 <code>EntityManagerFactory</code> 。Spring ORM 中的 <code>LocalContainerEntityManagerFactoryBean</code> 允许你根据需要配置 <code>EntityManagerFactory</code> 。你还可以重用 <code>JpaProperties</code> 为每个 <code>EntityManagerFactory</code> 绑定设置，如下例所示：</p>
<p translation-origin="off">If you need to use JPA against multiple data sources, you likely need one <code>EntityManagerFactory</code> per data source.
The <code>LocalContainerEntityManagerFactoryBean</code> from Spring ORM allows you to configure an <code>EntityManagerFactory</code> for your needs.
You can also reuse <code>JpaProperties</code> to bind settings for each <code>EntityManagerFactory</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.sql.DataSource;

import org.springframework.boot.autoconfigure.orm.jpa.JpaProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.orm.jpa.JpaVendorAdapter;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyEntityManagerFactoryConfiguration {

    @Bean
    @ConfigurationProperties("app.jpa.first")
    public JpaProperties firstJpaProperties() {
        return new JpaProperties();
    }

    @Bean
    public LocalContainerEntityManagerFactoryBean firstEntityManagerFactory(DataSource firstDataSource,
            JpaProperties firstJpaProperties) {
        EntityManagerFactoryBuilder builder = createEntityManagerFactoryBuilder(firstJpaProperties);
        return builder.dataSource(firstDataSource).packages(Order.class).persistenceUnit("firstDs").build();
    }

    private EntityManagerFactoryBuilder createEntityManagerFactoryBuilder(JpaProperties jpaProperties) {
        JpaVendorAdapter jpaVendorAdapter = createJpaVendorAdapter(jpaProperties);
        return new EntityManagerFactoryBuilder(jpaVendorAdapter, jpaProperties.getProperties(), null);
    }

    private JpaVendorAdapter createJpaVendorAdapter(JpaProperties jpaProperties) {
        // ... map JPA properties as needed
        return new HibernateJpaVendorAdapter();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">上面的示例使用名为 <code>firstDataSource</code> 的 <code>DataSource</code> bean 创建了一个 <code>EntityManagerFactory</code> 。它扫描与 <code>Order</code> 位于同一包中的实体。可以用 <code>app.first.jpa</code> 命名空间映射其他 JPA 属性。</p>
<p translation-origin="off">The example above creates an <code>EntityManagerFactory</code> using a <code>DataSource</code> bean named <code>firstDataSource</code>.
It scans entities located in the same package as <code>Order</code>.
It is possible to map additional JPA properties using the <code>app.first.jpa</code> namespace.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">当你自己为 <code>LocalContainerEntityManagerFactoryBean</code> 创建 bean 时，在创建自动配置的 <code>LocalContainerEntityManagerFactoryBean</code> 期间应用的任何自定义都将丢失。例如，在 Hibernate 的情况下，<code>spring.jpa.hibernate</code> 前缀下的任何属性都不会自动应用于你的 <code>LocalContainerEntityManagerFactoryBean</code> 。如果你依赖这些属性来配置命名策略或 DDL 模式等内容，则需要在创建 <code>LocalContainerEntityManagerFactoryBean</code> bean 时显式配置它们。</p>
<p translation-origin="off">When you create a bean for <code>LocalContainerEntityManagerFactoryBean</code> yourself, any customization that was applied during the creation of the auto-configured <code>LocalContainerEntityManagerFactoryBean</code> is lost.
For example, in case of Hibernate, any properties under the <code>spring.jpa.hibernate</code> prefix will not be automatically applied to your <code>LocalContainerEntityManagerFactoryBean</code>.
If you were relying on these properties for configuring things like the naming strategy or the DDL mode, you will need to explicitly configure that when creating the <code>LocalContainerEntityManagerFactoryBean</code> bean.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">你应该为需要 JPA 访问权限的任何其他数据源提供类似的配置。为了完成这幅图，你还需要为每个 <code>EntityManagerFactory</code> 配置一个 <code>JpaTransactionManager</code> 。或者，你可以用跨越两者的 JTA 事务管理器。</p>
<p translation-origin="off">You should provide a similar configuration for any additional data sources for which you need JPA access.
To complete the picture, you need to configure a <code>JpaTransactionManager</code> for each <code>EntityManagerFactory</code> as well.
Alternatively, you might be able to use a JTA transaction manager that spans both.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果使用 Spring Data，则需要相应地配置 <code>@EnableJpaRepositories</code> ，如下例所示：</p>
<p translation-origin="off">If you use Spring Data, you need to configure <code>@EnableJpaRepositories</code> accordingly, as shown in the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableJpaRepositories(basePackageClasses = Order.class, entityManagerFactoryRef = "firstEntityManagerFactory")
public class OrderConfiguration {

}
</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableJpaRepositories(basePackageClasses = Customer.class, entityManagerFactoryRef = "secondEntityManagerFactory")
public class CustomerConfiguration {

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.use-traditional-persistence-xml" translation-result="on"><a href="howto.html#howto.data-access.use-traditional-persistence-xml"></a>8.11. 使用传统的 persistence.xml 文件</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.use-traditional-persistence-xml"></a>8.11. Use a Traditional persistence.xml File</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 默认不会搜索或使用 <code>META-INF/persistence.xml</code> 。如果你更喜欢使用传统的 <code>persistence.xml</code> ，你需要定义自己的 <code>@Bean</code> 类型的 <code>LocalEntityManagerFactoryBean</code> （ID 为“entityManagerFactory”）并在那里设置持久性单元名称。</p>
<p translation-origin="off">Spring Boot will not search for or use a <code>META-INF/persistence.xml</code> by default.
If you prefer to use a traditional <code>persistence.xml</code>, you need to define your own <code>@Bean</code> of type <code>LocalEntityManagerFactoryBean</code> (with an ID of ‘entityManagerFactory’) and set the persistence unit name there.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关默认设置，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java"><code>JpaBaseConfiguration</code></a> 。</p>
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java"><code>JpaBaseConfiguration</code></a> for the default settings.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.use-spring-data-jpa-and-mongo-repositories" translation-result="on"><a href="howto.html#howto.data-access.use-spring-data-jpa-and-mongo-repositories"></a>8.12. 使用 Spring Data JPA 和 Mongo 存储库</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.use-spring-data-jpa-and-mongo-repositories"></a>8.12. Use Spring Data JPA and Mongo Repositories</h3>
<div class="paragraph">
<p translation-result="on">Spring Data JPA 和 Spring Data Mongo 都可以自动为你创建 <code>Repository</code> 实现。如果它们都存在于类路径中，你可能需要做一些额外的配置来告诉 Spring Boot 要创建哪些存储库。最明确的方法是使用标准 Spring Data <code>@EnableJpaRepositories</code> 和 <code>@EnableMongoRepositories</code> 注解并提供 <code>Repository</code> 接口的位置。</p>
<p translation-origin="off">Spring Data JPA and Spring Data Mongo can both automatically create <code>Repository</code> implementations for you.
If they are both present on the classpath, you might have to do some extra configuration to tell Spring Boot which repositories to create.
The most explicit way to do that is to use the standard Spring Data <code>@EnableJpaRepositories</code> and <code>@EnableMongoRepositories</code> annotations and provide the location of your <code>Repository</code> interfaces.</p>
</div>
<div class="paragraph">
<p translation-result="on">还有一些标志（ <code>spring.data.*.repositories.enabled</code> 和 <code>spring.data.*.repositories.type</code> ）可用于在外部配置中打开和关闭自动配置的存储库。这样做很有用，例如，如果你想关闭 Mongo 存储库并仍然使用自动配置的 <code>MongoTemplate</code> 。</p>
<p translation-origin="off">There are also flags (<code>spring.data.*.repositories.enabled</code> and <code>spring.data.*.repositories.type</code>) that you can use to switch the auto-configured repositories on and off in external configuration.
Doing so is useful, for instance, in case you want to switch off the Mongo repositories and still use the auto-configured <code>MongoTemplate</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">其他自动配置的 Spring Data 存储库类型（Elasticsearch、Solr 等）存在相同的障碍和相同的功能。要使用它们，请相应地更改注解和标志的名称。</p>
<p translation-origin="off">The same obstacle and the same features exist for other auto-configured Spring Data repository types (Elasticsearch, Solr, and others).
To work with them, change the names of the annotations and flags accordingly.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.customize-spring-data-web-support" translation-result="on"><a href="howto.html#howto.data-access.customize-spring-data-web-support"></a>8.13. 自定义 Spring Data 的 Web 支持</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.customize-spring-data-web-support"></a>8.13. Customize Spring Data’s Web Support</h3>
<div class="paragraph">
<p translation-result="on">Spring Data 提供 Web 支持，简化了在 Web 应用程序中使用 Spring Data 存储库。Spring Boot 在 <code>spring.data.web</code> 命名空间中提供了用于自定义其配置的属性。请注意，如果你使用 Spring Data REST，则必须改用 <code>spring.data.rest</code> 命名空间中的属性。</p>
<p translation-origin="off">Spring Data provides web support that simplifies the use of Spring Data repositories in a web application.
Spring Boot provides properties in the <code>spring.data.web</code> namespace for customizing its configuration.
Note that if you are using Spring Data REST, you must use the properties in the <code>spring.data.rest</code> namespace instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.exposing-spring-data-repositories-as-rest" translation-result="on"><a href="howto.html#howto.data-access.exposing-spring-data-repositories-as-rest"></a>8.14. 将 Spring 数据存储库公开为 REST 端点</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.exposing-spring-data-repositories-as-rest"></a>8.14. Expose Spring Data Repositories as REST Endpoint</h3>
<div class="paragraph">
<p translation-result="on">Spring Data REST 可以为你将 <code>Repository</code> 实现公开为 REST 端点，前提是已为应用程序启用了 Spring MVC。</p>
<p translation-origin="off">Spring Data REST can expose the <code>Repository</code> implementations as REST endpoints for you,
provided Spring MVC has been enabled for the application.</p>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 公开了一组有用的属性（来自 <code>spring.data.rest</code> 命名空间），用于自定义<a href="https://docs.spring.io/spring-data/rest/docs/3.6.1/api/org/springframework/data/rest/core/config/RepositoryRestConfiguration.html"><code>RepositoryRestConfiguration</code></a> 。如果你需要提供额外的定制，你应该使用<a href="https://docs.spring.io/spring-data/rest/docs/3.6.1/api/org/springframework/data/rest/webmvc/config/RepositoryRestConfigurer.html"><code>RepositoryRestConfigurer</code></a> bean。</p>
<p translation-origin="off">Spring Boot exposes a set of useful properties (from the <code>spring.data.rest</code> namespace) that customize the <a href="https://docs.spring.io/spring-data/rest/docs/3.6.1/api/org/springframework/data/rest/core/config/RepositoryRestConfiguration.html"><code>RepositoryRestConfiguration</code></a>.
If you need to provide additional customization, you should use a <a href="https://docs.spring.io/spring-data/rest/docs/3.6.1/api/org/springframework/data/rest/webmvc/config/RepositoryRestConfigurer.html"><code>RepositoryRestConfigurer</code></a> bean.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">如果你没有在自定义 <code>RepositoryRestConfigurer</code> 上指定任何顺序，它将在 Spring Boot 内部使用的一个之后运行。如果你需要指定订单，请确保它高于 0。</p>
<p translation-origin="off">If you do not specify any order on your custom <code>RepositoryRestConfigurer</code>, it runs after the one Spring Boot uses internally.
If you need to specify an order, make sure it is higher than 0.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-a-component-that-is-used-by-jpa" translation-result="on"><a href="howto.html#howto.data-access.configure-a-component-that-is-used-by-jpa"></a>8.15. 配置 JPA 使用的组件</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-a-component-that-is-used-by-jpa"></a>8.15. Configure a Component that is Used by JPA</h3>
<div class="paragraph">
<p translation-result="on">如果要配置 JPA 使用的组件，则需要确保组件在 JPA 之前初始化。当组件自动配置时，Spring Boot 会为你处理这些。例如，当 Flyway 被自动配置时，Hibernate 被配置为依赖于 Flyway，这样 Flyway 就有机会在 Hibernate 尝试使用它之前初始化数据库。</p>
<p translation-origin="off">If you want to configure a component that JPA uses, then you need to ensure that the component is initialized before JPA.
When the component is auto-configured, Spring Boot takes care of this for you.
For example, when Flyway is auto-configured, Hibernate is configured to depend upon Flyway so that Flyway has a chance to initialize the database before Hibernate tries to use it.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果你自己配置组件，则可以用 <code>EntityManagerFactoryDependsOnPostProcessor</code> 子类作为设置必要依赖项的便捷方式。例如，如果你使用 Hibernate Search 并将 Elasticsearch 作为其索引管理器，则必须将任何 <code>EntityManagerFactory</code> bean 配置为依赖于 <code>elasticsearchClient</code> bean，如下例所示：</p>
<p translation-origin="off">If you are configuring a component yourself, you can use an <code>EntityManagerFactoryDependsOnPostProcessor</code> subclass as a convenient way of setting up the necessary dependencies.
For example, if you use Hibernate Search with Elasticsearch as its index manager, any <code>EntityManagerFactory</code> beans must be configured to depend on the <code>elasticsearchClient</code> bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.persistence.EntityManagerFactory;

import org.springframework.boot.autoconfigure.orm.jpa.EntityManagerFactoryDependsOnPostProcessor;
import org.springframework.stereotype.Component;

</span><span class="fold-block">/**
 * {@link EntityManagerFactoryDependsOnPostProcessor} that ensures that
 * {@link EntityManagerFactory} beans depend on the {@code elasticsearchClient} bean.
 */
@Component
public class ElasticsearchEntityManagerFactoryDependsOnPostProcessor
        extends EntityManagerFactoryDependsOnPostProcessor {

    public ElasticsearchEntityManagerFactoryDependsOnPostProcessor() {
        super("elasticsearchClient");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-jooq-with-multiple-datasources" translation-result="on"><a href="howto.html#howto.data-access.configure-jooq-with-multiple-datasources"></a>8.16. 使用两个数据源配置 jOOQ</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-jooq-with-multiple-datasources"></a>8.16. Configure jOOQ with Two DataSources</h3>
<div class="paragraph">
<p translation-result="on">如果你需要将 jOOQ 与多个数据源一起使用，你应该为每个数据源创建自己的 <code>DSLContext</code> 。有关更多详细信息，请参阅 <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jooq/JooqAutoConfiguration.java">JooqAutoConfiguration</a> 。</p>
<p translation-origin="off">If you need to use jOOQ with multiple data sources, you should create your own <code>DSLContext</code> for each one.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jooq/JooqAutoConfiguration.java">JooqAutoConfiguration</a> for more details.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">特别是，可以重用 <code>JooqExceptionTranslator</code> 和 <code>SpringTransactionProvider</code> 以提供与自动配置对单个 <code>DataSource</code> 所做的类似的功能。</p>
<p translation-origin="off">In particular, <code>JooqExceptionTranslator</code> and <code>SpringTransactionProvider</code> can be reused to provide similar features to what the auto-configuration does with a single <code>DataSource</code>.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.data-initialization" translation-result="on"><a href="howto.html#howto.data-initialization"></a>9. 数据库初始化</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization"></a>9. Database Initialization</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">可以根据堆栈的不同以不同的方式初始化 SQL 数据库。当然，你也可以手动完成，前提是数据库是一个单独的进程。建议使用单一机制生成模式。</p>
<p translation-origin="off">An SQL database can be initialized in different ways depending on what your stack is.
Of course, you can also do it manually, provided the database is a separate process.
It is recommended to use a single mechanism for schema generation.</p>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.using-jpa" translation-result="on"><a href="howto.html#howto.data-initialization.using-jpa"></a>9.1. 使用 JPA 初始化数据库</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.using-jpa"></a>9.1. Initialize a Database Using JPA</h3>
<div class="paragraph">
<p translation-result="on">JPA 具有用于 DDL 生成的功能，这些功能可以设置为在启动时针对数据库运行。这是通过两个外部属性控制的：</p>
<p translation-origin="off">JPA has features for DDL generation, and these can be set up to run on startup against the database.
This is controlled through two external properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on"><code>spring.jpa.generate-ddl</code> (boolean) 打开和关闭功能，并且独立于供应商。</p>
<p translation-origin="off"><code>spring.jpa.generate-ddl</code> (boolean) switches the feature on and off and is vendor independent.</p>
</li>
<li>
<p translation-result="on"><code>spring.jpa.hibernate.ddl-auto</code> (enum) 是一个 Hibernate 特性，它以更细粒度的方式控制行为。本指南稍后将更详细地介绍此功能。</p>
<p translation-origin="off"><code>spring.jpa.hibernate.ddl-auto</code> (enum) is a Hibernate feature that controls the behavior in a more fine-grained way.
This feature is described in more detail later in this guide.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.using-hibernate" translation-result="on"><a href="howto.html#howto.data-initialization.using-hibernate"></a>9.2. 使用 Hibernate 初始化数据库</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.using-hibernate"></a>9.2. Initialize a Database Using Hibernate</h3>
<div class="paragraph">
<p translation-result="on">你可以显式设置 <code>spring.jpa.hibernate.ddl-auto</code> ，标准 Hibernate 属性值为 <code>none</code> 、 <code>validate</code> 、 <code>update</code> 、 <code>create</code> 和 <code>create-drop</code> 。Spring Boot 会根据它是否认为你的数据库是嵌入的来为你选择一个默认值。如果未检测到模式管理器或在所有其他情况下 <code>none</code> 检测到，则默认为 <code>create-drop</code> 。通过查看 <code>Connection</code> 类型和 JDBC url 来检测嵌入式数据库。<code>hsqldb</code> 、 <code>h2</code> 和 <code>derby</code> 是候选对象，而其他则不是。从内存中切换到“真实”数据库时要小心，不要假设新平台中是否存在表和数据。你要么必须显式设置 <code>ddl-auto</code> ，要么使用其他机制之一来初始化数据库。</p>
<p translation-origin="off">You can set <code>spring.jpa.hibernate.ddl-auto</code> explicitly and the standard Hibernate property values are <code>none</code>, <code>validate</code>, <code>update</code>, <code>create</code>, and <code>create-drop</code>.
Spring Boot chooses a default value for you based on whether it thinks your database is embedded.
It defaults to <code>create-drop</code> if no schema manager has been detected or <code>none</code> in all other cases.
An embedded database is detected by looking at the <code>Connection</code> type and JDBC url.
<code>hsqldb</code>, <code>h2</code>, and <code>derby</code> are candidates, and others are not.
Be careful when switching from in-memory to a ‘real’ database that you do not make assumptions about the existence of the tables and data in the new platform.
You either have to set <code>ddl-auto</code> explicitly or use one of the other mechanisms to initialize the database.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">你可以通过启用 <code>org.hibernate.SQL</code> 记录器来输出模式创建。如果你启用<a href="features.html#features.logging.console-output">调试模式</a>，这将自动为你完成。</p>
<p translation-origin="off">You can output the schema creation by enabling the <code>org.hibernate.SQL</code> logger.
This is done for you automatically if you enable the <a href="features.html#features.logging.console-output">debug mode</a>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">此外，如果 Hibernate 从头开始创建模式（也就是说，如果 <code>ddl-auto</code> 属性设置为 <code>create</code> 或 <code>create-drop</code> ），则在启动时会执行类路径根目录中名为 <code>import.sql</code> 的文件。如果你小心的话，这对于演示和测试很有用，但可能不是你希望在生产中的类路径上出现的东西。这是一个 Hibernate 特性（与 Spring 无关）。</p>
<p translation-origin="off">In addition, a file named <code>import.sql</code> in the root of the classpath is executed on startup if Hibernate creates the schema from scratch (that is, if the <code>ddl-auto</code> property is set to <code>create</code> or <code>create-drop</code>).
This can be useful for demos and for testing if you are careful but is probably not something you want to be on the classpath in production.
It is a Hibernate feature (and has nothing to do with Spring).</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.using-basic-sql-scripts" translation-result="on"><a href="howto.html#howto.data-initialization.using-basic-sql-scripts"></a>9.3. 使用基本 SQL 脚本初始化数据库</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.using-basic-sql-scripts"></a>9.3. Initialize a Database Using Basic SQL Scripts</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 可以自动创建 JDBC <code>DataSource</code> 或 R2DBC <code>ConnectionFactory</code> 的模式（DDL 脚本）并对其进行初始化（DML 脚本）。它分别从标准根类路径位置加载 SQL： <code>schema.sql</code> 和 <code>data.sql</code> 。此外，Spring Boot 处理 <code>schema-${platform}.sql</code> 和 <code>data-${platform}.sql</code> 文件（如果存在），其中 <code>platform</code> 是 <code>spring.sql.init.platform</code> 的值。这允许你在必要时切换到特定于数据库的脚本。例如，你可以选择将其设置为数据库的供应商名称（ <code>hsqldb</code> 、 <code>h2</code> 、 <code>oracle</code> 、 <code>mysql</code> 、 <code>postgresql</code> 等）。默认情况下，SQL 数据库初始化仅在使用嵌入式内存数据库时执行。要始终初始化 SQL 数据库，无论其类型如何，请将 <code>spring.sql.init.mode</code> 设置为 <code>always</code> 。同样，要禁用初始化，请将 <code>spring.sql.init.mode</code> 设置为 <code>never</code> 。默认情况下，Spring Boot 启用其基于脚本的数据库初始化程序的快速失败特性。这意味着，如果脚本导致异常，应用程序将无法启动。你可以通过设置 <code>spring.sql.init.continue-on-error</code> 来调整该行为。</p>
<p translation-origin="off">Spring Boot can automatically create the schema (DDL scripts) of your JDBC <code>DataSource</code> or R2DBC <code>ConnectionFactory</code> and initialize it (DML scripts).
It loads SQL from the standard root classpath locations: <code>schema.sql</code> and <code>data.sql</code>, respectively.
In addition, Spring Boot processes the <code>schema-${platform}.sql</code> and <code>data-${platform}.sql</code> files (if present), where <code>platform</code> is the value of <code>spring.sql.init.platform</code>.
This allows you to switch to database-specific scripts if necessary.
For example, you might choose to set it to the vendor name of the database (<code>hsqldb</code>, <code>h2</code>, <code>oracle</code>, <code>mysql</code>, <code>postgresql</code>, and so on).
By default, SQL database initialization is only performed when using an embedded in-memory database.
To always initialize an SQL database, irrespective of its type, set <code>spring.sql.init.mode</code> to <code>always</code>.
Similarly, to disable initialization, set <code>spring.sql.init.mode</code> to <code>never</code>.
By default, Spring Boot enables the fail-fast feature of its script-based database initializer.
This means that, if the scripts cause exceptions, the application fails to start.
You can tune that behavior by setting <code>spring.sql.init.continue-on-error</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">默认情况下，在创建任何 JPA <code>EntityManagerFactory</code> bean 之前执行基于脚本的 <code>DataSource</code> 初始化。<code>schema.sql</code> 可用于为 JPA 管理的实体创建模式，而 <code>data.sql</code> 可用于填充它。虽然我们不建议使用多个数据源初始化技术，但如果你希望基于脚本的 <code>DataSource</code> 初始化能够建立在 Hibernate 执行的模式创建之上，请将 <code>spring.jpa.defer-datasource-initialization</code> 设置为 <code>true</code> 。这将推迟数据源初始化，直到创建和初始化任何 <code>EntityManagerFactory</code> bean 之后。然后可以用 <code>schema.sql</code> 对 Hibernate 执行的任何模式创建进行添加，并且可以用 <code>data.sql</code> 来填充它。</p>
<p translation-origin="off">Script-based <code>DataSource</code> initialization is performed, by default, before any JPA <code>EntityManagerFactory</code> beans are created.
<code>schema.sql</code> can be used to create the schema for JPA-managed entities and <code>data.sql</code> can be used to populate it.
While we do not recommend using multiple data source initialization technologies, if you want script-based <code>DataSource</code> initialization to be able to build upon the schema creation performed by Hibernate, set <code>spring.jpa.defer-datasource-initialization</code> to <code>true</code>.
This will defer data source initialization until after any <code>EntityManagerFactory</code> beans have been created and initialized.
<code>schema.sql</code> can then be used to make additions to any schema creation performed by Hibernate and <code>data.sql</code> can be used to populate it.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果你使用的是<a href="howto.html#howto.data-initialization.migration-tool">高级数据库迁移工具</a>，例如 Flyway 或 Liquibase，则应单独使用它们来创建和初始化架构。不建议将基本 <code>schema.sql</code> 和 <code>data.sql</code> 脚本与 Flyway 或 Liquibase 一起使用，并且将在未来的版本中删除支持。</p>
<p translation-origin="off">If you are using a <a href="howto.html#howto.data-initialization.migration-tool">Higher-level Database Migration Tool</a>, like Flyway or Liquibase, you should use them alone to create and initialize the schema.
Using the basic <code>schema.sql</code> and <code>data.sql</code> scripts alongside Flyway or Liquibase is not recommended and support will be removed in a future release.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.batch" translation-result="on"><a href="howto.html#howto.data-initialization.batch"></a>9.4. 初始化 Spring Batch 数据库</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.batch"></a>9.4. Initialize a Spring Batch Database</h3>
<div class="paragraph">
<p translation-result="on">如果你使用 Spring Batch，它会预先打包适用于大多数流行数据库平台的 SQL 初始化脚本。Spring Boot 可以检测你的数据库类型并在启动时执行这些脚本。如果你使用嵌入式数据库，则默认情况下会发生这种情况。你还可以为任何数据库类型启用它，如以下示例所示：</p>
<p translation-origin="off">If you use Spring Batch, it comes pre-packaged with SQL initialization scripts for most popular database platforms.
Spring Boot can detect your database type and execute those scripts on startup.
If you use an embedded database, this happens by default.
You can also enable it for any database type, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.batch.jdbc.initialize-schema=always</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  batch:
    jdbc:
      initialize-schema: "always"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">你还可以通过将 <code>spring.batch.jdbc.initialize-schema</code> 设置为 <code>never</code> 来显式关闭初始化。</p>
<p translation-origin="off">You can also switch off the initialization explicitly by setting <code>spring.batch.jdbc.initialize-schema</code> to <code>never</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.migration-tool" translation-result="on"><a href="howto.html#howto.data-initialization.migration-tool"></a>9.5. 使用更高级别的数据库迁移工具</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.migration-tool"></a>9.5. Use a Higher-level Database Migration Tool</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 支持两个更高级别的迁移工具： <a href="https://flywaydb.org/">Flyway</a> 和 <a href="https://www.liquibase.org/">Liquibase</a> 。</p>
<p translation-origin="off">Spring Boot supports two higher-level migration tools: <a href="https://flywaydb.org/">Flyway</a> and <a href="https://www.liquibase.org/">Liquibase</a>.</p>
</div>
<div class="sect3">
<h4 id="howto.data-initialization.migration-tool.flyway" translation-result="on"><a href="howto.html#howto.data-initialization.migration-tool.flyway"></a>9.5.1. 在启动时执行 Flyway 数据库迁移</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.migration-tool.flyway"></a>9.5.1. Execute Flyway Database Migrations on Startup</h4>
<div class="paragraph">
<p translation-result="on">要在启动时自动运行 Flyway 数据库迁移，请将 <code>org.flywaydb:flyway-core</code> 添加到你的类路径中。</p>
<p translation-origin="off">To automatically run Flyway database migrations on startup, add the <code>org.flywaydb:flyway-core</code> to your classpath.</p>
</div>
<div class="paragraph">
<p translation-result="on">通常，迁移是 <code>V&lt;VERSION&gt;__&lt;NAME&gt;.sql</code> 形式的脚本（ <code>&lt;VERSION&gt;</code> 是下划线分隔的版本，例如“1”或“2_1”）。默认情况下，它们位于名为 <code>classpath:db/migration</code> 的目录中，但你可以通过设置 <code>spring.flyway.locations</code> 来修改该位置。这是一个或多个 <code>classpath:</code> 或 <code>filesystem:</code> 位置的逗号分隔列表。例如，以下配置将在默认类路径位置和 <code>/opt/migration</code> 目录中搜索脚本：</p>
<p translation-origin="off">Typically, migrations are scripts in the form <code>V&lt;VERSION&gt;__&lt;NAME&gt;.sql</code> (with <code>&lt;VERSION&gt;</code> an underscore-separated version, such as ‘1’ or ‘2_1’).
By default, they are in a directory called <code>classpath:db/migration</code>, but you can modify that location by setting <code>spring.flyway.locations</code>.
This is a comma-separated list of one or more <code>classpath:</code> or <code>filesystem:</code> locations.
For example, the following configuration would search for scripts in both the default classpath location and the <code>/opt/migration</code> directory:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.flyway.locations=classpath:db/migration,filesystem:/opt/migration</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  flyway:
    locations: "classpath:db/migration,filesystem:/opt/migration"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">你还可以添加一个特殊的 <code>{vendor}</code> 占位符来使用特定于供应商的脚本。假设如下：</p>
<p translation-origin="off">You can also add a special <code>{vendor}</code> placeholder to use vendor-specific scripts.
Assume the following:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.flyway.locations=classpath:db/migration/{vendor}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  flyway:
    locations: "classpath:db/migration/{vendor}"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">前面的配置没有使用 <code>db/migration</code> ，而是根据数据库的类型（例如 MySQL 的 <code>db/migration/mysql</code> ）设置要使用的目录。支持的数据库列表在<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jdbc/DatabaseDriver.java"><code>DatabaseDriver</code></a>中可用。</p>
<p translation-origin="off">Rather than using <code>db/migration</code>, the preceding configuration sets the directory to use according to the type of the database (such as <code>db/migration/mysql</code> for MySQL).
The list of supported databases is available in <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jdbc/DatabaseDriver.java"><code>DatabaseDriver</code></a>.</p>
</div>
<div class="paragraph">
<p translation-result="on">迁移也可以用 Java 编写。Flyway 将自动配置任何实现 <code>JavaMigration</code> 的 bean。</p>
<p translation-origin="off">Migrations can also be written in Java.
Flyway will be auto-configured with any beans that implement <code>JavaMigration</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on"><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/flyway/FlywayProperties.java"><code>FlywayProperties</code></a>提供 Flyway 的大部分设置和一小组附加属性，可用于禁用迁移或关闭位置检查。如果你需要对配置进行更多控制，请考虑注册 <code>FlywayConfigurationCustomizer</code> bean。</p>
<p translation-origin="off"><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/flyway/FlywayProperties.java"><code>FlywayProperties</code></a> provides most of Flyway’s settings and a small set of additional properties that can be used to disable the migrations or switch off the location checking.
If you need more control over the configuration, consider registering a <code>FlywayConfigurationCustomizer</code> bean.</p>
</div>
<div class="paragraph">
<p translation-result="on">Spring Boot 调用 <code>Flyway.migrate()</code> 来执行数据库迁移。如果你想要更多控制，请提供一个实现 <code>@Bean</code> 的<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/flyway/FlywayMigrationStrategy.java"><code>FlywayMigrationStrategy</code></a> 。</p>
<p translation-origin="off">Spring Boot calls <code>Flyway.migrate()</code> to perform the database migration.
If you would like more control, provide a <code>@Bean</code> that implements <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/flyway/FlywayMigrationStrategy.java"><code>FlywayMigrationStrategy</code></a>.</p>
</div>
<div class="paragraph">
<p translation-result="on">Flyway 支持 SQL 和 Java<a href="https://flywaydb.org/documentation/concepts/callbacks">回调</a>。要使用基于 SQL 的回调，请将回调脚本放在 <code>classpath:db/migration</code> 目录中。要使用基于 Java 的回调，请创建一个或多个实现 <code>Callback</code> 的 bean。任何此类 bean 都会自动注册到 <code>Flyway</code> 。它们可以通过使用 <code>@Order</code> 或通过实现 <code>Ordered</code> 来订购。也可以检测到实现已弃用 <code>FlywayCallback</code> 接口的 Bean，但它们不能与 <code>Callback</code> bean 一起使用。</p>
<p translation-origin="off">Flyway supports SQL and Java <a href="https://flywaydb.org/documentation/concepts/callbacks">callbacks</a>.
To use SQL-based callbacks, place the callback scripts in the <code>classpath:db/migration</code> directory.
To use Java-based callbacks, create one or more beans that implement <code>Callback</code>.
Any such beans are automatically registered with <code>Flyway</code>.
They can be ordered by using <code>@Order</code> or by implementing <code>Ordered</code>.
Beans that implement the deprecated <code>FlywayCallback</code> interface can also be detected, however they cannot be used alongside <code>Callback</code> beans.</p>
</div>
<div class="paragraph">
<p translation-result="on">默认情况下，<code>@Primary</code> 在你的上下文中自动连接 (@Primary) <code>DataSource</code> 并将其用于迁移。如果你喜欢使用不同的 <code>DataSource</code> ，你可以创建一个并将其 <code>@Bean</code> 标记为 <code>@FlywayDataSource</code> 。如果你这样做并且想要两个数据源，请记住创建另一个并将其标记为 <code>@Primary</code> 。或者，你可以通过在外部属性中设置 <code>spring.flyway.[url,user,password]</code> 来使用 Flyway 的本机 <code>DataSource</code> 。设置 <code>spring.flyway.url</code> 或 <code>spring.flyway.user</code> 足以使 Flyway 使用它自己的 <code>DataSource</code> 。如果没有设置三个属性中的任何一个，则将使用其等效 <code>spring.datasource</code> 属性的值。</p>
<p translation-origin="off">By default, Flyway autowires the (<code>@Primary</code>) <code>DataSource</code> in your context and uses that for migrations.
If you like to use a different <code>DataSource</code>, you can create one and mark its <code>@Bean</code> as <code>@FlywayDataSource</code>.
If you do so and want two data sources, remember to create another one and mark it as <code>@Primary</code>.
Alternatively, you can use Flyway’s native <code>DataSource</code> by setting <code>spring.flyway.[url,user,password]</code> in external properties.
Setting either <code>spring.flyway.url</code> or <code>spring.flyway.user</code> is sufficient to cause Flyway to use its own <code>DataSource</code>.
If any of the three properties has not been set, the value of its equivalent <code>spring.datasource</code> property will be used.</p>
</div>
<div class="paragraph">
<p translation-result="on">你还可以用 Flyway 为特定场景提供数据。例如，你可以将特定于测试的迁移放在 <code>src/test/resources</code> 中，并且它们仅在你的应用程序开始进行测试时运行。此外，你可以用特定于配置文件的配置来自定义 <code>spring.flyway.locations</code> 以便某些迁移仅在特定配置文件处于活动状态时运行。例如，在 <code>application-dev.properties</code> 中，你可以指定以下设置：</p>
<p translation-origin="off">You can also use Flyway to provide data for specific scenarios.
For example, you can place test-specific migrations in <code>src/test/resources</code> and they are run only when your application starts for testing.
Also, you can use profile-specific configuration to customize <code>spring.flyway.locations</code> so that certain migrations run only when a particular profile is active.
For example, in <code>application-dev.properties</code>, you might specify the following setting:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.flyway.locations=classpath:/db/migration,classpath:/dev/db/migration</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  flyway:
    locations: "classpath:/db/migration,classpath:/dev/db/migration"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">使用该设置，<code>dev/db/migration</code> 中的迁移仅在 <code>dev</code> 配置文件处于活动状态时运行。</p>
<p translation-origin="off">With that setup, migrations in <code>dev/db/migration</code> run only when the <code>dev</code> profile is active.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.data-initialization.migration-tool.liquibase" translation-result="on"><a href="howto.html#howto.data-initialization.migration-tool.liquibase"></a>9.5.2. 在启动时执行 Liquibase 数据库迁移</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.migration-tool.liquibase"></a>9.5.2. Execute Liquibase Database Migrations on Startup</h4>
<div class="paragraph">
<p translation-result="on">要在启动时自动运行 Liquibase 数据库迁移，请将 <code>org.liquibase:liquibase-core</code> 添加到你的类路径中。</p>
<p translation-origin="off">To automatically run Liquibase database migrations on startup, add the <code>org.liquibase:liquibase-core</code> to your classpath.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-result="on">当你将 <code>org.liquibase:liquibase-core</code> 添加到你的类路径时，数据库迁移默认在应用程序启动期间和测试运行之前运行。可以通过使用 <code>spring.liquibase.enabled</code> 属性来自定义此行为，在 <code>main</code> 配置和 <code>test</code> 配置中设置不同的值。不可能使用两种不同的方式来初始化数据库（例如，用于应用程序启动的 Liquibase，用于测试运行的 JPA）。</p>
<p translation-origin="off">When you add the <code>org.liquibase:liquibase-core</code> to your classpath, database migrations run by default for both during application startup and before your tests run.
This behavior can be customized by using the <code>spring.liquibase.enabled</code> property, setting different values in the <code>main</code> and <code>test</code> configurations.
It is not possible to use two different ways to initialize the database (for example Liquibase for application startup, JPA for test runs).</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">默认情况下，从 <code>db/changelog/db.changelog-master.yaml</code> 读取主更改日志，但你可以通过设置 <code>spring.liquibase.change-log</code> 更改位置。除了 YAML，Liquibase 还支持 JSON、XML 和 SQL 更改日志格式。</p>
<p translation-origin="off">By default, the master change log is read from <code>db/changelog/db.changelog-master.yaml</code>, but you can change the location by setting <code>spring.liquibase.change-log</code>.
In addition to YAML, Liquibase also supports JSON, XML, and SQL change log formats.</p>
</div>
<div class="paragraph">
<p translation-result="on">默认情况下，Liquibase 在你的上下文中自动装配 ( <code>@Primary</code> ) <code>DataSource</code> 并将其用于迁移。如果你需要使用不同的 <code>DataSource</code> ，你可以创建一个并将其 <code>@Bean</code> 标记为 <code>@LiquibaseDataSource</code> 。如果你这样做并且想要两个数据源，请记住创建另一个数据源并将其标记为 <code>@Primary</code> 。或者，你可以通过在外部属性中设置 <code>spring.liquibase.[driver-class-name,url,user,password]</code> 来使用 Liquibase 的本机 <code>DataSource</code> 。设置 <code>spring.liquibase.url</code> 或 <code>spring.liquibase.user</code> 足以使 Liquibase 使用它自己的 <code>DataSource</code> 。如果没有设置三个属性中的任何一个，则将使用其等效 <code>spring.datasource</code> 属性的值。</p>
<p translation-origin="off">By default, Liquibase autowires the (<code>@Primary</code>) <code>DataSource</code> in your context and uses that for migrations.
If you need to use a different <code>DataSource</code>, you can create one and mark its <code>@Bean</code> as <code>@LiquibaseDataSource</code>.
If you do so and you want two data sources, remember to create another one and mark it as <code>@Primary</code>.
Alternatively, you can use Liquibase’s native <code>DataSource</code> by setting <code>spring.liquibase.[driver-class-name,url,user,password]</code> in external properties.
Setting either <code>spring.liquibase.url</code> or <code>spring.liquibase.user</code> is sufficient to cause Liquibase to use its own <code>DataSource</code>.
If any of the three properties has not been set, the value of its equivalent <code>spring.datasource</code> property will be used.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关可用设置（例如上下文、默认架构等）的详细信息，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/liquibase/LiquibaseProperties.java"><code>LiquibaseProperties</code></a> 。</p>
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/liquibase/LiquibaseProperties.java"><code>LiquibaseProperties</code></a> for details about available settings such as contexts, the default schema, and others.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.dependencies" translation-result="on"><a href="howto.html#howto.data-initialization.dependencies"></a>9.6. 依赖于一个初始化的数据库</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.dependencies"></a>9.6. Depend Upon an Initialized Database</h3>
<div class="paragraph">
<p translation-result="on">作为应用程序上下文刷新的一部分，在应用程序启动时执行数据库初始化。为了允许在启动期间访问已初始化的数据库，会自动检测充当数据库初始化程序的 bean 和需要已初始化该数据库的 bean。初始化依赖于已初始化数据库的 Bean 被配置为依赖于那些初始化它的 Bean。如果在启动期间，你的应用程序尝试访问数据库但尚未初始化，你可以配置对初始化数据库并要求数据库已初始化的 bean 的额外检测。</p>
<p translation-origin="off">Database initialization is performed while the application is starting up as part of application context refresh.
To allow an initialized database to be accessed during startup, beans that act as database initializers and beans that require that database to have been initialized are detected automatically.
Beans whose initialization depends upon the database having been initialized are configured to depend upon those that initialize it.
If, during startup, your application tries to access the database and it has not been initialized, you can configure additional detection of beans that initialize the database and require the database to have been initialized.</p>
</div>
<div class="sect3">
<h4 id="howto.data-initialization.dependencies.initializer-detection" translation-result="on"><a href="howto.html#howto.data-initialization.dependencies.initializer-detection"></a>9.6.1. 检测数据库初始化器</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.dependencies.initializer-detection"></a>9.6.1. Detect a Database Initializer</h4>
<div class="paragraph">
<p translation-result="on">Spring Boot 将自动检测初始化 SQL 数据库的以下类型的 bean：</p>
<p translation-origin="off">Spring Boot will automatically detect beans of the following types that initialize an SQL database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DataSourceScriptDatabaseInitializer</code></p>
</li>
<li>
<p><code>EntityManagerFactory</code></p>
</li>
<li>
<p><code>Flyway</code></p>
</li>
<li>
<p><code>FlywayMigrationInitializer</code></p>
</li>
<li>
<p><code>R2dbcScriptDatabaseInitializer</code></p>
</li>
<li>
<p><code>SpringLiquibase</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">如果你使用第三方启动器进行数据库初始化库，它可能会提供一个检测器，这样其他类型的 bean 也会被自动检测到。要检测其他 bean，请在 <code>META-INF/spring-factories</code> 中注册 <code>DatabaseInitializerDetector</code> 的实现。</p>
<p translation-origin="off">If you are using a third-party starter for a database initialization library, it may provide a detector such that beans of other types are also detected automatically.
To have other beans be detected, register an implementation of <code>DatabaseInitializerDetector</code> in <code>META-INF/spring-factories</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.data-initialization.dependencies.depends-on-initialization-detection" translation-result="on"><a href="howto.html#howto.data-initialization.dependencies.depends-on-initialization-detection"></a>9.6.2. 检测依赖于数据库初始化的 Bean</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.dependencies.depends-on-initialization-detection"></a>9.6.2. Detect a Bean That Depends On Database Initialization</h4>
<div class="paragraph">
<p translation-result="on">Spring Boot 将根据数据库初始化自动检测以下类型的 bean：</p>
<p translation-origin="off">Spring Boot will automatically detect beans of the following types that depends upon database initialization:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on"><code>AbstractEntityManagerFactoryBean</code> （除非 <code>spring.jpa.defer-datasource-initialization</code> 设置为 <code>true</code> ）</p>
<p translation-origin="off"><code>AbstractEntityManagerFactoryBean</code> (unless <code>spring.jpa.defer-datasource-initialization</code> is set to <code>true</code>)</p>
</li>
<li>
<p><code>DSLContext</code> (jOOQ)</p>
</li>
<li>
<p translation-result="on"><code>EntityManagerFactory</code> （除非 <code>spring.jpa.defer-datasource-initialization</code> 设置为 <code>true</code> ）</p>
<p translation-origin="off"><code>EntityManagerFactory</code> (unless <code>spring.jpa.defer-datasource-initialization</code> is set to <code>true</code>)</p>
</li>
<li>
<p><code>JdbcOperations</code></p>
</li>
<li>
<p><code>NamedParameterJdbcOperations</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">如果你使用的是第三方启动器数据访问库，它可能会提供一个检测器，以便也自动检测其他类型的 bean。要检测其他 bean，请在 <code>META-INF/spring-factories</code> 中注册 <code>DependsOnDatabaseInitializationDetector</code> 的实现。或者，使用 <code>@DependsOnDatabaseInitialization</code> 注解 bean 的类或其 <code>@Bean</code> 方法。</p>
<p translation-origin="off">If you are using a third-party starter data access library, it may provide a detector such that beans of other types are also detected automatically.
To have other beans be detected, register an implementation of <code>DependsOnDatabaseInitializationDetector</code> in <code>META-INF/spring-factories</code>.
Alternatively, annotate the bean’s class or its <code>@Bean</code> method with <code>@DependsOnDatabaseInitialization</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.messaging" translation-result="on"><a href="howto.html#howto.messaging"></a>10. 消息传递</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.messaging"></a>10. Messaging</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 提供了许多启动器来支持消息传递。本节回答了在 Spring Boot 中使用消息传递产生的问题。</p>
<p translation-origin="off">Spring Boot offers a number of starters to support messaging.
This section answers questions that arise from using messaging with Spring Boot.</p>
</div>
<div class="sect2">
<h3 id="howto.messaging.disable-transacted-jms-session" translation-result="on"><a href="howto.html#howto.messaging.disable-transacted-jms-session"></a>10.1. 禁用事务处理的 JMS 会话</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.messaging.disable-transacted-jms-session"></a>10.1. Disable Transacted JMS Session</h3>
<div class="paragraph">
<p translation-result="on">如果你的 JMS 代理不支持事务会话，则必须完全禁用对事务的支持。如果你创建自己的 <code>JmsListenerContainerFactory</code> ，则无需执行任何操作，因为默认情况下无法对其进行交易。如果要使用 <code>DefaultJmsListenerContainerFactoryConfigurer</code> 来重用 Spring Boot 的默认值，可以禁用事务会话，如下所示：</p>
<p translation-origin="off">If your JMS broker does not support transacted sessions, you have to disable the support of transactions altogether.
If you create your own <code>JmsListenerContainerFactory</code>, there is nothing to do, since, by default it cannot be transacted.
If you want to use the <code>DefaultJmsListenerContainerFactoryConfigurer</code> to reuse Spring Boot’s default, you can disable transacted sessions, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.jms.ConnectionFactory;

import org.springframework.boot.autoconfigure.jms.DefaultJmsListenerContainerFactoryConfigurer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.jms.config.DefaultJmsListenerContainerFactory;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyJmsConfiguration {

    @Bean
    public DefaultJmsListenerContainerFactory jmsListenerContainerFactory(ConnectionFactory connectionFactory,
            DefaultJmsListenerContainerFactoryConfigurer configurer) {
        DefaultJmsListenerContainerFactory listenerFactory = new DefaultJmsListenerContainerFactory();
        configurer.configure(listenerFactory, connectionFactory);
        listenerFactory.setTransactionManager(null);
        listenerFactory.setSessionTransacted(false);
        return listenerFactory;
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">前面的示例覆盖了默认工厂，它应该应用于你的应用程序定义的任何其他工厂（如果有）。</p>
<p translation-origin="off">The preceding example overrides the default factory, and it should be applied to any other factory that your application defines, if any.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.batch" translation-result="on"><a href="howto.html#howto.batch"></a>11. 批量申请</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.batch"></a>11. Batch Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">当人们在 Spring Boot 应用程序中使用 Spring Batch 时，经常会出现许多问题。本节将解决这些问题。</p>
<p translation-origin="off">A number of questions often arise when people use Spring Batch from within a Spring Boot application.
This section addresses those questions.</p>
</div>
<div class="sect2">
<h3 id="howto.batch.specifying-a-data-source" translation-result="on"><a href="howto.html#howto.batch.specifying-a-data-source"></a>11.1. 指定批处理数据源</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.batch.specifying-a-data-source"></a>11.1. Specifying a Batch Data Source</h3>
<div class="paragraph">
<p translation-result="on">默认情况下，批处理应用程序需要 <code>DataSource</code> 来存储作业详细信息。Spring Batch 默认需要一个 <code>DataSource</code> 。要让它使用应用程序的主 <code>DataSource</code> 以外的 <code>DataSource</code> ，请声明一个 <code>DataSource</code> bean，用 <code>@BatchDataSource</code> 注解其 <code>@Bean</code> 方法。如果你这样做并且想要两个数据源，请记住标记另一个 <code>@Primary</code> 。要获得更大的控制权，请实施 <code>BatchConfigurer</code> 。有关更多详细信息，请参阅<a href="https://docs.spring.io/spring-batch/docs/4.3.4/api/org/springframework/batch/core/configuration/annotation/EnableBatchProcessing.html"><code>@EnableBatchProcessing</code> 的 Javadoc</a> 。</p>
<p translation-origin="off">By default, batch applications require a <code>DataSource</code> to store job details.
Spring Batch expects a single <code>DataSource</code> by default.
To have it use a <code>DataSource</code> other than the application’s main <code>DataSource</code>, declare a <code>DataSource</code> bean, annotating its <code>@Bean</code> method with <code>@BatchDataSource</code>.
If you do so and want two data sources, remember to mark the other one <code>@Primary</code>.
To take greater control, implement <code>BatchConfigurer</code>.
See <a href="https://docs.spring.io/spring-batch/docs/4.3.4/api/org/springframework/batch/core/configuration/annotation/EnableBatchProcessing.html">The Javadoc of <code>@EnableBatchProcessing</code></a> for more details.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关 Spring Batch 的更多信息，请参阅 <a href="https://spring.io/projects/spring-batch">Spring Batch 项目页面</a>。</p>
<p translation-origin="off">For more info about Spring Batch, see the <a href="https://spring.io/projects/spring-batch">Spring Batch project page</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.batch.running-jobs-on-startup" translation-result="on"><a href="howto.html#howto.batch.running-jobs-on-startup"></a>11.2. 在启动时运行 Spring Batch 作业</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.batch.running-jobs-on-startup"></a>11.2. Running Spring Batch Jobs on Startup</h3>
<div class="paragraph">
<p translation-result="on">通过将 <code>@EnableBatchProcessing</code> 添加到你的 <code>@Configuration</code> 类之一来启用 Spring Batch 自动配置。</p>
<p translation-origin="off">Spring Batch auto-configuration is enabled by adding <code>@EnableBatchProcessing</code> to one of your <code>@Configuration</code> classes.</p>
</div>
<div class="paragraph">
<p translation-result="on">默认情况下，它在启动时执行应用程序上下文中的<strong>所有</strong><code>Jobs</code> （有关详细信息，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/batch/JobLauncherApplicationRunner.java"><code>JobLauncherApplicationRunner</code></a> ）。你可以通过指定 <code>spring.batch.job.names</code> （它采用逗号分隔的作业名称模式列表）来缩小到一个或多个特定作业。</p>
<p translation-origin="off">By default, it executes <strong>all</strong> <code>Jobs</code> in the application context on startup (see <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/batch/JobLauncherApplicationRunner.java"><code>JobLauncherApplicationRunner</code></a> for details).
You can narrow down to a specific job or jobs by specifying <code>spring.batch.job.names</code> (which takes a comma-separated list of job name patterns).</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅 <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration.java">BatchAutoConfiguration</a> 和<a href="https://docs.spring.io/spring-batch/docs/4.3.4/api/org/springframework/batch/core/configuration/annotation/EnableBatchProcessing.html">@EnableBatchProcessing</a> 。</p>
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration.java">BatchAutoConfiguration</a> and <a href="https://docs.spring.io/spring-batch/docs/4.3.4/api/org/springframework/batch/core/configuration/annotation/EnableBatchProcessing.html">@EnableBatchProcessing</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.batch.running-from-the-command-line" translation-result="on"><a href="howto.html#howto.batch.running-from-the-command-line"></a>11.3. 从命令行运行</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.batch.running-from-the-command-line"></a>11.3. Running from the Command Line</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 将以 <code>--</code> 开头的任何命令行参数转换为要添加到 <code>Environment</code> 中的属性，请参阅<a href="features.html#features.external-config.command-line-args">访问命令行属性</a>。这不应该用于将参数传递给批处理作业。要在命令行上指定批处理参数，请使用常规格式（即不带 <code>--</code> ），如以下示例所示：</p>
<p translation-origin="off">Spring Boot converts any command line argument starting with <code>--</code> to a property to add to the <code>Environment</code>, see <a href="features.html#features.external-config.command-line-args">accessing command line properties</a>.
This should not be used to pass arguments to batch jobs.
To specify batch arguments on the command line, use the regular format (that is without <code>--</code>), as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar myapp.jar someParameter=someValue anotherParameter=anotherValue</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">如果你在命令行上指定 <code>Environment</code> 的属性，则作业会忽略它。考虑以下命令：</p>
<p translation-origin="off">If you specify a property of the <code>Environment</code> on the command line, it is ignored by the job.
Consider the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar myapp.jar --server.port=7070 someParameter=someValue</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">这只为批处理作业提供了一个参数： <code>someParameter=someValue</code> 。</p>
<p translation-origin="off">This provides only one argument to the batch job: <code>someParameter=someValue</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.batch.storing-job-repository" translation-result="on"><a href="howto.html#howto.batch.storing-job-repository"></a>11.4. 存储作业存储库</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.batch.storing-job-repository"></a>11.4. Storing the Job Repository</h3>
<div class="paragraph">
<p translation-result="on">Spring Batch 需要一个用于 <code>Job</code> 存储库的数据存储。如果使用 Spring Boot，则必须使用实际的数据库。请注意，它可以是内存数据库，请参阅<a href="https://docs.spring.io/spring-batch/docs/4.3.4/reference/html/job.html#configuringJobRepository">配置作业存储库</a>。</p>
<p translation-origin="off">Spring Batch requires a data store for the <code>Job</code> repository.
If you use Spring Boot, you must use an actual database.
Note that it can be an in-memory database, see <a href="https://docs.spring.io/spring-batch/docs/4.3.4/reference/html/job.html#configuringJobRepository">Configuring a Job Repository</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.actuator" translation-result="on"><a href="howto.html#howto.actuator"></a>12. 执行器</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.actuator"></a>12. Actuator</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 包括 Spring Boot 执行器。本节回答了使用它时经常出现的问题。</p>
<p translation-origin="off">Spring Boot includes the Spring Boot Actuator.
This section answers questions that often arise from its use.</p>
</div>
<div class="sect2">
<h3 id="howto.actuator.change-http-port-or-address" translation-result="on"><a href="howto.html#howto.actuator.change-http-port-or-address"></a>12.1. 更改执行器端点的 HTTP 端口或地址</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.actuator.change-http-port-or-address"></a>12.1. Change the HTTP Port or Address of the Actuator Endpoints</h3>
<div class="paragraph">
<p translation-result="on">在独立应用程序中，Actuator HTTP 端口默认与主 HTTP 端口相同。要让应用程序侦听不同的端口，请设置外部属性： <code>management.server.port</code> 。要侦听完全不同的网络地址（例如，当你有一个用于管理的内部网络和一个用于用户应用程序的外部网络时），你还可以将 <code>management.server.address</code> 设置为服务器能够绑定的有效 IP 地址.</p>
<p translation-origin="off">In a standalone application, the Actuator HTTP port defaults to the same as the main HTTP port.
To make the application listen on a different port, set the external property: <code>management.server.port</code>.
To listen on a completely different network address (such as when you have an internal network for management and an external one for user applications), you can also set <code>management.server.address</code> to a valid IP address to which the server is able to bind.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅“生产就绪功能”部分中的<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-actuator-autoconfigure/src/main/java/org/springframework/boot/actuate/autoconfigure/web/server/ManagementServerProperties.java"><code>ManagementServerProperties</code></a>源代码和“ <a href="actuator.html#actuator.monitoring.customizing-management-server-port">actuator.html</a> ”。</p>
<p translation-origin="off">For more detail, see the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-actuator-autoconfigure/src/main/java/org/springframework/boot/actuate/autoconfigure/web/server/ManagementServerProperties.java"><code>ManagementServerProperties</code></a> source code and “<a href="actuator.html#actuator.monitoring.customizing-management-server-port">actuator.html</a>” in the “Production-ready features” section.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.actuator.customize-whitelabel-error-page" translation-result="on"><a href="howto.html#howto.actuator.customize-whitelabel-error-page"></a>12.2. 自定义“whitelabel”错误页面</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.actuator.customize-whitelabel-error-page"></a>12.2. Customize the ‘whitelabel’ Error Page</h3>
<div class="paragraph">
<p translation-result="on">如果你遇到服务器错误（使用 JSON 和其他媒体类型的机器客户端应该看到带有正确错误代码的合理响应），Spring Boot 会安装一个“whitelabel”错误页面，你会在浏览器客户端中看到该页面。</p>
<p translation-origin="off">Spring Boot installs a ‘whitelabel’ error page that you see in a browser client if you encounter a server error (machine clients consuming JSON and other media types should see a sensible response with the right error code).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-result="on">设置 <code>server.error.whitelabel.enabled=false</code> 以关闭默认错误页面。这样做会恢复你正在使用的 servlet 容器的默认值。请注意，Spring Boot 仍然尝试解决错误视图，因此你可能应该添加自己的错误页面，而不是完全禁用它。</p>
<p translation-origin="off">Set <code>server.error.whitelabel.enabled=false</code> to switch the default error page off.
Doing so restores the default of the servlet container that you are using.
Note that Spring Boot still tries to resolve the error view, so you should probably add your own error page rather than disabling it completely.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">用你自己的错误页面覆盖错误页面取决于你使用的模板技术。例如，如果你使用 Thymeleaf，则可以添加 <code>error.html</code> 模板。如果你使用 FreeMarker，你可以添加一个 <code>error.ftlh</code> 模板。通常，你需要一个使用 <code>error</code> 名称解析的 <code>View</code> 或一个处理 <code>/error</code> 路径的 <code>@Controller</code> 。除非你替换了一些默认配置，否则你应该在 <code>ApplicationContext</code> 中找到一个 <code>BeanNameViewResolver</code> ，因此 <code>@Bean</code> 命名 <code>error</code> 将是一种方法。有关更多选项，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/error/ErrorMvcAutoConfiguration.java"><code>ErrorMvcAutoConfiguration</code></a> 。</p>
<p translation-origin="off">Overriding the error page with your own depends on the templating technology that you use.
For example, if you use Thymeleaf, you can add an <code>error.html</code> template.
If you use FreeMarker, you can add an <code>error.ftlh</code> template.
In general, you need a <code>View</code> that resolves with a name of <code>error</code> or a <code>@Controller</code> that handles the <code>/error</code> path.
Unless you replaced some of the default configuration, you should find a <code>BeanNameViewResolver</code> in your <code>ApplicationContext</code>, so a <code>@Bean</code> named <code>error</code> would be one way of doing that.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/error/ErrorMvcAutoConfiguration.java"><code>ErrorMvcAutoConfiguration</code></a> for more options.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关如何在 servlet 容器中注册处理程序的详细信息，另请参阅“<a href="web.html#web.servlet.spring-mvc.error-handling">错误处理</a>”部分。</p>
<p translation-origin="off">See also the section on “<a href="web.html#web.servlet.spring-mvc.error-handling">Error Handling</a>” for details of how to register handlers in the servlet container.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.actuator.sanitize-sensitive-values" translation-result="on"><a href="howto.html#howto.actuator.sanitize-sensitive-values"></a>12.3. 清理敏感值</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.actuator.sanitize-sensitive-values"></a>12.3. Sanitize Sensitive Values</h3>
<div class="paragraph">
<p translation-result="on"><code>env</code> 和 <code>configprops</code> 端点返回的信息可能有些敏感，因此默认情况下会清理匹配某些模式的键（即它们的值被替换为 <code>******</code> ）。Spring Boot 对这些键使用合理的默认值：任何以单词“password”、“secret”、“key”、“token”、“vcap_services”、“sun.java.command”结尾的键都会被完全清除。此外，任何包含单词 <code>credentials</code> （配置为正则表达式，即 <code>*credentials.*</code> ）作为密钥一部分的密钥也被完全清理。</p>
<p translation-origin="off">Information returned by the <code>env</code> and <code>configprops</code> endpoints can be somewhat sensitive so keys matching certain patterns are sanitized by default (that is their values are replaced by <code>******</code>).
Spring Boot uses sensible defaults for such keys: any key ending with the word "password", "secret", "key", "token", "vcap_services", "sun.java.command" is entirely sanitized.
Additionally, any key that holds the word <code>credentials</code> (configured as a regular expression, that is <code>*credentials.*</code>) as part of the key is also entirely sanitized.</p>
</div>
<div class="paragraph">
<p translation-result="on">此外，Spring Boot 对具有以下结尾之一的键的类似 URI 的值的敏感部分进行清理：</p>
<p translation-origin="off">Furthermore, Spring Boot sanitizes the sensitive portion of URI-like values for keys with one of the following endings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>address</code></p>
</li>
<li>
<p><code>addresses</code></p>
</li>
<li>
<p><code>uri</code></p>
</li>
<li>
<p><code>uris</code></p>
</li>
<li>
<p><code>url</code></p>
</li>
<li>
<p><code>urls</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">URI 的敏感部分使用 <code>&lt;scheme&gt;://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/</code> 格式标识。例如，对于属性 <code>myclient.uri=http://user1:[email protected]:8081</code> ，过滤后的值为 <code>http://user1:******@localhost:8081</code> 。</p>
<p translation-origin="off">The sensitive portion of the URI is identified using the format <code>&lt;scheme&gt;://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/</code>.
For example, for the property <code>myclient.uri=http://user1:<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2454455757534b56401564484b4745484c4b5750">[email&nbsp;protected]</a>:8081</code>, the resulting sanitized value is
<code>http://user1:******@localhost:8081</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on"><code>env</code> 和 <code>configprops</code> 端点使用的默认模式可以分别使用 <code>management.endpoint.env.keys-to-sanitize</code> 和 <code>management.endpoint.configprops.keys-to-sanitize</code> 替换。或者，可以用 <code>management.endpoint.env.additional-keys-to-sanitize</code> 和 <code>management.endpoint.configprops.additional-keys-to-sanitize</code> 配置其他模式。</p>
<p translation-origin="off">The default patterns used by the <code>env</code> and <code>configprops</code> endpoints can be replaced using <code>management.endpoint.env.keys-to-sanitize</code> and <code>management.endpoint.configprops.keys-to-sanitize</code> respectively.
Alternatively, additional patterns can be configured using <code>management.endpoint.env.additional-keys-to-sanitize</code> and <code>management.endpoint.configprops.additional-keys-to-sanitize</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.actuator.map-health-indicators-to-metrics" translation-result="on"><a href="howto.html#howto.actuator.map-health-indicators-to-metrics"></a>12.4. 将健康度量映射到千分尺度量</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.actuator.map-health-indicators-to-metrics"></a>12.4. Map Health Indicators to Micrometer Metrics</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 健康度量返回一个 <code>Status</code> 类型来指示整个系统的健康状况。如果你想监控或提醒特定应用程序的健康水平，你可以用 Micrometer 将这些状态导出为度量。默认情况下，Spring Boot 使用状态码“UP”、“DOWN”、“OUT_OF_SERVICE”和“UNKNOWN”。要导出这些，你需要将这些状态转换为一组数字，以便它们可以与 Micrometer <code>Gauge</code> 一起使用。</p>
<p translation-origin="off">Spring Boot health indicators return a <code>Status</code> type to indicate the overall system health.
If you want to monitor or alert on levels of health for a particular application, you can export these statuses as metrics with Micrometer.
By default, the status codes “UP”, “DOWN”, “OUT_OF_SERVICE” and “UNKNOWN” are used by Spring Boot.
To export these, you will need to convert these states to some set of numbers so that they can be used with a Micrometer <code>Gauge</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">以下示例显示了编写此类导出器的一种方法：</p>
<p translation-origin="off">The following example shows one way to write such an exporter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Gauge;
import io.micrometer.core.instrument.MeterRegistry;

import org.springframework.boot.actuate.health.HealthEndpoint;
import org.springframework.boot.actuate.health.Status;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyHealthMetricsExportConfiguration {

    public MyHealthMetricsExportConfiguration(MeterRegistry registry, HealthEndpoint healthEndpoint) {
        // This example presumes common tags (such as the app) are applied elsewhere
        Gauge.builder("health", healthEndpoint, this::getStatusCode).strongReference(true).register(registry);
    }

    private int getStatusCode(HealthEndpoint health) {
        Status status = health.health().getStatus();
        if (Status.UP.equals(status)) {
            return 3;
        }
        if (Status.OUT_OF_SERVICE.equals(status)) {
            return 2;
        }
        if (Status.DOWN.equals(status)) {
            return 1;
        }
        return 0;
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.security" translation-result="on"><a href="howto.html#howto.security"></a>13. 安全</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.security"></a>13. Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">本节解决使用 Spring Boot 时有关安全性的问题，包括将 Spring Security 与 Spring Boot 一起使用时出现的问题。</p>
<p translation-origin="off">This section addresses questions about security when working with Spring Boot, including questions that arise from using Spring Security with Spring Boot.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关 Spring Security 的更多信息，请参阅 <a href="https://spring.io/projects/spring-security">Spring Security 项目页面</a>。</p>
<p translation-origin="off">For more about Spring Security, see the <a href="https://spring.io/projects/spring-security">Spring Security project page</a>.</p>
</div>
<div class="sect2">
<h3 id="howto.security.switch-off-spring-boot-configuration" translation-result="on"><a href="howto.html#howto.security.switch-off-spring-boot-configuration"></a>13.1. 关闭 Spring Boot 安全配置</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.security.switch-off-spring-boot-configuration"></a>13.1. Switch off the Spring Boot Security Configuration</h3>
<div class="paragraph">
<p translation-result="on">如果你在应用程序中使用 <code>WebSecurityConfigurerAdapter</code> 或 <code>SecurityFilterChain</code> bean 定义 <code>@Configuration</code> ，它将关闭 Spring Boot 中的默认 webapp 安全设置。</p>
<p translation-origin="off">If you define a <code>@Configuration</code> with a <code>WebSecurityConfigurerAdapter</code> or a <code>SecurityFilterChain</code> bean in your application, it switches off the default webapp security settings in Spring Boot.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.security.change-user-details-service-and-add-user-accounts" translation-result="on"><a href="howto.html#howto.security.change-user-details-service-and-add-user-accounts"></a>13.2. 更改 UserDetailsService 并添加用户帐户</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.security.change-user-details-service-and-add-user-accounts"></a>13.2. Change the UserDetailsService and Add User Accounts</h3>
<div class="paragraph">
<p translation-result="on">如果你提供 <code>AuthenticationManager</code> 、 <code>AuthenticationProvider</code> 或 <code>UserDetailsService</code> 类型的 <code>@Bean</code> ，则不会创建 <code>InMemoryUserDetailsManager</code> 的默认 <code>@Bean</code> 。这意味着你可以用 Spring Security 的完整功能集（例如 <a href="https://docs.spring.io/spring-security/reference/5.6.1/servlet/authentication/index.html">各种身份验证选项</a>）。</p>
<p translation-origin="off">If you provide a <code>@Bean</code> of type <code>AuthenticationManager</code>, <code>AuthenticationProvider</code>, or <code>UserDetailsService</code>, the default <code>@Bean</code> for <code>InMemoryUserDetailsManager</code> is not created.
This means you have the full feature set of Spring Security available (such as <a href="https://docs.spring.io/spring-security/reference/5.6.1/servlet/authentication/index.html">various authentication options</a>).</p>
</div>
<div class="paragraph">
<p translation-result="on">添加用户帐户的最简单方法是提供你自己的 <code>UserDetailsService</code> bean。</p>
<p translation-origin="off">The easiest way to add user accounts is to provide your own <code>UserDetailsService</code> bean.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.security.enable-https" translation-result="on"><a href="howto.html#howto.security.enable-https"></a>13.3. 在代理服务器后面运行时启用 HTTPS</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.security.enable-https"></a>13.3. Enable HTTPS When Running behind a Proxy Server</h3>
<div class="paragraph">
<p translation-result="on">确保所有主要端点只能通过 HTTPS 使用，对于任何应用程序来说都是一项重要的工作。如果你使用 Tomcat 作为 servlet 容器，那么 Spring Boot 如果检测到一些环境设置会自动添加 Tomcat 自己的 <code>RemoteIpValve</code> ，你应该能够依赖 <code>HttpServletRequest</code> 来报告它是否安全（甚至是代理服务器的下游）处理真正的 SSL 终止）。标准行为取决于是否存在某些请求标头（ <code>x-forwarded-for</code> 和 <code>x-forwarded-proto</code> ），它们的名称是常规的，因此它应该适用于大多数前端代理。你可以通过向 <code>application.properties</code> 添加一些条目来打开阀门，如下例所示：</p>
<p translation-origin="off">Ensuring that all your main endpoints are only available over HTTPS is an important chore for any application.
If you use Tomcat as a servlet container, then Spring Boot adds Tomcat’s own <code>RemoteIpValve</code> automatically if it detects some environment settings, and you should be able to rely on the <code>HttpServletRequest</code> to report whether it is secure or not (even downstream of a proxy server that handles the real SSL termination).
The standard behavior is determined by the presence or absence of certain request headers (<code>x-forwarded-for</code> and <code>x-forwarded-proto</code>), whose names are conventional, so it should work with most front-end proxies.
You can switch on the valve by adding some entries to <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.remoteip.remote-ip-header=x-forwarded-for
server.tomcat.remoteip.protocol-header=x-forwarded-proto</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    remoteip:
      remote-ip-header: "x-forwarded-for"
      protocol-header: "x-forwarded-proto"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">（其中任何一个属性的存在都会打开阀门。或者，你可以通过使用 <code>WebServerFactoryCustomizer</code> bean 自定义 <code>TomcatServletWebServerFactory</code> 来添加 <code>RemoteIpValve</code> 。）</p>
<p translation-origin="off">(The presence of either of those properties switches on the valve.
Alternatively, you can add the <code>RemoteIpValve</code> by customizing the <code>TomcatServletWebServerFactory</code> using a <code>WebServerFactoryCustomizer</code> bean.)</p>
</div>
<div class="paragraph">
<p translation-result="on">要将 Spring Security 配置为要求所有（或部分）请求的安全通道，请考虑添加你自己的 <code>SecurityFilterChain</code> bean，该 bean 添加以下 <code>HttpSecurity</code> 配置：</p>
<p translation-origin="off">To configure Spring Security to require a secure channel for all (or some) requests, consider adding your own <code>SecurityFilterChain</code> bean that adds the following <code>HttpSecurity</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.SecurityFilterChain;

</span><span class="fold-block">@Configuration
public class MySecurityConfig {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        // Customize the application security ...
        http.requiresChannel().anyRequest().requiresSecure();
        return http.build();
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.hotswapping" translation-result="on"><a href="howto.html#howto.hotswapping"></a>14. 热插拔</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping"></a>14. Hot Swapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 支持热插拔。本节回答有关其工作原理的问题。</p>
<p translation-origin="off">Spring Boot supports hot swapping.
This section answers questions about how it works.</p>
</div>
<div class="sect2">
<h3 id="howto.hotswapping.reload-static-content" translation-result="on"><a href="howto.html#howto.hotswapping.reload-static-content"></a>14.1. 重新加载静态内容</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-static-content"></a>14.1. Reload Static Content</h3>
<div class="paragraph">
<p translation-result="on">有几种热重载选项。推荐的方法是使用<a href="using.html#using.devtools"><code>spring-boot-devtools</code></a> ，因为它提供了额外的开发时特性，例如支持快速应用程序重启和 LiveReload 以及合理的开发时配置（例如模板缓存）。Devtools 通过监视类路径的变化来工作。这意味着必须“构建”静态资源更改才能使更改生效。默认情况下，当你保存更改时，这会在 Eclipse 中自动发生。在 IntelliJ IDEA 中，Make Project 命令会触发必要的构建。由于<a href="using.html#using.devtools.restart.excluding-resources">默认的重启排除</a>，对静态资源的更改不会触发应用程序的重启。但是，它们确实会触发实时重新加载。</p>
<p translation-origin="off">There are several options for hot reloading.
The recommended approach is to use <a href="using.html#using.devtools"><code>spring-boot-devtools</code></a>, as it provides additional development-time features, such as support for fast application restarts and LiveReload as well as sensible development-time configuration (such as template caching).
Devtools works by monitoring the classpath for changes.
This means that static resource changes must be "built" for the change to take effect.
By default, this happens automatically in Eclipse when you save your changes.
In IntelliJ IDEA, the Make Project command triggers the necessary build.
Due to the <a href="using.html#using.devtools.restart.excluding-resources">default restart exclusions</a>, changes to static resources do not trigger a restart of your application.
They do, however, trigger a live reload.</p>
</div>
<div class="paragraph">
<p translation-result="on">或者，在 IDE 中运行（尤其是在调试时）是一种很好的开发方式（所有现代 IDE 都允许重新加载静态资源，并且通常还允许热交换 Java 类更改）。</p>
<p translation-origin="off">Alternatively, running in an IDE (especially with debugging on) is a good way to do development (all modern IDEs allow reloading of static resources and usually also allow hot-swapping of Java class changes).</p>
</div>
<div class="paragraph">
<p translation-result="on">最后，可以配置 <a href="build-tool-plugins.html#build-tool-plugins">Maven 和 Gradle 插件</a>（参见 <code>addResources</code> 属性）以支持从命令行运行并直接从源重新加载静态文件。如果你使用更高级别的工具编写该代码，则可以将其与外部 css/js 编译器进程一起使用。</p>
<p translation-origin="off">Finally, the <a href="build-tool-plugins.html#build-tool-plugins">Maven and Gradle plugins</a> can be configured (see the <code>addResources</code> property) to support running from the command line with reloading of static files directly from source.
You can use that with an external css/js compiler process if you are writing that code with higher-level tools.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.hotswapping.reload-templates" translation-result="on"><a href="howto.html#howto.hotswapping.reload-templates"></a>14.2. 在不重启容器的情况下重新加载模板</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-templates"></a>14.2. Reload Templates without Restarting the Container</h3>
<div class="paragraph">
<p translation-result="on">Spring Boot 支持的大多数模板技术都包含一个禁用缓存的配置选项（本文档稍后会介绍）。如果你使用 <code>spring-boot-devtools</code> 模块，这些属性会在开发时<a href="using.html#using.devtools.property-defaults">自动为你配置</a>。</p>
<p translation-origin="off">Most of the templating technologies supported by Spring Boot include a configuration option to disable caching (described later in this document).
If you use the <code>spring-boot-devtools</code> module, these properties are <a href="using.html#using.devtools.property-defaults">automatically configured</a> for you at development time.</p>
</div>
<div class="sect3">
<h4 id="howto.hotswapping.reload-templates.thymeleaf" translation-result="on"><a href="howto.html#howto.hotswapping.reload-templates.thymeleaf"></a>14.2.1. 百里香模板</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-templates.thymeleaf"></a>14.2.1. Thymeleaf Templates</h4>
<div class="paragraph">
<p translation-result="on">如果你使用 Thymeleaf，请将 <code>spring.thymeleaf.cache</code> 设置为 <code>false</code> 。有关其他 Thymeleaf 自定义选项，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java"><code>ThymeleafAutoConfiguration</code></a> 。</p>
<p translation-origin="off">If you use Thymeleaf, set <code>spring.thymeleaf.cache</code> to <code>false</code>.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java"><code>ThymeleafAutoConfiguration</code></a> for other Thymeleaf customization options.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.hotswapping.reload-templates.freemarker" translation-result="on"><a href="howto.html#howto.hotswapping.reload-templates.freemarker"></a>14.2.2. FreeMarker 模板</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-templates.freemarker"></a>14.2.2. FreeMarker Templates</h4>
<div class="paragraph">
<p translation-result="on">如果你使用 FreeMarker，请将 <code>spring.freemarker.cache</code> 设置为 <code>false</code> 。有关其他 FreeMarker 自定义选项，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/freemarker/FreeMarkerAutoConfiguration.java"><code>FreeMarkerAutoConfiguration</code></a> 。</p>
<p translation-origin="off">If you use FreeMarker, set <code>spring.freemarker.cache</code> to <code>false</code>.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/freemarker/FreeMarkerAutoConfiguration.java"><code>FreeMarkerAutoConfiguration</code></a> for other FreeMarker customization options.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.hotswapping.reload-templates.groovy" translation-result="on"><a href="howto.html#howto.hotswapping.reload-templates.groovy"></a>14.2.3. Groovy 模板</h4>
<h4 translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-templates.groovy"></a>14.2.3. Groovy Templates</h4>
<div class="paragraph">
<p translation-result="on">如果你使用 Groovy 模板，请将 <code>spring.groovy.template.cache</code> 设置为 <code>false</code> 。有关其他 Groovy 自定义选项，请参阅<a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/groovy/template/GroovyTemplateAutoConfiguration.java"><code>GroovyTemplateAutoConfiguration</code></a> 。</p>
<p translation-origin="off">If you use Groovy templates, set <code>spring.groovy.template.cache</code> to <code>false</code>.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/groovy/template/GroovyTemplateAutoConfiguration.java"><code>GroovyTemplateAutoConfiguration</code></a> for other Groovy customization options.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.hotswapping.fast-application-restarts" translation-result="on"><a href="howto.html#howto.hotswapping.fast-application-restarts"></a>14.3. 快速应用程序重启</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.fast-application-restarts"></a>14.3. Fast Application Restarts</h3>
<div class="paragraph">
<p translation-result="on"><code>spring-boot-devtools</code> 模块包括对自动应用程序重启的支持。虽然不如 <a href="https://www.jrebel.com/products/jrebel">JRebel</a> 等技术快，但它通常比“冷启动”快得多。在研究本文档后面讨论的一些更复杂的重新加载选项之前，你可能应该尝试一下。</p>
<p translation-origin="off">The <code>spring-boot-devtools</code> module includes support for automatic application restarts.
While not as fast as technologies such as <a href="https://www.jrebel.com/products/jrebel">JRebel</a> it is usually significantly faster than a “cold start”.
You should probably give it a try before investigating some of the more complex reload options discussed later in this document.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅 <a href="using.html#using.devtools">using.html</a> 部分。</p>
<p translation-origin="off">For more details, see the <a href="using.html#using.devtools">using.html</a> section.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.hotswapping.reload-java-classes-without-restarting" translation-result="on"><a href="howto.html#howto.hotswapping.reload-java-classes-without-restarting"></a>14.4. 在不重新启动容器的情况下重新加载 Java 类</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-java-classes-without-restarting"></a>14.4. Reload Java Classes without Restarting the Container</h3>
<div class="paragraph">
<p translation-result="on">许多现代 IDE（Eclipse、IDEA 等）支持字节码的热交换。因此，如果你进行不影响类或方法签名的更改，它应该干净地重新加载而没有副作用。</p>
<p translation-origin="off">Many modern IDEs (Eclipse, IDEA, and others) support hot swapping of bytecode.
Consequently, if you make a change that does not affect class or method signatures, it should reload cleanly with no side effects.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.testing" translation-result="on"><a href="howto.html#howto.testing"></a>15. 测试</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.testing"></a>15. Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 包括许多测试实用程序和支持类，以及提供常见测试依赖项的专用启动器。本节回答有关测试的常见问题。</p>
<p translation-origin="off">Spring Boot includes a number of testing utilities and support classes as well as a dedicated starter that provides common test dependencies.
This section answers common questions about testing.</p>
</div>
<div class="sect2">
<h3 id="howto.testing.with-spring-security" translation-result="on"><a href="howto.html#howto.testing.with-spring-security"></a>15.1. 使用 Spring Security 进行测试</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.testing.with-spring-security"></a>15.1. Testing With Spring Security</h3>
<div class="paragraph">
<p translation-result="on">Spring Security 支持以特定用户身份运行测试。例如，下面代码段中的测试将使用具有 <code>ADMIN</code> 角色的经过身份验证的用户运行。</p>
<p translation-origin="off">Spring Security provides support for running tests as a specific user.
For example, the test in the snippet below will run with an authenticated user that has the <code>ADMIN</code> role.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.security.test.context.support.WithMockUser;
import org.springframework.test.web.servlet.MockMvc;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;

</span><span class="fold-block">@WebMvcTest(UserController.class)
class MySecurityTests {

    @Autowired
    private MockMvc mvc;

    @Test
    @WithMockUser(roles = "ADMIN")
    void requestProtectedUrlWithUser() throws Exception {
        this.mvc.perform(get("/"));
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">Spring Security 提供了与 Spring MVC Test 的全面集成，这也可以在使用 <code>@WebMvcTest</code> 切片和 <code>MockMvc</code> 测试控制器时使用。</p>
<p translation-origin="off">Spring Security provides comprehensive integration with Spring MVC Test and this can also be used when testing controllers using the <code>@WebMvcTest</code> slice and <code>MockMvc</code>.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关 Spring Security 的测试支持的更多详细信息，请参阅 Spring Security 的<a href="https://docs.spring.io/spring-security/reference/5.6.1/servlet/test/index.html">参考文档</a>。</p>
<p translation-origin="off">For additional details on Spring Security’s testing support, see Spring Security’s <a href="https://docs.spring.io/spring-security/reference/5.6.1/servlet/test/index.html">reference documentation</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.testing.testcontainers" translation-result="on"><a href="howto.html#howto.testing.testcontainers"></a>15.2. 使用测试容器进行集成测试</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.testing.testcontainers"></a>15.2. Use Testcontainers for Integration Testing</h3>
<div class="paragraph">
<p translation-result="on"><a href="https://www.testcontainers.org/">Testcontainers</a> 库提供了一种管理在 Docker 容器内运行的服务的方法。它与 JUnit 集成，允许你编写一个可以在任何测试运行之前启动容器的测试类。Testcontainers 对于编写与真正的后端服务（如 MySQL、MongoDB、Cassandra 等）对话的集成测试特别有用。测试容器可用于 Spring Boot 测试，如下所示：</p>
<p translation-origin="off">The <a href="https://www.testcontainers.org/">Testcontainers</a> library provides a way to manage services running inside Docker containers.
It integrates with JUnit, allowing you to write a test class that can start up a container before any of the tests run.
Testcontainers is especially useful for writing integration tests that talk to a real backend service such as MySQL, MongoDB, Cassandra and others.
Testcontainers can be used in a Spring Boot test as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;
import org.testcontainers.containers.Neo4jContainer;
import org.testcontainers.junit.jupiter.Container;
import org.testcontainers.junit.jupiter.Testcontainers;

import org.springframework.boot.test.context.SpringBootTest;

</span><span class="fold-block">@SpringBootTest
@Testcontainers
class MyIntegrationTests {

    @Container
    static Neo4jContainer&lt;?&gt; neo4j = new Neo4jContainer&lt;&gt;("neo4j:4.2");

    @Test
    void myTest() {
        // ...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">这将在运行任何测试之前启动一个运行 Neo4j 的 docker 容器（如果 Docker 在本地运行）。在大多数情况下，你需要使用正在运行的容器中的详细信息来配置应用程序，例如容器 IP 或端口。</p>
<p translation-origin="off">This will start up a docker container running Neo4j (if Docker is running locally) before any of the tests are run.
In most cases, you will need to configure the application using details from the running container, such as container IP or port.</p>
</div>
<div class="paragraph">
<p translation-result="on">这可以通过静态 <code>@DynamicPropertySource</code> 方法来完成，该方法允许将动态属性值添加到 Spring 环境。</p>
<p translation-origin="off">This can be done with a static <code>@DynamicPropertySource</code> method that allows adding dynamic property values to the Spring Environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;
import org.testcontainers.containers.Neo4jContainer;
import org.testcontainers.junit.jupiter.Container;
import org.testcontainers.junit.jupiter.Testcontainers;

import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.DynamicPropertyRegistry;
import org.springframework.test.context.DynamicPropertySource;

</span><span class="fold-block">@SpringBootTest
@Testcontainers
class MyIntegrationTests {

    @Container
    static Neo4jContainer&lt;?&gt; neo4j = new Neo4jContainer&lt;&gt;("neo4j:4.2");

    @Test
    void myTest() {
        // ...
    }

    @DynamicPropertySource
    static void neo4jProperties(DynamicPropertyRegistry registry) {
        registry.add("spring.neo4j.uri", neo4j::getBoltUrl);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">上述配置允许应用程序中与 Neo4j 相关的 bean 与在 Testcontainers 管理的 Docker 容器内运行的 Neo4j 通信。</p>
<p translation-origin="off">The above configuration allows Neo4j-related beans in the application to communicate with Neo4j running inside the Testcontainers-managed Docker container.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.build" translation-result="on"><a href="howto.html#howto.build"></a>16. 建造</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.build"></a>16. Build</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 包括 Maven 和 Gradle 的构建插件。本节回答有关这些插件的常见问题。</p>
<p translation-origin="off">Spring Boot includes build plugins for Maven and Gradle.
This section answers common questions about these plugins.</p>
</div>
<div class="sect2">
<h3 id="howto.build.generate-info" translation-result="on"><a href="howto.html#howto.build.generate-info"></a>16.1. 生成构建信息</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.build.generate-info"></a>16.1. Generate Build Information</h3>
<div class="paragraph">
<p translation-result="on">Maven 插件和 Gradle 插件都允许生成包含项目坐标、名称和版本的构建信息。插件还可以配置为通过配置添加其他属性。当存在这样的文件时，Spring Boot 会自动配置一个 <code>BuildProperties</code> bean。</p>
<p translation-origin="off">Both the Maven plugin and the Gradle plugin allow generating build information containing the coordinates, name, and version of the project.
The plugins can also be configured to add additional properties through configuration.
When such a file is present, Spring Boot auto-configures a <code>BuildProperties</code> bean.</p>
</div>
<div class="paragraph">
<p translation-result="on">要使用 Maven 生成构建信息，请为 <code>build-info</code> 目标添加一个执行，如以下示例所示：</p>
<p translation-origin="off">To generate build information with Maven, add an execution for the <code>build-info</code> goal, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;2.6.3&lt;/version&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;build-info&lt;/goal&gt;
                    &lt;/goals&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">有关更多详细信息，请参阅 <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#goals-build-info">Spring Boot Maven 插件文档</a>。</p>
<p translation-origin="off">See the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#goals-build-info">Spring Boot Maven Plugin documentation</a> for more details.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">以下示例对 Gradle 执行相同操作：</p>
<p translation-origin="off">The following example does the same with Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">springBoot {
    buildInfo()
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on">有关更多详细信息，请参阅 <a href="https://docs.spring.io/spring-boot/docs/2.6.3/gradle-plugin/reference/htmlsingle/#integrating-with-actuator-build-info">Spring Boot Gradle 插件文档</a>。</p>
<p translation-origin="off">See the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/gradle-plugin/reference/htmlsingle/#integrating-with-actuator-build-info">Spring Boot Gradle Plugin documentation</a> for more details.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.generate-git-info" translation-result="on"><a href="howto.html#howto.build.generate-git-info"></a>16.2. 生成 Git 信息</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.build.generate-git-info"></a>16.2. Generate Git Information</h3>
<div class="paragraph">
<p translation-result="on">Maven 和 Gradle 都允许生成一个 <code>git.properties</code> 文件，其中包含有关构建项目时 <code>git</code> 源代码存储库状态的信息。</p>
<p translation-origin="off">Both Maven and Gradle allow generating a <code>git.properties</code> file containing information about the state of your <code>git</code> source code repository when the project was built.</p>
</div>
<div class="paragraph">
<p translation-result="on">对于 Maven 用户，<code>spring-boot-starter-parent</code> POM 包含一个预配置的插件来生成一个 <code>git.properties</code> 文件。要使用它，请将<a href="https://github.com/git-commit-id/git-commit-id-maven-plugin"><code>Git Commit Id Plugin</code></a>的以下声明添加到你的 POM：</p>
<p translation-origin="off">For Maven users, the <code>spring-boot-starter-parent</code> POM includes a pre-configured plugin to generate a <code>git.properties</code> file.
To use it, add the following declaration for the <a href="https://github.com/git-commit-id/git-commit-id-maven-plugin"><code>Git Commit Id Plugin</code></a> to your POM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;pl.project13.maven&lt;/groupId&gt;
            &lt;artifactId&gt;git-commit-id-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">Gradle 用户可以用<a href="https://plugins.gradle.org/plugin/com.gorylenko.gradle-git-properties"><code>gradle-git-properties</code></a>插件实现相同的结果，如下例所示：</p>
<p translation-origin="off">Gradle users can achieve the same result by using the <a href="https://plugins.gradle.org/plugin/com.gorylenko.gradle-git-properties"><code>gradle-git-properties</code></a> plugin, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">plugins {
    id "com.gorylenko.gradle-git-properties" version "2.2.4"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">Maven 和 Gradle 插件都允许配置 <code>git.properties</code> 中包含的属性。</p>
<p translation-origin="off">Both the Maven and Gradle plugins allow the properties that are included in <code>git.properties</code> to be configured.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on"><code>git.properties</code> 中的提交时间预计与以下格式匹配： <code>yyyy-MM-dd'T'HH:mm:ssZ</code> 。这是上面列出的两个插件的默认格式。使用这种格式可以将时间解析为 <code>Date</code> ，并且其格式在序列化为 JSON 时，由 Jackson 的日期序列化配置设置控制。</p>
<p translation-origin="off">The commit time in <code>git.properties</code> is expected to match the following format: <code>yyyy-MM-dd’T’HH:mm:ssZ</code>.
This is the default format for both plugins listed above.
Using this format lets the time be parsed into a <code>Date</code> and its format, when serialized to JSON, to be controlled by Jackson’s date serialization configuration settings.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.customize-dependency-versions" translation-result="on"><a href="howto.html#howto.build.customize-dependency-versions"></a>16.3. 自定义依赖版本</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.build.customize-dependency-versions"></a>16.3. Customize Dependency Versions</h3>
<div class="paragraph">
<p translation-result="on"><code>spring-boot-dependencies</code> POM 管理常见依赖项的版本。Maven 和 Gradle 的 Spring Boot 插件允许使用构建属性自定义这些托管依赖版本。</p>
<p translation-origin="off">The <code>spring-boot-dependencies</code> POM manages the versions of common dependencies.
The Spring Boot plugins for Maven and Gradle allow these managed dependency versions to be customized using build properties.</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<p translation-result="on">每个 Spring Boot 版本都针对这组特定的第三方依赖项进行设计和测试。覆盖版本可能会导致兼容性问题。</p>
<p translation-origin="off">Each Spring Boot release is designed and tested against this specific set of third-party dependencies.
Overriding versions may cause compatibility issues.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">要使用 Maven 覆盖依赖版本，请参阅 Maven 插件文档的<a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#using">这一部分</a>。</p>
<p translation-origin="off">To override dependency versions with Maven, see <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#using">this section</a> of the Maven plugin’s documentation.</p>
</div>
<div class="paragraph">
<p translation-result="on">要覆盖 Gradle 中的依赖版本，请参阅 Gradle 插件文档的<a href="https://docs.spring.io/spring-boot/docs/2.6.3/gradle-plugin/reference/htmlsingle/#managing-dependencies-dependency-management-plugin-customizing">这一部分</a>。</p>
<p translation-origin="off">To override dependency versions in Gradle, see <a href="https://docs.spring.io/spring-boot/docs/2.6.3/gradle-plugin/reference/htmlsingle/#managing-dependencies-dependency-management-plugin-customizing">this section</a> of the Gradle plugin’s documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.create-an-executable-jar-with-maven" translation-result="on"><a href="howto.html#howto.build.create-an-executable-jar-with-maven"></a>16.4. 使用 Maven 创建可执行 JAR</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.build.create-an-executable-jar-with-maven"></a>16.4. Create an Executable JAR with Maven</h3>
<div class="paragraph">
<p translation-result="on"><code>spring-boot-maven-plugin</code> 可用于创建可执行的“胖”JAR。如果你使用 <code>spring-boot-starter-parent</code> POM，你可以声明插件并且你的 jars 被重新打包如下：</p>
<p translation-origin="off">The <code>spring-boot-maven-plugin</code> can be used to create an executable “fat” JAR.
If you use the <code>spring-boot-starter-parent</code> POM, you can declare the plugin and your jars are repackaged as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">如果你不使用父 POM，你仍然可以用该插件。但是，你必须另外添加 <code>&lt;executions&gt;</code> 部分，如下所示：</p>
<p translation-origin="off">If you do not use the parent POM, you can still use the plugin.
However, you must additionally add an <code>&lt;executions&gt;</code> section, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;{spring-boot-version}&lt;/version&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;repackage&lt;/goal&gt;
                    &lt;/goals&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">有关完整的使用详情，请参阅<a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#repackage">插件文档</a>。</p>
<p translation-origin="off">See the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#repackage">plugin documentation</a> for full usage details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.use-a-spring-boot-application-as-dependency" translation-result="on"><a href="howto.html#howto.build.use-a-spring-boot-application-as-dependency"></a>16.5. 使用 Spring Boot 应用程序作为依赖项</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.build.use-a-spring-boot-application-as-dependency"></a>16.5. Use a Spring Boot Application as a Dependency</h3>
<div class="paragraph">
<p translation-result="on">与 war 文件一样，Spring Boot 应用程序不打算用作依赖项。如果你的应用程序包含你想与其他项目共享的类，推荐的方法是将该代码移动到单独的模块中。然后，你的应用程序和其他项目可以依赖单独的模块。</p>
<p translation-origin="off">Like a war file, a Spring Boot application is not intended to be used as a dependency.
If your application contains classes that you want to share with other projects, the recommended approach is to move that code into a separate module.
The separate module can then be depended upon by your application and other projects.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果你无法按照上述建议重新排列代码，则必须将 Spring Boot 的 Maven 和 Gradle 插件配置为生成适合用作依赖项的单独工件。可执行存档不能用作依赖项，因为<a href="executable-jar.html#executable-jar.nested-jars.jar-structure">可执行 jar 格式</a>将应用程序类打包在 <code>BOOT-INF/classes</code> 中。这意味着当可执行 jar 用作依赖项时，无法找到它们。</p>
<p translation-origin="off">If you cannot rearrange your code as recommended above, Spring Boot’s Maven and Gradle plugins must be configured to produce a separate artifact that is suitable for use as a dependency.
The executable archive cannot be used as a dependency as the <a href="executable-jar.html#executable-jar.nested-jars.jar-structure">executable jar format</a> packages application classes in <code>BOOT-INF/classes</code>.
This means that they cannot be found when the executable jar is used as a dependency.</p>
</div>
<div class="paragraph">
<p translation-result="on">要生成两个工件，一个可以用作依赖项，另一个是可执行的，必须指定一个分类器。此分类器应用于可执行存档的名称，将默认存档用作依赖项。</p>
<p translation-origin="off">To produce the two artifacts, one that can be used as a dependency and one that is executable, a classifier must be specified.
This classifier is applied to the name of the executable archive, leaving the default archive for use as a dependency.</p>
</div>
<div class="paragraph">
<p translation-result="on">在 Maven 中配置 <code>exec</code> 的分类器，可以用如下配置：</p>
<p translation-origin="off">To configure a classifier of <code>exec</code> in Maven, you can use the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;classifier&gt;exec&lt;/classifier&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.extract-specific-libraries-when-an-executable-jar-runs" translation-result="on"><a href="howto.html#howto.build.extract-specific-libraries-when-an-executable-jar-runs"></a>16.6. 可执行 Jar 运行时提取特定库</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.build.extract-specific-libraries-when-an-executable-jar-runs"></a>16.6. Extract Specific Libraries When an Executable Jar Runs</h3>
<div class="paragraph">
<p translation-result="on">可执行 jar 中的大多数嵌套库不需要解包即可运行。但是，某些库可能会出现问题。例如，JRuby 包括它自己的嵌套 jar 支持，它假定 <code>jruby-complete.jar</code> 始终可以直接作为文件直接使用。</p>
<p translation-origin="off">Most nested libraries in an executable jar do not need to be unpacked in order to run.
However, certain libraries can have problems.
For example, JRuby includes its own nested jar support, which assumes that the <code>jruby-complete.jar</code> is always directly available as a file in its own right.</p>
</div>
<div class="paragraph">
<p translation-result="on">要处理任何有问题的库，你可以标记特定的嵌套 jar 在可执行 jar 首次运行时应自动解包。这样的嵌套 jar 被写入 <code>java.io.tmpdir</code> 系统属性标识的临时目录下。</p>
<p translation-origin="off">To deal with any problematic libraries, you can flag that specific nested jars should be automatically unpacked when the executable jar first runs.
Such nested jars are written beneath the temporary directory identified by the <code>java.io.tmpdir</code> system property.</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<p translation-result="on">应注意确保你的操作系统已配置，以便在应用程序仍在运行时不会删除已解压到临时目录的 jar。</p>
<p translation-origin="off">Care should be taken to ensure that your operating system is configured so that it will not delete the jars that have been unpacked to the temporary directory while the application is still running.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">例如，要指示应使用 Maven 插件将 JRuby 标记为解包，你将添加以下配置：</p>
<p translation-origin="off">For example, to indicate that JRuby should be flagged for unpacking by using the Maven Plugin, you would add the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;requiresUnpack&gt;
                    &lt;dependency&gt;
                        &lt;groupId&gt;org.jruby&lt;/groupId&gt;
                        &lt;artifactId&gt;jruby-complete&lt;/artifactId&gt;
                    &lt;/dependency&gt;
                &lt;/requiresUnpack&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.create-a-nonexecutable-jar" translation-result="on"><a href="howto.html#howto.build.create-a-nonexecutable-jar"></a>16.7. 创建具有排除项的不可执行 JAR</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.build.create-a-nonexecutable-jar"></a>16.7. Create a Non-executable JAR with Exclusions</h3>
<div class="paragraph">
<p translation-result="on">通常，如果你将可执行文件和不可执行 jar 作为两个单独的构建产品，则可执行版本具有库 jar 中不需要的附加配置文件。例如，<code>application.yml</code> 配置文件可能会从不可执行的 JAR 中排除。</p>
<p translation-origin="off">Often, if you have an executable and a non-executable jar as two separate build products, the executable version has additional configuration files that are not needed in a library jar.
For example, the <code>application.yml</code> configuration file might be excluded from the non-executable JAR.</p>
</div>
<div class="paragraph">
<p translation-result="on">在 Maven 中，可执行 jar 必须是主要工件，你可以为库添加分类 jar，如下所示：</p>
<p translation-origin="off">In Maven, the executable jar must be the main artifact and you can add a classified jar for the library, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
            &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;id&gt;lib&lt;/id&gt;
                    &lt;phase&gt;package&lt;/phase&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;jar&lt;/goal&gt;
                    &lt;/goals&gt;
                    &lt;configuration&gt;
                        &lt;classifier&gt;lib&lt;/classifier&gt;
                        &lt;excludes&gt;
                            &lt;exclude&gt;application.yml&lt;/exclude&gt;
                        &lt;/excludes&gt;
                    &lt;/configuration&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.remote-debug-maven" translation-result="on"><a href="howto.html#howto.build.remote-debug-maven"></a>16.8. 远程调试使用 Maven 启动的 Spring Boot 应用程序</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.build.remote-debug-maven"></a>16.8. Remote Debug a Spring Boot Application Started with Maven</h3>
<div class="paragraph">
<p translation-result="on">要将远程调试器附加到使用 Maven 启动的 Spring Boot 应用程序，你可以用 <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/">maven 插件</a>的 <code>jvmArguments</code> 属性。</p>
<p translation-origin="off">To attach a remote debugger to a Spring Boot application that was started with Maven, you can use the <code>jvmArguments</code> property of the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/">maven plugin</a>.</p>
</div>
<div class="paragraph">
<p translation-result="on">有关更多详细信息，请参阅<a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#run-example-debug">此示例</a>。</p>
<p translation-origin="off">See <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#run-example-debug">this example</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib" translation-result="on"><a href="howto.html#howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib"></a> 16.9. 在不使用 spring-boot-antlib 的情况下从 Ant 构建可执行存档</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib"></a>16.9. Build an Executable Archive from Ant without Using spring-boot-antlib</h3>
<div class="paragraph">
<p translation-result="on">要使用 Ant 构建，你需要获取依赖项、编译，然后创建 jar 或 war 存档。要使其可执行，你可以用 <code>spring-boot-antlib</code> 模块，也可以按照以下说明进行操作：</p>
<p translation-origin="off">To build with Ant, you need to grab dependencies, compile, and then create a jar or war archive.
To make it executable, you can either use the <code>spring-boot-antlib</code> module or you can follow these instructions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p translation-result="on">如果你正在构建一个 jar，请将应用程序的类和资源打包到嵌套的 <code>BOOT-INF/classes</code> 目录中。如果你正在构建一个战争，像往常一样将应用程序的类打包到一个嵌套的 <code>WEB-INF/classes</code> 目录中。</p>
<p translation-origin="off">If you are building a jar, package the application’s classes and resources in a nested <code>BOOT-INF/classes</code> directory.
If you are building a war, package the application’s classes in a nested <code>WEB-INF/classes</code> directory as usual.</p>
</li>
<li>
<p translation-result="on">在嵌套的 <code>BOOT-INF/lib</code> 目录中添加运行时依赖项以用于 jar 或 <code>WEB-INF/lib</code> 用于战争。切记<strong>不要</strong>压缩存档中的条目。</p>
<p translation-origin="off">Add the runtime dependencies in a nested <code>BOOT-INF/lib</code> directory for a jar or <code>WEB-INF/lib</code> for a war.
Remember <strong>not</strong> to compress the entries in the archive.</p>
</li>
<li>
<p translation-result="on">在嵌套的 <code>BOOT-INF/lib</code> 目录中添加 <code>provided</code> 的（嵌入式容器）依赖项以用于 jar 或 <code>WEB-INF/lib-provided</code> 用于战争。切记<strong>不要</strong>压缩存档中的条目。</p>
<p translation-origin="off">Add the <code>provided</code> (embedded container) dependencies in a nested <code>BOOT-INF/lib</code> directory for a jar or <code>WEB-INF/lib-provided</code> for a war.
Remember <strong>not</strong> to compress the entries in the archive.</p>
</li>
<li>
<p translation-result="on">在存档的根目录添加 <code>spring-boot-loader</code> 类（以便 <code>Main-Class</code> 可用）。</p>
<p translation-origin="off">Add the <code>spring-boot-loader</code> classes at the root of the archive (so that the <code>Main-Class</code> is available).</p>
</li>
<li>
<p translation-result="on">使用适当的启动器（例如用于 jar 文件的 <code>JarLauncher</code> ）作为清单中的 <code>Main-Class</code> 属性，并指定它所需的其他属性作为清单条目 — 主要是通过设置 <code>Start-Class</code> 属性。</p>
<p translation-origin="off">Use the appropriate launcher (such as <code>JarLauncher</code> for a jar file) as a <code>Main-Class</code> attribute in the manifest and specify the other properties it needs as manifest entries — principally, by setting a <code>Start-Class</code> property.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p translation-result="on">以下示例显示了如何使用 Ant 构建可执行存档：</p>
<p translation-origin="off">The following example shows how to build an executable archive with Ant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;target name="build" depends="compile"&gt;
    &lt;jar destfile="target/${ant.project.name}-${spring-boot.version}.jar" compress="false"&gt;
        &lt;mappedresources&gt;
            &lt;fileset dir="target/classes" /&gt;
            &lt;globmapper from="*" to="BOOT-INF/classes/*"/&gt;
        &lt;/mappedresources&gt;
        &lt;mappedresources&gt;
            &lt;fileset dir="src/main/resources" erroronmissingdir="false"/&gt;
            &lt;globmapper from="*" to="BOOT-INF/classes/*"/&gt;
        &lt;/mappedresources&gt;
        &lt;mappedresources&gt;
            &lt;fileset dir="${lib.dir}/runtime" /&gt;
            &lt;globmapper from="*" to="BOOT-INF/lib/*"/&gt;
        &lt;/mappedresources&gt;
        &lt;zipfileset src="${lib.dir}/loader/spring-boot-loader-jar-${spring-boot.version}.jar" /&gt;
        &lt;manifest&gt;
            &lt;attribute name="Main-Class" value="org.springframework.boot.loader.JarLauncher" /&gt;
            &lt;attribute name="Start-Class" value="${start-class}" /&gt;
        &lt;/manifest&gt;
    &lt;/jar&gt;
&lt;/target&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.traditional-deployment" translation-result="on"><a href="howto.html#howto.traditional-deployment"></a>17. 传统部署</h2>
<h2 translation-origin="off"><a class="anchor" href="howto.html#howto.traditional-deployment"></a>17. Traditional Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-result="on">Spring Boot 支持传统部署以及更现代的部署形式。本节回答有关传统部署的常见问题。</p>
<p translation-origin="off">Spring Boot supports traditional deployment as well as more modern forms of deployment.
This section answers common questions about traditional deployment.</p>
</div>
<div class="sect2">
<h3 id="howto.traditional-deployment.war" translation-result="on"><a href="howto.html#howto.traditional-deployment.war"></a>17.1. 创建可部署的战争文件</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.traditional-deployment.war"></a>17.1. Create a Deployable War File</h3>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<p translation-result="on">由于 Spring WebFlux 不严格依赖 servlet API，并且应用程序默认部署在嵌入式 Reactor Netty 服务器上，因此 WebFlux 应用程序不支持 War 部署。</p>
<p translation-origin="off">Because Spring WebFlux does not strictly depend on the servlet API and applications are deployed by default on an embedded Reactor Netty server, War deployment is not supported for WebFlux applications.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">生成可部署的 war 文件的第一步是提供 <code>SpringBootServletInitializer</code> 子类并覆盖其 <code>configure</code> 方法。这样做会利用 Spring Framework 的 servlet 3.0 支持，并允许你在应用程序由 servlet 容器启动时对其进行配置。通常，你应该更新应用程序的主类以扩展 <code>SpringBootServletInitializer</code> ，如以下示例所示：</p>
<p translation-origin="off">The first step in producing a deployable war file is to provide a <code>SpringBootServletInitializer</code> subclass and override its <code>configure</code> method.
Doing so makes use of Spring Framework’s servlet 3.0 support and lets you configure your application when it is launched by the servlet container.
Typically, you should update your application’s main class to extend <code>SpringBootServletInitializer</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(MyApplication.class);
    }

    public static void main(String[] args) {
        SpringApplication.run(MyApplication.class, args);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">下一步是更新你的构建配置，以便你的项目生成一个 war 文件而不是 jar 文件。如果你使用 Maven 和 <code>spring-boot-starter-parent</code> （它为你配置了 Maven 的 war 插件），你只需要修改 <code>pom.xml</code> ，将打包改为 war，如下：</p>
<p translation-origin="off">The next step is to update your build configuration such that your project produces a war file rather than a jar file.
If you use Maven and <code>spring-boot-starter-parent</code> (which configures Maven’s war plugin for you), all you need to do is to modify <code>pom.xml</code> to change the packaging to war, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;packaging&gt;war&lt;/packaging&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">如果使用 Gradle，需要修改 <code>build.gradle</code> ，将 war 插件应用到项目中，如下：</p>
<p translation-origin="off">If you use Gradle, you need to modify <code>build.gradle</code> to apply the war plugin to the project, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">apply plugin: 'war'</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">该过程的最后一步是确保嵌入式 servlet 容器不会干扰部署 war 文件的 servlet 容器。为此，你需要将嵌入式 servlet 容器依赖项标记为已提供。</p>
<p translation-origin="off">The final step in the process is to ensure that the embedded servlet container does not interfere with the servlet container to which the war file is deployed.
To do so, you need to mark the embedded servlet container dependency as being provided.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果你使用 Maven，以下示例将 servlet 容器（在本例中为 Tomcat）标记为已提供：</p>
<p translation-origin="off">If you use Maven, the following example marks the servlet container (Tomcat, in this case) as being provided:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;!-- ... --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
        &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;!-- ... --&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">如果你使用 Gradle，以下示例将 servlet 容器（在本例中为 Tomcat）标记为已提供：</p>
<p translation-origin="off">If you use Gradle, the following example marks the servlet container (Tomcat, in this case) as being provided:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">dependencies {
    // ...
    providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat'
    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-result="on"><code>providedRuntime</code> 优先于 Gradle 的 <code>compileOnly</code> 配置。除其他限制外，<code>compileOnly</code> 依赖项不在测试类路径上，因此任何基于 Web 的集成测试都会失败。</p>
<p translation-origin="off"><code>providedRuntime</code> is preferred to Gradle’s <code>compileOnly</code> configuration.
Among other limitations, <code>compileOnly</code> dependencies are not on the test classpath, so any web-based integration tests fail.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">如果你使用 <a href="build-tool-plugins.html#build-tool-plugins">Spring Boot 构建工具</a>，将嵌入式 servlet 容器依赖项标记为提供会生成一个可执行的 war 文件，其中提供的依赖项打包在 <code>lib-provided</code> 目录中。这意味着，除了可以部署到 servlet 容器之外，你还可以通过在命令行上使用 <code>java -jar</code> 来运行你的应用程序。</p>
<p translation-origin="off">If you use the <a href="build-tool-plugins.html#build-tool-plugins">Spring Boot build tools</a>, marking the embedded servlet container dependency as provided produces an executable war file with the provided dependencies packaged in a <code>lib-provided</code> directory.
This means that, in addition to being deployable to a servlet container, you can also run your application by using <code>java -jar</code> on the command line.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.traditional-deployment.convert-existing-application" translation-result="on"><a href="howto.html#howto.traditional-deployment.convert-existing-application"></a>17.2. 将现有应用程序转换为 Spring Boot</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.traditional-deployment.convert-existing-application"></a>17.2. Convert an Existing Application to Spring Boot</h3>
<div class="paragraph">
<p translation-result="on">要将现有的非 Web Spring 应用程序转换为 Spring Boot 应用程序，请替换创建 <code>ApplicationContext</code> 的代码并将其替换为对 <code>SpringApplication</code> 或 <code>SpringApplicationBuilder</code> 的调用。Spring MVC Web 应用程序通常可以先创建一个可部署的 war 应用程序，然后再将其迁移到可执行的 war 或 jar 中。请参阅<a href="https://spring.io/guides/gs/convert-jar-to-war/">关于将 jar 转换为战争的入门指南</a>。</p>
<p translation-origin="off">To convert an existing non-web Spring application to a Spring Boot application, replace the code that creates your <code>ApplicationContext</code> and replace it with calls to <code>SpringApplication</code> or <code>SpringApplicationBuilder</code>.
Spring MVC web applications are generally amenable to first creating a deployable war application and then migrating it later to an executable war or jar.
See the <a href="https://spring.io/guides/gs/convert-jar-to-war/">Getting Started Guide on Converting a jar to a war</a>.</p>
</div>
<div class="paragraph">
<p translation-result="on">要通过扩展 <code>SpringBootServletInitializer</code> （例如，在名为 <code>Application</code> 的类中）并添加 Spring Boot <code>@SpringBootApplication</code> 注解来创建可部署的战争，请使用类似于以下示例中所示的代码：</p>
<p translation-origin="off">To create a deployable war by extending <code>SpringBootServletInitializer</code> (for example, in a class called <code>Application</code>) and adding the Spring Boot <code>@SpringBootApplication</code> annotation, use code similar to that shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        // Customize the application or call application.sources(...) to add sources
        // Since our example is itself a @Configuration class (via @SpringBootApplication)
        // we actually do not need to override this method.
        return application;
    }


}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">请记住，你在 <code>sources</code> 中输入的任何内容都只是 Spring <code>ApplicationContext</code> 。通常，任何已经工作的东西都应该在这里工作。可能有一些 bean 你可以稍后删除并让 Spring Boot 为它们提供自己的默认值，但在你需要这样做之前应该可以让某些东西工作。</p>
<p translation-origin="off">Remember that, whatever you put in the <code>sources</code> is merely a Spring <code>ApplicationContext</code>.
Normally, anything that already works should work here.
There might be some beans you can remove later and let Spring Boot provide its own defaults for them, but it should be possible to get something working before you need to do that.</p>
</div>
<div class="paragraph">
<p translation-result="on">静态资源可以移动到类路径根目录中的 <code>/public</code> （或 <code>/static</code> 或 <code>/resources</code> 或 <code>/META-INF/resources</code> ）。这同样适用于 <code>messages.properties</code> （Spring Boot 在类路径的根目录中自动检测到）。</p>
<p translation-origin="off">Static resources can be moved to <code>/public</code> (or <code>/static</code> or <code>/resources</code> or <code>/META-INF/resources</code>) in the classpath root.
The same applies to <code>messages.properties</code> (which Spring Boot automatically detects in the root of the classpath).</p>
</div>
<div class="paragraph">
<p translation-result="on">Spring <code>DispatcherServlet</code> 和 Spring Security 的普通用法应该不需要进一步的更改。如果你的应用程序中有其他功能（例如，使用其他 servlet 或过滤器），你可能需要通过替换 <code>web.xml</code> 中的这些元素来向你的 <code>Application</code> 上下文添加一些配置，如下所示：</p>
<p translation-origin="off">Vanilla usage of Spring <code>DispatcherServlet</code> and Spring Security should require no further changes.
If you have other features in your application (for instance, using other servlets or filters), you may need to add some configuration to your <code>Application</code> context, by replacing those elements from the <code>web.xml</code>, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on"><code>Servlet</code> 或 <code>ServletRegistrationBean</code> 类型的 <code>@Bean</code> 将该 bean 安装在容器中，就好像它是 <code>web.xml</code> 中的 <code>&lt;servlet/&gt;</code> 和 <code>&lt;servlet-mapping/&gt;</code> 一样。</p>
<p translation-origin="off">A <code>@Bean</code> of type <code>Servlet</code> or <code>ServletRegistrationBean</code> installs that bean in the container as if it were a <code>&lt;servlet/&gt;</code> and <code>&lt;servlet-mapping/&gt;</code> in <code>web.xml</code>.</p>
</li>
<li>
<p translation-result="on"><code>Filter</code> 或 <code>FilterRegistrationBean</code> 类型的 <code>@Bean</code> 行为类似（作为 <code>&lt;filter/&gt;</code> 和 <code>&lt;filter-mapping/&gt;</code> ）。</p>
<p translation-origin="off">A <code>@Bean</code> of type <code>Filter</code> or <code>FilterRegistrationBean</code> behaves similarly (as a <code>&lt;filter/&gt;</code> and <code>&lt;filter-mapping/&gt;</code>).</p>
</li>
<li>
<p translation-result="on">XML 文件中的 <code>ApplicationContext</code> 可以通过 <code>Application</code> 中的 <code>@ImportResource</code> 添加。或者，已经大量使用注解配置的情况可以在几行中重新创建为 <code>@Bean</code> 定义。</p>
<p translation-origin="off">An <code>ApplicationContext</code> in an XML file can be added through an <code>@ImportResource</code> in your <code>Application</code>.
Alternatively, cases where annotation configuration is heavily used already can be recreated in a few lines as <code>@Bean</code> definitions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">一旦 war 文件开始工作，你可以通过向 <code>Application</code> 添加一个 <code>main</code> 方法使其可执行，如下例所示：</p>
<p translation-origin="off">Once the war file is working, you can make it executable by adding a <code>main</code> method to your <code>Application</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static void main(String[] args) {
    SpringApplication.run(MyApplication.class, args);
}
</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-result="on">如果你打算将应用程序作为战争或可执行应用程序启动，则需要在 <code>SpringBootServletInitializer</code> 回调可用的方法和类似于以下的类的 <code>main</code> 方法中共享构建器的自定义：</p>
<p translation-origin="off">If you intend to start your application as a war or as an executable application, you need to share the customizations of the builder in a method that is both available to the <code>SpringBootServletInitializer</code> callback and in the <code>main</code> method in a class similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.Banner;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {
        return customizerBuilder(builder);
    }

    public static void main(String[] args) {
        customizerBuilder(new SpringApplicationBuilder()).run(args);
    }

    private static SpringApplicationBuilder customizerBuilder(SpringApplicationBuilder builder) {
        return builder.sources(MyApplication.class).bannerMode(Banner.Mode.OFF);
    }

}
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-result="on">应用程序可以分为不止一类：</p>
<p translation-origin="off">Applications can fall into more than one category:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-result="on">没有 <code>web.xml</code> 的 Servlet 3.0+ 应用程序。</p>
<p translation-origin="off">Servlet 3.0+ applications with no <code>web.xml</code>.</p>
</li>
<li>
<p translation-result="on">带有 <code>web.xml</code> 的应用程序。</p>
<p translation-origin="off">Applications with a <code>web.xml</code>.</p>
</li>
<li>
<p translation-result="on">具有上下文层次结构的应用程序。</p>
<p translation-origin="off">Applications with a context hierarchy.</p>
</li>
<li>
<p translation-result="on">没有上下文层次结构的应用程序。</p>
<p translation-origin="off">Applications without a context hierarchy.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-result="on">所有这些都应该可以翻译，但每个都可能需要稍微不同的技术。</p>
<p translation-origin="off">All of these should be amenable to translation, but each might require slightly different techniques.</p>
</div>
<div class="paragraph">
<p translation-result="on">如果 Servlet 3.0+ 应用程序已经使用 Spring Servlet 3.0+ 初始化器支持类，它们可能会很容易转换。通常，现有 <code>WebApplicationInitializer</code> 中的所有代码都可以移动到 <code>SpringBootServletInitializer</code> 中。如果你现有的应用程序有多个 <code>ApplicationContext</code> （例如，如果它使用 <code>AbstractDispatcherServletInitializer</code> ），那么你可以将所有上下文源合并到一个 <code>SpringApplication</code> 中。你可能遇到的主要复杂情况是如果组合不起作用并且你需要维护上下文层次结构。有关示例，请参阅<a href="howto.html#howto.application.context-hierarchy">有关构建层次结构的条目</a>。包含 Web 特定功能的现有父上下文通常需要分解，以便所有 <code>ServletContextAware</code> 组件都在子上下文中。</p>
<p translation-origin="off">Servlet 3.0+ applications might translate pretty easily if they already use the Spring Servlet 3.0+ initializer support classes.
Normally, all the code from an existing <code>WebApplicationInitializer</code> can be moved into a <code>SpringBootServletInitializer</code>.
If your existing application has more than one <code>ApplicationContext</code> (for example, if it uses <code>AbstractDispatcherServletInitializer</code>) then you might be able to combine all your context sources into a single <code>SpringApplication</code>.
The main complication you might encounter is if combining does not work and you need to maintain the context hierarchy.
See the <a href="howto.html#howto.application.context-hierarchy">entry on building a hierarchy</a> for examples.
An existing parent context that contains web-specific features usually needs to be broken up so that all the <code>ServletContextAware</code> components are in the child context.</p>
</div>
<div class="paragraph">
<p translation-result="on">尚未成为 Spring 应用程序的应用程序可以转换为 Spring Boot 应用程序，前面提到的指南可能会有所帮助。但是，你可能还会遇到问题。在这种情况下，我们建议<a href="https://stackoverflow.com/questions/tagged/spring-boot">在 Stack Overflow 上使用 <code>spring-boot</code> 标签提问</a>。</p>
<p translation-origin="off">Applications that are not already Spring applications might be convertible to Spring Boot applications, and the previously mentioned guidance may help.
However, you may yet encounter problems.
In that case, we suggest <a href="https://stackoverflow.com/questions/tagged/spring-boot">asking questions on Stack Overflow with a tag of <code>spring-boot</code></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.traditional-deployment.weblogic" translation-result="on"><a href="howto.html#howto.traditional-deployment.weblogic"></a>17.3. 将 WAR 部署到 WebLogic</h3>
<h3 translation-origin="off"><a class="anchor" href="howto.html#howto.traditional-deployment.weblogic"></a>17.3. Deploying a WAR to WebLogic</h3>
<div class="paragraph">
<p translation-result="on">要将 Spring Boot 应用程序部署到 WebLogic，你必须确保你的 servlet 初始化程序<strong>直接</strong>实现 <code>WebApplicationInitializer</code> （即使你从已经实现它的基类扩展）。</p>
<p translation-origin="off">To deploy a Spring Boot application to WebLogic, you must ensure that your servlet initializer <strong>directly</strong> implements <code>WebApplicationInitializer</code> (even if you extend from a base class that already implements it).</p>
</div>
<div class="paragraph">
<p translation-result="on">WebLogic 的典型初始化程序应类似于以下示例：</p>
<p translation-origin="off">A typical initializer for WebLogic should resemble the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;
import org.springframework.web.WebApplicationInitializer;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication extends SpringBootServletInitializer implements WebApplicationInitializer {

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-result="on">如果使用 Logback，还需要告诉 WebLogic 更喜欢打包的版本，而不是服务器预装的版本。你可以通过添加具有以下内容的 <code>WEB-INF/weblogic.xml</code> 文件来执行此操作：</p>
<p translation-origin="off">If you use Logback, you also need to tell WebLogic to prefer the packaged version rather than the version that was pre-installed with the server.
You can do so by adding a <code>WEB-INF/weblogic.xml</code> file with the following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wls:weblogic-web-app
    xmlns:wls="http://xmlns.oracle.com/weblogic/weblogic-web-app"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
        https://java.sun.com/xml/ns/javaee/ejb-jar_3_0.xsd
        http://xmlns.oracle.com/weblogic/weblogic-web-app
        https://xmlns.oracle.com/weblogic/weblogic-web-app/1.4/weblogic-web-app.xsd"&gt;
    &lt;wls:container-descriptor&gt;
        &lt;wls:prefer-application-packages&gt;
            &lt;wls:package-name&gt;org.slf4j&lt;/wls:package-name&gt;
        &lt;/wls:prefer-application-packages&gt;
    &lt;/wls:container-descriptor&gt;
&lt;/wls:weblogic-web-app&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
最后更新于 2022-01-20 14:11:26 UTC
</div>
</div>
</div>
</div>
</div>
<script data-cfasync="false" src="../../../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>if (window.parent == window) {(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-2728886-23', 'auto', {'siteSpeedSampleRate': 100});ga('send', 'pageview');}</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/v652eace1692a40cfa3763df669d7439c1639079717194" integrity="sha512-Gi7xpJR8tSkrpF7aordPZQlW2DLtzUlZcumS8dMQjwDHEnw9I7ZLyiOj/6tZStRBGtGgN6ceN6cMH8z7etPGlw==" data-cf-beacon="{&quot;rayId&quot;:&quot;6d1fded6f88f7c65&quot;,&quot;token&quot;:&quot;bffcb8a918ae4755926f76178bfbd26b&quot;,&quot;version&quot;:&quot;2021.12.0&quot;,&quot;si&quot;:100}" crossorigin="anonymous"></script>




</body></html>
