<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>“How-to” Guides</title>
<link rel="stylesheet" href="css/site.css">
<script src="js/setup.js"></script><script defer="" src="js/site.js"></script>
<script type="application/json" id="anchor-rewrite">
{
"actuator-properties":"application-properties.actuator",
"auto-configuration-classes-from-actuator":"auto-configuration-classes.actuator",
"auto-configuration-classes-from-autoconfigure-module":"auto-configuration-classes.core",
"boot-documentation":"documentation",
"boot-documentation-about":"documentation.about",
"boot-documentation-advanced":"documentation.advanced",
"boot-documentation-first-steps":"documentation.first-steps",
"boot-documentation-getting-help":"documentation.getting-help",
"boot-documentation-learning":"documentation.features",
"boot-documentation-production":"documentation.actuator",
"boot-documentation-upgrading":"documentation.upgrading",
"boot-documentation-workingwith":"documentation.using",
"boot-features":"features",
"boot-features-activemq":"features.messaging.jms.activemq",
"boot-features-adding-active-profiles":"features.profiles.adding-active-profiles",
"boot-features-amqp":"features.messaging.amqp",
"boot-features-application-admin":"features.spring-application.admin",
"boot-features-application-arguments":"features.spring-application.application-arguments",
"boot-features-application-availability":"features.spring-application.application-availability",
"boot-features-application-availability-liveness-state":"features.spring-application.application-availability.liveness",
"boot-features-application-availability-managing":"features.spring-application.application-availability.managing",
"boot-features-application-availability-readiness-state":"features.spring-application.application-availability.readiness",
"boot-features-application-events-and-listeners":"features.spring-application.application-events-and-listeners",
"boot-features-application-exit":"features.spring-application.application-exit",
"boot-features-application-startup-tracking":"features.spring-application.startup-tracking",
"boot-features-artemis":"features.messaging.jms.artemis",
"boot-features-banner":"features.spring-application.banner",
"boot-features-bean-conditions":"features.developing-auto-configuration.condition-annotations.bean-conditions",
"boot-features-caching":"features.caching",
"boot-features-caching-provider":"features.caching.provider",
"boot-features-caching-provider-caffeine":"features.caching.provider.caffeine",
"boot-features-caching-provider-couchbase":"features.caching.provider.couchbase",
"boot-features-caching-provider-ehcache2":"features.caching.provider.ehcache2",
"boot-features-caching-provider-generic":"features.caching.provider.generic",
"boot-features-caching-provider-hazelcast":"features.caching.provider.hazelcast",
"boot-features-caching-provider-infinispan":"features.caching.provider.infinispan",
"boot-features-caching-provider-jcache":"features.caching.provider.jcache",
"boot-features-caching-provider-none":"features.caching.provider.none",
"boot-features-caching-provider-redis":"features.caching.provider.redis",
"boot-features-caching-provider-simple":"features.caching.provider.simple",
"boot-features-cassandra":"features.nosql.cassandra",
"boot-features-class-conditions":"features.developing-auto-configuration.condition-annotations.class-conditions",
"boot-features-command-line-runner":"features.spring-application.command-line-runner",
"boot-features-condition-annotations":"features.developing-auto-configuration.condition-annotations",
"boot-features-configfileapplicationcontextinitializer-test-utility":"features.testing.utilities.config-data-application-context-initializer",
"boot-features-configure-datasource":"features.sql.datasource",
"boot-features-connect-to-production-database":"features.sql.datasource.production",
"boot-features-connect-to-production-database-configuration":"features.sql.datasource.configuration",
"boot-features-connect-to-production-database-connection-pool":"features.sql.datasource.connection-pool",
"boot-features-connecting-to-a-jndi-datasource":"features.sql.datasource.jndi",
"boot-features-connecting-to-cassandra":"features.nosql.cassandra.connecting",
"boot-features-connecting-to-couchbase":"features.nosql.couchbase.connecting",
"boot-features-connecting-to-elasticsearch-reactive-rest":"features.nosql.elasticsearch.connecting-using-reactive-rest",
"boot-features-connecting-to-elasticsearch-rest":"features.nosql.elasticsearch.connecting-using-rest",
"boot-features-connecting-to-elasticsearch-spring-data":"features.nosql.elasticsearch.connecting-using-spring-data",
"boot-features-connecting-to-influxdb":"features.nosql.influxdb.connecting",
"boot-features-connecting-to-mongodb":"features.nosql.mongodb.connecting",
"boot-features-connecting-to-neo4j":"features.nosql.neo4j.connecting",
"boot-features-connecting-to-redis":"features.nosql.redis.connecting",
"boot-features-connecting-to-solr":"features.nosql.solr.connecting",
"boot-features-container-images":"features.container-images",
"boot-features-container-images-building":"features.container-images.building",
"boot-features-container-images-buildpacks":"features.container-images.building.buildpacks",
"boot-features-container-images-docker":"features.container-images.building.dockerfiles",
"boot-features-cors":"features.developing-web-applications.spring-mvc.cors",
"boot-features-couchbase":"features.nosql.couchbase",
"boot-features-creating-and-dropping-jpa-databases":"features.sql.jpa-and-spring-data.creating-and-dropping",
"boot-features-custom-log-configuration":"features.logging.custom-log-configuration",
"boot-features-custom-log-groups":"features.logging.log-groups",
"boot-features-custom-log-levels":"features.logging.log-levels",
"boot-features-custom-starter":"features.developing-auto-configuration.custom-starter",
"boot-features-custom-starter-configuration-keys":"features.developing-auto-configuration.custom-starter.configuration-keys",
"boot-features-custom-starter-module-autoconfigure":"features.developing-auto-configuration.custom-starter.autoconfigure-module",
"boot-features-custom-starter-module-starter":"features.developing-auto-configuration.custom-starter.starter-module",
"boot-features-custom-starter-naming":"features.developing-auto-configuration.custom-starter.naming",
"boot-features-customizing-configurableservletwebserverfactory-directly":"features.developing-web-applications.embedded-container.customizing.direct",
"boot-features-customizing-embedded-containers":"features.developing-web-applications.embedded-container.customizing",
"boot-features-customizing-spring-application":"features.spring-application.customizing-spring-application",
"boot-features-data-jdbc":"features.sql.jdbc",
"boot-features-developing-auto-configuration":"features.developing-auto-configuration",
"boot-features-developing-web-applications":"features.developing-web-applications",
"boot-features-elasticsearch":"features.nosql.elasticsearch",
"boot-features-email":"features.email",
"boot-features-embedded-container":"features.developing-web-applications.embedded-container",
"boot-features-embedded-container-application-context":"features.developing-web-applications.embedded-container.application-context",
"boot-features-embedded-container-context-initializer":"features.developing-web-applications.embedded-container.context-initializer",
"boot-features-embedded-container-servlets-filters-listeners":"features.developing-web-applications.embedded-container.servlets-filters-listeners",
"boot-features-embedded-container-servlets-filters-listeners-beans":"features.developing-web-applications.embedded-container.servlets-filters-listeners.beans",
"boot-features-embedded-container-servlets-filters-listeners-scanning":"features.developing-web-applications.embedded-container.context-initializer.scanning",
"boot-features-embedded-database-support":"features.sql.datasource.embedded",
"boot-features-embedded-kafka":"features.messaging.kafka.embedded",
"boot-features-encrypting-properties":"features.external-config.encrypting",
"boot-features-entity-classes":"features.sql.jpa-and-spring-data.entity-classes",
"boot-features-error-handling":"features.developing-web-applications.spring-mvc.error-handling",
"boot-features-error-handling-custom-error-pages":"features.developing-web-applications.spring-mvc.error-handling.error-pages",
"boot-features-error-handling-mapping-error-pages-without-mvc":"features.developing-web-applications.spring-mvc.error-handling.error-pages-without-spring-mvc",
"boot-features-error-handling-war-deployment":"features.developing-web-applications.spring-mvc.error-handling.in-a-war-deployment",
"boot-features-external-config":"features.external-config",
"boot-features-external-config-3rd-party-configuration":"features.external-config.typesafe-configuration-properties.third-party-configuration",
"boot-features-external-config-application-json":"features.external-config.application-json",
"boot-features-external-config-application-property-files":"features.external-config.files",
"boot-features-external-config-command-line-args":"features.external-config.command-line-args",
"boot-features-external-config-complex-type-merge":"features.external-config.typesafe-configuration-properties.merging-complex-types",
"boot-features-external-config-constructor-binding":"features.external-config.typesafe-configuration-properties.constructor-binding",
"boot-features-external-config-conversion":"features.external-config.typesafe-configuration-properties.conversion",
"boot-features-external-config-conversion-datasize":"features.external-config.typesafe-configuration-properties.conversion.data-sizes",
"boot-features-external-config-conversion-duration":"features.external-config.typesafe-configuration-properties.conversion.durations",
"boot-features-external-config-conversion-period":"features.external-config.typesafe-configuration-properties.conversion.periods",
"boot-features-external-config-enabling":"features.external-config.typesafe-configuration-properties.enabling-annotated-types",
"boot-features-external-config-exposing-yaml-to-spring":"features.external-config.yaml.directly-loading",
"boot-features-external-config-file-activation-properties":"features.external-config.files.activation-properties",
"boot-features-external-config-files":"features.external-config.files",
"boot-features-external-config-files-configtree":"features.external-config.files.configtree",
"boot-features-external-config-files-importing":"features.external-config.files.importing",
"boot-features-external-config-files-importing-extensionless":"features.external-config.file.importing-extensionless",
"boot-features-external-config-files-multi-document":"features.external-config.files.multi-document",
"boot-features-external-config-files-profile-specific":"features.external-config.files.profile-specific",
"boot-features-external-config-files-wildcards":"features.external-config.files.wildcard-locations",
"boot-features-external-config-java-bean-binding":"features.external-config.typesafe-configuration-properties.java-bean-binding",
"boot-features-external-config-loading-yaml":"features.external-config.yaml.directly-loading",
"boot-features-external-config-optional-prefix":"features.external-config.files.optional-prefix",
"boot-features-external-config-placeholders-in-properties":"features.external-config.files.property-placeholders",
"boot-features-external-config-random-values":"features.external-config.random-values",
"boot-features-external-config-relaxed-binding":"features.external-config.typesafe-configuration-properties.relaxed-binding",
"boot-features-external-config-relaxed-binding-from-environment-variables":"features.external-config.typesafe-configuration-properties.relaxed-binding.environment-variables",
"boot-features-external-config-relaxed-binding-maps":"features.external-config.typesafe-configuration-properties.relaxed-binding.maps",
"boot-features-external-config-system-environment":"features.external-config.system-environment",
"boot-features-external-config-typesafe-configuration-properties":"features.external-config.typesafe-configuration-properties",
"boot-features-external-config-using":"features.external-config.typesafe-configuration-properties.using-annotated-types",
"boot-features-external-config-validation":"features.external-config.typesafe-configuration-properties.validation",
"boot-features-external-config-vs-value":"features.external-config.typesafe-configuration-properties.vs-value-annotation",
"boot-features-external-config-yaml":"features.external-config.yaml",
"boot-features-external-config-yaml-to-properties":"features.external-config.yaml.mapping-to-properties",
"boot-features-fluent-builder-api":"features.spring-application.fluent-builder-api",
"boot-features-graceful-shutdown":"features.graceful-shutdown",
"boot-features-hazelcast":"features.hazelcast",
"boot-features-influxdb":"features.nosql.influxdb",
"boot-features-integration":"features.spring-integration",
"boot-features-internationalization":"features.internationalization",
"boot-features-jersey":"features.developing-web-applications.jersey",
"boot-features-jms":"features.messaging.jms",
"boot-features-jms-jndi":"features.messaging.jms.jndi",
"boot-features-jmx":"features.jmx",
"boot-features-jooq":"features.sql.jooq",
"boot-features-jooq-codegen":"features.sql.jooq.codegen",
"boot-features-jooq-customizing":"features.sql.jooq.customizing",
"boot-features-jooq-dslcontext":"features.sql.jooq.dslcontext",
"boot-features-jooq-sqldialect":"features.sql.jooq.sqldialect",
"boot-features-jpa-and-spring-data":"features.sql.jpa-and-spring-data",
"boot-features-jpa-in-web-environment":"features.sql.jpa-and-spring-data.open-entity-manager-in-view",
"boot-features-json":"features.json",
"boot-features-json-components":"features.developing-web-applications.spring-mvc.json",
"boot-features-json-gson":"features.json.gson",
"boot-features-json-jackson":"features.json.jackson",
"boot-features-json-json-b":"features.json.json-b",
"boot-features-jsp-limitations":"features.developing-web-applications.embedded-container.jsp-limitations",
"boot-features-jta":"features.jta",
"boot-features-jta-atomikos":"features.jta.atomikos",
"boot-features-jta-javaee":"features.jta.javaee",
"boot-features-jta-mixed-jms":"features.jta.mixing-xa-and-non-xa-connections",
"boot-features-jta-supporting-alternative-embedded":"features.jta.supporting-alternative-embedded-transaction-manager",
"boot-features-kafka":"features.messaging.kafka",
"boot-features-kafka-extra-props":"features.messaging.kafka.additional-properties",
"boot-features-kafka-receiving-a-message":"features.messaging.kafka.receiving",
"boot-features-kafka-sending-a-message":"features.messaging.kafka.sending",
"boot-features-kafka-streams":"features.messaging.kafka.streams",
"boot-features-kotlin":"features.kotlin",
"boot-features-kotlin-api":"features.kotlin.api",
"boot-features-kotlin-api-extensions":"features.kotlin.api.extensions",
"boot-features-kotlin-api-runapplication":"features.kotlin.api.run-application",
"boot-features-kotlin-configuration-properties":"features.kotlin.configuration-properties",
"boot-features-kotlin-dependency-management":"features.kotlin.dependency-management",
"boot-features-kotlin-null-safety":"features.kotlin.null-safety",
"boot-features-kotlin-requirements":"features.kotlin.requirements",
"boot-features-kotlin-resources":"features.kotlin.resources",
"boot-features-kotlin-resources-examples":"features.kotlin.resources.examples",
"boot-features-kotlin-resources-further-reading":"features.kotlin.resources.further-reading",
"boot-features-kotlin-testing":"features.kotlin.testing",
"boot-features-lazy-initialization":"features.spring-application.lazy-initialization",
"boot-features-ldap":"features.nosql.ldap",
"boot-features-ldap-connecting":"features.nosql.ldap.connecting",
"boot-features-ldap-embedded":"features.nosql.ldap.embedded",
"boot-features-ldap-spring-data-repositories":"features.nosql.ldap.repositories",
"boot-features-locating-auto-configuration-candidates":"features.developing-auto-configuration.locating-auto-configuration-candidates",
"boot-features-log-shutdown-hook":"features.logging.shutdown-hook",
"boot-features-logback-environment-properties":"features.logging.logback-extensions.environment-properties",
"boot-features-logback-extensions":"features.logging.logback-extensions",
"boot-features-logback-extensions-profile-specific":"features.logging.logback-extensions.profile-specific",
"boot-features-logging":"features.logging",
"boot-features-logging-color-coded-output":"features.logging.console-output.color-coded",
"boot-features-logging-console-output":"features.logging.console-output",
"boot-features-logging-file-output":"features.logging.file-output",
"boot-features-logging-file-rotation":"features.logging.file-rotation",
"boot-features-logging-format":"features.logging.log-format",
"boot-features-messaging":"features.messaging",
"boot-features-mongo-embedded":"features.nosql.mongodb.embedded",
"boot-features-mongo-template":"features.nosql.mongodb.template",
"boot-features-mongodb":"features.nosql.mongodb",
"boot-features-neo4j":"features.nosql.neo4j",
"boot-features-nosql":"features.nosql",
"boot-features-output-capture-test-utility":"features.testing.utilities.output-capture",
"boot-features-profile-specific-configuration":"features.profiles.profile-specific-configuration-files",
"boot-features-profiles":"features.profiles",
"boot-features-profiles-groups":"features.profiles.groups",
"boot-features-programmatic-embedded-container-customization":"features.developing-web-applications.embedded-container.customizing.programmatic",
"boot-features-programmatically-setting-profiles":"features.profiles.programmatically-setting-profiles",
"boot-features-property-conditions":"features.developing-auto-configuration.condition-annotations.property-conditions",
"boot-features-quartz":"features.quartz",
"boot-features-r2dbc":"features.sql.r2dbc",
"boot-features-r2dbc-embedded-database":"features.sql.r2dbc.embedded",
"boot-features-r2dbc-using-database-client":"features.sql.r2dbc.using-database-client",
"boot-features-rabbitmq":"features.messaging.amqp.rabbitmq",
"boot-features-reactive-server":"features.developing-web-applications.reactive-server",
"boot-features-reactive-server-resources":"features.developing-web-applications.reactive-server-resources-configuration",
"boot-features-redis":"features.nosql.redis",
"boot-features-resource-conditions":"features.developing-auto-configuration.condition-annotations.resource-conditions",
"boot-features-rest-templates-test-utility":"features.testing.utilities.test-rest-template",
"boot-features-resttemplate":"features.resttemplate",
"boot-features-resttemplate-customization":"features.resttemplate.customization",
"boot-features-rsocket":"features.rsocket",
"boot-features-rsocket-messaging":"features.rsocket.messaging",
"boot-features-rsocket-requester":"features.rsocket.requester",
"boot-features-rsocket-server-auto-configuration":"features.rsocket.server-auto-configuration",
"boot-features-rsocket-strategies-auto-configuration":"features.rsocket.strategies-auto-configuration",
"boot-features-security":"features.security",
"boot-features-security-actuator":"features.security.actuator",
"boot-features-security-authorization-server":"features.security.oauth2.authorization-server",
"boot-features-security-csrf":"features.security.actuator.csrf",
"boot-features-security-mvc":"features.security.spring-mvc",
"boot-features-security-oauth2":"features.security.oauth2",
"boot-features-security-oauth2-client":"features.security.oauth2.client",
"boot-features-security-oauth2-common-providers":"features.security.oauth2.client.common-providers",
"boot-features-security-oauth2-server":"features.security.oauth2.server",
"boot-features-security-saml":"features.security.saml2",
"boot-features-security-saml2-relying-party":"features.security.saml2.relying-party",
"boot-features-security-webflux":"features.security.spring-webflux",
"boot-features-session":"features.spring-session",
"boot-features-solr":"features.nosql.solr",
"boot-features-spel-conditions":"features.developing-auto-configuration.condition-annotations.spel-conditions",
"boot-features-spring-application":"features.spring-application",
"boot-features-spring-data-cassandra-repositories":"features.nosql.cassandra.repositories",
"boot-features-spring-data-couchbase-repositories":"features.nosql.couchbase.repositories",
"boot-features-spring-data-elasticsearch-repositories":"features.nosql.elasticsearch.repositories",
"boot-features-spring-data-jpa-repositories":"features.sql.jpa-and-spring-data.repositories",
"boot-features-spring-data-mongo-repositories":"features.nosql.mongodb.repositories",
"boot-features-spring-data-mongodb-repositories":"features.nosql.mongodb.repositories",
"boot-features-spring-data-neo4j-repositories":"features.nosql.neo4j.repositories",
"boot-features-spring-data-r2dbc-repositories":"features.sql.r2dbc.repositories",
"boot-features-spring-hateoas":"features.developing-web-applications.spring-mvc.spring-hateoas",
"boot-features-spring-message-codes":"features.developing-web-applications.spring-mvc.message-codes",
"boot-features-spring-mvc":"features.developing-web-applications.spring-mvc",
"boot-features-spring-mvc-auto-configuration":"features.developing-web-applications.spring-mvc.auto-configuration",
"boot-features-spring-mvc-message-converters":"features.developing-web-applications.spring-mvc.message-converters",
"boot-features-spring-mvc-pathmatch":"features.developing-web-applications.spring-mvc.content-negotiation",
"boot-features-spring-mvc-static-content":"features.developing-web-applications.spring-mvc.static-content",
"boot-features-spring-mvc-template-engines":"features.developing-web-applications.spring-mvc.template-engines",
"boot-features-spring-mvc-web-binding-initializer":"features.developing-web-applications.spring-mvc.binding-initializer",
"boot-features-spring-mvc-welcome-page":"features.developing-web-applications.spring-mvc.welcome-page",
"boot-features-sql":"features.sql",
"boot-features-sql-h2-console":"features.sql.h2-web-console",
"boot-features-sql-h2-console-custom-path":"features.sql.h2-web-console.custom-path",
"boot-features-startup-failure":"features.spring-application.startup-failure",
"boot-features-task-execution-scheduling":"features.task-execution-and-scheduling",
"boot-features-test-autoconfig":"features.developing-auto-configuration.testing",
"boot-features-test-autoconfig-overriding-classpath":"features.developing-auto-configuration.testing.overriding-classpath",
"boot-features-test-autoconfig-simulating-web-context":"features.developing-auto-configuration.testing.simulating-a-web-context",
"boot-features-test-property-values":"features.testing.utilities.test-property-values",
"boot-features-test-scope-dependencies":"features.testing.test-scope-dependencies",
"boot-features-test-utilities":"features.testing.utilities",
"boot-features-testing":"features.testing",
"boot-features-testing-spring-applications":"features.testing.spring-applications",
"boot-features-testing-spring-boot-application-arguments":"features.testing.spring-boot-applications.using-application-arguments",
"boot-features-testing-spring-boot-applications":"features.testing.spring-boot-applications",
"boot-features-testing-spring-boot-applications-customizing-web-test-client":"features.testing.spring-boot-applications.customizing-web-test-client",
"boot-features-testing-spring-boot-applications-detecting-config":"features.testing.spring-boot-applications.detecting-configuration",
"boot-features-testing-spring-boot-applications-detecting-web-app-type":"features.testing.spring-boot-applications.detecting-web-app-type",
"boot-features-testing-spring-boot-applications-excluding-config":"features.testing.spring-boot-applications.excluding-configuration",
"boot-features-testing-spring-boot-applications-jmx":"features.testing.spring-boot-applications.jmx",
"boot-features-testing-spring-boot-applications-metrics":"features.testing.spring-boot-applications.metrics",
"boot-features-testing-spring-boot-applications-mocking-beans":"features.testing.spring-boot-applications.mocking-beans",
"boot-features-testing-spring-boot-applications-testing-auto-configured-additional-auto-config":"features.testing.spring-boot-applications.additional-autoconfiguration-and-slicing",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-cassandra-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-cassandra",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-data-jdbc-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-jdbc",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-jdbc-test":"features.testing.spring-boot-applications.autoconfigured-jdbc",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-jooq-test":"features.testing.spring-boot-applications.autoconfigured-jooq",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-jpa-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-jpa",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-json-tests":"features.testing.spring-boot-applications.json-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-ldap-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-ldap",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-mongo-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-mongodb",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-mvc-tests":"features.testing.spring-boot-applications.spring-mvc-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-neo4j-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-neo4j",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-redis-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-redis",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-client":"features.testing.spring-boot-applications.autoconfigured-rest-client",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs-mock-mvc":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-mock-mvc",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs-rest-assured":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-rest-assured",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs-web-test-client":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-web-test-client",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-tests":"features.testing.spring-boot-applications.autoconfigured-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-webflux-tests":"features.testing.spring-boot-applications.spring-webflux-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-webservices":"features.testing.spring-boot-applications.autoconfigured-webservices",
"boot-features-testing-spring-boot-applications-testing-user-configuration":"features.testing.spring-boot-applications.user-configuration-and-slicing",
"boot-features-testing-spring-boot-applications-testing-with-mock-environment":"features.testing.spring-boot-applications.with-mock-environment",
"boot-features-testing-spring-boot-applications-testing-with-running-server":"features.testing.spring-boot-applications.with-running-server",
"boot-features-testing-spring-boot-applications-with-spock":"features.testing.spring-boot-applications.spock",
"boot-features-understanding-auto-configured-beans":"features.developing-auto-configuration.understanding-auto-configured-beans",
"boot-features-using-amqp-receiving":"features.messaging.amqp.receiving",
"boot-features-using-amqp-sending":"features.messaging.amqp.sending",
"boot-features-using-jdbc-template":"features.sql.jdbc-template",
"boot-features-using-jms-receiving":"features.messaging.jms.receiving",
"boot-features-using-jms-sending":"features.messaging.jms.sending",
"boot-features-validation":"features.validation",
"boot-features-web-application-conditions":"features.developing-auto-configuration.condition-annotations.web-application-conditions",
"boot-features-web-environment":"features.spring-application.web-environment",
"boot-features-webclient":"features.webclient",
"boot-features-webclient-customization":"features.webclient.customization",
"boot-features-webclient-runtime":"features.webclient.runtime",
"boot-features-webflux":"features.developing-web-applications.spring-webflux",
"boot-features-webflux-auto-configuration":"features.developing-web-applications.spring-webflux.auto-configuration",
"boot-features-webflux-error-handling":"features.developing-web-applications.spring-webflux.error-handling",
"boot-features-webflux-error-handling-custom-error-pages":"features.developing-web-applications.spring-webflux.error-handling.error-pages",
"boot-features-webflux-httpcodecs":"features.developing-web-applications.spring-webflux.httpcodecs",
"boot-features-webflux-static-content":"features.developing-web-applications.spring-webflux.static-content",
"boot-features-webflux-template-engines":"features.developing-web-applications.spring-webflux.template-engines",
"boot-features-webflux-web-filters":"features.developing-web-applications.spring-webflux.web-filters",
"boot-features-webflux-welcome-page":"features.developing-web-applications.spring-webflux.welcome-page",
"boot-features-webservices":"features.webservices",
"boot-features-webservices-template":"features.webservices.template",
"boot-features-websockets":"features.websockets",
"boot-features-whats-next":"features.whats-next",
"boot-layering-docker-images":"features.container-images.layering",
"build-tool-plugins-antlib":"build-tool-plugins.antlib",
"build-tool-plugins-find-a-main-class":"build-tool-plugins.other-build-systems.finding-main-class",
"build-tool-plugins-gradle-plugin":"build-tool-plugins.gradle",
"build-tool-plugins-maven-plugin":"build-tool-plugins.maven",
"build-tool-plugins-nested-libraries":"build-tool-plugins.other-build-systems.nested-libraries",
"build-tool-plugins-other-build-systems":"build-tool-plugins.other-build-systems",
"build-tool-plugins-repackage-implementation":"build-tool-plugins.other-build-systems.example-repackage-implementation",
"build-tool-plugins-repackaging-archives":"build-tool-plugins.other-build-systems.repackaging-archives",
"build-tool-plugins-whats-next":"build-tool-plugins.whats-next",
"cache-properties":"application-properties.cache",
"cli-automatic-main-method":"cli.using-the-cli.run.automatic-main-method",
"cli-deduced-grab-annotations":"cli.using-the-cli.run.deduced-grab-annotations",
"cli-default-grab-deduced-coordinates":"cli.using-the-cli.run.deduced-grab-coordinates",
"cli-default-grab-deduced-coordinates-custom-dependency-management":"cli.using-the-cli.run.custom-dependency-management",
"cli-default-import-statements":"cli.using-the-cli.run.default-import-statements",
"cli-groovy-beans-dsl":"cli.groovy-beans-dsl",
"cli-init":"cli.using-the-cli.initialize-new-project",
"cli-install-uninstall":"cli.using-the-cli.extensions",
"cli-installation":"cli.installation",
"cli-jar":"cli.using-the-cli.packaging",
"cli-maven-settings":"cli.maven-setting",
"cli-multiple-source-files":"cli.using-the-cli.multiple-source-files",
"cli-run":"cli.using-the-cli.run",
"cli-shell":"cli.using-the-cli.embedded-shell",
"cli-using-the-cli":"cli.using-the-cli",
"cli-whats-next":"cli.whats-next",
"cloud-deployment":"deployment.cloud",
"cloud-deployment-aws":"deployment.cloud.aws",
"cloud-deployment-aws-beanstalk":"deployment.cloud.aws.beanstalk",
"cloud-deployment-aws-java-se-platform":"deployment.cloud.aws.beanstalk.java-se-platform",
"cloud-deployment-aws-summary":"deployment.cloud.aws.summary",
"cloud-deployment-aws-tomcat-platform":"deployment.cloud.aws.beanstalk.tomcat-platform",
"cloud-deployment-boxfuse":"deployment.cloud.boxfuse",
"cloud-deployment-cloud-foundry":"deployment.cloud.cloud-foundry",
"cloud-deployment-cloud-foundry-services":"deployment.cloud.cloud-foundry.binding-to-services",
"cloud-deployment-gae":"deployment.cloud.google",
"cloud-deployment-heroku":"deployment.cloud.heroku",
"cloud-deployment-kubernetes":"deployment.cloud.kubernetes",
"cloud-deployment-kubernetes-container-lifecycle":"deployment.cloud.kubernetes.container-lifecycle",
"cloud-deployment-openshift":"deployment.cloud.openshift",
"common-application-properties":"application-properties",
"common-application-properties-actuator":"application-properties.actuator",
"common-application-properties-cache":"application-properties.cache",
"common-application-properties-core":"application-properties.core",
"common-application-properties-data":"application-properties.data",
"common-application-properties-data-migration":"application-properties.data-migration",
"common-application-properties-devtools":"application-properties.devtools",
"common-application-properties-integration":"application-properties.integration",
"common-application-properties-json":"application-properties.json",
"common-application-properties-mail":"application-properties.mail",
"common-application-properties-rsocket":"application-properties.rsocket",
"common-application-properties-security":"application-properties.security",
"common-application-properties-server":"application-properties.server",
"common-application-properties-templating":"application-properties.templating",
"common-application-properties-testing":"application-properties.testing",
"common-application-properties-transaction":"application-properties.transaction",
"common-application-properties-web":"application-properties.web",
"configuration-metadata-additional-metadata":"configuration-metadata.annotation-processor.adding-additional-metadata",
"configuration-metadata-annotation-processor":"configuration-metadata.annotation-processor",
"configuration-metadata-annotation-processor-metadata-generation":"configuration-metadata.annotation-processor.automatic-metadata-generation",
"configuration-metadata-annotation-processor-metadata-generation-nested":"configuration-metadata.annotation-processor.automatic-metadata-generation.nested-properties",
"configuration-metadata-annotation-processor-setup":"configuration-metadata.annotation-processor.configuring",
"configuration-metadata-format":"configuration-metadata.format",
"configuration-metadata-group-attributes":"configuration-metadata.format.group",
"configuration-metadata-hints-attributes":"configuration-metadata.format.hints",
"configuration-metadata-property-attributes":"configuration-metadata.format.property",
"configuration-metadata-providing-manual-hints":"configuration-metadata.manual-hints",
"configuration-metadata-providing-manual-hints-any":"configuration-metadata.manual-hints.value-providers.any",
"configuration-metadata-providing-manual-hints-class-reference":"configuration-metadata.manual-hints.value-providers.class-reference",
"configuration-metadata-providing-manual-hints-handle-as":"configuration-metadata.manual-hints.value-providers.handle-as",
"configuration-metadata-providing-manual-hints-logger-name":"configuration-metadata.manual-hints.value-providers.logger-name",
"configuration-metadata-providing-manual-hints-spring-bean-reference":"configuration-metadata.manual-hints.value-providers.spring-bean-reference",
"configuration-metadata-providing-manual-hints-spring-profile-name":"configuration-metadata.manual-hints.value-providers.spring-profile-name",
"configuration-metadata-providing-manual-hints-value-hint":"configuration-metadata.manual-hints.value-hint",
"configuration-metadata-providing-manual-hints-value-providers":"configuration-metadata.manual-hints.value-providers",
"configuration-metadata-repeated-items":"configuration-metadata.format.repeated-items",
"configuring-file-system-watcher":"using.devtools.globalsettings.configuring-file-system-watcher",
"containers-deployment":"deployment.containers",
"core-properties":"application-properties.core",
"data-migration-properties":"application-properties.data-migration",
"data-properties":"application-properties.data",
"dependency-versions-coordinates":"dependency-versions.coordinates",
"dependency-versions-properties":"dependency-versions.properties",
"deployment-initd-service":"deployment.installing.nix-services.init-d",
"deployment-initd-service-securing":"deployment.installing.nix-services.init-d.securing",
"deployment-install":"deployment.installing",
"deployment-install-supported-operating-systems":"deployment.installing.supported-operating-systems",
"deployment-script-customization":"deployment.installing.nix-services.script-customization",
"deployment-script-customization-when-it-runs":"deployment.installing.nix-services.script-customization.when-running",
"deployment-script-customization-when-it-written":"deployment.installing.nix-services.script-customization.when-written",
"deployment-service":"deployment.installing.nix-services",
"deployment-systemd-service":"deployment.installing.nix-services.system-d",
"deployment-whats-next":"deployment.whats-next",
"deployment-windows":"deployment.installing.windows-services",
"deployment.containers":"container-images.efficient-images.unpacking",
"devtools-properties":"application-properties.devtools",
"executable-jar-alternatives":"executable-jar.alternatives",
"executable-jar-jar-file-structure":"executable-jar.nested-jars.jar-structure",
"executable-jar-jarfile":"executable-jar.jarfile-class",
"executable-jar-jarfile-compatibility":"executable-jar.jarfile-class.compatibility",
"executable-jar-launcher-manifest":"executable-jar.launching.manifest",
"executable-jar-launching":"executable-jar.launching",
"executable-jar-nested-jars":"executable-jar.nested-jars",
"executable-jar-property-launcher-features":"executable-jar.property-launcher",
"executable-jar-restrictions":"executable-jar.restrictions",
"executable-jar-war-file-structure":"executable-jar.nested-jars.war-structure",
"executable-jar-war-index-files":"executable-jar.nested-jars.index-files",
"executable-jar-war-index-files-classpath":"executable-jar.nested-jars.classpath-index",
"executable-jar-war-index-files-layers":"executable-jar.nested-jars.layer-index",
"features.caching":"io.caching",
"features.caching.provider":"io.caching.provider",
"features.caching.provider.caffeine":"io.caching.provider.caffeine",
"features.caching.provider.couchbase":"io.caching.provider.couchbase",
"features.caching.provider.ehcache2":"io.caching.provider.ehcache2",
"features.caching.provider.generic":"io.caching.provider.generic",
"features.caching.provider.hazelcast":"io.caching.provider.hazelcast",
"features.caching.provider.infinispan":"io.caching.provider.infinispan",
"features.caching.provider.jcache":"io.caching.provider.jcache",
"features.caching.provider.none":"io.caching.provider.none",
"features.caching.provider.redis":"io.caching.provider.redis",
"features.caching.provider.simple":"io.caching.provider.simple",
"features.container-images":"container-images.efficient-images",
"features.container-images.building":"container-images.efficient-images",
"features.container-images.building.buildpacks":"container-images.buildpacks",
"features.container-images.building.dockerfiles":"container-images.dockerfiles",
"features.container-images.layering":"container-images.efficient-images.layering",
"features.developing-web-applications":"web",
"features.developing-web-applications.embedded-container":"web.servlet.embedded-container",
"features.developing-web-applications.embedded-container.application-context":"web.servlet.embedded-container.application-context",
"features.developing-web-applications.embedded-container.context-initializer":"web.servlet.embedded-container.context-initializer",
"features.developing-web-applications.embedded-container.context-initializer.scanning":"web.servlet.embedded-container.context-initializer.scanning",
"features.developing-web-applications.embedded-container.customizing":"web.servlet.embedded-container.customizing",
"features.developing-web-applications.embedded-container.customizing.direct":"web.servlet.embedded-container.customizing.direct",
"features.developing-web-applications.embedded-container.customizing.programmatic":"web.servlet.embedded-container.customizing.programmatic",
"features.developing-web-applications.embedded-container.jsp-limitations":"web.servlet.embedded-container.jsp-limitations",
"features.developing-web-applications.embedded-container.servlets-filters-listeners":"web.servlet.embedded-container.servlets-filters-listeners",
"features.developing-web-applications.embedded-container.servlets-filters-listeners.beans":"web.servlet.embedded-container.servlets-filters-listeners.beans",
"features.developing-web-applications.jersey":"web.servlet.jersey",
"features.developing-web-applications.reactive-server":"web.reactive.reactive-server",
"features.developing-web-applications.reactive-server-resources-configuration":"web.reactive.reactive-server-resources-configuration",
"features.developing-web-applications.spring-mvc":"web.servlet.spring-mvc",
"features.developing-web-applications.spring-mvc.auto-configuration":"web.servlet.spring-mvc.auto-configuration",
"features.developing-web-applications.spring-mvc.binding-initializer":"web.servlet.spring-mvc.binding-initializer",
"features.developing-web-applications.spring-mvc.content-negotiation":"web.servlet.spring-mvc.content-negotiation",
"features.developing-web-applications.spring-mvc.cors":"web.servlet.spring-mvc.cors",
"features.developing-web-applications.spring-mvc.error-handling":"web.servlet.spring-mvc.error-handling",
"features.developing-web-applications.spring-mvc.error-handling.error-pages":"web.servlet.spring-mvc.error-handling.error-pages",
"features.developing-web-applications.spring-mvc.error-handling.error-pages-without-spring-mvc":"web.servlet.spring-mvc.error-handling.error-pages-without-spring-mvc",
"features.developing-web-applications.spring-mvc.error-handling.in-a-war-deployment":"web.servlet.spring-mvc.error-handling.in-a-war-deployment",
"features.developing-web-applications.spring-mvc.json":"web.servlet.spring-mvc.json",
"features.developing-web-applications.spring-mvc.message-codes":"web.servlet.spring-mvc.message-codes",
"features.developing-web-applications.spring-mvc.message-converters":"web.servlet.spring-mvc.message-converters",
"features.developing-web-applications.spring-mvc.static-content":"web.servlet.spring-mvc.static-content",
"features.developing-web-applications.spring-mvc.template-engines":"web.servlet.spring-mvc.template-engines",
"features.developing-web-applications.spring-mvc.welcome-page":"web.servlet.spring-mvc.welcome-page",
"features.developing-web-applications.spring-webflux":"web.reactive.webflux",
"features.developing-web-applications.spring-webflux.auto-configuration":"web.reactive.webflux.auto-configuration",
"features.developing-web-applications.spring-webflux.error-handling":"web.reactive.webflux.error-handling",
"features.developing-web-applications.spring-webflux.error-pages":"web.reactive.webflux.error-handling.error-pages",
"features.developing-web-applications.spring-webflux.httpcodecs":"web.reactive.webflux.httpcodecs",
"features.developing-web-applications.spring-webflux.static-context":"web.reactive.webflux.static-content",
"features.developing-web-applications.spring-webflux.template-engines":"web.reactive.webflux.template-engines",
"features.developing-web-applications.spring-webflux.web-filters":"web.reactive.webflux.web-filters",
"features.developing-web-applications.spring-webflux.welcome-page":"web.reactive.webflux.welcome-page",
"features.email":"io.email",
"features.graceful-shutdown":"web.graceful-shutdown",
"features.jmx":"actuator.jmx",
"features.jta":"io.jta",
"features.jta.atomikos":"io.jta.atomikos",
"features.jta.javaee":"io.jta.javaee",
"features.jta.mixing-xa-and-non-xa-connections":"io.jta.mixing-xa-and-non-xa-connections",
"features.jta.supporting-alternative-embedded-transaction-manager":"io.jta.supporting-alternative-embedded-transaction-manager",
"features.messaging":"messaging",
"features.messaging.amqp":"messaging.amqp",
"features.messaging.amqp.rabbit":"messaging.amqp.rabbit",
"features.messaging.amqp.receiving":"messaging.amqp.receiving",
"features.messaging.amqp.sending":"messaging.amqp.sending",
"features.messaging.jms.activemq":"messaging.jms.activemq",
"features.messaging.jms.artemis":"messaging.jms.artemis",
"features.messaging.jms.jndi":"messaging.jms.jndi",
"features.messaging.jms.receiving":"messaging.jms.receiving",
"features.messaging.jms.sending":"messaging.jms.sending",
"features.messaging.kafka":"messaging.kafka",
"features.messaging.kafka.additional-properties":"messaging.kafka.additional-properties",
"features.messaging.kafka.embedded":"messaging.kafka.embedded",
"features.messaging.kafka.receiving":"messaging.kafka.receiving",
"features.messaging.kafka.sending":"messaging.kafka.sending",
"features.messaging.kafka.streams":"messaging.kafka.streams",
"features.nosql":"data.nosql",
"features.nosql.cassandra":"data.nosql.cassandra",
"features.nosql.cassandra.connecting":"data.nosql.cassandra.connecting",
"features.nosql.cassandra.repositories":"data.nosql.cassandra.repositories",
"features.nosql.couchbase":"data.nosql.couchbase",
"features.nosql.couchbase.connecting":"data.nosql.couchbase.connecting",
"features.nosql.couchbase.repositories":"data.nosql.couchbase.repositories",
"features.nosql.elasticsearch":"data.nosql.elasticsearch",
"features.nosql.elasticsearch.connecting-using-reactive-rest":"data.nosql.elasticsearch.connecting-using-reactive-rest",
"features.nosql.elasticsearch.connecting-using-rest":"data.nosql.elasticsearch.connecting-using-rest",
"features.nosql.elasticsearch.connecting-using-spring-data":"data.nosql.elasticsearch.connecting-using-spring-data",
"features.nosql.elasticsearch.repositories":"data.nosql.elasticsearch.repositories",
"features.nosql.influxdb":"data.nosql.influxdb",
"features.nosql.influxdb.connecting":"data.nosql.influxdb.connecting",
"features.nosql.ldap":"data.nosql.ldap",
"features.nosql.ldap.connecting":"data.nosql.ldap.connecting",
"features.nosql.ldap.embedded":"data.nosql.ldap.embedded",
"features.nosql.ldap.repositories":"data.nosql.ldap.repositories",
"features.nosql.mongodb":"data.nosql.mongodb",
"features.nosql.mongodb.connecting":"data.nosql.mongodb.connecting",
"features.nosql.mongodb.embedded":"data.nosql.mongodb.embedded",
"features.nosql.mongodb.repositories":"data.nosql.mongodb.repositories",
"features.nosql.mongodb.template":"data.nosql.mongodb.template",
"features.nosql.neo4j":"data.nosql.neo4j",
"features.nosql.neo4j.connecting":"data.nosql.neo4j.connecting",
"features.nosql.neo4j.repositories":"data.nosql.neo4j.repositories",
"features.nosql.redis":"data.nosql.redis",
"features.nosql.redis.connecting":"data.nosql.redis.connecting",
"features.nosql.solr":"data.nosql.solr",
"features.nosql.solr.connecting":"data.nosql.solr.connecting",
"features.quartz":"io.quartz",
"features.resttemplate":"io.rest-client.resttemplate",
"features.resttemplate.customization":"io.rest-client.resttemplate.customization",
"features.rsocket":"messaging.rsocket",
"features.rsocket.messaging":"messaging.rsocket.messaging",
"features.rsocket.requester":"messaging.rsocket.requester",
"features.rsocket.server-auto-configuration":"messaging.rsocket.server-auto-configuration",
"features.rsocket.strategies-auto-configuration":"messaging.rsocket.strategies-auto-configuration",
"features.security":"web.security",
"features.security.actuator":"actuator.endpoints.security",
"features.security.actuator.csrf":"actuator.endpoints.security.csrf",
"features.security.authorization-server":"web.security.oauth2.authorization-server",
"features.security.oauth2":"web.security.oauth2",
"features.security.oauth2.client":"web.security.oauth2.client",
"features.security.oauth2.client.common-providers":"web.security.oauth2.client.common-providers",
"features.security.oauth2.server":"web.security.oauth2.server",
"features.security.saml2":"web.security.saml2",
"features.security.saml2.relying-party":"web.security.saml2.relying-party",
"features.security.spring-mvc":"web.security.spring-mvc",
"features.security.spring-webflux":"web.security.spring-webflux",
"features.spring-hateoas":"web.spring-hateoas",
"features.spring-integration":"messaging.spring-integration",
"features.spring-session":"web.spring-session",
"features.sql":"data.sql",
"features.sql.datasource":"data.sql.datasource",
"features.sql.datasource.configuration":"data.sql.datasource.configuration",
"features.sql.datasource.connection-pool":"data.sql.datasource.connection-pool",
"features.sql.datasource.embedded":"data.sql.datasource.embedded",
"features.sql.datasource.jndi":"data.sql.datasource.jndi",
"features.sql.datasource.production":"data.sql.datasource.production",
"features.sql.h2-web-console":"data.sql.h2-web-console",
"features.sql.h2-web-console.custom-path":"data.sql.h2-web-console.custom-path",
"features.sql.jdbc":"data.sql.jdbc",
"features.sql.jdbc-template":"data.sql.jdbc-template",
"features.sql.jooq":"data.sql.jooq",
"features.sql.jooq.codegen":"data.sql.jooq.codegen",
"features.sql.jooq.customizing":"data.sql.jooq.customizing",
"features.sql.jooq.dslcontext":"data.sql.jooq.dslcontext",
"features.sql.jooq.sqldialect":"data.sql.jooq.sqldialect",
"features.sql.jpa-and-spring-data":"data.sql.jpa-and-spring-data",
"features.sql.jpa-and-spring-data.creating-and-dropping":"data.sql.jpa-and-spring-data.creating-and-dropping",
"features.sql.jpa-and-spring-data.entity-classes":"data.sql.jpa-and-spring-data.entity-classes",
"features.sql.jpa-and-spring-data.envers-repositories":"data.sql.jpa-and-spring-data.envers-repositories",
"features.sql.jpa-and-spring-data.open-entity-manager-in-view":"data.sql.jpa-and-spring-data.open-entity-manager-in-view",
"features.sql.jpa-and-spring-data.repositories":"data.sql.jpa-and-spring-data.repositories",
"features.sql.r2dbc":"data.sql.r2dbc",
"features.sql.r2dbc.embedded":"data.sql.r2dbc.embedded",
"features.sql.r2dbc.repositories":"data.sql.r2dbc.repositories",
"features.sql.r2dbc.using-database-client":"data.sql.r2dbc.using-database-client",
"features.validation":"io.validation",
"features.webclient":"io.rest-client.webclient",
"features.webclient.customization":"io.rest-client.webclient.customization",
"features.webclient.runtime":"io.rest-client.webclient.runtime",
"features.webservices":"io.webservices",
"features.webservices.template":"io.webservices.template",
"features.websockets":"messaging.websockets",
"getting-started-cli-command-line-completion":"getting-started.installing.cli.completion",
"getting-started-cli-example":"getting-started.installing.cli.quick-start",
"getting-started-first-application":"getting-started.first-application",
"getting-started-first-application-annotations":"getting-started.first-application.code.mvc-annotations",
"getting-started-first-application-auto-configuration":"getting-started.first-application.code.enable-auto-configuration",
"getting-started-first-application-code":"getting-started.first-application.code",
"getting-started-first-application-dependencies":"getting-started.first-application.dependencies",
"getting-started-first-application-executable-jar":"getting-started.first-application.executable-jar",
"getting-started-first-application-main-method":"getting-started.first-application.code.main-method",
"getting-started-first-application-pom":"getting-started.first-application.pom",
"getting-started-first-application-run":"getting-started.first-application.run",
"getting-started-gradle-installation":"getting-started.installing.java.gradle",
"getting-started-homebrew-cli-installation":"getting-started.installing.cli.homebrew",
"getting-started-installation-instructions-for-java":"getting-started.installing.java",
"getting-started-installing-spring-boot":"getting-started.installing",
"getting-started-installing-the-cli":"getting-started.installing.cli",
"getting-started-introducing-spring-boot":"getting-started.introducing-spring-boot",
"getting-started-macports-cli-installation":"getting-started.installing.cli.macports",
"getting-started-manual-cli-installation":"getting-started.installing.cli.manual-installation",
"getting-started-maven-installation":"getting-started.installing.java.maven",
"getting-started-scoop-cli-installation":"getting-started.installing.cli.scoop",
"getting-started-sdkman-cli-installation":"getting-started.installing.cli.sdkman",
"getting-started-system-requirements":"getting-started.system-requirements",
"getting-started-system-requirements-servlet-containers":"getting-started.system-requirements.servlet-containers",
"getting-started-upgrading-from-an-earlier-version":"getting-started.installing.upgrading",
"getting-started-whats-next":"getting-started.whats-next",
"how-to-enable-http-response-compression":"howto.webserver.enable-response-compression",
"howto-actuator":"howto.actuator",
"howto-add-a-servlet-filter-or-listener":"howto.webserver.add-servlet-filter-listener",
"howto-add-a-servlet-filter-or-listener-as-spring-bean":"howto.webserver.add-servlet-filter-listener.spring-bean",
"howto-add-a-servlet-filter-or-listener-using-scanning":"howto.webserver.add-servlet-filter-listener.using-scanning",
"howto-automatic-expansion":"howto.properties-and-configuration.expand-properties",
"howto-automatic-expansion-gradle":"howto.properties-and-configuration.expand-properties.gradle",
"howto-automatic-expansion-maven":"howto.properties-and-configuration.expand-properties.maven",
"howto-batch-applications":"howto.batch",
"howto-build":"howto.build",
"howto-build-an-application-context-hierarchy":"howto.application.context-hierarchy",
"howto-build-an-executable-archive-with-ant":"howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib",
"howto-build-info":"howto.build.generate-info",
"howto-change-configuration-depending-on-the-environment":"howto.properties-and-configuration.change-configuration-depending-on-the-environment",
"howto-change-the-http-port":"howto.webserver.change-port",
"howto-change-the-http-port-or-address-of-the-actuator-endpoints":"howto.actuator.change-http-port-or-address",
"howto-change-the-location-of-external-properties":"howto.properties-and-configuration.external-properties-location",
"howto-change-the-user-details-service-and-add-user-accounts":"howto.security.change-user-details-service-and-add-user-accounts",
"howto-configure-a-component-that-is-used-by-JPA":"howto.data-access.configure-a-component-that-is-used-by-jpa",
"howto-configure-a-datasource":"howto.data-access.configure-custom-datasource",
"howto-configure-accesslogs":"howto.webserver.configure-access-logs",
"howto-configure-hibernate-naming-strategy":"howto.data-access.configure-hibernate-naming-strategy",
"howto-configure-hibernate-second-level-caching":"howto.data-access.configure-hibernate-second-level-caching",
"howto-configure-http2":"howto.webserver.configure-http2",
"howto-configure-http2-jetty":"howto.webserver.configure-http2.jetty",
"howto-configure-http2-netty":"howto.webserver.configure-http2.netty",
"howto-configure-http2-tomcat":"howto.webserver.configure-http2.tomcat",
"howto-configure-http2-undertow":"howto.webserver.configure-http2.undertow",
"howto-configure-jOOQ-with-multiple-datasources":"howto.data-access.configure-jooq-with-multiple-datasources",
"howto-configure-jpa-properties":"howto.data-access.jpa-properties",
"howto-configure-log4j-for-logging":"howto.logging.log4j",
"howto-configure-log4j-for-logging-yaml-or-json-config":"howto.logging.log4j.yaml-or-json-config",
"howto-configure-logback-for-logging":"howto.logging.logback",
"howto-configure-logback-for-logging-fileonly":"howto.logging.logback.file-only-output",
"howto-configure-ssl":"howto.webserver.configure-ssl",
"howto-configure-webserver":"howto.webserver.configure",
"howto-convert-an-existing-application-to-spring-boot":"howto.traditional-deployment.convert-existing-application",
"howto-create-a-deployable-war-file":"howto.traditional-deployment.war",
"howto-create-a-non-web-application":"howto.application.non-web-application",
"howto-create-a-nonexecutable-jar":"howto.build.create-a-nonexecutable-jar",
"howto-create-an-additional-executable-jar":"howto.build.use-a-spring-boot-application-as-dependency",
"howto-create-an-executable-jar-with-maven":"howto.build.create-an-executable-jar-with-maven",
"howto-create-websocket-endpoints-using-serverendpoint":"howto.webserver.create-websocket-endpoints-using-serverendpoint",
"howto-customize-dependency-versions":"howto.build.customize-dependency-versions",
"howto-customize-the-environment-or-application-context":"howto.application.customize-the-environment-or-application-context",
"howto-customize-the-jackson-objectmapper":"howto.spring-mvc.customize-jackson-objectmapper",
"howto-customize-the-responsebody-rendering":"howto.spring-mvc.customize-responsebody-rendering",
"howto-customize-the-whitelabel-error-page":"howto.actuator.customize-whitelabel-error-page",
"howto-customize-tomcat-behind-a-proxy-server":"howto.webserver.use-behind-a-proxy-server.tomcat",
"howto-customize-view-resolvers":"howto.spring-mvc.customize-view-resolvers",
"howto-data-access":"howto.data-access",
"howto-database-initialization":"howto.data-initialization",
"howto-disable-registration-of-a-servlet-or-filter":"howto.webserver.add-servlet-filter-listener.spring-bean.disable",
"howto-disable-web-server":"howto.webserver.disable",
"howto-discover-build-in-options-for-external-properties":"howto.properties-and-configuration.discover-build-in-options-for-external-properties",
"howto-discover-the-http-port-at-runtime":"howto.webserver.discover-port",
"howto-embedded-web-servers":"howto.webserver",
"howto-enable-https":"howto.security.enable-https",
"howto-enable-multiple-connectors-in-tomcat":"howto.webserver.enable-multiple-connectors-in-tomcat",
"howto-enable-multiple-listeners-in-undertow":"howto.webserver.enable-multiple-listeners-in-undertow",
"howto-enable-tomcat-mbean-registry":"howto.webserver.enable-tomcat-mbean-registry",
"howto-execute-flyway-database-migrations-on-startup":"howto.data-initialization.migration-tool.flyway",
"howto-execute-liquibase-database-migrations-on-startup":"howto.data-initialization.migration-tool.liquibase",
"howto-externalize-configuration":"howto.properties-and-configuration.externalize-configuration",
"howto-extract-specific-libraries-when-an-executable-jar-runs":"howto.build.extract-specific-libraries-when-an-executable-jar-runs",
"howto-failure-analyzer":"howto.application.failure-analyzer",
"howto-git-info":"howto.build.generate-git-info",
"howto-hotswapping":"howto.hotswapping",
"howto-http-clients":"howto.http-clients",
"howto-http-clients-proxy-configuration":"howto.http-clients.rest-template-proxy-configuration",
"howto-initialize-a-database-configuring-dependencies":"howto.data-initialization.dependencies",
"howto-initialize-a-database-configuring-dependencies-depends-on-initialization-detection":"howto.data-initialization.dependencies.depends-on-initialization-detection",
"howto-initialize-a-database-configuring-dependencies-initializer-detection":"howto.data-initialization.dependencies.initializer-detection",
"howto-initialize-a-database-using-basic-scripts":"howto.data-initialization.using-basic-sql-scripts",
"howto-initialize-a-database-using-hibernate":"howto.data-initialization.using-hibernate",
"howto-initialize-a-database-using-jpa":"howto.data-initialization.using-jpa",
"howto-initialize-a-spring-batch-database":"howto.data-initialization.batch",
"howto-jersey":"howto.jersey",
"howto-jersey-alongside-another-web-framework":"howto.jersey.alongside-another-web-framework",
"howto-jersey-spring-security":"howto.jersey.spring-security",
"howto-jms-disable-transaction":"howto.messaging.disable-transacted-jms-session",
"howto-logging":"howto.logging",
"howto-map-health-indicators-to-metrics":"howto.actuator.map-health-indicators-to-metrics",
"howto-messaging":"howto.messaging",
"howto-multipart-file-upload-configuration":"howto.spring-mvc.multipart-file-uploads",
"howto-properties-and-configuration":"howto.properties-and-configuration",
"howto-reload-fast-restart":"howto.hotswapping.fast-application-restarts",
"howto-reload-freemarker-content":"howto.hotswapping.reload-templates.freemarker",
"howto-reload-groovy-template-content":"howto.hotswapping.reload-templates.groovy",
"howto-reload-java-classes-without-restarting":"howto.hotswapping.reload-java-classes-without-restarting",
"howto-reload-static-content":"howto.hotswapping.reload-static-content",
"howto-reload-thymeleaf-content":"howto.hotswapping.reload-templates.thymeleaf",
"howto-reload-thymeleaf-template-content":"howto.hotswapping.reload-templates",
"howto-remote-debug-maven-run":"howto.build.remote-debug-maven",
"howto-sanitize-sensible-values":"howto.actuator.sanitize-sensitive-values",
"howto-sanitize-sensitive-values":"howto.actuator.sanitize-sensitive-values",
"howto-security":"howto.security",
"howto-separate-entity-definitions-from-spring-configuration":"howto.data-access.separate-entity-definitions-from-spring-configuration",
"howto-set-active-spring-profiles":"howto.properties-and-configuration.set-active-spring-profiles",
"howto-spring-batch-running-command-line":"howto.batch.running-from-the-command-line",
"howto-spring-batch-running-jobs-on-startup":"howto.batch.running-jobs-on-startup",
"howto-spring-batch-specifying-a-data-source":"howto.batch.specifying-a-data-source",
"howto-spring-batch-storing-job-repository":"howto.batch.storing-job-repository",
"howto-spring-boot-application":"howto.application",
"howto-spring-mvc":"howto.spring-mvc",
"howto-switch-off-default-mvc-configuration":"howto.spring-mvc.switch-off-default-configuration",
"howto-switch-off-spring-boot-security-configuration":"howto.security.switch-off-spring-boot-configuration",
"howto-switch-off-the-spring-mvc-dispatcherservlet":"howto.spring-mvc.switch-off-dispatcherservlet",
"howto-testcontainers":"howto.testing.testcontainers",
"howto-traditional-deployment":"howto.traditional-deployment",
"howto-troubleshoot-auto-configuration":"howto.application.troubleshoot-auto-configuration",
"howto-two-datasources":"howto.data-access.configure-two-datasources",
"howto-use-a-higher-level-database-migration-tool":"howto.data-initialization.migration-tool",
"howto-use-another-web-server":"howto.webserver.use-another",
"howto-use-behind-a-proxy-server":"howto.webserver.use-behind-a-proxy-server",
"howto-use-custom-entity-manager":"howto.data-access.use-custom-entity-manager",
"howto-use-customize-spring-datas-web-support":"howto.data-access.customize-spring-data-web-support",
"howto-use-dependency-injection-hibernate-components":"howto.data-access.dependency-injection-in-hibernate-components",
"howto-use-exposing-spring-data-repositories-rest-endpoint":"howto.data-access.exposing-spring-data-repositories-as-rest",
"howto-use-jedis-instead-of-lettuce":"howto.nosql.jedis-instead-of-lettuce",
"howto-use-multiple-entity-managers":"howto.data-access.use-multiple-entity-managers",
"howto-use-short-command-line-arguments":"howto.properties-and-configuration.short-command-line-arguments",
"howto-use-spring-data-jpa--and-mongo-repositories":"howto.data-access.use-spring-data-jpa-and-mongo-repositories",
"howto-use-spring-data-repositories":"howto.data-access.spring-data-repositories",
"howto-use-test-with-spring-security":"howto.spring-mvc.testing.with-spring-security",
"howto-use-tomcat-legacycookieprocessor":"howto.webserver.use-tomcat-legacycookieprocessor",
"howto-use-traditional-persistence-xml":"howto.data-access.use-traditional-persistence-xml",
"howto-use-two-entity-managers":"howto.data-access.use-multiple-entity-managers",
"howto-use-yaml-for-external-properties":"howto.properties-and-configuration.yaml",
"howto-user-a-random-unassigned-http-port":"howto.webserver.use-random-port",
"howto-webclient-reactor-netty-customization":"howto.http-clients.webclient-reactor-netty-customization",
"howto-weblogic":"howto.traditional-deployment.weblogic",
"howto-write-a-json-rest-service":"howto.spring-mvc.write-json-rest-service",
"howto-write-an-xml-rest-service":"howto.spring-mvc.write-xml-rest-service",
"integration-properties":"application-properties.integration",
"json-properties":"application-properties.json",
"mail-properties":"application-properties.mail",
"production-ready":"actuator",
"production-ready-application-info":"actuator.endpoints.info",
"production-ready-application-info-autoconfigure":"actuator.endpoints.info.auto-configured-info-contributors",
"production-ready-application-info-build":"actuator.endpoints.info.build-information",
"production-ready-application-info-custom":"actuator.endpoints.info.writing-custom-info-contributors",
"production-ready-application-info-env":"actuator.endpoints.info.custom-application-information",
"production-ready-application-info-git":"actuator.endpoints.info.git-commit-information",
"production-ready-auditing":"actuator.auditing",
"production-ready-auditing-custom":"actuator.auditing.custom",
"production-ready-cloudfoundry":"actuator.cloud-foundry",
"production-ready-cloudfoundry-disable":"actuator.cloud-foundry.disable",
"production-ready-cloudfoundry-ssl":"actuator.cloud-foundry.ssl",
"production-ready-custom-context-path":"actuator.cloud-foundry.custom-context-path",
"production-ready-custom-mbean-names":"actuator.jmx.custom-mbean-names",
"production-ready-customizing-jolokia":"actuator.jmx.jolokia.customizing",
"production-ready-customizing-management-server-address":"actuator.monitoring.customizing-management-server-address",
"production-ready-customizing-management-server-context-path":"actuator.monitoring.customizing-management-server-context-path",
"production-ready-customizing-management-server-port":"actuator.monitoring.customizing-management-server-port",
"production-ready-disable-jmx-endpoints":"actuator.jmx.disable-jmx-endpoints",
"production-ready-disabling-http-endpoints":"actuator.monitoring.disabling-http-endpoints",
"production-ready-disabling-jolokia":"actuator.jmx.jolokia.disabling",
"production-ready-enabling":"actuator.enabling",
"production-ready-endpoints":"actuator.endpoints",
"production-ready-endpoints-caching":"actuator.endpoints.caching",
"production-ready-endpoints-cors":"actuator.endpoints.cors",
"production-ready-endpoints-custom":"actuator.endpoints.implementing-custom",
"production-ready-endpoints-custom-controller":"actuator.endpoints.implementing-custom.controller",
"production-ready-endpoints-custom-input":"actuator.endpoints.implementing-custom.input",
"production-ready-endpoints-custom-input-conversion":"actuator.endpoints.implementing-custom.input.conversion",
"production-ready-endpoints-custom-servlet":"actuator.endpoints.implementing-custom.servlet",
"production-ready-endpoints-custom-web":"actuator.endpoints.implementing-custom.web",
"production-ready-endpoints-custom-web-predicate":"actuator.endpoints.implementing-custom.web.request-predicates",
"production-ready-endpoints-custom-web-predicate-consumes":"actuator.endpoints.implementing-custom.web.consumes-predicates",
"production-ready-endpoints-custom-web-predicate-http-method":"actuator.endpoints.implementing-custom.web.method-predicates",
"production-ready-endpoints-custom-web-predicate-path":"actuator.endpoints.implementing-custom.web.path-predicates",
"production-ready-endpoints-custom-web-predicate-produces":"actuator.endpoints.implementing-custom.web.produces-predicates",
"production-ready-endpoints-custom-web-range-requests":"actuator.endpoints.implementing-custom.web.range-requests",
"production-ready-endpoints-custom-web-response-status":"actuator.endpoints.implementing-custom.web.response-status",
"production-ready-endpoints-custom-web-security":"actuator.endpoints.implementing-custom.web.security",
"production-ready-endpoints-enabling-endpoints":"actuator.endpoints.enabling",
"production-ready-endpoints-exposing-endpoints":"actuator.endpoints.exposing",
"production-ready-endpoints-hypermedia":"actuator.endpoints.hypermedia",
"production-ready-endpoints-security":"actuator.endpoints.security",
"production-ready-health":"actuator.endpoints.health",
"production-ready-health-datasource":"actuator.endpoints.health.datasource",
"production-ready-health-groups":"actuator.endpoints.health.groups",
"production-ready-health-indicators":"actuator.endpoints.health.auto-configured-health-indicators",
"production-ready-health-indicators-writing":"actuator.endpoints.health.writing-custom-health-indicators",
"production-ready-http-tracing":"actuator.tracing",
"production-ready-http-tracing-custom":"actuator.tracing.custom",
"production-ready-jmx":"actuator.jmx",
"production-ready-jolokia":"actuator.jmx.jolokia",
"production-ready-kubernetes-probes":"actuator.endpoints.kubernetes-probes",
"production-ready-kubernetes-probes-external-state":"actuator.endpoints.kubernetes-probes.external-state",
"production-ready-kubernetes-probes-lifecycle":"actuator.endpoints.kubernetes-probes.lifecycle",
"production-ready-logger-configuration":"actuator.loggers.configure",
"production-ready-loggers":"actuator.loggers",
"production-ready-management-specific-ssl":"actuator.monitoring.management-specific-ssl",
"production-ready-metrics":"actuator.metrics",
"production-ready-metrics-cache":"actuator.metrics.supported.cache",
"production-ready-metrics-common-tags":"actuator.metrics.customizing.common-tags",
"production-ready-metrics-custom":"actuator.metrics.registering-custom",
"production-ready-metrics-customizing":"actuator.metrics.customizing",
"production-ready-metrics-data-repository":"actuator.metrics.supported.spring-data-repository",
"production-ready-metrics-endpoint":"actuator.metrics.endpoint",
"production-ready-metrics-export":"actuator.metrics.export",
"production-ready-metrics-export-appoptics":"actuator.metrics.export.appoptics",
"production-ready-metrics-export-atlas":"actuator.metrics.export.atlas",
"production-ready-metrics-export-datadog":"actuator.metrics.export.datadog",
"production-ready-metrics-export-dynatrace":"actuator.metrics.export.dynatrace",
"production-ready-metrics-export-elastic":"actuator.metrics.export.elastic",
"production-ready-metrics-export-ganglia":"actuator.metrics.export.ganglia",
"production-ready-metrics-export-graphite":"actuator.metrics.export.graphite",
"production-ready-metrics-export-humio":"actuator.metrics.export.humio",
"production-ready-metrics-export-influx":"actuator.metrics.export.influx",
"production-ready-metrics-export-jmx":"actuator.metrics.export.jmx",
"production-ready-metrics-export-kairos":"actuator.metrics.export.kairos",
"production-ready-metrics-export-newrelic":"actuator.metrics.export.newrelic",
"production-ready-metrics-export-prometheus":"actuator.metrics.export.prometheus",
"production-ready-metrics-export-signalfx":"actuator.metrics.export.signalfx",
"production-ready-metrics-export-simple":"actuator.metrics.export.simple",
"production-ready-metrics-export-stackdriver":"actuator.metrics.export.stackdriver",
"production-ready-metrics-export-statsd":"actuator.metrics.export.statsd",
"production-ready-metrics-export-wavefront":"actuator.metrics.export.wavefront",
"production-ready-metrics-getting-started":"actuator.metrics.getting-started",
"production-ready-metrics-hibernate":"actuator.metrics.supported.hibernate",
"production-ready-metrics-http-clients":"actuator.metrics.supported.http-clients",
"production-ready-metrics-integration":"actuator.metrics.supported.spring-integration",
"production-ready-metrics-jdbc":"actuator.metrics.supported.jdbc",
"production-ready-metrics-jersey-server":"actuator.metrics.supported.jersey",
"production-ready-metrics-jvm":"actuator.metrics.supported.jvm",
"production-ready-metrics-kafka":"actuator.metrics.supported.kafka",
"production-ready-metrics-logger":"actuator.metrics.supported.logger",
"production-ready-metrics-meter":"actuator.metrics.supported",
"production-ready-metrics-mongodb":"actuator.metrics.supported.mongodb",
"production-ready-metrics-mongodb-command":"actuator.metrics.supported.mongodb.command",
"production-ready-metrics-mongodb-connectionpool":"actuator.metrics.supported.mongodb.connection-pool",
"production-ready-metrics-per-meter-properties":"actuator.metrics.customizing.per-meter-properties",
"production-ready-metrics-rabbitmq":"actuator.metrics.supported.rabbitmq",
"production-ready-metrics-spring-mvc":"actuator.metrics.supported.spring-mvc",
"production-ready-metrics-system":"actuator.metrics.supported.system",
"production-ready-metrics-timed-annotation":"actuator.metrics.supported.timed-annotation",
"production-ready-metrics-tomcat":"actuator.metrics.supported.tomcat",
"production-ready-metrics-web-flux":"actuator.metrics.supported.spring-webflux",
"production-ready-monitoring":"actuator.monitoring",
"production-ready-process-monitoring":"actuator.process-monitoring",
"production-ready-process-monitoring-configuration":"actuator.process-monitoring.configuration",
"production-ready-process-monitoring-programmatically":"actuator.process-monitoring.programmatically",
"production-ready-whats-next":"actuator.whats-next",
"reactive-health-indicators":"actuator.endpoints.health.reactive-health-indicators",
"reactive-health-indicators-autoconfigured":"actuator.endpoints.health.auto-configured-reactive-health-indicators",
"rsocket-properties":"application-properties.rsocket",
"running-remote-client-application":"using.devtools.remote-applications.client",
"security-properties":"application-properties.security",
"server-properties":"application-properties.server",
"spring-boot-ant-exejar":"build-tool-plugins.antlib.tasks.exejar",
"spring-boot-ant-exejar-examples":"build-tool-plugins.antlib.tasks.examples",
"spring-boot-ant-findmainclass":"build-tool-plugins.antlib.findmainclass",
"spring-boot-ant-findmainclass-examples":"build-tool-plugins.antlib.findmainclass.examples",
"spring-boot-ant-tasks":"build-tool-plugins.antlib.tasks",
"spring-boot-reference-documentation":"index",
"templating-properties":"application-properties.templating",
"test-auto-configuration-slices":"test-auto-configuration.slices",
"testing-properties":"application-properties.testing",
"transaction-properties":"application-properties.transaction",
"using-boot":"using",
"using-boot-ant":"using.build-systems.ant",
"using-boot-auto-configuration":"using.auto-configuration",
"using-boot-build-systems":"using.build-systems",
"using-boot-configuration-classes":"using.configuration-classes",
"using-boot-dependency-management":"using.build-systems.dependency-management",
"using-boot-devtools":"using.devtools",
"using-boot-devtools-customizing-classload":"using.devtools.restart.customizing-the-classload",
"using-boot-devtools-globalsettings":"using.devtools.globalsettings",
"using-boot-devtools-known-restart-limitations":"using.devtools.restart.limitations",
"using-boot-devtools-livereload":"using.devtools.livereload",
"using-boot-devtools-property-defaults":"using.devtools.property-defaults",
"using-boot-devtools-remote":"using.devtools.remote-applications",
"using-boot-devtools-remote-update":"using.devtools.remote-applications.update",
"using-boot-devtools-restart":"using.devtools.restart",
"using-boot-devtools-restart-additional-paths":"using.devtools.restart.watching-additional-paths",
"using-boot-devtools-restart-disable":"using.devtools.restart.disable",
"using-boot-devtools-restart-exclude":"using.devtools.restart.excluding-resources",
"using-boot-devtools-restart-logging-condition-delta":"using.devtools.restart.logging-condition-delta",
"using-boot-devtools-restart-triggerfile":"using.devtools.restart.triggerfile",
"using-boot-disabling-specific-auto-configuration":"using.auto-configuration.disabling-specific",
"using-boot-gradle":"using.build-systems.gradle",
"using-boot-hot-swapping":"using.running-your-application.hot-swapping",
"using-boot-importing-configuration":"using.configuration-classes.importing-additional-configuration",
"using-boot-importing-xml-configuration":"using.configuration-classes.importing-xml-configuration",
"using-boot-locating-the-main-class":"using.structuring-your-code.locating-the-main-class",
"using-boot-maven":"using.build-systems.maven",
"using-boot-packaging-for-production":"using.packaging-for-production",
"using-boot-replacing-auto-configuration":"using.auto-configuration.replacing",
"using-boot-running-as-a-packaged-application":"using.running-your-application.as-a-packaged-application",
"using-boot-running-from-an-ide":"using.running-your-application.from-an-ide",
"using-boot-running-with-the-gradle-plugin":"using.running-your-application.with-the-gradle-plugin",
"using-boot-running-with-the-maven-plugin":"using.running-your-application.with-the-maven-plugin",
"using-boot-running-your-application":"using.running-your-application",
"using-boot-spring-beans-and-dependency-injection":"using.spring-beans-and-dependency-injection",
"using-boot-starter":"using.build-systems.starters",
"using-boot-structuring-your-code":"using.structuring-your-code",
"using-boot-using-springbootapplication-annotation":"using.using-the-springbootapplication-annotation",
"using-boot-using-the-default-package":"using.structuring-your-code.using-the-default-package",
"using-boot-whats-next":"using.whats-next",
"using-spring-boot-restart-vs-reload":"using.devtools.restart.restart-vs-reload",
"web-properties":"application-properties.web"
}
</script>
</head>
<body id="howto" class="book toc2 toc-left"><div id="banner-container" class="container" role="banner">
<div id="banner" class="contained" role="banner">
<div id="switch-theme">
<input type="checkbox" id="switch-theme-checkbox">
<label for="switch-theme-checkbox">暗黑模式</label>
</div>
</div>
</div>
<div id="tocbar-container" class="container" role="navigation">
<div id="tocbar" class="contained" role="navigation">
<button id="toggle-toc"></button>
</div>
</div>
<div id="main-container" class="container">
<div id="main" class="contained">
<div id="doc" class="doc">
<div id="header">
<h1 translation-origin="off">“How-to” Guides</h1>
<div id="toc" class="toc2">
<div id="toctitle">目录</div>
<span id="back-to-index"><a href="index.html">返回索引页</a></span><ul class="sectlevel1">
<li>
  <p translation-origin="off"><a href="howto.html#howto.application">1. Spring Boot Application</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.application.failure-analyzer">1.1. Create Your Own FailureAnalyzer</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.application.troubleshoot-auto-configuration">1.2. Troubleshoot Auto-configuration</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.application.customize-the-environment-or-application-context">1.3. Customize the Environment or ApplicationContext Before It Starts</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.application.context-hierarchy">1.4. Build an ApplicationContext Hierarchy (Adding a Parent or Root Context)</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.application.non-web-application">1.5. Create a Non-web Application</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration">2. Properties and Configuration</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.expand-properties">2.1. Automatically Expand Properties at Build Time</a></p>
<ul class="sectlevel3">
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.expand-properties.maven">2.1.1. Automatic Property Expansion Using Maven</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.expand-properties.gradle">2.1.2. Automatic Property Expansion Using Gradle</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.externalize-configuration">2.2. Externalize the Configuration of SpringApplication</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.external-properties-location">2.3. Change the Location of External Properties of an Application</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.short-command-line-arguments">2.4. Use ‘Short’ Command Line Arguments</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.yaml">2.5. Use YAML for External Properties</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.set-active-spring-profiles">2.6. Set the Active Spring Profiles</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.set-default-spring-profile-name">2.7. Set the Default Profile Name</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.change-configuration-depending-on-the-environment">2.8. Change Configuration Depending on the Environment</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.properties-and-configuration.discover-build-in-options-for-external-properties">2.9. Discover Built-in Options for External Properties</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver">3. Embedded Web Servers</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-another">3.1. Use Another Web Server</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.disable">3.2. Disabling the Web Server</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.change-port">3.3. Change the HTTP Port</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-random-port">3.4. Use a Random Unassigned HTTP Port</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.discover-port">3.5. Discover the HTTP Port at Runtime</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.enable-response-compression">3.6. Enable HTTP Response Compression</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-ssl">3.7. Configure SSL</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2">3.8. Configure HTTP/2</a></p>
<ul class="sectlevel3">
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2.tomcat">3.8.1. HTTP/2 with Tomcat</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2.jetty">3.8.2. HTTP/2 with Jetty</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2.netty">3.8.3. HTTP/2 with Reactor Netty</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-http2.undertow">3.8.4. HTTP/2 with Undertow</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure">3.9. Configure the Web Server</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener">3.10. Add a Servlet, Filter, or Listener to an Application</a></p>
<ul class="sectlevel3">
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean">3.10.1. Add a Servlet, Filter, or Listener by Using a Spring Bean</a></p>
<ul class="sectlevel4">
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean.disable">Disable Registration of a Servlet or Filter</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.using-scanning">3.10.2. Add Servlets, Filters, and Listeners by Using Classpath Scanning</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.configure-access-logs">3.11. Configure Access Logging</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-behind-a-proxy-server">3.12. Running Behind a Front-end Proxy Server</a></p>
<ul class="sectlevel3">
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-behind-a-proxy-server.tomcat">3.12.1. Customize Tomcat’s Proxy Configuration</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.enable-multiple-connectors-in-tomcat">3.13. Enable Multiple Connectors with Tomcat</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.use-tomcat-legacycookieprocessor">3.14. Use Tomcat’s LegacyCookieProcessor</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.enable-tomcat-mbean-registry">3.15. Enable Tomcat’s MBean Registry</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.enable-multiple-listeners-in-undertow">3.16. Enable Multiple Listeners with Undertow</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.webserver.create-websocket-endpoints-using-serverendpoint">3.17. Create WebSocket Endpoints Using @ServerEndpoint</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc">4. Spring MVC</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.write-json-rest-service">4.1. Write a JSON REST Service</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.write-xml-rest-service">4.2. Write an XML REST Service</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.customize-jackson-objectmapper">4.3. Customize the Jackson ObjectMapper</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.customize-responsebody-rendering">4.4. Customize the @ResponseBody Rendering</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.multipart-file-uploads">4.5. Handling Multipart File Uploads</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.switch-off-dispatcherservlet">4.6. Switch Off the Spring MVC DispatcherServlet</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.switch-off-default-configuration">4.7. Switch off the Default MVC Configuration</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.spring-mvc.customize-view-resolvers">4.8. Customize ViewResolvers</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.jersey">5. Jersey</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.jersey.spring-security">5.1. Secure Jersey endpoints with Spring Security</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.jersey.alongside-another-web-framework">5.2. Use Jersey Alongside Another Web Framework</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.http-clients">6. HTTP Clients</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.http-clients.rest-template-proxy-configuration">6.1. Configure RestTemplate to Use a Proxy</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.http-clients.webclient-reactor-netty-customization">6.2. Configure the TcpClient used by a Reactor Netty-based WebClient</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.logging">7. Logging</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.logging.logback">7.1. Configure Logback for Logging</a></p>
<ul class="sectlevel3">
<li>
  <p translation-origin="off"><a href="howto.html#howto.logging.logback.file-only-output">7.1.1. Configure Logback for File-only Output</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.logging.log4j">7.2. Configure Log4j for Logging</a></p>
<ul class="sectlevel3">
<li>
  <p translation-origin="off"><a href="howto.html#howto.logging.log4j.yaml-or-json-config">7.2.1. Use YAML or JSON to Configure Log4j 2</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.logging.log4j.composite-configuration">7.2.2. Use Composite Configuration to Configure Log4j 2</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access">8. Data Access</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-custom-datasource">8.1. Configure a Custom DataSource</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-two-datasources">8.2. Configure Two DataSources</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.spring-data-repositories">8.3. Use Spring Data Repositories</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.separate-entity-definitions-from-spring-configuration">8.4. Separate @Entity Definitions from Spring Configuration</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.jpa-properties">8.5. Configure JPA Properties</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-hibernate-naming-strategy">8.6. Configure Hibernate Naming Strategy</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-hibernate-second-level-caching">8.7. Configure Hibernate Second-Level Caching</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.dependency-injection-in-hibernate-components">8.8. Use Dependency Injection in Hibernate Components</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.use-custom-entity-manager">8.9. Use a Custom EntityManagerFactory</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.use-multiple-entity-managers">8.10. Using Multiple EntityManagerFactories</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.use-traditional-persistence-xml">8.11. Use a Traditional persistence.xml File</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.use-spring-data-jpa-and-mongo-repositories">8.12. Use Spring Data JPA and Mongo Repositories</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.customize-spring-data-web-support">8.13. Customize Spring Data’s Web Support</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.exposing-spring-data-repositories-as-rest">8.14. Expose Spring Data Repositories as REST Endpoint</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-a-component-that-is-used-by-jpa">8.15. Configure a Component that is Used by JPA</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-access.configure-jooq-with-multiple-datasources">8.16. Configure jOOQ with Two DataSources</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization">9. Database Initialization</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.using-jpa">9.1. Initialize a Database Using JPA</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.using-hibernate">9.2. Initialize a Database Using Hibernate</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.using-basic-sql-scripts">9.3. Initialize a Database Using Basic SQL Scripts</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.batch">9.4. Initialize a Spring Batch Database</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.migration-tool">9.5. Use a Higher-level Database Migration Tool</a></p>
<ul class="sectlevel3">
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.migration-tool.flyway">9.5.1. Execute Flyway Database Migrations on Startup</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.migration-tool.liquibase">9.5.2. Execute Liquibase Database Migrations on Startup</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.dependencies">9.6. Depend Upon an Initialized Database</a></p>
<ul class="sectlevel3">
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.dependencies.initializer-detection">9.6.1. Detect a Database Initializer</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.data-initialization.dependencies.depends-on-initialization-detection">9.6.2. Detect a Bean That Depends On Database Initialization</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.messaging">10. Messaging</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.messaging.disable-transacted-jms-session">10.1. Disable Transacted JMS Session</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.batch">11. Batch Applications</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.batch.specifying-a-data-source">11.1. Specifying a Batch Data Source</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.batch.running-jobs-on-startup">11.2. Running Spring Batch Jobs on Startup</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.batch.running-from-the-command-line">11.3. Running from the Command Line</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.batch.storing-job-repository">11.4. Storing the Job Repository</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.actuator">12. Actuator</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.actuator.change-http-port-or-address">12.1. Change the HTTP Port or Address of the Actuator Endpoints</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.actuator.customize-whitelabel-error-page">12.2. Customize the ‘whitelabel’ Error Page</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.actuator.sanitize-sensitive-values">12.3. Sanitize Sensitive Values</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.actuator.map-health-indicators-to-metrics">12.4. Map Health Indicators to Micrometer Metrics</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.security">13. Security</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.security.switch-off-spring-boot-configuration">13.1. Switch off the Spring Boot Security Configuration</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.security.change-user-details-service-and-add-user-accounts">13.2. Change the UserDetailsService and Add User Accounts</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.security.enable-https">13.3. Enable HTTPS When Running behind a Proxy Server</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping">14. Hot Swapping</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-static-content">14.1. Reload Static Content</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-templates">14.2. Reload Templates without Restarting the Container</a></p>
<ul class="sectlevel3">
<li>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-templates.thymeleaf">14.2.1. Thymeleaf Templates</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-templates.freemarker">14.2.2. FreeMarker Templates</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-templates.groovy">14.2.3. Groovy Templates</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.fast-application-restarts">14.3. Fast Application Restarts</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.hotswapping.reload-java-classes-without-restarting">14.4. Reload Java Classes without Restarting the Container</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.testing">15. Testing</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.testing.with-spring-security">15.1. Testing With Spring Security</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.testing.testcontainers">15.2. Use Testcontainers for Integration Testing</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.build">16. Build</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.build.generate-info">16.1. Generate Build Information</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.build.generate-git-info">16.2. Generate Git Information</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.build.customize-dependency-versions">16.3. Customize Dependency Versions</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.build.create-an-executable-jar-with-maven">16.4. Create an Executable JAR with Maven</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.build.use-a-spring-boot-application-as-dependency">16.5. Use a Spring Boot Application as a Dependency</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.build.extract-specific-libraries-when-an-executable-jar-runs">16.6. Extract Specific Libraries When an Executable Jar Runs</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.build.create-a-nonexecutable-jar">16.7. Create a Non-executable JAR with Exclusions</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.build.remote-debug-maven">16.8. Remote Debug a Spring Boot Application Started with Maven</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib">16.9. Build an Executable Archive from Ant without Using spring-boot-antlib</a></p>
</li>
</ul>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.traditional-deployment">17. Traditional Deployment</a></p>
<ul class="sectlevel2">
<li>
  <p translation-origin="off"><a href="howto.html#howto.traditional-deployment.war">17.1. Create a Deployable War File</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.traditional-deployment.convert-existing-application">17.2. Convert an Existing Application to Spring Boot</a></p>
</li>
<li>
  <p translation-origin="off"><a href="howto.html#howto.traditional-deployment.weblogic">17.3. Deploying a WAR to WebLogic</a></p>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">This section provides answers to some common ‘how do I do that…​’ questions that often arise when using Spring Boot.
Its coverage is not exhaustive, but it does cover quite a lot.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If you have a specific problem that we do not cover here, you might want to check <a href="https://stackoverflow.com/tags/spring-boot">stackoverflow.com</a> to see if someone has already provided an answer.
This is also a great place to ask new questions (please use the <code>spring-boot</code> tag).</p>
</div>
<div class="paragraph">
<p translation-origin="off">We are also more than happy to extend this section.
If you want to add a ‘how-to’, send us a <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3">pull request</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.application" translation-origin="off"><a class="anchor" href="howto.html#howto.application"></a>1. Spring Boot Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">This section includes topics relating directly to Spring Boot applications.</p>
</div>
<div class="sect2">
<h3 id="howto.application.failure-analyzer" translation-origin="off"><a class="anchor" href="howto.html#howto.application.failure-analyzer"></a>1.1. Create Your Own FailureAnalyzer</h3>
<div class="paragraph">
<p translation-origin="off"><a href="https://docs.spring.io/spring-boot/docs/2.6.3/api/org/springframework/boot/diagnostics/FailureAnalyzer.html"><code>FailureAnalyzer</code></a> is a great way to intercept an exception on startup and turn it into a human-readable message, wrapped in a <a href="https://docs.spring.io/spring-boot/docs/2.6.3/api/org/springframework/boot/diagnostics/FailureAnalysis.html"><code>FailureAnalysis</code></a>.
Spring Boot provides such an analyzer for application-context-related exceptions, JSR-303 validations, and more.
You can also create your own.</p>
</div>
<div class="paragraph">
<p translation-origin="off"><code>AbstractFailureAnalyzer</code> is a convenient extension of <code>FailureAnalyzer</code> that checks the presence of a specified exception type in the exception to handle.
You can extend from that so that your implementation gets a chance to handle the exception only when it is actually present.
If, for whatever reason, you cannot handle the exception, return <code>null</code> to give another implementation a chance to handle the exception.</p>
</div>
<div class="paragraph">
<p translation-origin="off"><code>FailureAnalyzer</code> implementations must be registered in <code>META-INF/spring.factories</code>.
The following example registers <code>ProjectConstraintViolationFailureAnalyzer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">org.springframework.boot.diagnostics.FailureAnalyzer=\
com.example.ProjectConstraintViolationFailureAnalyzer</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">If you need access to the <code>BeanFactory</code> or the <code>Environment</code>, your <code>FailureAnalyzer</code> can implement <code>BeanFactoryAware</code> or <code>EnvironmentAware</code> respectively.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.application.troubleshoot-auto-configuration" translation-origin="off"><a class="anchor" href="howto.html#howto.application.troubleshoot-auto-configuration"></a>1.2. Troubleshoot Auto-configuration</h3>
<div class="paragraph">
<p translation-origin="off">The Spring Boot auto-configuration tries its best to “do the right thing”, but sometimes things fail, and it can be hard to tell why.</p>
</div>
<div class="paragraph">
<p translation-origin="off">There is a really useful <code>ConditionEvaluationReport</code> available in any Spring Boot <code>ApplicationContext</code>.
You can see it if you enable <code>DEBUG</code> logging output.
If you use the <code>spring-boot-actuator</code> (see <a href="actuator.html#actuator">the Actuator chapter</a>), there is also a <code>conditions</code> endpoint that renders the report in JSON.
Use that endpoint to debug the application and see what features have been added (and which have not been added) by Spring Boot at runtime.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Many more questions can be answered by looking at the source code and the Javadoc.
When reading the code, remember the following rules of thumb:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off">Look for classes called <code>*AutoConfiguration</code> and read their sources.
Pay special attention to the <code>@Conditional*</code> annotations to find out what features they enable and when.
Add <code>--debug</code> to the command line or a System property <code>-Ddebug</code> to get a log on the console of all the auto-configuration decisions that were made in your app.
In a running application with actuator enabled, look at the <code>conditions</code> endpoint (<code>/actuator/conditions</code> or the JMX equivalent) for the same information.</p>
</li>
<li>
<p translation-origin="off">Look for classes that are <code>@ConfigurationProperties</code> (such as <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ServerProperties.java"><code>ServerProperties</code></a>) and read from there the available external configuration options.
The <code>@ConfigurationProperties</code> annotation has a <code>name</code> attribute that acts as a prefix to external properties.
Thus, <code>ServerProperties</code> has <code>prefix="server"</code> and its configuration properties are <code>server.port</code>, <code>server.address</code>, and others.
In a running application with actuator enabled, look at the <code>configprops</code> endpoint.</p>
</li>
<li>
<p translation-origin="off">Look for uses of the <code>bind</code> method on the <code>Binder</code> to pull configuration values explicitly out of the <code>Environment</code> in a relaxed manner.
It is often used with a prefix.</p>
</li>
<li>
<p translation-origin="off">Look for <code>@Value</code> annotations that bind directly to the <code>Environment</code>.</p>
</li>
<li>
<p translation-origin="off">Look for <code>@ConditionalOnExpression</code> annotations that switch features on and off in response to SpEL expressions, normally evaluated with placeholders resolved from the <code>Environment</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="howto.application.customize-the-environment-or-application-context" translation-origin="off"><a class="anchor" href="howto.html#howto.application.customize-the-environment-or-application-context"></a>1.3. Customize the Environment or ApplicationContext Before It Starts</h3>
<div class="paragraph">
<p translation-origin="off">A <code>SpringApplication</code> has <code>ApplicationListeners</code> and <code>ApplicationContextInitializers</code> that are used to apply customizations to the context or environment.
Spring Boot loads a number of such customizations for use internally from <code>META-INF/spring.factories</code>.
There is more than one way to register additional customizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off">Programmatically, per application, by calling the <code>addListeners</code> and <code>addInitializers</code> methods on <code>SpringApplication</code> before you run it.</p>
</li>
<li>
<p translation-origin="off">Declaratively, per application, by setting the <code>context.initializer.classes</code> or <code>context.listener.classes</code> properties.</p>
</li>
<li>
<p translation-origin="off">Declaratively, for all applications, by adding a <code>META-INF/spring.factories</code> and packaging a jar file that the applications all use as a library.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">The <code>SpringApplication</code> sends some special <code>ApplicationEvents</code> to the listeners (some even before the context is created) and then registers the listeners for events published by the <code>ApplicationContext</code> as well.
See “<a href="features.html#features.spring-application.application-events-and-listeners">Application Events and Listeners</a>” in the ‘Spring Boot features’ section for a complete list.</p>
</div>
<div class="paragraph">
<p translation-origin="off">It is also possible to customize the <code>Environment</code> before the application context is refreshed by using <code>EnvironmentPostProcessor</code>.
Each implementation should be registered in <code>META-INF/spring.factories</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.springframework.boot.env.EnvironmentPostProcessor=com.example.YourEnvironmentPostProcessor</pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The implementation can load arbitrary files and add them to the <code>Environment</code>.
For instance, the following example loads a YAML configuration file from the classpath:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.io.IOException;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.env.EnvironmentPostProcessor;
import org.springframework.boot.env.YamlPropertySourceLoader;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.core.env.PropertySource;
import org.springframework.core.io.ClassPathResource;
import org.springframework.core.io.Resource;
import org.springframework.util.Assert;

</span><span class="fold-block">public class MyEnvironmentPostProcessor implements EnvironmentPostProcessor {

    private final YamlPropertySourceLoader loader = new YamlPropertySourceLoader();

    @Override
    public void postProcessEnvironment(ConfigurableEnvironment environment, SpringApplication application) {
        Resource path = new ClassPathResource("com/example/myapp/config.yml");
        PropertySource&lt;?&gt; propertySource = loadYaml(path);
        environment.getPropertySources().addLast(propertySource);
    }

    private PropertySource&lt;?&gt; loadYaml(Resource path) {
        Assert.isTrue(path.exists(), () -&gt; "Resource " + path + " does not exist");
        try {
            return this.loader.load("custom-resource", path).get(0);
        }
        catch (IOException ex) {
            throw new IllegalStateException("Failed to load yaml configuration from " + path, ex);
        }
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">The <code>Environment</code> has already been prepared with all the usual property sources that Spring Boot loads by default.
It is therefore possible to get the location of the file from the environment.
The preceding example adds the <code>custom-resource</code> property source at the end of the list so that a key defined in any of the usual other locations takes precedence.
A custom implementation may define another order.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="小心"></i>
</td>
<td class="content">
<p translation-origin="off">While using <code>@PropertySource</code> on your <code>@SpringBootApplication</code> may seem to be a convenient way to load a custom resource in the <code>Environment</code>, we do not recommend it.
Such property sources are not added to the <code>Environment</code> until the application context is being refreshed.
This is too late to configure certain properties such as <code>logging.*</code> and <code>spring.main.*</code> which are read before refresh begins.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.application.context-hierarchy" translation-origin="off"><a class="anchor" href="howto.html#howto.application.context-hierarchy"></a>1.4. Build an ApplicationContext Hierarchy (Adding a Parent or Root Context)</h3>
<div class="paragraph">
<p translation-origin="off">You can use the <code>ApplicationBuilder</code> class to create parent/child <code>ApplicationContext</code> hierarchies.
See “<a href="features.html#features.spring-application.fluent-builder-api">features.html</a>” in the ‘Spring Boot features’ section for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.application.non-web-application" translation-origin="off"><a class="anchor" href="howto.html#howto.application.non-web-application"></a>1.5. Create a Non-web Application</h3>
<div class="paragraph">
<p translation-origin="off">Not all Spring applications have to be web applications (or web services).
If you want to execute some code in a <code>main</code> method but also bootstrap a Spring application to set up the infrastructure to use, you can use the <code>SpringApplication</code> features of Spring Boot.
A <code>SpringApplication</code> changes its <code>ApplicationContext</code> class, depending on whether it thinks it needs a web application or not.
The first thing you can do to help it is to leave server-related dependencies (such as the servlet API) off the classpath.
If you cannot do that (for example, you run two applications from the same code base) then you can explicitly call <code>setWebApplicationType(WebApplicationType.NONE)</code> on your <code>SpringApplication</code> instance or set the <code>applicationContextClass</code> property (through the Java API or with external properties).
Application code that you want to run as your business logic can be implemented as a <code>CommandLineRunner</code> and dropped into the context as a <code>@Bean</code> definition.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.properties-and-configuration" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration"></a>2. Properties and Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">This section includes topics about setting and reading properties and configuration settings and their interaction with Spring Boot applications.</p>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.expand-properties" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.expand-properties"></a>2.1. Automatically Expand Properties at Build Time</h3>
<div class="paragraph">
<p translation-origin="off">Rather than hardcoding some properties that are also specified in your project’s build configuration, you can automatically expand them by instead using the existing build configuration.
This is possible in both Maven and Gradle.</p>
</div>
<div class="sect3">
<h4 id="howto.properties-and-configuration.expand-properties.maven" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.expand-properties.maven"></a>2.1.1. Automatic Property Expansion Using Maven</h4>
<div class="paragraph">
<p translation-origin="off">You can automatically expand properties from the Maven project by using resource filtering.
If you use the <code>spring-boot-starter-parent</code>, you can then refer to your Maven ‘project properties’ with <code>@<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d0fefe90">[email&nbsp;protected]</a></code> placeholders, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"><a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d1b0a1a1ffb4bfb2beb5b8bfb6ec91a1a3bebbb4b2a5ffb3a4b8bdb5ffa2bea4a3b2b494bfb2beb5b8bfb6">[email&nbsp;protected]</a>@
<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="84e5f4f4aaeee5f2e5aaf2e1f6f7edebeab9c4eee5f2e5aaf2e1f6f7edebea">[email&nbsp;protected]</a>@</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  encoding: "@<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b8c8cad7d2dddbcc96dacdd1d4dc96cbd7cdcadbddfdd6dbd7dcd1d6dff8">[email&nbsp;protected]</a>"
  java:
    version: "@<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="93f9f2e5f2bde5f6e1e0fafcfdd3">[email&nbsp;protected]</a>"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">Only production configuration is filtered that way (in other words, no filtering is applied on <code>src/test/resources</code>).</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">If you enable the <code>addResources</code> flag, the <code>spring-boot:run</code> goal can add <code>src/main/resources</code> directly to the classpath (for hot reloading purposes).
Doing so circumvents the resource filtering and this feature.
Instead, you can use the <code>exec:java</code> goal or customize the plugin’s configuration.
See the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#getting-started">plugin usage page</a> for more details.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">If you do not use the starter parent, you need to include the following element inside the <code>&lt;build/&gt;</code> element of your <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;resources&gt;
    &lt;resource&gt;
        &lt;directory&gt;src/main/resources&lt;/directory&gt;
        &lt;filtering&gt;true&lt;/filtering&gt;
    &lt;/resource&gt;
&lt;/resources&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">You also need to include the following element inside <code>&lt;plugins/&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.7&lt;/version&gt;
    &lt;configuration&gt;
        &lt;delimiters&gt;
            &lt;delimiter&gt;@&lt;/delimiter&gt;
        &lt;/delimiters&gt;
        &lt;useDefaultDelimiters&gt;false&lt;/useDefaultDelimiters&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">The <code>useDefaultDelimiters</code> property is important if you use standard Spring placeholders (such as <code>${placeholder}</code>) in your configuration.
If that property is not set to <code>false</code>, these may be expanded by the build.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="howto.properties-and-configuration.expand-properties.gradle" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.expand-properties.gradle"></a>2.1.2. Automatic Property Expansion Using Gradle</h4>
<div class="paragraph">
<p translation-origin="off">You can automatically expand properties from the Gradle project by configuring the Java plugin’s <code>processResources</code> task to do so, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">processResources {
    expand(project.properties)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">You can then refer to your Gradle project’s properties by using placeholders, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.name=${name}
app.description=${description}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  name: "${name}"
  description: "${description}"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">Gradle’s <code>expand</code> method uses Groovy’s <code>SimpleTemplateEngine</code>, which transforms <code>${..}</code> tokens.
The <code>${..}</code> style conflicts with Spring’s own property placeholder mechanism.
To use Spring property placeholders together with automatic expansion, escape the Spring property placeholders as follows: <code>\${..}</code>.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.externalize-configuration" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.externalize-configuration"></a>2.2. Externalize the Configuration of SpringApplication</h3>
<div class="paragraph">
<p translation-origin="off">A <code>SpringApplication</code> has bean property setters, so you can use its Java API as you create the application to modify its behavior.
Alternatively, you can externalize the configuration by setting properties in <code>spring.main.*</code>.
For example, in <code>application.properties</code>, you might have the following settings:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.main.web-application-type=none
spring.main.banner-mode=off</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  main:
    web-application-type: "none"
    banner-mode: "off"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Then the Spring Boot banner is not printed on startup, and the application is not starting an embedded web server.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Properties defined in external configuration override and replace the values specified with the Java API, with the notable exception of the primary sources.
Primary sources are those provided to the <code>SpringApplication</code> constructor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.Banner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication {

    public static void main(String[] args) {
        SpringApplication application = new SpringApplication(MyApplication.class);
        application.setBannerMode(Banner.Mode.OFF);
        application.run(args);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Or to <code>sources(…​)</code> method of a <code>SpringApplicationBuilder</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.Banner;
import org.springframework.boot.builder.SpringApplicationBuilder;

</span><span class="fold-block">public class MyApplication {

    public static void main(String[] args) {
        new SpringApplicationBuilder()
            .bannerMode(Banner.Mode.OFF)
            .sources(MyApplication.class)
            .run(args);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Given the examples above, if we have the following configuration:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.main.sources=com.example.MyDatabaseConfig,com.example.MyJmsConfig
spring.main.banner-mode=console</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  main:
    sources: "com.example.MyDatabaseConfig,com.example.MyJmsConfig"
    banner-mode: "console"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The actual application will show the banner (as overridden by configuration) and uses three sources for the <code>ApplicationContext</code>.
The application sources are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p translation-origin="off"><code>MyApplication</code> (from the code)</p>
</li>
<li>
<p translation-origin="off"><code>MyDatabaseConfig</code> (from the external config)</p>
</li>
<li>
<p translation-origin="off"><code>MyJmsConfig</code>(from the external config)</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.external-properties-location" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.external-properties-location"></a>2.3. Change the Location of External Properties of an Application</h3>
<div class="paragraph">
<p translation-origin="off">By default, properties from different sources are added to the Spring <code>Environment</code> in a defined order (see “<a href="features.html#features.external-config">features.html</a>” in the ‘Spring Boot features’ section for the exact order).</p>
</div>
<div class="paragraph">
<p translation-origin="off">You can also provide the following System properties (or environment variables) to change the behavior:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>spring.config.name</code> (<code>SPRING_CONFIG_NAME</code>): Defaults to <code>application</code> as the root of the file name.</p>
</li>
<li>
<p translation-origin="off"><code>spring.config.location</code> (<code>SPRING_CONFIG_LOCATION</code>): The file to load (such as a classpath resource or a URL).
A separate <code>Environment</code> property source is set up for this document and it can be overridden by system properties, environment variables, or the command line.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">No matter what you set in the environment, Spring Boot always loads <code>application.properties</code> as described above.
By default, if YAML is used, then files with the ‘.yml’ extension are also added to the list.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot logs the configuration files that are loaded at the <code>DEBUG</code> level and the candidates it has not found at <code>TRACE</code> level.</p>
</div>
<div class="paragraph">
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/context/config/ConfigFileApplicationListener.java"><code>ConfigFileApplicationListener</code></a> for more detail.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.short-command-line-arguments" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.short-command-line-arguments"></a>2.4. Use ‘Short’ Command Line Arguments</h3>
<div class="paragraph">
<p translation-origin="off">Some people like to use (for example) <code>--port=9000</code> instead of <code>--server.port=9000</code> to set configuration properties on the command line.
You can enable this behavior by using placeholders in <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.port=${port:8080}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  port: "${port:8080}"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">If you inherit from the <code>spring-boot-starter-parent</code> POM, the default filter token of the <code>maven-resources-plugins</code> has been changed from <code>${*}</code> to <code>@</code> (that is, <code>@<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5b363a2d3e35752f34303e351b">[email&nbsp;protected]</a></code> instead of <code>${maven.token}</code>) to prevent conflicts with Spring-style placeholders.
If you have enabled Maven filtering for the <code>application.properties</code> directly, you may want to also change the default filter token to use <a href="https://maven.apache.org/plugins/maven-resources-plugin/resources-mojo.html#delimiters">other delimiters</a>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">In this specific case, the port binding works in a PaaS environment such as Heroku or Cloud Foundry.
In those two platforms, the <code>PORT</code> environment variable is set automatically and Spring can bind to capitalized synonyms for <code>Environment</code> properties.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.yaml" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.yaml"></a>2.5. Use YAML for External Properties</h3>
<div class="paragraph">
<p translation-origin="off">YAML is a superset of JSON and, as such, is a convenient syntax for storing external properties in a hierarchical format, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  application:
    name: "cruncher"
  datasource:
    driver-class-name: "com.mysql.jdbc.Driver"
    url: "jdbc:mysql://localhost/test"
server:
  port: 9000</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Create a file called <code>application.yml</code> and put it in the root of your classpath.
Then add <code>snakeyaml</code> to your dependencies (Maven coordinates <code>org.yaml:snakeyaml</code>, already included if you use the <code>spring-boot-starter</code>).
A YAML file is parsed to a Java <code>Map&lt;String,Object&gt;</code> (like a JSON object), and Spring Boot flattens the map so that it is one level deep and has period-separated keys, as many people are used to with <code>Properties</code> files in Java.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The preceding example YAML corresponds to the following <code>application.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.application.name=cruncher
spring.datasource.driver-class-name=com.mysql.jdbc.Driver
spring.datasource.url=jdbc:mysql://localhost/test
server.port=9000</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">See “<a href="features.html#features.external-config.yaml">features.html</a>” in the ‘Spring Boot features’ section for more information about YAML.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.set-active-spring-profiles" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.set-active-spring-profiles"></a>2.6. Set the Active Spring Profiles</h3>
<div class="paragraph">
<p translation-origin="off">The Spring <code>Environment</code> has an API for this, but you would normally set a System property (<code>spring.profiles.active</code>) or an OS environment variable (<code>SPRING_PROFILES_ACTIVE</code>).
Also, you can launch your application with a <code>-D</code> argument (remember to put it before the main class or jar archive), as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar -Dspring.profiles.active=production demo-0.0.1-SNAPSHOT.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">In Spring Boot, you can also set the active profile in <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.profiles.active=production</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  profiles:
    active: "production"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">A value set this way is replaced by the System property or environment variable setting but not by the <code>SpringApplicationBuilder.profiles()</code> method.
Thus, the latter Java API can be used to augment the profiles without changing the defaults.</p>
</div>
<div class="paragraph">
<p translation-origin="off">See “<a href="features.html#features.profiles">features.html</a>” in the “Spring Boot features” section for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.set-default-spring-profile-name" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.set-default-spring-profile-name"></a>2.7. Set the Default Profile Name</h3>
<div class="paragraph">
<p translation-origin="off">The default profile is a profile that is enabled if no profile is active.
By default, the name of the default profile is <code>default</code>, but it could be changed using a System property (<code>spring.profiles.default</code>) or an OS environment variable (<code>SPRING_PROFILES_DEFAULT</code>).</p>
</div>
<div class="paragraph">
<p translation-origin="off">In Spring Boot, you can also set the default profile name in <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.profiles.default=dev</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  profiles:
    default: "dev"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">See “<a href="features.html#features.profiles">features.html</a>” in the “Spring Boot features” section for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.change-configuration-depending-on-the-environment" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.change-configuration-depending-on-the-environment"></a>2.8. Change Configuration Depending on the Environment</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot supports multi-document YAML and Properties files (see <a href="features.html#features.external-config.files.multi-document">features.html</a> for details) which can be activated conditionally based on the active profiles.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If a document contains a <code>spring.config.activate.on-profile</code> key, then the profiles value (a comma-separated list of profiles or a profile expression) is fed into the Spring <code>Environment.acceptsProfiles()</code> method.
If the profile expression matches then that document is included in the final merge (otherwise, it is not), as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.port=9000
#---
spring.config.activate.on-profile=development
server.port=9001
#---
spring.config.activate.on-profile=production
server.port=0</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  port: 9000
---
spring:
  config:
    activate:
      on-profile: "development"
server:
  port: 9001
---
spring:
  config:
    activate:
      on-profile: "production"
server:
  port: 0</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">In the preceding example, the default port is 9000.
However, if the Spring profile called ‘development’ is active, then the port is 9001.
If ‘production’ is active, then the port is 0.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">The documents are merged in the order in which they are encountered.
Later values override earlier values.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.properties-and-configuration.discover-build-in-options-for-external-properties" translation-origin="off"><a class="anchor" href="howto.html#howto.properties-and-configuration.discover-build-in-options-for-external-properties"></a>2.9. Discover Built-in Options for External Properties</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot binds external properties from <code>application.properties</code> (or <code>.yml</code> files and other places) into an application at runtime.
There is not (and technically cannot be) an exhaustive list of all supported properties in a single location, because contributions can come from additional jar files on your classpath.</p>
</div>
<div class="paragraph">
<p translation-origin="off">A running application with the Actuator features has a <code>configprops</code> endpoint that shows all the bound and bindable properties available through <code>@ConfigurationProperties</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The appendix includes an <a href="application-properties.html#application-properties"><code>application.properties</code></a> example with a list of the most common properties supported by Spring Boot.
The definitive list comes from searching the source code for <code>@ConfigurationProperties</code> and <code>@Value</code> annotations as well as the occasional use of <code>Binder</code>.
For more about the exact ordering of loading properties, see "<a href="features.html#features.external-config">features.html</a>".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.webserver" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver"></a>3. Embedded Web Servers</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Each Spring Boot web application includes an embedded web server.
This feature leads to a number of how-to questions, including how to change the embedded server and how to configure the embedded server.
This section answers those questions.</p>
</div>
<div class="sect2">
<h3 id="howto.webserver.use-another" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-another"></a>3.1. Use Another Web Server</h3>
<div class="paragraph">
<p translation-origin="off">Many Spring Boot starters include default embedded containers.</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off">For servlet stack applications, the <code>spring-boot-starter-web</code> includes Tomcat by including <code>spring-boot-starter-tomcat</code>, but you can use <code>spring-boot-starter-jetty</code> or <code>spring-boot-starter-undertow</code> instead.</p>
</li>
<li>
<p translation-origin="off">For reactive stack applications, the <code>spring-boot-starter-webflux</code> includes Reactor Netty by including <code>spring-boot-starter-reactor-netty</code>, but you can use <code>spring-boot-starter-tomcat</code>, <code>spring-boot-starter-jetty</code>, or <code>spring-boot-starter-undertow</code> instead.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">When switching to a different HTTP server, you need to swap the default dependencies for those that you need instead.
To help with this process, Spring Boot provides a separate starter for each of the supported HTTP servers.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The following Maven example shows how to exclude Tomcat and include Jetty for Spring MVC:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;properties&gt;
    &lt;servlet-api.version&gt;3.1.0&lt;/servlet-api.version&gt;
&lt;/properties&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;!-- Exclude the Tomcat dependency --&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;!-- Use Jetty instead --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">The version of the servlet API has been overridden as, unlike Tomcat 9 and Undertow 2, Jetty 9.4 does not support servlet 4.0.
If you wish to use Jetty 10, which does support servlet 4.0, override the <code>jetty.version</code> property rather than the <code>servlet-api.version</code> property.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">The following Gradle example configures the necessary dependencies and a <a href="https://docs.gradle.org/current/userguide/resolution_rules.html#sec:module_replacement">module replacement</a> to use Undertow in place of Reactor Netty for Spring WebFlux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">dependencies {
    implementation "org.springframework.boot:spring-boot-starter-undertow"
    implementation "org.springframework.boot:spring-boot-starter-webflux"
    modules {
        module("org.springframework.boot:spring-boot-starter-reactor-netty") {
            replacedBy("org.springframework.boot:spring-boot-starter-undertow", "Use Undertow instead of Reactor Netty")
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off"><code>spring-boot-starter-reactor-netty</code> is required to use the <code>WebClient</code> class, so you may need to keep a dependency on Netty even when you need to include a different HTTP server.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.disable" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.disable"></a>3.2. Disabling the Web Server</h3>
<div class="paragraph">
<p translation-origin="off">If your classpath contains the necessary bits to start a web server, Spring Boot will automatically start it.
To disable this behavior configure the <code>WebApplicationType</code> in your <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.main.web-application-type=none</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  main:
    web-application-type: "none"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.change-port" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.change-port"></a>3.3. Change the HTTP Port</h3>
<div class="paragraph">
<p translation-origin="off">In a standalone application, the main HTTP port defaults to <code>8080</code> but can be set with <code>server.port</code> (for example, in <code>application.properties</code> or as a System property).
Thanks to relaxed binding of <code>Environment</code> values, you can also use <code>SERVER_PORT</code> (for example, as an OS environment variable).</p>
</div>
<div class="paragraph">
<p translation-origin="off">To switch off the HTTP endpoints completely but still create a <code>WebApplicationContext</code>, use <code>server.port=-1</code> (doing so is sometimes useful for testing).</p>
</div>
<div class="paragraph">
<p translation-origin="off">For more details, see “<a href="web.html#web.servlet.embedded-container.customizing">web.html</a>” in the ‘Spring Boot Features’ section, or the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ServerProperties.java"><code>ServerProperties</code></a> source code.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.use-random-port" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-random-port"></a>3.4. Use a Random Unassigned HTTP Port</h3>
<div class="paragraph">
<p translation-origin="off">To scan for a free port (using OS natives to prevent clashes) use <code>server.port=0</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.discover-port" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.discover-port"></a>3.5. Discover the HTTP Port at Runtime</h3>
<div class="paragraph">
<p translation-origin="off">You can access the port the server is running on from log output or from the <code>WebServerApplicationContext</code> through its <code>WebServer</code>.
The best way to get that and be sure it has been initialized is to add a <code>@Bean</code> of type <code>ApplicationListener&lt;WebServerInitializedEvent&gt;</code> and pull the container out of the event when it is published.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Tests that use <code>@SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT)</code> can also inject the actual port into a field by using the <code>@LocalServerPort</code> annotation, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.SpringBootTest.WebEnvironment;
import org.springframework.boot.web.server.LocalServerPort;

</span><span class="fold-block">@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
public class MyWebIntegrationTests {

    @LocalServerPort
    int port;

    // ...

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-origin="off"><code>@LocalServerPort</code> is a meta-annotation for <code>@Value("${local.server.port}")</code>.
Do not try to inject the port in a regular application.
As we just saw, the value is set only after the container has been initialized.
Contrary to a test, application code callbacks are processed early (before the value is actually available).</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.enable-response-compression" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.enable-response-compression"></a>3.6. Enable HTTP Response Compression</h3>
<div class="paragraph">
<p translation-origin="off">HTTP response compression is supported by Jetty, Tomcat, and Undertow.
It can be enabled in <code>application.properties</code>, as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.compression.enabled=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  compression:
    enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">By default, responses must be at least 2048 bytes in length for compression to be performed.
You can configure this behavior by setting the <code>server.compression.min-response-size</code> property.</p>
</div>
<div class="paragraph">
<p translation-origin="off">By default, responses are compressed only if their content type is one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>text/html</code></p>
</li>
<li>
<p translation-origin="off"><code>text/xml</code></p>
</li>
<li>
<p translation-origin="off"><code>text/plain</code></p>
</li>
<li>
<p translation-origin="off"><code>text/css</code></p>
</li>
<li>
<p translation-origin="off"><code>text/javascript</code></p>
</li>
<li>
<p translation-origin="off"><code>application/javascript</code></p>
</li>
<li>
<p translation-origin="off"><code>application/json</code></p>
</li>
<li>
<p translation-origin="off"><code>application/xml</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">You can configure this behavior by setting the <code>server.compression.mime-types</code> property.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.configure-ssl" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-ssl"></a>3.7. Configure SSL</h3>
<div class="paragraph">
<p translation-origin="off">SSL can be configured declaratively by setting the various <code>server.ssl.*</code> properties, typically in <code>application.properties</code> or <code>application.yml</code>.
The following example shows setting SSL properties in <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.port=8443
server.ssl.key-store=classpath:keystore.jks
server.ssl.key-store-password=secret
server.ssl.key-password=another-secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  port: 8443
  ssl:
    key-store: "classpath:keystore.jks"
    key-store-password: "secret"
    key-password: "another-secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/web/server/Ssl.java"><code>Ssl</code></a> for details of all of the supported properties.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Using configuration such as the preceding example means the application no longer supports a plain HTTP connector at port 8080.
Spring Boot does not support the configuration of both an HTTP connector and an HTTPS connector through <code>application.properties</code>.
If you want to have both, you need to configure one of them programmatically.
We recommend using <code>application.properties</code> to configure HTTPS, as the HTTP connector is the easier of the two to configure programmatically.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.configure-http2" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2"></a>3.8. Configure HTTP/2</h3>
<div class="paragraph">
<p translation-origin="off">You can enable HTTP/2 support in your Spring Boot application with the <code>server.http2.enabled</code> configuration property.
Both <code>h2</code> (HTTP/2 over TLS) and <code>h2c</code> (HTTP/2 over TCP) are supported.
To use <code>h2</code>, SSL must also be enabled.
When SSL is not enabled, <code>h2c</code> will be used.
The details of the <code>h2</code> support depend on the chosen web server and the application environment, since that protocol is not supported out-of-the-box by all JDK 8 releases.</p>
</div>
<div class="sect3">
<h4 id="howto.webserver.configure-http2.tomcat" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2.tomcat"></a>3.8.1. HTTP/2 with Tomcat</h4>
<div class="paragraph">
<p translation-origin="off">Spring Boot ships by default with Tomcat 9.0.x which supports <code>h2c</code> out of the box and <code>h2</code> out of the box when using JDK 9 or later.
Alternatively, <code>h2</code> can be used on JDK 8 if the <code>libtcnative</code> library and its dependencies are installed on the host operating system.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The library directory must be made available, if not already, to the JVM library path.
You can do so with a JVM argument such as <code>-Djava.library.path=/usr/local/opt/tomcat-native/lib</code>.
More on this in the <a href="https://tomcat.apache.org/tomcat-9.0-doc/apr.html">official Tomcat documentation</a>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Starting Tomcat 9.0.x on JDK 8 with HTTP/2 and SSL enabled but without that native support logs the following error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ERROR 8787 --- [           main] o.a.coyote.http11.Http11NioProtocol      : The upgrade handler [org.apache.coyote.http2.Http2Protocol] for [h2] only supports upgrade via ALPN but has been configured for the ["https-jsse-nio-8443"] connector that does not support ALPN.</pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">This error is not fatal, and the application still starts with HTTP/1.1 SSL support.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.webserver.configure-http2.jetty" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2.jetty"></a>3.8.2. HTTP/2 with Jetty</h4>
<div class="paragraph">
<p translation-origin="off">For HTTP/2 support, Jetty requires the additional <code>org.eclipse.jetty.http2:http2-server</code> dependency.
To use <code>h2c</code> no other dependencies are required.
To use <code>h2</code>, you also need to choose one of the following dependencies, depending on your deployment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>org.eclipse.jetty:jetty-alpn-java-server</code> for applications running on JDK9+</p>
</li>
<li>
<p translation-origin="off"><code>org.eclipse.jetty:jetty-alpn-openjdk8-server</code> for applications running on JDK8u252+</p>
</li>
<li>
<p translation-origin="off"><code>org.eclipse.jetty:jetty-alpn-conscrypt-server</code> and the <a href="https://www.conscrypt.org/">Conscrypt library</a> with no JDK requirement</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="howto.webserver.configure-http2.netty" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2.netty"></a>3.8.3. HTTP/2 with Reactor Netty</h4>
<div class="paragraph">
<p translation-origin="off">The <code>spring-boot-webflux-starter</code> is using by default Reactor Netty as a server.
Reactor Netty supports <code>h2c</code> using JDK 8 or later with no additional dependencies.
Reactor Netty supports <code>h2</code> using the JDK support with JDK 9 or later.
For JDK 8 environments, or for optimal runtime performance, this server also supports <code>h2</code> with native libraries.
To enable that, your application needs to have an additional dependency.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot manages the version for the <code>io.netty:netty-tcnative-boringssl-static</code> "uber jar", containing native libraries for all platforms.
Developers can choose to import only the required dependencies using a classifier (see <a href="https://netty.io/wiki/forked-tomcat-native.html">the Netty official documentation</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.webserver.configure-http2.undertow" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-http2.undertow"></a>3.8.4. HTTP/2 with Undertow</h4>
<div class="paragraph">
<p translation-origin="off">As of Undertow 1.4.0+, both <code>h2</code> and <code>h2c</code> are supported on JDK 8 without any additional dependencies.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.configure" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure"></a>3.9. Configure the Web Server</h3>
<div class="paragraph">
<p translation-origin="off">Generally, you should first consider using one of the many available configuration keys and customize your web server by adding new entries in your <code>application.properties</code> or <code>application.yml</code> file.
See “<a href="howto.html#howto.properties-and-configuration.discover-build-in-options-for-external-properties">Discover Built-in Options for External Properties</a>”).
The <code>server.*</code> namespace is quite useful here, and it includes namespaces like <code>server.tomcat.*</code>, <code>server.jetty.*</code> and others, for server-specific features.
See the list of <a href="application-properties.html#application-properties">application-properties.html</a>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The previous sections covered already many common use cases, such as compression, SSL or HTTP/2.
However, if a configuration key does not exist for your use case, you should then look at <a href="https://docs.spring.io/spring-boot/docs/2.6.3/api/org/springframework/boot/web/server/WebServerFactoryCustomizer.html"><code>WebServerFactoryCustomizer</code></a>.
You can declare such a component and get access to the server factory relevant to your choice: you should select the variant for the chosen Server (Tomcat, Jetty, Reactor Netty, Undertow) and the chosen web stack (servlet or reactive).</p>
</div>
<div class="paragraph">
<p translation-origin="off">The example below is for Tomcat with the <code>spring-boot-starter-web</code> (servlet stack):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;
import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyTomcatWebServerCustomizer implements WebServerFactoryCustomizer&lt;TomcatServletWebServerFactory&gt; {

    @Override
    public void customize(TomcatServletWebServerFactory factory) {
        // customize the factory here
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">Spring Boot uses that infrastructure internally to auto-configure the server.
Auto-configured <code>WebServerFactoryCustomizer</code> beans have an order of <code>0</code> and will be processed before any user-defined customizers, unless it has an explicit order that states otherwise.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">Once you have got access to a <code>WebServerFactory</code> using the customizer, you can use it to configure specific parts, like connectors, server resources, or the server itself - all using server-specific APIs.</p>
</div>
<div class="paragraph">
<p translation-origin="off">In addition Spring Boot provides:</p>
</div>
<table id="howto-configure-webserver-customizers" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">
  <p translation-origin="off">Server</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-origin="off">Servlet stack</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-origin="off">Reactive stack</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off">Tomcat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>TomcatServletWebServerFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>TomcatReactiveWebServerFactory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off">Jetty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>JettyServletWebServerFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>JettyReactiveWebServerFactory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off">Undertow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>UndertowServletWebServerFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>UndertowReactiveWebServerFactory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off">Reactor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>NettyReactiveWebServerFactory</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p translation-origin="off">As a last resort, you can also declare your own <code>WebServerFactory</code> bean, which will override the one provided by Spring Boot.
When you do so, auto-configured customizers are still applied on your custom factory, so use that option carefully.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.add-servlet-filter-listener" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.add-servlet-filter-listener"></a>3.10. Add a Servlet, Filter, or Listener to an Application</h3>
<div class="paragraph">
<p translation-origin="off">In a servlet stack application, that is with the <code>spring-boot-starter-web</code>, there are two ways to add <code>Servlet</code>, <code>Filter</code>, <code>ServletContextListener</code>, and the other listeners supported by the Servlet API to your application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean">Add a Servlet, Filter, or Listener by Using a Spring Bean</a></p>
</li>
<li>
<p translation-origin="off"><a href="howto.html#howto.webserver.add-servlet-filter-listener.using-scanning">Add Servlets, Filters, and Listeners by Using Classpath Scanning</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="howto.webserver.add-servlet-filter-listener.spring-bean" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean"></a>3.10.1. Add a Servlet, Filter, or Listener by Using a Spring Bean</h4>
<div class="paragraph">
<p translation-origin="off">To add a <code>Servlet</code>, <code>Filter</code>, or servlet <code>*Listener</code> by using a Spring bean, you must provide a <code>@Bean</code> definition for it.
Doing so can be very useful when you want to inject configuration or dependencies.
However, you must be very careful that they do not cause eager initialization of too many other beans, because they have to be installed in the container very early in the application lifecycle.
(For example, it is not a good idea to have them depend on your <code>DataSource</code> or JPA configuration.)
You can work around such restrictions by initializing the beans lazily when first used instead of on initialization.</p>
</div>
<div class="paragraph">
<p translation-origin="off">In the case of filters and servlets, you can also add mappings and init parameters by adding a <code>FilterRegistrationBean</code> or a <code>ServletRegistrationBean</code> instead of or in addition to the underlying component.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-origin="off">If no <code>dispatcherType</code> is specified on a filter registration, <code>REQUEST</code> is used.
This aligns with the servlet specification’s default dispatcher type.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">Like any other Spring bean, you can define the order of servlet filter beans; please make sure to check the “<a href="web.html#web.servlet.embedded-container.servlets-filters-listeners.beans">web.html</a>” section.</p>
</div>
<div class="sect4">
<h5 id="howto.webserver.add-servlet-filter-listener.spring-bean.disable" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean.disable"></a>Disable Registration of a Servlet or Filter</h5>
<div class="paragraph">
<p translation-origin="off">As <a href="howto.html#howto.webserver.add-servlet-filter-listener.spring-bean">described earlier</a>, any <code>Servlet</code> or <code>Filter</code> beans are registered with the servlet container automatically.
To disable registration of a particular <code>Filter</code> or <code>Servlet</code> bean, create a registration bean for it and mark it as disabled, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyFilterConfiguration {

    @Bean
    public FilterRegistrationBean&lt;MyFilter&gt; registration(MyFilter filter) {
        FilterRegistrationBean&lt;MyFilter&gt; registration = new FilterRegistrationBean&lt;&gt;(filter);
        registration.setEnabled(false);
        return registration;
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="howto.webserver.add-servlet-filter-listener.using-scanning" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.add-servlet-filter-listener.using-scanning"></a>3.10.2. Add Servlets, Filters, and Listeners by Using Classpath Scanning</h4>
<div class="paragraph">
<p translation-origin="off"><code>@WebServlet</code>, <code>@WebFilter</code>, and <code>@WebListener</code> annotated classes can be automatically registered with an embedded servlet container by annotating a <code>@Configuration</code> class with <code>@ServletComponentScan</code> and specifying the package(s) containing the components that you want to register.
By default, <code>@ServletComponentScan</code> scans from the package of the annotated class.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.configure-access-logs" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.configure-access-logs"></a>3.11. Configure Access Logging</h3>
<div class="paragraph">
<p translation-origin="off">Access logs can be configured for Tomcat, Undertow, and Jetty through their respective namespaces.</p>
</div>
<div class="paragraph">
<p translation-origin="off">For instance, the following settings log access on Tomcat with a <a href="https://tomcat.apache.org/tomcat-9.0-doc/config/valve.html#Access_Logging">custom pattern</a>.</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.basedir=my-tomcat
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.pattern=%t %a %r %s (%D ms)</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    basedir: "my-tomcat"
    accesslog:
      enabled: true
      pattern: "%t %a %r %s (%D ms)"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">The default location for logs is a <code>logs</code> directory relative to the Tomcat base directory.
By default, the <code>logs</code> directory is a temporary directory, so you may want to fix Tomcat’s base directory or use an absolute path for the logs.
In the preceding example, the logs are available in <code>my-tomcat/logs</code> relative to the working directory of the application.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">Access logging for Undertow can be configured in a similar fashion, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.undertow.accesslog.enabled=true
server.undertow.accesslog.pattern=%t %a %r %s (%D ms)</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  undertow:
    accesslog:
      enabled: true
      pattern: "%t %a %r %s (%D ms)"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Logs are stored in a <code>logs</code> directory relative to the working directory of the application.
You can customize this location by setting the <code>server.undertow.accesslog.dir</code> property.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Finally, access logging for Jetty can also be configured as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.jetty.accesslog.enabled=true
server.jetty.accesslog.filename=/var/log/jetty-access.log</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  jetty:
    accesslog:
      enabled: true
      filename: "/var/log/jetty-access.log"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">By default, logs are redirected to <code>System.err</code>.
For more details, see the Jetty documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.use-behind-a-proxy-server" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-behind-a-proxy-server"></a>3.12. Running Behind a Front-end Proxy Server</h3>
<div class="paragraph">
<p translation-origin="off">If your application is running behind a proxy, a load-balancer or in the cloud, the request information (like the host, port, scheme…​) might change along the way.
Your application may be running on <code>10.10.10.10:8080</code>, but HTTP clients should only see <code>example.org</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off"><a href="https://tools.ietf.org/html/rfc7239">RFC7239 "Forwarded Headers"</a> defines the <code>Forwarded</code> HTTP header; proxies can use this header to provide information about the original request.
You can configure your application to read those headers and automatically use that information when creating links and sending them to clients in HTTP 302 responses, JSON documents or HTML pages.
There are also non-standard headers, like <code>X-Forwarded-Host</code>, <code>X-Forwarded-Port</code>, <code>X-Forwarded-Proto</code>, <code>X-Forwarded-Ssl</code>, and <code>X-Forwarded-Prefix</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If the proxy adds the commonly used <code>X-Forwarded-For</code> and <code>X-Forwarded-Proto</code> headers, setting <code>server.forward-headers-strategy</code> to <code>NATIVE</code> is enough to support those.
With this option, the Web servers themselves natively support this feature; you can check their specific documentation to learn about specific behavior.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If this is not enough, Spring Framework provides a <a href="https://docs.spring.io/spring-framework/docs/5.3.15/reference/html/web.html#filters-forwarded-headers">ForwardedHeaderFilter</a>.
You can register it as a servlet filter in your application by setting <code>server.forward-headers-strategy</code> is set to <code>FRAMEWORK</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">If you are using Tomcat and terminating SSL at the proxy, <code>server.tomcat.redirect-context-root</code> should be set to <code>false</code>.
This allows the <code>X-Forwarded-Proto</code> header to be honored before any redirects are performed.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">If your application runs in Cloud Foundry or Heroku, the <code>server.forward-headers-strategy</code> property defaults to <code>NATIVE</code>.
In all other instances, it defaults to <code>NONE</code>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="howto.webserver.use-behind-a-proxy-server.tomcat" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-behind-a-proxy-server.tomcat"></a>3.12.1. Customize Tomcat’s Proxy Configuration</h4>
<div class="paragraph">
<p translation-origin="off">If you use Tomcat, you can additionally configure the names of the headers used to carry “forwarded” information, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.remoteip.remote-ip-header=x-your-remote-ip-header
server.tomcat.remoteip.protocol-header=x-your-protocol-header</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    remoteip:
      remote-ip-header: "x-your-remote-ip-header"
      protocol-header: "x-your-protocol-header"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Tomcat is also configured with a default regular expression that matches internal proxies that are to be trusted.
By default, IP addresses in <code>10/8</code>, <code>192.168/16</code>, <code>169.254/16</code> and <code>127/8</code> are trusted.
You can customize the valve’s configuration by adding an entry to <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.remoteip.internal-proxies=192\\.168\\.\\d{1,3}\\.\\d{1,3}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    remoteip:
      internal-proxies: "192\\.168\\.\\d{1,3}\\.\\d{1,3}"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">You can trust all proxies by setting the <code>internal-proxies</code> to empty (but do not do so in production).</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">You can take complete control of the configuration of Tomcat’s <code>RemoteIpValve</code> by switching the automatic one off (to do so, set <code>server.forward-headers-strategy=NONE</code>) and adding a new valve instance using a <code>WebServerFactoryCustomizer</code> bean.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.enable-multiple-connectors-in-tomcat" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.enable-multiple-connectors-in-tomcat"></a>3.13. Enable Multiple Connectors with Tomcat</h3>
<div class="paragraph">
<p translation-origin="off">You can add an <code>org.apache.catalina.connector.Connector</code> to the <code>TomcatServletWebServerFactory</code>, which can allow multiple connectors, including HTTP and HTTPS connectors, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.io.IOException;
import java.net.URL;

import org.apache.catalina.connector.Connector;
import org.apache.coyote.http11.Http11NioProtocol;

import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;
import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.util.ResourceUtils;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyTomcatConfiguration {

    @Bean
    public WebServerFactoryCustomizer&lt;TomcatServletWebServerFactory&gt; sslConnectorCustomizer() {
        return (tomcat) -&gt; tomcat.addAdditionalTomcatConnectors(createSslConnector());
    }

    private Connector createSslConnector() {
        Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");
        Http11NioProtocol protocol = (Http11NioProtocol) connector.getProtocolHandler();
        try {
            URL keystore = ResourceUtils.getURL("keystore");
            URL truststore = ResourceUtils.getURL("truststore");
            connector.setScheme("https");
            connector.setSecure(true);
            connector.setPort(8443);
            protocol.setSSLEnabled(true);
            protocol.setKeystoreFile(keystore.toString());
            protocol.setKeystorePass("changeit");
            protocol.setTruststoreFile(truststore.toString());
            protocol.setTruststorePass("changeit");
            protocol.setKeyAlias("apitester");
            return connector;
        }
        catch (IOException ex) {
            throw new IllegalStateException("Fail to create ssl connector", ex);
        }
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.use-tomcat-legacycookieprocessor" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.use-tomcat-legacycookieprocessor"></a>3.14. Use Tomcat’s LegacyCookieProcessor</h3>
<div class="paragraph">
<p translation-origin="off">By default, the embedded Tomcat used by Spring Boot does not support "Version 0" of the Cookie format, so you may see the following error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java.lang.IllegalArgumentException: An invalid character [32] was present in the Cookie value</pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">If at all possible, you should consider updating your code to only store values compliant with later Cookie specifications.
If, however, you cannot change the way that cookies are written, you can instead configure Tomcat to use a <code>LegacyCookieProcessor</code>.
To switch to the <code>LegacyCookieProcessor</code>, use an <code>WebServerFactoryCustomizer</code> bean that adds a <code>TomcatContextCustomizer</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.apache.tomcat.util.http.LegacyCookieProcessor;

import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;
import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyLegacyCookieProcessorConfiguration {

    @Bean
    public WebServerFactoryCustomizer&lt;TomcatServletWebServerFactory&gt; cookieProcessorCustomizer() {
        return (factory) -&gt; factory
                .addContextCustomizers((context) -&gt; context.setCookieProcessor(new LegacyCookieProcessor()));
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.enable-tomcat-mbean-registry" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.enable-tomcat-mbean-registry"></a>3.15. Enable Tomcat’s MBean Registry</h3>
<div class="paragraph">
<p translation-origin="off">Embedded Tomcat’s MBean registry is disabled by default.
This minimizes Tomcat’s memory footprint.
If you want to use Tomcat’s MBeans, for example so that they can be used by Micrometer to expose metrics, you must use the <code>server.tomcat.mbeanregistry.enabled</code> property to do so, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.mbeanregistry.enabled=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    mbeanregistry:
      enabled: true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.enable-multiple-listeners-in-undertow" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.enable-multiple-listeners-in-undertow"></a>3.16. Enable Multiple Listeners with Undertow</h3>
<div class="paragraph">
<p translation-origin="off">Add an <code>UndertowBuilderCustomizer</code> to the <code>UndertowServletWebServerFactory</code> and add a listener to the <code>Builder</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.undertow.Undertow.Builder;

import org.springframework.boot.web.embedded.undertow.UndertowServletWebServerFactory;
import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyUndertowConfiguration {

    @Bean
    public WebServerFactoryCustomizer&lt;UndertowServletWebServerFactory&gt; undertowListenerCustomizer() {
        return (factory) -&gt; factory.addBuilderCustomizers(this::addHttpListener);
    }

    private Builder addHttpListener(Builder builder) {
        return builder.addHttpListener(8080, "0.0.0.0");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.webserver.create-websocket-endpoints-using-serverendpoint" translation-origin="off"><a class="anchor" href="howto.html#howto.webserver.create-websocket-endpoints-using-serverendpoint"></a>3.17. Create WebSocket Endpoints Using @ServerEndpoint</h3>
<div class="paragraph">
<p translation-origin="off">If you want to use <code>@ServerEndpoint</code> in a Spring Boot application that used an embedded container, you must declare a single <code>ServerEndpointExporter</code> <code>@Bean</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.socket.server.standard.ServerEndpointExporter;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyWebSocketConfiguration {

    @Bean
    public ServerEndpointExporter serverEndpointExporter() {
        return new ServerEndpointExporter();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The bean shown in the preceding example registers any <code>@ServerEndpoint</code> annotated beans with the underlying WebSocket container.
When deployed to a standalone servlet container, this role is performed by a servlet container initializer, and the <code>ServerEndpointExporter</code> bean is not required.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.spring-mvc" translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc"></a>4. Spring MVC</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot has a number of starters that include Spring MVC.
Note that some starters include a dependency on Spring MVC rather than include it directly.
This section answers common questions about Spring MVC and Spring Boot.</p>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.write-json-rest-service" translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.write-json-rest-service"></a>4.1. Write a JSON REST Service</h3>
<div class="paragraph">
<p translation-origin="off">Any Spring <code>@RestController</code> in a Spring Boot application should render JSON response by default as long as Jackson2 is on the classpath, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

</span><span class="fold-block">@RestController
public class MyController {

    @RequestMapping("/thing")
    public MyThing thing() {
        return new MyThing();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">As long as <code>MyThing</code> can be serialized by Jackson2 (true for a normal POJO or Groovy object), then <code><a href="http://localhost:8080/thing" class="bare">localhost:8080/thing</a></code> serves a JSON representation of it by default.
Note that, in a browser, you might sometimes see XML responses, because browsers tend to send accept headers that prefer XML.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.write-xml-rest-service" translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.write-xml-rest-service"></a>4.2. Write an XML REST Service</h3>
<div class="paragraph">
<p translation-origin="off">If you have the Jackson XML extension (<code>jackson-dataformat-xml</code>) on the classpath, you can use it to render XML responses.
The previous example that we used for JSON would work.
To use the Jackson XML renderer, add the following dependency to your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;
    &lt;artifactId&gt;jackson-dataformat-xml&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">If Jackson’s XML extension is not available and JAXB is available, XML can be rendered with the additional requirement of having <code>MyThing</code> annotated as <code>@XmlRootElement</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.xml.bind.annotation.XmlRootElement;

</span><span class="fold-block">@XmlRootElement
public class MyThing {

    private String name;

</span><span class="fold-block hide-when-unfolded">    // getters/setters ...

</span><span class="fold-block hide-when-folded">    public String getName() {
        return this.name;
    }

    public void setName(String name) {
        this.name = name;
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">JAXB is only available out of the box with Java 8.
If you use a more recent Java generation, add the following dependency to your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish.jaxb&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb-runtime&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">To get the server to render XML instead of JSON, you might have to send an <code>Accept: text/xml</code> header (or use a browser).</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.customize-jackson-objectmapper" translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.customize-jackson-objectmapper"></a>4.3. Customize the Jackson ObjectMapper</h3>
<div class="paragraph">
<p translation-origin="off">Spring MVC (client and server side) uses <code>HttpMessageConverters</code> to negotiate content conversion in an HTTP exchange.
If Jackson is on the classpath, you already get the default converter(s) provided by <code>Jackson2ObjectMapperBuilder</code>, an instance of which is auto-configured for you.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The <code>ObjectMapper</code> (or <code>XmlMapper</code> for Jackson XML converter) instance (created by default) has the following customized properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>MapperFeature.DEFAULT_VIEW_INCLUSION</code> is disabled</p>
</li>
<li>
<p translation-origin="off"><code>DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES</code> is disabled</p>
</li>
<li>
<p translation-origin="off"><code>SerializationFeature.WRITE_DATES_AS_TIMESTAMPS</code> is disabled</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot also has some features to make it easier to customize this behavior.</p>
</div>
<div class="paragraph">
<p translation-origin="off">You can configure the <code>ObjectMapper</code> and <code>XmlMapper</code> instances by using the environment.
Jackson provides an extensive suite of on/off features that can be used to configure various aspects of its processing.
These features are described in six enums (in Jackson) that map onto properties in the environment:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">
  <p translation-origin="off">Enum</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-origin="off">Property</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-origin="off">Values</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>com.fasterxml.jackson.databind.DeserializationFeature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>spring.jackson.deserialization.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>com.fasterxml.jackson.core.JsonGenerator.Feature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>spring.jackson.generator.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>com.fasterxml.jackson.databind.MapperFeature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>spring.jackson.mapper.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>com.fasterxml.jackson.core.JsonParser.Feature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>spring.jackson.parser.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>com.fasterxml.jackson.databind.SerializationFeature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>spring.jackson.serialization.&lt;feature_name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>true</code>, <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>com.fasterxml.jackson.annotation.JsonInclude.Include</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>spring.jackson.default-property-inclusion</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off"><code>always</code>, <code>non_null</code>, <code>non_absent</code>, <code>non_default</code>, <code>non_empty</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p translation-origin="off">For example, to enable pretty print, set <code>spring.jackson.serialization.indent_output=true</code>.
Note that, thanks to the use of <a href="features.html#features.external-config.typesafe-configuration-properties.relaxed-binding">relaxed binding</a>, the case of <code>indent_output</code> does not have to match the case of the corresponding enum constant, which is <code>INDENT_OUTPUT</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">This environment-based configuration is applied to the auto-configured <code>Jackson2ObjectMapperBuilder</code> bean and applies to any mappers created by using the builder, including the auto-configured <code>ObjectMapper</code> bean.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The context’s <code>Jackson2ObjectMapperBuilder</code> can be customized by one or more <code>Jackson2ObjectMapperBuilderCustomizer</code> beans.
Such customizer beans can be ordered (Boot’s own customizer has an order of 0), letting additional customization be applied both before and after Boot’s customization.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Any beans of type <code>com.fasterxml.jackson.databind.Module</code> are automatically registered with the auto-configured <code>Jackson2ObjectMapperBuilder</code> and are applied to any <code>ObjectMapper</code> instances that it creates.
This provides a global mechanism for contributing custom modules when you add new features to your application.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If you want to replace the default <code>ObjectMapper</code> completely, either define a <code>@Bean</code> of that type and mark it as <code>@Primary</code> or, if you prefer the builder-based approach, define a <code>Jackson2ObjectMapperBuilder</code> <code>@Bean</code>.
Note that, in either case, doing so disables all auto-configuration of the <code>ObjectMapper</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If you provide any <code>@Beans</code> of type <code>MappingJackson2HttpMessageConverter</code>, they replace the default value in the MVC configuration.
Also, a convenience bean of type <code>HttpMessageConverters</code> is provided (and is always available if you use the default MVC configuration).
It has some useful methods to access the default and user-enhanced message converters.</p>
</div>
<div class="paragraph">
<p translation-origin="off">See the “<a href="howto.html#howto.spring-mvc.customize-responsebody-rendering">Customize the @ResponseBody Rendering</a>” section and the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java"><code>WebMvcAutoConfiguration</code></a> source code for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.customize-responsebody-rendering" translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.customize-responsebody-rendering"></a>4.4. Customize the @ResponseBody Rendering</h3>
<div class="paragraph">
<p translation-origin="off">Spring uses <code>HttpMessageConverters</code> to render <code>@ResponseBody</code> (or responses from <code>@RestController</code>).
You can contribute additional converters by adding beans of the appropriate type in a Spring Boot context.
If a bean you add is of a type that would have been included by default anyway (such as <code>MappingJackson2HttpMessageConverter</code> for JSON conversions), it replaces the default value.
A convenience bean of type <code>HttpMessageConverters</code> is provided and is always available if you use the default MVC configuration.
It has some useful methods to access the default and user-enhanced message converters (For example, it can be useful if you want to manually inject them into a custom <code>RestTemplate</code>).</p>
</div>
<div class="paragraph">
<p translation-origin="off">As in normal MVC usage, any <code>WebMvcConfigurer</code> beans that you provide can also contribute converters by overriding the <code>configureMessageConverters</code> method.
However, unlike with normal MVC, you can supply only additional converters that you need (because Spring Boot uses the same mechanism to contribute its defaults).
Finally, if you opt out of the Spring Boot default MVC configuration by providing your own <code>@EnableWebMvc</code> configuration, you can take control completely and do everything manually by using <code>getMessageConverters</code> from <code>WebMvcConfigurationSupport</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">See the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java"><code>WebMvcAutoConfiguration</code></a> source code for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.multipart-file-uploads" translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.multipart-file-uploads"></a>4.5. Handling Multipart File Uploads</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot embraces the servlet 3 <code>javax.servlet.http.Part</code> API to support uploading files.
By default, Spring Boot configures Spring MVC with a maximum size of 1MB per file and a maximum of 10MB of file data in a single request.
You may override these values, the location to which intermediate data is stored (for example, to the <code>/tmp</code> directory), and the threshold past which data is flushed to disk by using the properties exposed in the <code>MultipartProperties</code> class.
For example, if you want to specify that files be unlimited, set the <code>spring.servlet.multipart.max-file-size</code> property to <code>-1</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The multipart support is helpful when you want to receive multipart encoded file data as a <code>@RequestParam</code>-annotated parameter of type <code>MultipartFile</code> in a Spring MVC controller handler method.</p>
</div>
<div class="paragraph">
<p translation-origin="off">See the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/MultipartAutoConfiguration.java"><code>MultipartAutoConfiguration</code></a> source for more details.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">It is recommended to use the container’s built-in support for multipart uploads rather than introducing an additional dependency such as Apache Commons File Upload.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.switch-off-dispatcherservlet" translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.switch-off-dispatcherservlet"></a>4.6. Switch Off the Spring MVC DispatcherServlet</h3>
<div class="paragraph">
<p translation-origin="off">By default, all content is served from the root of your application (<code>/</code>).
If you would rather map to a different path, you can configure one as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mvc.servlet.path=/mypath</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mvc:
    servlet:
      path: "/mypath"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">If you have additional servlets you can declare a <code>@Bean</code> of type <code>Servlet</code> or <code>ServletRegistrationBean</code> for each and Spring Boot will register them transparently to the container.
Because servlets are registered that way, they can be mapped to a sub-context of the <code>DispatcherServlet</code> without invoking it.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Configuring the <code>DispatcherServlet</code> yourself is unusual but if you really need to do it, a <code>@Bean</code> of type <code>DispatcherServletPath</code> must be provided as well to provide the path of your custom <code>DispatcherServlet</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.switch-off-default-configuration" translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.switch-off-default-configuration"></a>4.7. Switch off the Default MVC Configuration</h3>
<div class="paragraph">
<p translation-origin="off">The easiest way to take complete control over MVC configuration is to provide your own <code>@Configuration</code> with the <code>@EnableWebMvc</code> annotation.
Doing so leaves all MVC configuration in your hands.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.spring-mvc.customize-view-resolvers" translation-origin="off"><a class="anchor" href="howto.html#howto.spring-mvc.customize-view-resolvers"></a>4.8. Customize ViewResolvers</h3>
<div class="paragraph">
<p translation-origin="off">A <code>ViewResolver</code> is a core component of Spring MVC, translating view names in <code>@Controller</code> to actual <code>View</code> implementations.
Note that <code>ViewResolvers</code> are mainly used in UI applications, rather than REST-style services (a <code>View</code> is not used to render a <code>@ResponseBody</code>).
There are many implementations of <code>ViewResolver</code> to choose from, and Spring on its own is not opinionated about which ones you should use.
Spring Boot, on the other hand, installs one or two for you, depending on what it finds on the classpath and in the application context.
The <code>DispatcherServlet</code> uses all the resolvers it finds in the application context, trying each one in turn until it gets a result.
If you add your own, you have to be aware of the order and in which position your resolver is added.</p>
</div>
<div class="paragraph">
<p translation-origin="off"><code>WebMvcAutoConfiguration</code> adds the following <code>ViewResolvers</code> to your context:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off">An <code>InternalResourceViewResolver</code> named ‘defaultViewResolver’.
This one locates physical resources that can be rendered by using the <code>DefaultServlet</code> (including static resources and JSP pages, if you use those).
It applies a prefix and a suffix to the view name and then looks for a physical resource with that path in the servlet context (the defaults are both empty but are accessible for external configuration through <code>spring.mvc.view.prefix</code> and <code>spring.mvc.view.suffix</code>).
You can override it by providing a bean of the same type.</p>
</li>
<li>
<p translation-origin="off">A <code>BeanNameViewResolver</code> named ‘beanNameViewResolver’.
This is a useful member of the view resolver chain and picks up any beans with the same name as the <code>View</code> being resolved.
It should not be necessary to override or replace it.</p>
</li>
<li>
<p translation-origin="off">A <code>ContentNegotiatingViewResolver</code> named ‘viewResolver’ is added only if there <strong>are</strong> actually beans of type <code>View</code> present.
This is a composite resolver, delegating to all the others and attempting to find a match to the ‘Accept’ HTTP header sent by the client.
There is a useful <a href="https://spring.io/blog/2013/06/03/content-negotiation-using-views">blog about <code>ContentNegotiatingViewResolver</code></a> that you might like to study to learn more, and you might also look at the source code for detail.
You can switch off the auto-configured <code>ContentNegotiatingViewResolver</code> by defining a bean named ‘viewResolver’.</p>
</li>
<li>
<p translation-origin="off">If you use Thymeleaf, you also have a <code>ThymeleafViewResolver</code> named ‘thymeleafViewResolver’.
It looks for resources by surrounding the view name with a prefix and suffix.
The prefix is <code>spring.thymeleaf.prefix</code>, and the suffix is <code>spring.thymeleaf.suffix</code>.
The values of the prefix and suffix default to ‘classpath:/templates/’ and ‘.html’, respectively.
You can override <code>ThymeleafViewResolver</code> by providing a bean of the same name.</p>
</li>
<li>
<p translation-origin="off">If you use FreeMarker, you also have a <code>FreeMarkerViewResolver</code> named ‘freeMarkerViewResolver’.
It looks for resources in a loader path (which is externalized to <code>spring.freemarker.templateLoaderPath</code> and has a default value of ‘classpath:/templates/’) by surrounding the view name with a prefix and a suffix.
The prefix is externalized to <code>spring.freemarker.prefix</code>, and the suffix is externalized to <code>spring.freemarker.suffix</code>.
The default values of the prefix and suffix are empty and ‘.ftlh’, respectively.
You can override <code>FreeMarkerViewResolver</code> by providing a bean of the same name.</p>
</li>
<li>
<p translation-origin="off">If you use Groovy templates (actually, if <code>groovy-templates</code> is on your classpath), you also have a <code>GroovyMarkupViewResolver</code> named ‘groovyMarkupViewResolver’.
It looks for resources in a loader path by surrounding the view name with a prefix and suffix (externalized to <code>spring.groovy.template.prefix</code> and <code>spring.groovy.template.suffix</code>).
The prefix and suffix have default values of ‘classpath:/templates/’ and ‘.tpl’, respectively.
You can override <code>GroovyMarkupViewResolver</code> by providing a bean of the same name.</p>
</li>
<li>
<p translation-origin="off">If you use Mustache, you also have a <code>MustacheViewResolver</code> named ‘mustacheViewResolver’.
It looks for resources by surrounding the view name with a prefix and suffix.
The prefix is <code>spring.mustache.prefix</code>, and the suffix is <code>spring.mustache.suffix</code>.
The values of the prefix and suffix default to ‘classpath:/templates/’ and ‘.mustache’, respectively.
You can override <code>MustacheViewResolver</code> by providing a bean of the same name.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">For more detail, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java"><code>WebMvcAutoConfiguration</code></a></p>
</li>
<li>
<p translation-origin="off"><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java"><code>ThymeleafAutoConfiguration</code></a></p>
</li>
<li>
<p translation-origin="off"><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/freemarker/FreeMarkerAutoConfiguration.java"><code>FreeMarkerAutoConfiguration</code></a></p>
</li>
<li>
<p translation-origin="off"><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/groovy/template/GroovyTemplateAutoConfiguration.java"><code>GroovyTemplateAutoConfiguration</code></a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.jersey" translation-origin="off"><a class="anchor" href="howto.html#howto.jersey"></a>5. Jersey</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="howto.jersey.spring-security" translation-origin="off"><a class="anchor" href="howto.html#howto.jersey.spring-security"></a>5.1. Secure Jersey endpoints with Spring Security</h3>
<div class="paragraph">
<p translation-origin="off">Spring Security can be used to secure a Jersey-based web application in much the same way as it can be used to secure a Spring MVC-based web application.
However, if you want to use Spring Security’s method-level security with Jersey, you must configure Jersey to use <code>setStatus(int)</code> rather <code>sendError(int)</code>.
This prevents Jersey from committing the response before Spring Security has had an opportunity to report an authentication or authorization failure to the client.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The <code>jersey.config.server.response.setStatusOverSendError</code> property must be set to <code>true</code> on the application’s <code>ResourceConfig</code> bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.Collections;

import org.glassfish.jersey.server.ResourceConfig;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class JerseySetStatusOverSendErrorConfig extends ResourceConfig {

    public JerseySetStatusOverSendErrorConfig() {
        register(Endpoint.class);
        setProperties(Collections.singletonMap("jersey.config.server.response.setStatusOverSendError", true));
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.jersey.alongside-another-web-framework" translation-origin="off"><a class="anchor" href="howto.html#howto.jersey.alongside-another-web-framework"></a>5.2. Use Jersey Alongside Another Web Framework</h3>
<div class="paragraph">
<p translation-origin="off">To use Jersey alongside another web framework, such as Spring MVC, it should be configured so that it will allow the other framework to handle requests that it cannot handle.
First, configure Jersey to use a filter rather than a servlet by configuring the <code>spring.jersey.type</code> application property with a value of <code>filter</code>.
Second, configure your <code>ResourceConfig</code> to forward requests that would have resulted in a 404, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.glassfish.jersey.server.ResourceConfig;
import org.glassfish.jersey.servlet.ServletProperties;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class JerseyConfig extends ResourceConfig {

    public JerseyConfig() {
        register(Endpoint.class);
        property(ServletProperties.FILTER_FORWARD_ON_404, true);
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.http-clients" translation-origin="off"><a class="anchor" href="howto.html#howto.http-clients"></a>6. HTTP Clients</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot offers a number of starters that work with HTTP clients.
This section answers questions related to using them.</p>
</div>
<div class="sect2">
<h3 id="howto.http-clients.rest-template-proxy-configuration" translation-origin="off"><a class="anchor" href="howto.html#howto.http-clients.rest-template-proxy-configuration"></a>6.1. Configure RestTemplate to Use a Proxy</h3>
<div class="paragraph">
<p translation-origin="off">As described in <a href="io.html#io.rest-client.resttemplate.customization">io.html</a>, you can use a <code>RestTemplateCustomizer</code> with <code>RestTemplateBuilder</code> to build a customized <code>RestTemplate</code>.
This is the recommended approach for creating a <code>RestTemplate</code> configured to use a proxy.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The exact details of the proxy configuration depend on the underlying client request factory that is being used.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.http-clients.webclient-reactor-netty-customization" translation-origin="off"><a class="anchor" href="howto.html#howto.http-clients.webclient-reactor-netty-customization"></a>6.2. Configure the TcpClient used by a Reactor Netty-based WebClient</h3>
<div class="paragraph">
<p translation-origin="off">When Reactor Netty is on the classpath a Reactor Netty-based <code>WebClient</code> is auto-configured.
To customize the client’s handling of network connections, provide a <code>ClientHttpConnector</code> bean.
The following example configures a 60 second connect timeout and adds a <code>ReadTimeoutHandler</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.netty.channel.ChannelOption;
import io.netty.handler.timeout.ReadTimeoutHandler;
import reactor.netty.http.client.HttpClient;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.client.reactive.ClientHttpConnector;
import org.springframework.http.client.reactive.ReactorClientHttpConnector;
import org.springframework.http.client.reactive.ReactorResourceFactory;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyReactorNettyClientConfiguration {

    @Bean
    ClientHttpConnector clientHttpConnector(ReactorResourceFactory resourceFactory) {
        HttpClient httpClient = HttpClient.create(resourceFactory.getConnectionProvider())
                .runOn(resourceFactory.getLoopResources())
                .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, 60000)
                .doOnConnected((connection) -&gt; connection.addHandlerLast(new ReadTimeoutHandler(60)));
        return new ReactorClientHttpConnector(httpClient);
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">Note the use of <code>ReactorResourceFactory</code> for the connection provider and event loop resources.
This ensures efficient sharing of resources for the server receiving requests and the client making requests.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.logging" translation-origin="off"><a class="anchor" href="howto.html#howto.logging"></a>7. Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot has no mandatory logging dependency, except for the Commons Logging API, which is typically provided by Spring Framework’s <code>spring-jcl</code> module.
To use <a href="https://logback.qos.ch">Logback</a>, you need to include it and <code>spring-jcl</code> on the classpath.
The recommended way to do that is through the starters, which all depend on <code>spring-boot-starter-logging</code>.
For a web application, you need only <code>spring-boot-starter-web</code>, since it depends transitively on the logging starter.
If you use Maven, the following dependency adds logging for you:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot has a <code>LoggingSystem</code> abstraction that attempts to configure logging based on the content of the classpath.
If Logback is available, it is the first choice.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If the only change you need to make to logging is to set the levels of various loggers, you can do so in <code>application.properties</code> by using the "logging.level" prefix, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logging.level.org.springframework.web=debug
logging.level.org.hibernate=error</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">logging:
  level:
    org.springframework.web: "debug"
    org.hibernate: "error"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">You can also set the location of a file to which to write the log (in addition to the console) by using <code>logging.file.name</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">To configure the more fine-grained settings of a logging system, you need to use the native configuration format supported by the <code>LoggingSystem</code> in question.
By default, Spring Boot picks up the native configuration from its default location for the system (such as <code>classpath:logback.xml</code> for Logback), but you can set the location of the config file by using the <code>logging.config</code> property.</p>
</div>
<div class="sect2">
<h3 id="howto.logging.logback" translation-origin="off"><a class="anchor" href="howto.html#howto.logging.logback"></a>7.1. Configure Logback for Logging</h3>
<div class="paragraph">
<p translation-origin="off">If you need to apply customizations to logback beyond those that can be achieved with <code>application.properties</code>, you will need to add a standard logback configuration file.
You can add a <code>logback.xml</code> file to the root of your classpath for logback to find.
You can also use <code>logback-spring.xml</code> if you want to use the <a href="features.html#features.logging.logback-extensions">Spring Boot Logback extensions</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">The Logback documentation has a <a href="https://logback.qos.ch/manual/configuration.html">dedicated section that covers configuration</a> in some detail.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot provides a number of logback configurations that be <code>included</code> from your own configuration.
These includes are designed to allow certain common Spring Boot conventions to be re-applied.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The following files are provided under <code>org/springframework/boot/logging/logback/</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>defaults.xml</code> - Provides conversion rules, pattern properties and common logger configurations.</p>
</li>
<li>
<p translation-origin="off"><code>console-appender.xml</code> - Adds a <code>ConsoleAppender</code> using the <code>CONSOLE_LOG_PATTERN</code>.</p>
</li>
<li>
<p translation-origin="off"><code>file-appender.xml</code> - Adds a <code>RollingFileAppender</code> using the <code>FILE_LOG_PATTERN</code> and <code>ROLLING_FILE_NAME_PATTERN</code> with appropriate settings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">In addition, a legacy <code>base.xml</code> file is provided for compatibility with earlier versions of Spring Boot.</p>
</div>
<div class="paragraph">
<p translation-origin="off">A typical custom <code>logback.xml</code> file would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;include resource="org/springframework/boot/logging/logback/defaults.xml"/&gt;
    &lt;include resource="org/springframework/boot/logging/logback/console-appender.xml" /&gt;
    &lt;root level="INFO"&gt;
        &lt;appender-ref ref="CONSOLE" /&gt;
    &lt;/root&gt;
    &lt;logger name="org.springframework.web" level="DEBUG"/&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Your logback configuration file can also make use of System properties that the <code>LoggingSystem</code> takes care of creating for you:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>${PID}</code>: The current process ID.</p>
</li>
<li>
<p translation-origin="off"><code>${LOG_FILE}</code>: Whether <code>logging.file.name</code> was set in Boot’s external configuration.</p>
</li>
<li>
<p translation-origin="off"><code>${LOG_PATH}</code>: Whether <code>logging.file.path</code> (representing a directory for log files to live in) was set in Boot’s external configuration.</p>
</li>
<li>
<p translation-origin="off"><code>${LOG_EXCEPTION_CONVERSION_WORD}</code>: Whether <code>logging.exception-conversion-word</code> was set in Boot’s external configuration.</p>
</li>
<li>
<p translation-origin="off"><code>${ROLLING_FILE_NAME_PATTERN}</code>: Whether <code>logging.pattern.rolling-file-name</code> was set in Boot’s external configuration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot also provides some nice ANSI color terminal output on a console (but not in a log file) by using a custom Logback converter.
See the <code>CONSOLE_LOG_PATTERN</code> in the <code>defaults.xml</code> configuration for an example.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If Groovy is on the classpath, you should be able to configure Logback with <code>logback.groovy</code> as well.
If present, this setting is given preference.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">Spring extensions are not supported with Groovy configuration.
Any <code>logback-spring.groovy</code> files will not be detected.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="howto.logging.logback.file-only-output" translation-origin="off"><a class="anchor" href="howto.html#howto.logging.logback.file-only-output"></a>7.1.1. Configure Logback for File-only Output</h4>
<div class="paragraph">
<p translation-origin="off">If you want to disable console logging and write output only to a file, you need a custom <code>logback-spring.xml</code> that imports <code>file-appender.xml</code> but not <code>console-appender.xml</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;include resource="org/springframework/boot/logging/logback/defaults.xml" /&gt;
    &lt;property name="LOG_FILE" value="${LOG_FILE:-${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}/}spring.log}"/&gt;
    &lt;include resource="org/springframework/boot/logging/logback/file-appender.xml" /&gt;
    &lt;root level="INFO"&gt;
        &lt;appender-ref ref="FILE" /&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">You also need to add <code>logging.file.name</code> to your <code>application.properties</code> or <code>application.yaml</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logging.file.name=myapplication.log</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">logging:
  file:
    name: "myapplication.log"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.logging.log4j" translation-origin="off"><a class="anchor" href="howto.html#howto.logging.log4j"></a>7.2. Configure Log4j for Logging</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot supports <a href="https://logging.apache.org/log4j/2.x/">Log4j 2</a> for logging configuration if it is on the classpath.
If you use the starters for assembling dependencies, you have to exclude Logback and then include log4j 2 instead.
If you do not use the starters, you need to provide (at least) <code>spring-jcl</code> in addition to Log4j 2.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The recommended path is through the starters, even though it requires some jiggling.
The following example shows how to set up the starters in Maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-log4j2&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Gradle provides a few different ways to set up the starters.
One way is to use a <a href="https://docs.gradle.org/current/userguide/resolution_rules.html#sec:module_replacement">module replacement</a>.
To do so, declare a dependency on the Log4j 2 starter and tell Gradle that any occurrences of the default logging starter should be replaced by the Log4j 2 starter, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">dependencies {
    implementation "org.springframework.boot:spring-boot-starter-log4j2"
    modules {
        module("org.springframework.boot:spring-boot-starter-logging") {
            replacedBy("org.springframework.boot:spring-boot-starter-log4j2", "Use Log4j2 instead of Logback")
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">The Log4j starters gather together the dependencies for common logging requirements (such as having Tomcat use <code>java.util.logging</code> but configuring the output using Log4j 2).</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">To ensure that debug logging performed using <code>java.util.logging</code> is routed into Log4j 2, configure its <a href="https://logging.apache.org/log4j/2.x/log4j-jul/index.html">JDK logging adapter</a> by setting the <code>java.util.logging.manager</code> system property to <code>org.apache.logging.log4j.jul.LogManager</code>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="howto.logging.log4j.yaml-or-json-config" translation-origin="off"><a class="anchor" href="howto.html#howto.logging.log4j.yaml-or-json-config"></a>7.2.1. Use YAML or JSON to Configure Log4j 2</h4>
<div class="paragraph">
<p translation-origin="off">In addition to its default XML configuration format, Log4j 2 also supports YAML and JSON configuration files.
To configure Log4j 2 to use an alternative configuration file format, add the appropriate dependencies to the classpath and name your configuration files to match your chosen file format, as shown in the following example:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 75%;">
<col style="width: 15%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">
  <p translation-origin="off">Format</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-origin="off">Dependencies</p>
</th>
<th class="tableblock halign-left valign-top">
  <p translation-origin="off">File names</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off">YAML</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p translation-origin="off"><code>com.fasterxml.jackson.core:jackson-databind</code> + <code>com.fasterxml.jackson.dataformat:jackson-dataformat-yaml</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p translation-origin="off"><code>log4j2.yaml</code> + <code>log4j2.yml</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock" translation-origin="off">JSON</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p translation-origin="off"><code>com.fasterxml.jackson.core:jackson-databind</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p translation-origin="off"><code>log4j2.json</code> + <code>log4j2.jsn</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="howto.logging.log4j.composite-configuration" translation-origin="off"><a class="anchor" href="howto.html#howto.logging.log4j.composite-configuration"></a>7.2.2. Use Composite Configuration to Configure Log4j 2</h4>
<div class="paragraph">
<p translation-origin="off">Log4j 2 has support for combining multiple configuration files into a single composite configuration.
To use this support in Spring Boot, configure <code>logging.log4j2.config.override</code> with the locations of one or more secondary configuration files.
The secondary configuration files will be merged with the primary configuration, whether the primary’s source is Spring Boot’s defaults, a standard location such as <code>log4j.xml</code>, or the location configured by the <code>logging.config</code> property.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.data-access" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access"></a>8. Data Access</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot includes a number of starters for working with data sources.
This section answers questions related to doing so.</p>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-custom-datasource" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-custom-datasource"></a>8.1. Configure a Custom DataSource</h3>
<div class="paragraph">
<p translation-origin="off">To configure your own <code>DataSource</code>, define a <code>@Bean</code> of that type in your configuration.
Spring Boot reuses your <code>DataSource</code> anywhere one is required, including database initialization.
If you need to externalize some settings, you can bind your <code>DataSource</code> to the environment (see “<a href="features.html#features.external-config.typesafe-configuration-properties.third-party-configuration">features.html</a>”).</p>
</div>
<div class="paragraph">
<p translation-origin="off">The following example shows how to define a data source in a bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourceConfiguration {

    @Bean
    @ConfigurationProperties(prefix = "app.datasource")
    public SomeDataSource dataSource() {
        return new SomeDataSource();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The following example shows how to define a data source by setting properties:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.url=jdbc:h2:mem:mydb
app.datasource.username=sa
app.datasource.pool-size=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    url: "jdbc:h2:mem:mydb"
    username: "sa"
    pool-size: 30</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Assuming that <code>SomeDataSource</code> has regular JavaBean properties for the URL, the username, and the pool size, these settings are bound automatically before the <code>DataSource</code> is made available to other components.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot also provides a utility builder class, called <code>DataSourceBuilder</code>, that can be used to create one of the standard data sources (if it is on the classpath).
The builder can detect the one to use based on what is available on the classpath.
It also auto-detects the driver based on the JDBC URL.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The following example shows how to create a data source by using a <code>DataSourceBuilder</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.sql.DataSource;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourceConfiguration {

    @Bean
    @ConfigurationProperties("app.datasource")
    public DataSource dataSource() {
        return DataSourceBuilder.create().build();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">To run an app with that <code>DataSource</code>, all you need is the connection information.
Pool-specific settings can also be provided.
Check the implementation that is going to be used at runtime for more details.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The following example shows how to define a JDBC data source by setting properties:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.url=jdbc:mysql://localhost/test
app.datasource.username=dbuser
app.datasource.password=dbpass
app.datasource.pool-size=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    url: "jdbc:mysql://localhost/test"
    username: "dbuser"
    password: "dbpass"
    pool-size: 30</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">However, there is a catch.
Because the actual type of the connection pool is not exposed, no keys are generated in the metadata for your custom <code>DataSource</code> and no completion is available in your IDE (because the <code>DataSource</code> interface exposes no properties).
Also, if you happen to have Hikari on the classpath, this basic setup does not work, because Hikari has no <code>url</code> property (but does have a <code>jdbcUrl</code> property).
In that case, you must rewrite your configuration as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.jdbc-url=jdbc:mysql://localhost/test
app.datasource.username=dbuser
app.datasource.password=dbpass
app.datasource.pool-size=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    jdbc-url: "jdbc:mysql://localhost/test"
    username: "dbuser"
    password: "dbpass"
    pool-size: 30</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">You can fix that by forcing the connection pool to use and return a dedicated implementation rather than <code>DataSource</code>.
You cannot change the implementation at runtime, but the list of options will be explicit.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The following example shows how create a <code>HikariDataSource</code> with <code>DataSourceBuilder</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.zaxxer.hikari.HikariDataSource;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourceConfiguration {

    @Bean
    @ConfigurationProperties("app.datasource")
    public HikariDataSource dataSource() {
        return DataSourceBuilder.create().type(HikariDataSource.class).build();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">You can even go further by leveraging what <code>DataSourceProperties</code> does for you — that is, by providing a default embedded database with a sensible username and password if no URL is provided.
You can easily initialize a <code>DataSourceBuilder</code> from the state of any <code>DataSourceProperties</code> object, so you could also inject the DataSource that Spring Boot creates automatically.
However, that would split your configuration into two namespaces: <code>url</code>, <code>username</code>, <code>password</code>, <code>type</code>, and <code>driver</code> on <code>spring.datasource</code> and the rest on your custom namespace (<code>app.datasource</code>).
To avoid that, you can redefine a custom <code>DataSourceProperties</code> on your custom namespace, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.zaxxer.hikari.HikariDataSource;

import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourceConfiguration {

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource")
    public DataSourceProperties dataSourceProperties() {
        return new DataSourceProperties();
    }

    @Bean
    @ConfigurationProperties("app.datasource.configuration")
    public HikariDataSource dataSource(DataSourceProperties properties) {
        return properties.initializeDataSourceBuilder().type(HikariDataSource.class).build();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">This setup puts you <em>in sync</em> with what Spring Boot does for you by default, except that a dedicated connection pool is chosen (in code) and its settings are exposed in the <code>app.datasource.configuration</code> sub namespace.
Because <code>DataSourceProperties</code> is taking care of the <code>url</code>/<code>jdbcUrl</code> translation for you, you can configure it as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.url=jdbc:mysql://localhost/test
app.datasource.username=dbuser
app.datasource.password=dbpass
app.datasource.configuration.maximum-pool-size=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    url: "jdbc:mysql://localhost/test"
    username: "dbuser"
    password: "dbpass"
    configuration:
      maximum-pool-size: 30</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">Spring Boot will expose Hikari-specific settings to <code>spring.datasource.hikari</code>.
This example uses a more generic <code>configuration</code> sub namespace as the example does not support multiple datasource implementations.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">Because your custom configuration chooses to go with Hikari, <code>app.datasource.type</code> has no effect.
In practice, the builder is initialized with whatever value you might set there and then overridden by the call to <code>.type()</code>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">See “<a href="data.html#data.sql.datasource">data.html</a>” in the “Spring Boot features” section and the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jdbc/DataSourceAutoConfiguration.java"><code>DataSourceAutoConfiguration</code></a> class for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-two-datasources" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-two-datasources"></a>8.2. Configure Two DataSources</h3>
<div class="paragraph">
<p translation-origin="off">If you need to configure multiple data sources, you can apply the same tricks that are described in the previous section.
You must, however, mark one of the <code>DataSource</code> instances as <code>@Primary</code>, because various auto-configurations down the road expect to be able to get one by type.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If you create your own <code>DataSource</code>, the auto-configuration backs off.
In the following example, we provide the <em>exact</em> same feature set as the auto-configuration provides on the primary data source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.zaxxer.hikari.HikariDataSource;
import org.apache.commons.dbcp2.BasicDataSource;

import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyDataSourcesConfiguration {

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource.first")
    public DataSourceProperties firstDataSourceProperties() {
        return new DataSourceProperties();
    }

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource.first.configuration")
    public HikariDataSource firstDataSource(DataSourceProperties firstDataSourceProperties) {
        return firstDataSourceProperties.initializeDataSourceBuilder().type(HikariDataSource.class).build();
    }

    @Bean
    @ConfigurationProperties("app.datasource.second")
    public BasicDataSource secondDataSource() {
        return DataSourceBuilder.create().type(BasicDataSource.class).build();
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off"><code>firstDataSourceProperties</code> has to be flagged as <code>@Primary</code> so that the database initializer feature uses your copy (if you use the initializer).</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">Both data sources are also bound for advanced customizations.
For instance, you could configure them as follows:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.datasource.first.url=jdbc:mysql://localhost/first
app.datasource.first.username=dbuser
app.datasource.first.password=dbpass
app.datasource.first.configuration.maximum-pool-size=30

app.datasource.second.url=jdbc:mysql://localhost/second
app.datasource.second.username=dbuser
app.datasource.second.password=dbpass
app.datasource.second.max-total=30</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  datasource:
    first:
      url: "jdbc:mysql://localhost/first"
      username: "dbuser"
      password: "dbpass"
      configuration:
        maximum-pool-size: 30

    second:
      url: "jdbc:mysql://localhost/second"
      username: "dbuser"
      password: "dbpass"
      max-total: 30</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">You can apply the same concept to the secondary <code>DataSource</code> as well, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.zaxxer.hikari.HikariDataSource;
import org.apache.commons.dbcp2.BasicDataSource;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyCompleteDataSourcesConfiguration {

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource.first")
    public DataSourceProperties firstDataSourceProperties() {
        return new DataSourceProperties();
    }

    @Bean
    @Primary
    @ConfigurationProperties("app.datasource.first.configuration")
    public HikariDataSource firstDataSource(DataSourceProperties firstDataSourceProperties) {
        return firstDataSourceProperties.initializeDataSourceBuilder().type(HikariDataSource.class).build();
    }

    @Bean
    @ConfigurationProperties("app.datasource.second")
    public DataSourceProperties secondDataSourceProperties() {
        return new DataSourceProperties();
    }

    @Bean
    @ConfigurationProperties("app.datasource.second.configuration")
    public BasicDataSource secondDataSource(
            @Qualifier("secondDataSourceProperties") DataSourceProperties secondDataSourceProperties) {
        return secondDataSourceProperties.initializeDataSourceBuilder().type(BasicDataSource.class).build();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The preceding example configures two data sources on custom namespaces with the same logic as Spring Boot would use in auto-configuration.
Note that each <code>configuration</code> sub namespace provides advanced settings based on the chosen implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.spring-data-repositories" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.spring-data-repositories"></a>8.3. Use Spring Data Repositories</h3>
<div class="paragraph">
<p translation-origin="off">Spring Data can create implementations of <code>@Repository</code> interfaces of various flavors.
Spring Boot handles all of that for you, as long as those <code>@Repositories</code> are included in the same package (or a sub-package) of your <code>@EnableAutoConfiguration</code> class.</p>
</div>
<div class="paragraph">
<p translation-origin="off">For many applications, all you need is to put the right Spring Data dependencies on your classpath.
There is a <code>spring-boot-starter-data-jpa</code> for JPA, <code>spring-boot-starter-data-mongodb</code> for Mongodb, and various other starters for supported technologies.
To get started, create some repository interfaces to handle your <code>@Entity</code> objects.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot tries to guess the location of your <code>@Repository</code> definitions, based on the <code>@EnableAutoConfiguration</code> it finds.
To get more control, use the <code>@EnableJpaRepositories</code> annotation (from Spring Data JPA).</p>
</div>
<div class="paragraph">
<p translation-origin="off">For more about Spring Data, see the <a href="https://spring.io/projects/spring-data">Spring Data project page</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.separate-entity-definitions-from-spring-configuration" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.separate-entity-definitions-from-spring-configuration"></a>8.4. Separate @Entity Definitions from Spring Configuration</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot tries to guess the location of your <code>@Entity</code> definitions, based on the <code>@EnableAutoConfiguration</code> it finds.
To get more control, you can use the <code>@EntityScan</code> annotation, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.domain.EntityScan;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableAutoConfiguration
@EntityScan(basePackageClasses = City.class)
public class MyApplication {

    // ...

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.jpa-properties" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.jpa-properties"></a>8.5. Configure JPA Properties</h3>
<div class="paragraph">
<p translation-origin="off">Spring Data JPA already provides some vendor-independent configuration options (such as those for SQL logging), and Spring Boot exposes those options and a few more for Hibernate as external configuration properties.
Some of them are automatically detected according to the context so you should not have to set them.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The <code>spring.jpa.hibernate.ddl-auto</code> is a special case, because, depending on runtime conditions, it has different defaults.
If an embedded database is used and no schema manager (such as Liquibase or Flyway) is handling the <code>DataSource</code>, it defaults to <code>create-drop</code>.
In all other cases, it defaults to <code>none</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The dialect to use is detected by the JPA provider.
If you prefer to set the dialect yourself, set the <code>spring.jpa.database-platform</code> property.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The most common options to set are shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jpa.hibernate.naming.physical-strategy=com.example.MyPhysicalNamingStrategy
spring.jpa.show-sql=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  jpa:
    hibernate:
      naming:
        physical-strategy: "com.example.MyPhysicalNamingStrategy"
    show-sql: true</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">In addition, all properties in <code>spring.jpa.properties.*</code> are passed through as normal JPA properties (with the prefix stripped) when the local <code>EntityManagerFactory</code> is created.</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-origin="off">You need to ensure that names defined under <code>spring.jpa.properties.*</code> exactly match those expected by your JPA provider.
Spring Boot will not attempt any kind of relaxed binding for these entries.</p>
</div>
<div class="paragraph">
<p translation-origin="off">For example, if you want to configure Hibernate’s batch size you must use <code>spring.jpa.properties.hibernate.jdbc.batch_size</code>.
If you use other forms, such as <code>batchSize</code> or <code>batch-size</code>, Hibernate will not apply the setting.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">If you need to apply advanced customization to Hibernate properties, consider registering a <code>HibernatePropertiesCustomizer</code> bean that will be invoked prior to creating the <code>EntityManagerFactory</code>.
This takes precedence to anything that is applied by the auto-configuration.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-hibernate-naming-strategy" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-hibernate-naming-strategy"></a>8.6. Configure Hibernate Naming Strategy</h3>
<div class="paragraph">
<p translation-origin="off">Hibernate uses <a href="https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#naming">two different naming strategies</a> to map names from the object model to the corresponding database names.
The fully qualified class name of the physical and the implicit strategy implementations can be configured by setting the <code>spring.jpa.hibernate.naming.physical-strategy</code> and <code>spring.jpa.hibernate.naming.implicit-strategy</code> properties, respectively.
Alternatively, if <code>ImplicitNamingStrategy</code> or <code>PhysicalNamingStrategy</code> beans are available in the application context, Hibernate will be automatically configured to use them.</p>
</div>
<div class="paragraph">
<p translation-origin="off">By default, Spring Boot configures the physical naming strategy with <code>SpringPhysicalNamingStrategy</code>.
This implementation provides the same table structure as Hibernate 4: all dots are replaced by underscores and camel casing is replaced by underscores as well. Additionally, by default, all table names are generated in lower case. For example, a <code>TelephoneNumber</code> entity is mapped to the <code>telephone_number</code> table. If your schema requires mixed-case identifiers, define a custom <code>SpringPhysicalNamingStrategy</code> bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy;
import org.hibernate.engine.jdbc.env.spi.JdbcEnvironment;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyHibernateConfiguration {

    @Bean
    public CamelCaseToUnderscoresNamingStrategy caseSensitivePhysicalNamingStrategy() {
        return new CamelCaseToUnderscoresNamingStrategy() {

            @Override
            protected boolean isCaseInsensitive(JdbcEnvironment jdbcEnvironment) {
                return false;
            }

        };
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">If you prefer to use Hibernate 5’s default instead, set the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Alternatively, you can configure the following bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyHibernateConfiguration {

    @Bean
    PhysicalNamingStrategyStandardImpl caseSensitivePhysicalNamingStrategy() {
        return new PhysicalNamingStrategyStandardImpl();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaAutoConfiguration.java"><code>HibernateJpaAutoConfiguration</code></a> and <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java"><code>JpaBaseConfiguration</code></a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-hibernate-second-level-caching" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-hibernate-second-level-caching"></a>8.7. Configure Hibernate Second-Level Caching</h3>
<div class="paragraph">
<p translation-origin="off">Hibernate <a href="https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#caching">second-level cache</a> can be configured for a range of cache providers.
Rather than configuring Hibernate to lookup the cache provider again, it is better to provide the one that is available in the context whenever possible.</p>
</div>
<div class="paragraph">
<p translation-origin="off">To do this with JCache, first make sure that <code>org.hibernate:hibernate-jcache</code> is available on the classpath.
Then, add a <code>HibernatePropertiesCustomizer</code> bean as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.hibernate.cache.jcache.ConfigSettings;

import org.springframework.boot.autoconfigure.orm.jpa.HibernatePropertiesCustomizer;
import org.springframework.cache.jcache.JCacheCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyHibernateSecondLevelCacheConfiguration {

    @Bean
    public HibernatePropertiesCustomizer hibernateSecondLevelCacheCustomizer(JCacheCacheManager cacheManager) {
        return (properties) -&gt; properties.put(ConfigSettings.CACHE_MANAGER, cacheManager.getCacheManager());
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">This customizer will configure Hibernate to use the same <code>CacheManager</code> as the one that the application uses.
It is also possible to use separate <code>CacheManager</code> instances.
For details, see <a href="https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#caching-provider-jcache">the Hibernate user guide</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.dependency-injection-in-hibernate-components" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.dependency-injection-in-hibernate-components"></a>8.8. Use Dependency Injection in Hibernate Components</h3>
<div class="paragraph">
<p translation-origin="off">By default, Spring Boot registers a <code>BeanContainer</code> implementation that uses the <code>BeanFactory</code> so that converters and entity listeners can use regular dependency injection.</p>
</div>
<div class="paragraph">
<p translation-origin="off">You can disable or tune this behavior by registering a <code>HibernatePropertiesCustomizer</code> that removes or changes the <code>hibernate.resource.beans.container</code> property.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.use-custom-entity-manager" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.use-custom-entity-manager"></a>8.9. Use a Custom EntityManagerFactory</h3>
<div class="paragraph">
<p translation-origin="off">To take full control of the configuration of the <code>EntityManagerFactory</code>, you need to add a <code>@Bean</code> named ‘entityManagerFactory’.
Spring Boot auto-configuration switches off its entity manager in the presence of a bean of that type.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.use-multiple-entity-managers" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.use-multiple-entity-managers"></a>8.10. Using Multiple EntityManagerFactories</h3>
<div class="paragraph">
<p translation-origin="off">If you need to use JPA against multiple data sources, you likely need one <code>EntityManagerFactory</code> per data source.
The <code>LocalContainerEntityManagerFactoryBean</code> from Spring ORM allows you to configure an <code>EntityManagerFactory</code> for your needs.
You can also reuse <code>JpaProperties</code> to bind settings for each <code>EntityManagerFactory</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.sql.DataSource;

import org.springframework.boot.autoconfigure.orm.jpa.JpaProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.orm.jpa.JpaVendorAdapter;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyEntityManagerFactoryConfiguration {

    @Bean
    @ConfigurationProperties("app.jpa.first")
    public JpaProperties firstJpaProperties() {
        return new JpaProperties();
    }

    @Bean
    public LocalContainerEntityManagerFactoryBean firstEntityManagerFactory(DataSource firstDataSource,
            JpaProperties firstJpaProperties) {
        EntityManagerFactoryBuilder builder = createEntityManagerFactoryBuilder(firstJpaProperties);
        return builder.dataSource(firstDataSource).packages(Order.class).persistenceUnit("firstDs").build();
    }

    private EntityManagerFactoryBuilder createEntityManagerFactoryBuilder(JpaProperties jpaProperties) {
        JpaVendorAdapter jpaVendorAdapter = createJpaVendorAdapter(jpaProperties);
        return new EntityManagerFactoryBuilder(jpaVendorAdapter, jpaProperties.getProperties(), null);
    }

    private JpaVendorAdapter createJpaVendorAdapter(JpaProperties jpaProperties) {
        // ... map JPA properties as needed
        return new HibernateJpaVendorAdapter();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The example above creates an <code>EntityManagerFactory</code> using a <code>DataSource</code> bean named <code>firstDataSource</code>.
It scans entities located in the same package as <code>Order</code>.
It is possible to map additional JPA properties using the <code>app.first.jpa</code> namespace.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">When you create a bean for <code>LocalContainerEntityManagerFactoryBean</code> yourself, any customization that was applied during the creation of the auto-configured <code>LocalContainerEntityManagerFactoryBean</code> is lost.
For example, in case of Hibernate, any properties under the <code>spring.jpa.hibernate</code> prefix will not be automatically applied to your <code>LocalContainerEntityManagerFactoryBean</code>.
If you were relying on these properties for configuring things like the naming strategy or the DDL mode, you will need to explicitly configure that when creating the <code>LocalContainerEntityManagerFactoryBean</code> bean.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">You should provide a similar configuration for any additional data sources for which you need JPA access.
To complete the picture, you need to configure a <code>JpaTransactionManager</code> for each <code>EntityManagerFactory</code> as well.
Alternatively, you might be able to use a JTA transaction manager that spans both.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If you use Spring Data, you need to configure <code>@EnableJpaRepositories</code> accordingly, as shown in the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableJpaRepositories(basePackageClasses = Order.class, entityManagerFactoryRef = "firstEntityManagerFactory")
public class OrderConfiguration {

}
</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableJpaRepositories(basePackageClasses = Customer.class, entityManagerFactoryRef = "secondEntityManagerFactory")
public class CustomerConfiguration {

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.use-traditional-persistence-xml" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.use-traditional-persistence-xml"></a>8.11. Use a Traditional persistence.xml File</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot will not search for or use a <code>META-INF/persistence.xml</code> by default.
If you prefer to use a traditional <code>persistence.xml</code>, you need to define your own <code>@Bean</code> of type <code>LocalEntityManagerFactoryBean</code> (with an ID of ‘entityManagerFactory’) and set the persistence unit name there.</p>
</div>
<div class="paragraph">
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java"><code>JpaBaseConfiguration</code></a> for the default settings.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.use-spring-data-jpa-and-mongo-repositories" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.use-spring-data-jpa-and-mongo-repositories"></a>8.12. Use Spring Data JPA and Mongo Repositories</h3>
<div class="paragraph">
<p translation-origin="off">Spring Data JPA and Spring Data Mongo can both automatically create <code>Repository</code> implementations for you.
If they are both present on the classpath, you might have to do some extra configuration to tell Spring Boot which repositories to create.
The most explicit way to do that is to use the standard Spring Data <code>@EnableJpaRepositories</code> and <code>@EnableMongoRepositories</code> annotations and provide the location of your <code>Repository</code> interfaces.</p>
</div>
<div class="paragraph">
<p translation-origin="off">There are also flags (<code>spring.data.*.repositories.enabled</code> and <code>spring.data.*.repositories.type</code>) that you can use to switch the auto-configured repositories on and off in external configuration.
Doing so is useful, for instance, in case you want to switch off the Mongo repositories and still use the auto-configured <code>MongoTemplate</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The same obstacle and the same features exist for other auto-configured Spring Data repository types (Elasticsearch, Solr, and others).
To work with them, change the names of the annotations and flags accordingly.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.customize-spring-data-web-support" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.customize-spring-data-web-support"></a>8.13. Customize Spring Data’s Web Support</h3>
<div class="paragraph">
<p translation-origin="off">Spring Data provides web support that simplifies the use of Spring Data repositories in a web application.
Spring Boot provides properties in the <code>spring.data.web</code> namespace for customizing its configuration.
Note that if you are using Spring Data REST, you must use the properties in the <code>spring.data.rest</code> namespace instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.exposing-spring-data-repositories-as-rest" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.exposing-spring-data-repositories-as-rest"></a>8.14. Expose Spring Data Repositories as REST Endpoint</h3>
<div class="paragraph">
<p translation-origin="off">Spring Data REST can expose the <code>Repository</code> implementations as REST endpoints for you,
provided Spring MVC has been enabled for the application.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot exposes a set of useful properties (from the <code>spring.data.rest</code> namespace) that customize the <a href="https://docs.spring.io/spring-data/rest/docs/3.6.1/api/org/springframework/data/rest/core/config/RepositoryRestConfiguration.html"><code>RepositoryRestConfiguration</code></a>.
If you need to provide additional customization, you should use a <a href="https://docs.spring.io/spring-data/rest/docs/3.6.1/api/org/springframework/data/rest/webmvc/config/RepositoryRestConfigurer.html"><code>RepositoryRestConfigurer</code></a> bean.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">If you do not specify any order on your custom <code>RepositoryRestConfigurer</code>, it runs after the one Spring Boot uses internally.
If you need to specify an order, make sure it is higher than 0.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-a-component-that-is-used-by-jpa" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-a-component-that-is-used-by-jpa"></a>8.15. Configure a Component that is Used by JPA</h3>
<div class="paragraph">
<p translation-origin="off">If you want to configure a component that JPA uses, then you need to ensure that the component is initialized before JPA.
When the component is auto-configured, Spring Boot takes care of this for you.
For example, when Flyway is auto-configured, Hibernate is configured to depend upon Flyway so that Flyway has a chance to initialize the database before Hibernate tries to use it.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If you are configuring a component yourself, you can use an <code>EntityManagerFactoryDependsOnPostProcessor</code> subclass as a convenient way of setting up the necessary dependencies.
For example, if you use Hibernate Search with Elasticsearch as its index manager, any <code>EntityManagerFactory</code> beans must be configured to depend on the <code>elasticsearchClient</code> bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.persistence.EntityManagerFactory;

import org.springframework.boot.autoconfigure.orm.jpa.EntityManagerFactoryDependsOnPostProcessor;
import org.springframework.stereotype.Component;

</span><span class="fold-block">/**
 * {@link EntityManagerFactoryDependsOnPostProcessor} that ensures that
 * {@link EntityManagerFactory} beans depend on the {@code elasticsearchClient} bean.
 */
@Component
public class ElasticsearchEntityManagerFactoryDependsOnPostProcessor
        extends EntityManagerFactoryDependsOnPostProcessor {

    public ElasticsearchEntityManagerFactoryDependsOnPostProcessor() {
        super("elasticsearchClient");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-access.configure-jooq-with-multiple-datasources" translation-origin="off"><a class="anchor" href="howto.html#howto.data-access.configure-jooq-with-multiple-datasources"></a>8.16. Configure jOOQ with Two DataSources</h3>
<div class="paragraph">
<p translation-origin="off">If you need to use jOOQ with multiple data sources, you should create your own <code>DSLContext</code> for each one.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jooq/JooqAutoConfiguration.java">JooqAutoConfiguration</a> for more details.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">In particular, <code>JooqExceptionTranslator</code> and <code>SpringTransactionProvider</code> can be reused to provide similar features to what the auto-configuration does with a single <code>DataSource</code>.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.data-initialization" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization"></a>9. Database Initialization</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">An SQL database can be initialized in different ways depending on what your stack is.
Of course, you can also do it manually, provided the database is a separate process.
It is recommended to use a single mechanism for schema generation.</p>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.using-jpa" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.using-jpa"></a>9.1. Initialize a Database Using JPA</h3>
<div class="paragraph">
<p translation-origin="off">JPA has features for DDL generation, and these can be set up to run on startup against the database.
This is controlled through two external properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>spring.jpa.generate-ddl</code> (boolean) switches the feature on and off and is vendor independent.</p>
</li>
<li>
<p translation-origin="off"><code>spring.jpa.hibernate.ddl-auto</code> (enum) is a Hibernate feature that controls the behavior in a more fine-grained way.
This feature is described in more detail later in this guide.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.using-hibernate" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.using-hibernate"></a>9.2. Initialize a Database Using Hibernate</h3>
<div class="paragraph">
<p translation-origin="off">You can set <code>spring.jpa.hibernate.ddl-auto</code> explicitly and the standard Hibernate property values are <code>none</code>, <code>validate</code>, <code>update</code>, <code>create</code>, and <code>create-drop</code>.
Spring Boot chooses a default value for you based on whether it thinks your database is embedded.
It defaults to <code>create-drop</code> if no schema manager has been detected or <code>none</code> in all other cases.
An embedded database is detected by looking at the <code>Connection</code> type and JDBC url.
<code>hsqldb</code>, <code>h2</code>, and <code>derby</code> are candidates, and others are not.
Be careful when switching from in-memory to a ‘real’ database that you do not make assumptions about the existence of the tables and data in the new platform.
You either have to set <code>ddl-auto</code> explicitly or use one of the other mechanisms to initialize the database.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">You can output the schema creation by enabling the <code>org.hibernate.SQL</code> logger.
This is done for you automatically if you enable the <a href="features.html#features.logging.console-output">debug mode</a>.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">In addition, a file named <code>import.sql</code> in the root of the classpath is executed on startup if Hibernate creates the schema from scratch (that is, if the <code>ddl-auto</code> property is set to <code>create</code> or <code>create-drop</code>).
This can be useful for demos and for testing if you are careful but is probably not something you want to be on the classpath in production.
It is a Hibernate feature (and has nothing to do with Spring).</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.using-basic-sql-scripts" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.using-basic-sql-scripts"></a>9.3. Initialize a Database Using Basic SQL Scripts</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot can automatically create the schema (DDL scripts) of your JDBC <code>DataSource</code> or R2DBC <code>ConnectionFactory</code> and initialize it (DML scripts).
It loads SQL from the standard root classpath locations: <code>schema.sql</code> and <code>data.sql</code>, respectively.
In addition, Spring Boot processes the <code>schema-${platform}.sql</code> and <code>data-${platform}.sql</code> files (if present), where <code>platform</code> is the value of <code>spring.sql.init.platform</code>.
This allows you to switch to database-specific scripts if necessary.
For example, you might choose to set it to the vendor name of the database (<code>hsqldb</code>, <code>h2</code>, <code>oracle</code>, <code>mysql</code>, <code>postgresql</code>, and so on).
By default, SQL database initialization is only performed when using an embedded in-memory database.
To always initialize an SQL database, irrespective of its type, set <code>spring.sql.init.mode</code> to <code>always</code>.
Similarly, to disable initialization, set <code>spring.sql.init.mode</code> to <code>never</code>.
By default, Spring Boot enables the fail-fast feature of its script-based database initializer.
This means that, if the scripts cause exceptions, the application fails to start.
You can tune that behavior by setting <code>spring.sql.init.continue-on-error</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Script-based <code>DataSource</code> initialization is performed, by default, before any JPA <code>EntityManagerFactory</code> beans are created.
<code>schema.sql</code> can be used to create the schema for JPA-managed entities and <code>data.sql</code> can be used to populate it.
While we do not recommend using multiple data source initialization technologies, if you want script-based <code>DataSource</code> initialization to be able to build upon the schema creation performed by Hibernate, set <code>spring.jpa.defer-datasource-initialization</code> to <code>true</code>.
This will defer data source initialization until after any <code>EntityManagerFactory</code> beans have been created and initialized.
<code>schema.sql</code> can then be used to make additions to any schema creation performed by Hibernate and <code>data.sql</code> can be used to populate it.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If you are using a <a href="howto.html#howto.data-initialization.migration-tool">Higher-level Database Migration Tool</a>, like Flyway or Liquibase, you should use them alone to create and initialize the schema.
Using the basic <code>schema.sql</code> and <code>data.sql</code> scripts alongside Flyway or Liquibase is not recommended and support will be removed in a future release.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.batch" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.batch"></a>9.4. Initialize a Spring Batch Database</h3>
<div class="paragraph">
<p translation-origin="off">If you use Spring Batch, it comes pre-packaged with SQL initialization scripts for most popular database platforms.
Spring Boot can detect your database type and execute those scripts on startup.
If you use an embedded database, this happens by default.
You can also enable it for any database type, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.batch.jdbc.initialize-schema=always</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  batch:
    jdbc:
      initialize-schema: "always"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">You can also switch off the initialization explicitly by setting <code>spring.batch.jdbc.initialize-schema</code> to <code>never</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.migration-tool" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.migration-tool"></a>9.5. Use a Higher-level Database Migration Tool</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot supports two higher-level migration tools: <a href="https://flywaydb.org/">Flyway</a> and <a href="https://www.liquibase.org/">Liquibase</a>.</p>
</div>
<div class="sect3">
<h4 id="howto.data-initialization.migration-tool.flyway" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.migration-tool.flyway"></a>9.5.1. Execute Flyway Database Migrations on Startup</h4>
<div class="paragraph">
<p translation-origin="off">To automatically run Flyway database migrations on startup, add the <code>org.flywaydb:flyway-core</code> to your classpath.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Typically, migrations are scripts in the form <code>V&lt;VERSION&gt;__&lt;NAME&gt;.sql</code> (with <code>&lt;VERSION&gt;</code> an underscore-separated version, such as ‘1’ or ‘2_1’).
By default, they are in a directory called <code>classpath:db/migration</code>, but you can modify that location by setting <code>spring.flyway.locations</code>.
This is a comma-separated list of one or more <code>classpath:</code> or <code>filesystem:</code> locations.
For example, the following configuration would search for scripts in both the default classpath location and the <code>/opt/migration</code> directory:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.flyway.locations=classpath:db/migration,filesystem:/opt/migration</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  flyway:
    locations: "classpath:db/migration,filesystem:/opt/migration"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">You can also add a special <code>{vendor}</code> placeholder to use vendor-specific scripts.
Assume the following:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.flyway.locations=classpath:db/migration/{vendor}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  flyway:
    locations: "classpath:db/migration/{vendor}"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Rather than using <code>db/migration</code>, the preceding configuration sets the directory to use according to the type of the database (such as <code>db/migration/mysql</code> for MySQL).
The list of supported databases is available in <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jdbc/DatabaseDriver.java"><code>DatabaseDriver</code></a>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Migrations can also be written in Java.
Flyway will be auto-configured with any beans that implement <code>JavaMigration</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off"><a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/flyway/FlywayProperties.java"><code>FlywayProperties</code></a> provides most of Flyway’s settings and a small set of additional properties that can be used to disable the migrations or switch off the location checking.
If you need more control over the configuration, consider registering a <code>FlywayConfigurationCustomizer</code> bean.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Boot calls <code>Flyway.migrate()</code> to perform the database migration.
If you would like more control, provide a <code>@Bean</code> that implements <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/flyway/FlywayMigrationStrategy.java"><code>FlywayMigrationStrategy</code></a>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Flyway supports SQL and Java <a href="https://flywaydb.org/documentation/concepts/callbacks">callbacks</a>.
To use SQL-based callbacks, place the callback scripts in the <code>classpath:db/migration</code> directory.
To use Java-based callbacks, create one or more beans that implement <code>Callback</code>.
Any such beans are automatically registered with <code>Flyway</code>.
They can be ordered by using <code>@Order</code> or by implementing <code>Ordered</code>.
Beans that implement the deprecated <code>FlywayCallback</code> interface can also be detected, however they cannot be used alongside <code>Callback</code> beans.</p>
</div>
<div class="paragraph">
<p translation-origin="off">By default, Flyway autowires the (<code>@Primary</code>) <code>DataSource</code> in your context and uses that for migrations.
If you like to use a different <code>DataSource</code>, you can create one and mark its <code>@Bean</code> as <code>@FlywayDataSource</code>.
If you do so and want two data sources, remember to create another one and mark it as <code>@Primary</code>.
Alternatively, you can use Flyway’s native <code>DataSource</code> by setting <code>spring.flyway.[url,user,password]</code> in external properties.
Setting either <code>spring.flyway.url</code> or <code>spring.flyway.user</code> is sufficient to cause Flyway to use its own <code>DataSource</code>.
If any of the three properties has not been set, the value of its equivalent <code>spring.datasource</code> property will be used.</p>
</div>
<div class="paragraph">
<p translation-origin="off">You can also use Flyway to provide data for specific scenarios.
For example, you can place test-specific migrations in <code>src/test/resources</code> and they are run only when your application starts for testing.
Also, you can use profile-specific configuration to customize <code>spring.flyway.locations</code> so that certain migrations run only when a particular profile is active.
For example, in <code>application-dev.properties</code>, you might specify the following setting:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.flyway.locations=classpath:/db/migration,classpath:/dev/db/migration</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  flyway:
    locations: "classpath:/db/migration,classpath:/dev/db/migration"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">With that setup, migrations in <code>dev/db/migration</code> run only when the <code>dev</code> profile is active.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.data-initialization.migration-tool.liquibase" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.migration-tool.liquibase"></a>9.5.2. Execute Liquibase Database Migrations on Startup</h4>
<div class="paragraph">
<p translation-origin="off">To automatically run Liquibase database migrations on startup, add the <code>org.liquibase:liquibase-core</code> to your classpath.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-origin="off">When you add the <code>org.liquibase:liquibase-core</code> to your classpath, database migrations run by default for both during application startup and before your tests run.
This behavior can be customized by using the <code>spring.liquibase.enabled</code> property, setting different values in the <code>main</code> and <code>test</code> configurations.
It is not possible to use two different ways to initialize the database (for example Liquibase for application startup, JPA for test runs).</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">By default, the master change log is read from <code>db/changelog/db.changelog-master.yaml</code>, but you can change the location by setting <code>spring.liquibase.change-log</code>.
In addition to YAML, Liquibase also supports JSON, XML, and SQL change log formats.</p>
</div>
<div class="paragraph">
<p translation-origin="off">By default, Liquibase autowires the (<code>@Primary</code>) <code>DataSource</code> in your context and uses that for migrations.
If you need to use a different <code>DataSource</code>, you can create one and mark its <code>@Bean</code> as <code>@LiquibaseDataSource</code>.
If you do so and you want two data sources, remember to create another one and mark it as <code>@Primary</code>.
Alternatively, you can use Liquibase’s native <code>DataSource</code> by setting <code>spring.liquibase.[driver-class-name,url,user,password]</code> in external properties.
Setting either <code>spring.liquibase.url</code> or <code>spring.liquibase.user</code> is sufficient to cause Liquibase to use its own <code>DataSource</code>.
If any of the three properties has not been set, the value of its equivalent <code>spring.datasource</code> property will be used.</p>
</div>
<div class="paragraph">
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/liquibase/LiquibaseProperties.java"><code>LiquibaseProperties</code></a> for details about available settings such as contexts, the default schema, and others.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.data-initialization.dependencies" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.dependencies"></a>9.6. Depend Upon an Initialized Database</h3>
<div class="paragraph">
<p translation-origin="off">Database initialization is performed while the application is starting up as part of application context refresh.
To allow an initialized database to be accessed during startup, beans that act as database initializers and beans that require that database to have been initialized are detected automatically.
Beans whose initialization depends upon the database having been initialized are configured to depend upon those that initialize it.
If, during startup, your application tries to access the database and it has not been initialized, you can configure additional detection of beans that initialize the database and require the database to have been initialized.</p>
</div>
<div class="sect3">
<h4 id="howto.data-initialization.dependencies.initializer-detection" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.dependencies.initializer-detection"></a>9.6.1. Detect a Database Initializer</h4>
<div class="paragraph">
<p translation-origin="off">Spring Boot will automatically detect beans of the following types that initialize an SQL database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>DataSourceScriptDatabaseInitializer</code></p>
</li>
<li>
<p translation-origin="off"><code>EntityManagerFactory</code></p>
</li>
<li>
<p translation-origin="off"><code>Flyway</code></p>
</li>
<li>
<p translation-origin="off"><code>FlywayMigrationInitializer</code></p>
</li>
<li>
<p translation-origin="off"><code>R2dbcScriptDatabaseInitializer</code></p>
</li>
<li>
<p translation-origin="off"><code>SpringLiquibase</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">If you are using a third-party starter for a database initialization library, it may provide a detector such that beans of other types are also detected automatically.
To have other beans be detected, register an implementation of <code>DatabaseInitializerDetector</code> in <code>META-INF/spring-factories</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.data-initialization.dependencies.depends-on-initialization-detection" translation-origin="off"><a class="anchor" href="howto.html#howto.data-initialization.dependencies.depends-on-initialization-detection"></a>9.6.2. Detect a Bean That Depends On Database Initialization</h4>
<div class="paragraph">
<p translation-origin="off">Spring Boot will automatically detect beans of the following types that depends upon database initialization:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>AbstractEntityManagerFactoryBean</code> (unless <code>spring.jpa.defer-datasource-initialization</code> is set to <code>true</code>)</p>
</li>
<li>
<p translation-origin="off"><code>DSLContext</code> (jOOQ)</p>
</li>
<li>
<p translation-origin="off"><code>EntityManagerFactory</code> (unless <code>spring.jpa.defer-datasource-initialization</code> is set to <code>true</code>)</p>
</li>
<li>
<p translation-origin="off"><code>JdbcOperations</code></p>
</li>
<li>
<p translation-origin="off"><code>NamedParameterJdbcOperations</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">If you are using a third-party starter data access library, it may provide a detector such that beans of other types are also detected automatically.
To have other beans be detected, register an implementation of <code>DependsOnDatabaseInitializationDetector</code> in <code>META-INF/spring-factories</code>.
Alternatively, annotate the bean’s class or its <code>@Bean</code> method with <code>@DependsOnDatabaseInitialization</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.messaging" translation-origin="off"><a class="anchor" href="howto.html#howto.messaging"></a>10. Messaging</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot offers a number of starters to support messaging.
This section answers questions that arise from using messaging with Spring Boot.</p>
</div>
<div class="sect2">
<h3 id="howto.messaging.disable-transacted-jms-session" translation-origin="off"><a class="anchor" href="howto.html#howto.messaging.disable-transacted-jms-session"></a>10.1. Disable Transacted JMS Session</h3>
<div class="paragraph">
<p translation-origin="off">If your JMS broker does not support transacted sessions, you have to disable the support of transactions altogether.
If you create your own <code>JmsListenerContainerFactory</code>, there is nothing to do, since, by default it cannot be transacted.
If you want to use the <code>DefaultJmsListenerContainerFactoryConfigurer</code> to reuse Spring Boot’s default, you can disable transacted sessions, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.jms.ConnectionFactory;

import org.springframework.boot.autoconfigure.jms.DefaultJmsListenerContainerFactoryConfigurer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.jms.config.DefaultJmsListenerContainerFactory;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyJmsConfiguration {

    @Bean
    public DefaultJmsListenerContainerFactory jmsListenerContainerFactory(ConnectionFactory connectionFactory,
            DefaultJmsListenerContainerFactoryConfigurer configurer) {
        DefaultJmsListenerContainerFactory listenerFactory = new DefaultJmsListenerContainerFactory();
        configurer.configure(listenerFactory, connectionFactory);
        listenerFactory.setTransactionManager(null);
        listenerFactory.setSessionTransacted(false);
        return listenerFactory;
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The preceding example overrides the default factory, and it should be applied to any other factory that your application defines, if any.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.batch" translation-origin="off"><a class="anchor" href="howto.html#howto.batch"></a>11. Batch Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">A number of questions often arise when people use Spring Batch from within a Spring Boot application.
This section addresses those questions.</p>
</div>
<div class="sect2">
<h3 id="howto.batch.specifying-a-data-source" translation-origin="off"><a class="anchor" href="howto.html#howto.batch.specifying-a-data-source"></a>11.1. Specifying a Batch Data Source</h3>
<div class="paragraph">
<p translation-origin="off">By default, batch applications require a <code>DataSource</code> to store job details.
Spring Batch expects a single <code>DataSource</code> by default.
To have it use a <code>DataSource</code> other than the application’s main <code>DataSource</code>, declare a <code>DataSource</code> bean, annotating its <code>@Bean</code> method with <code>@BatchDataSource</code>.
If you do so and want two data sources, remember to mark the other one <code>@Primary</code>.
To take greater control, implement <code>BatchConfigurer</code>.
See <a href="https://docs.spring.io/spring-batch/docs/4.3.4/api/org/springframework/batch/core/configuration/annotation/EnableBatchProcessing.html">The Javadoc of <code>@EnableBatchProcessing</code></a> for more details.</p>
</div>
<div class="paragraph">
<p translation-origin="off">For more info about Spring Batch, see the <a href="https://spring.io/projects/spring-batch">Spring Batch project page</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.batch.running-jobs-on-startup" translation-origin="off"><a class="anchor" href="howto.html#howto.batch.running-jobs-on-startup"></a>11.2. Running Spring Batch Jobs on Startup</h3>
<div class="paragraph">
<p translation-origin="off">Spring Batch auto-configuration is enabled by adding <code>@EnableBatchProcessing</code> to one of your <code>@Configuration</code> classes.</p>
</div>
<div class="paragraph">
<p translation-origin="off">By default, it executes <strong>all</strong> <code>Jobs</code> in the application context on startup (see <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/batch/JobLauncherApplicationRunner.java"><code>JobLauncherApplicationRunner</code></a> for details).
You can narrow down to a specific job or jobs by specifying <code>spring.batch.job.names</code> (which takes a comma-separated list of job name patterns).</p>
</div>
<div class="paragraph">
<p translation-origin="off">See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration.java">BatchAutoConfiguration</a> and <a href="https://docs.spring.io/spring-batch/docs/4.3.4/api/org/springframework/batch/core/configuration/annotation/EnableBatchProcessing.html">@EnableBatchProcessing</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.batch.running-from-the-command-line" translation-origin="off"><a class="anchor" href="howto.html#howto.batch.running-from-the-command-line"></a>11.3. Running from the Command Line</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot converts any command line argument starting with <code>--</code> to a property to add to the <code>Environment</code>, see <a href="features.html#features.external-config.command-line-args">accessing command line properties</a>.
This should not be used to pass arguments to batch jobs.
To specify batch arguments on the command line, use the regular format (that is without <code>--</code>), as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar myapp.jar someParameter=someValue anotherParameter=anotherValue</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">If you specify a property of the <code>Environment</code> on the command line, it is ignored by the job.
Consider the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar myapp.jar --server.port=7070 someParameter=someValue</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">This provides only one argument to the batch job: <code>someParameter=someValue</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.batch.storing-job-repository" translation-origin="off"><a class="anchor" href="howto.html#howto.batch.storing-job-repository"></a>11.4. Storing the Job Repository</h3>
<div class="paragraph">
<p translation-origin="off">Spring Batch requires a data store for the <code>Job</code> repository.
If you use Spring Boot, you must use an actual database.
Note that it can be an in-memory database, see <a href="https://docs.spring.io/spring-batch/docs/4.3.4/reference/html/job.html#configuringJobRepository">Configuring a Job Repository</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.actuator" translation-origin="off"><a class="anchor" href="howto.html#howto.actuator"></a>12. Actuator</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot includes the Spring Boot Actuator.
This section answers questions that often arise from its use.</p>
</div>
<div class="sect2">
<h3 id="howto.actuator.change-http-port-or-address" translation-origin="off"><a class="anchor" href="howto.html#howto.actuator.change-http-port-or-address"></a>12.1. Change the HTTP Port or Address of the Actuator Endpoints</h3>
<div class="paragraph">
<p translation-origin="off">In a standalone application, the Actuator HTTP port defaults to the same as the main HTTP port.
To make the application listen on a different port, set the external property: <code>management.server.port</code>.
To listen on a completely different network address (such as when you have an internal network for management and an external one for user applications), you can also set <code>management.server.address</code> to a valid IP address to which the server is able to bind.</p>
</div>
<div class="paragraph">
<p translation-origin="off">For more detail, see the <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-actuator-autoconfigure/src/main/java/org/springframework/boot/actuate/autoconfigure/web/server/ManagementServerProperties.java"><code>ManagementServerProperties</code></a> source code and “<a href="actuator.html#actuator.monitoring.customizing-management-server-port">actuator.html</a>” in the “Production-ready features” section.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.actuator.customize-whitelabel-error-page" translation-origin="off"><a class="anchor" href="howto.html#howto.actuator.customize-whitelabel-error-page"></a>12.2. Customize the ‘whitelabel’ Error Page</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot installs a ‘whitelabel’ error page that you see in a browser client if you encounter a server error (machine clients consuming JSON and other media types should see a sensible response with the right error code).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<p translation-origin="off">Set <code>server.error.whitelabel.enabled=false</code> to switch the default error page off.
Doing so restores the default of the servlet container that you are using.
Note that Spring Boot still tries to resolve the error view, so you should probably add your own error page rather than disabling it completely.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">Overriding the error page with your own depends on the templating technology that you use.
For example, if you use Thymeleaf, you can add an <code>error.html</code> template.
If you use FreeMarker, you can add an <code>error.ftlh</code> template.
In general, you need a <code>View</code> that resolves with a name of <code>error</code> or a <code>@Controller</code> that handles the <code>/error</code> path.
Unless you replaced some of the default configuration, you should find a <code>BeanNameViewResolver</code> in your <code>ApplicationContext</code>, so a <code>@Bean</code> named <code>error</code> would be one way of doing that.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/error/ErrorMvcAutoConfiguration.java"><code>ErrorMvcAutoConfiguration</code></a> for more options.</p>
</div>
<div class="paragraph">
<p translation-origin="off">See also the section on “<a href="web.html#web.servlet.spring-mvc.error-handling">Error Handling</a>” for details of how to register handlers in the servlet container.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.actuator.sanitize-sensitive-values" translation-origin="off"><a class="anchor" href="howto.html#howto.actuator.sanitize-sensitive-values"></a>12.3. Sanitize Sensitive Values</h3>
<div class="paragraph">
<p translation-origin="off">Information returned by the <code>env</code> and <code>configprops</code> endpoints can be somewhat sensitive so keys matching certain patterns are sanitized by default (that is their values are replaced by <code>******</code>).
Spring Boot uses sensible defaults for such keys: any key ending with the word "password", "secret", "key", "token", "vcap_services", "sun.java.command" is entirely sanitized.
Additionally, any key that holds the word <code>credentials</code> (configured as a regular expression, that is <code>*credentials.*</code>) as part of the key is also entirely sanitized.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Furthermore, Spring Boot sanitizes the sensitive portion of URI-like values for keys with one of the following endings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off"><code>address</code></p>
</li>
<li>
<p translation-origin="off"><code>addresses</code></p>
</li>
<li>
<p translation-origin="off"><code>uri</code></p>
</li>
<li>
<p translation-origin="off"><code>uris</code></p>
</li>
<li>
<p translation-origin="off"><code>url</code></p>
</li>
<li>
<p translation-origin="off"><code>urls</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">The sensitive portion of the URI is identified using the format <code>&lt;scheme&gt;://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/</code>.
For example, for the property <code>myclient.uri=http://user1:<a href="https://docs.spring.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2454455757534b56401564484b4745484c4b5750">[email&nbsp;protected]</a>:8081</code>, the resulting sanitized value is
<code>http://user1:******@localhost:8081</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The default patterns used by the <code>env</code> and <code>configprops</code> endpoints can be replaced using <code>management.endpoint.env.keys-to-sanitize</code> and <code>management.endpoint.configprops.keys-to-sanitize</code> respectively.
Alternatively, additional patterns can be configured using <code>management.endpoint.env.additional-keys-to-sanitize</code> and <code>management.endpoint.configprops.additional-keys-to-sanitize</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.actuator.map-health-indicators-to-metrics" translation-origin="off"><a class="anchor" href="howto.html#howto.actuator.map-health-indicators-to-metrics"></a>12.4. Map Health Indicators to Micrometer Metrics</h3>
<div class="paragraph">
<p translation-origin="off">Spring Boot health indicators return a <code>Status</code> type to indicate the overall system health.
If you want to monitor or alert on levels of health for a particular application, you can export these statuses as metrics with Micrometer.
By default, the status codes “UP”, “DOWN”, “OUT_OF_SERVICE” and “UNKNOWN” are used by Spring Boot.
To export these, you will need to convert these states to some set of numbers so that they can be used with a Micrometer <code>Gauge</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">The following example shows one way to write such an exporter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Gauge;
import io.micrometer.core.instrument.MeterRegistry;

import org.springframework.boot.actuate.health.HealthEndpoint;
import org.springframework.boot.actuate.health.Status;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyHealthMetricsExportConfiguration {

    public MyHealthMetricsExportConfiguration(MeterRegistry registry, HealthEndpoint healthEndpoint) {
        // This example presumes common tags (such as the app) are applied elsewhere
        Gauge.builder("health", healthEndpoint, this::getStatusCode).strongReference(true).register(registry);
    }

    private int getStatusCode(HealthEndpoint health) {
        Status status = health.health().getStatus();
        if (Status.UP.equals(status)) {
            return 3;
        }
        if (Status.OUT_OF_SERVICE.equals(status)) {
            return 2;
        }
        if (Status.DOWN.equals(status)) {
            return 1;
        }
        return 0;
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.security" translation-origin="off"><a class="anchor" href="howto.html#howto.security"></a>13. Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">This section addresses questions about security when working with Spring Boot, including questions that arise from using Spring Security with Spring Boot.</p>
</div>
<div class="paragraph">
<p translation-origin="off">For more about Spring Security, see the <a href="https://spring.io/projects/spring-security">Spring Security project page</a>.</p>
</div>
<div class="sect2">
<h3 id="howto.security.switch-off-spring-boot-configuration" translation-origin="off"><a class="anchor" href="howto.html#howto.security.switch-off-spring-boot-configuration"></a>13.1. Switch off the Spring Boot Security Configuration</h3>
<div class="paragraph">
<p translation-origin="off">If you define a <code>@Configuration</code> with a <code>WebSecurityConfigurerAdapter</code> or a <code>SecurityFilterChain</code> bean in your application, it switches off the default webapp security settings in Spring Boot.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.security.change-user-details-service-and-add-user-accounts" translation-origin="off"><a class="anchor" href="howto.html#howto.security.change-user-details-service-and-add-user-accounts"></a>13.2. Change the UserDetailsService and Add User Accounts</h3>
<div class="paragraph">
<p translation-origin="off">If you provide a <code>@Bean</code> of type <code>AuthenticationManager</code>, <code>AuthenticationProvider</code>, or <code>UserDetailsService</code>, the default <code>@Bean</code> for <code>InMemoryUserDetailsManager</code> is not created.
This means you have the full feature set of Spring Security available (such as <a href="https://docs.spring.io/spring-security/reference/5.6.1/servlet/authentication/index.html">various authentication options</a>).</p>
</div>
<div class="paragraph">
<p translation-origin="off">The easiest way to add user accounts is to provide your own <code>UserDetailsService</code> bean.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.security.enable-https" translation-origin="off"><a class="anchor" href="howto.html#howto.security.enable-https"></a>13.3. Enable HTTPS When Running behind a Proxy Server</h3>
<div class="paragraph">
<p translation-origin="off">Ensuring that all your main endpoints are only available over HTTPS is an important chore for any application.
If you use Tomcat as a servlet container, then Spring Boot adds Tomcat’s own <code>RemoteIpValve</code> automatically if it detects some environment settings, and you should be able to rely on the <code>HttpServletRequest</code> to report whether it is secure or not (even downstream of a proxy server that handles the real SSL termination).
The standard behavior is determined by the presence or absence of certain request headers (<code>x-forwarded-for</code> and <code>x-forwarded-proto</code>), whose names are conventional, so it should work with most front-end proxies.
You can switch on the valve by adding some entries to <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title" translation-result="on">属性</div>
<div class="title" translation-origin="off">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.tomcat.remoteip.remote-ip-header=x-forwarded-for
server.tomcat.remoteip.protocol-header=x-forwarded-proto</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  tomcat:
    remoteip:
      remote-ip-header: "x-forwarded-for"
      protocol-header: "x-forwarded-proto"</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">(The presence of either of those properties switches on the valve.
Alternatively, you can add the <code>RemoteIpValve</code> by customizing the <code>TomcatServletWebServerFactory</code> using a <code>WebServerFactoryCustomizer</code> bean.)</p>
</div>
<div class="paragraph">
<p translation-origin="off">To configure Spring Security to require a secure channel for all (or some) requests, consider adding your own <code>SecurityFilterChain</code> bean that adds the following <code>HttpSecurity</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.SecurityFilterChain;

</span><span class="fold-block">@Configuration
public class MySecurityConfig {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        // Customize the application security ...
        http.requiresChannel().anyRequest().requiresSecure();
        return http.build();
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.hotswapping" translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping"></a>14. Hot Swapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot supports hot swapping.
This section answers questions about how it works.</p>
</div>
<div class="sect2">
<h3 id="howto.hotswapping.reload-static-content" translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-static-content"></a>14.1. Reload Static Content</h3>
<div class="paragraph">
<p translation-origin="off">There are several options for hot reloading.
The recommended approach is to use <a href="using.html#using.devtools"><code>spring-boot-devtools</code></a>, as it provides additional development-time features, such as support for fast application restarts and LiveReload as well as sensible development-time configuration (such as template caching).
Devtools works by monitoring the classpath for changes.
This means that static resource changes must be "built" for the change to take effect.
By default, this happens automatically in Eclipse when you save your changes.
In IntelliJ IDEA, the Make Project command triggers the necessary build.
Due to the <a href="using.html#using.devtools.restart.excluding-resources">default restart exclusions</a>, changes to static resources do not trigger a restart of your application.
They do, however, trigger a live reload.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Alternatively, running in an IDE (especially with debugging on) is a good way to do development (all modern IDEs allow reloading of static resources and usually also allow hot-swapping of Java class changes).</p>
</div>
<div class="paragraph">
<p translation-origin="off">Finally, the <a href="build-tool-plugins.html#build-tool-plugins">Maven and Gradle plugins</a> can be configured (see the <code>addResources</code> property) to support running from the command line with reloading of static files directly from source.
You can use that with an external css/js compiler process if you are writing that code with higher-level tools.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.hotswapping.reload-templates" translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-templates"></a>14.2. Reload Templates without Restarting the Container</h3>
<div class="paragraph">
<p translation-origin="off">Most of the templating technologies supported by Spring Boot include a configuration option to disable caching (described later in this document).
If you use the <code>spring-boot-devtools</code> module, these properties are <a href="using.html#using.devtools.property-defaults">automatically configured</a> for you at development time.</p>
</div>
<div class="sect3">
<h4 id="howto.hotswapping.reload-templates.thymeleaf" translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-templates.thymeleaf"></a>14.2.1. Thymeleaf Templates</h4>
<div class="paragraph">
<p translation-origin="off">If you use Thymeleaf, set <code>spring.thymeleaf.cache</code> to <code>false</code>.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java"><code>ThymeleafAutoConfiguration</code></a> for other Thymeleaf customization options.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.hotswapping.reload-templates.freemarker" translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-templates.freemarker"></a>14.2.2. FreeMarker Templates</h4>
<div class="paragraph">
<p translation-origin="off">If you use FreeMarker, set <code>spring.freemarker.cache</code> to <code>false</code>.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/freemarker/FreeMarkerAutoConfiguration.java"><code>FreeMarkerAutoConfiguration</code></a> for other FreeMarker customization options.</p>
</div>
</div>
<div class="sect3">
<h4 id="howto.hotswapping.reload-templates.groovy" translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-templates.groovy"></a>14.2.3. Groovy Templates</h4>
<div class="paragraph">
<p translation-origin="off">If you use Groovy templates, set <code>spring.groovy.template.cache</code> to <code>false</code>.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.6.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/groovy/template/GroovyTemplateAutoConfiguration.java"><code>GroovyTemplateAutoConfiguration</code></a> for other Groovy customization options.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.hotswapping.fast-application-restarts" translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.fast-application-restarts"></a>14.3. Fast Application Restarts</h3>
<div class="paragraph">
<p translation-origin="off">The <code>spring-boot-devtools</code> module includes support for automatic application restarts.
While not as fast as technologies such as <a href="https://www.jrebel.com/products/jrebel">JRebel</a> it is usually significantly faster than a “cold start”.
You should probably give it a try before investigating some of the more complex reload options discussed later in this document.</p>
</div>
<div class="paragraph">
<p translation-origin="off">For more details, see the <a href="using.html#using.devtools">using.html</a> section.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.hotswapping.reload-java-classes-without-restarting" translation-origin="off"><a class="anchor" href="howto.html#howto.hotswapping.reload-java-classes-without-restarting"></a>14.4. Reload Java Classes without Restarting the Container</h3>
<div class="paragraph">
<p translation-origin="off">Many modern IDEs (Eclipse, IDEA, and others) support hot swapping of bytecode.
Consequently, if you make a change that does not affect class or method signatures, it should reload cleanly with no side effects.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.testing" translation-origin="off"><a class="anchor" href="howto.html#howto.testing"></a>15. Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot includes a number of testing utilities and support classes as well as a dedicated starter that provides common test dependencies.
This section answers common questions about testing.</p>
</div>
<div class="sect2">
<h3 id="howto.testing.with-spring-security" translation-origin="off"><a class="anchor" href="howto.html#howto.testing.with-spring-security"></a>15.1. Testing With Spring Security</h3>
<div class="paragraph">
<p translation-origin="off">Spring Security provides support for running tests as a specific user.
For example, the test in the snippet below will run with an authenticated user that has the <code>ADMIN</code> role.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.security.test.context.support.WithMockUser;
import org.springframework.test.web.servlet.MockMvc;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;

</span><span class="fold-block">@WebMvcTest(UserController.class)
class MySecurityTests {

    @Autowired
    private MockMvc mvc;

    @Test
    @WithMockUser(roles = "ADMIN")
    void requestProtectedUrlWithUser() throws Exception {
        this.mvc.perform(get("/"));
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Spring Security provides comprehensive integration with Spring MVC Test and this can also be used when testing controllers using the <code>@WebMvcTest</code> slice and <code>MockMvc</code>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">For additional details on Spring Security’s testing support, see Spring Security’s <a href="https://docs.spring.io/spring-security/reference/5.6.1/servlet/test/index.html">reference documentation</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.testing.testcontainers" translation-origin="off"><a class="anchor" href="howto.html#howto.testing.testcontainers"></a>15.2. Use Testcontainers for Integration Testing</h3>
<div class="paragraph">
<p translation-origin="off">The <a href="https://www.testcontainers.org/">Testcontainers</a> library provides a way to manage services running inside Docker containers.
It integrates with JUnit, allowing you to write a test class that can start up a container before any of the tests run.
Testcontainers is especially useful for writing integration tests that talk to a real backend service such as MySQL, MongoDB, Cassandra and others.
Testcontainers can be used in a Spring Boot test as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;
import org.testcontainers.containers.Neo4jContainer;
import org.testcontainers.junit.jupiter.Container;
import org.testcontainers.junit.jupiter.Testcontainers;

import org.springframework.boot.test.context.SpringBootTest;

</span><span class="fold-block">@SpringBootTest
@Testcontainers
class MyIntegrationTests {

    @Container
    static Neo4jContainer&lt;?&gt; neo4j = new Neo4jContainer&lt;&gt;("neo4j:4.2");

    @Test
    void myTest() {
        // ...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">This will start up a docker container running Neo4j (if Docker is running locally) before any of the tests are run.
In most cases, you will need to configure the application using details from the running container, such as container IP or port.</p>
</div>
<div class="paragraph">
<p translation-origin="off">This can be done with a static <code>@DynamicPropertySource</code> method that allows adding dynamic property values to the Spring Environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;
import org.testcontainers.containers.Neo4jContainer;
import org.testcontainers.junit.jupiter.Container;
import org.testcontainers.junit.jupiter.Testcontainers;

import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.DynamicPropertyRegistry;
import org.springframework.test.context.DynamicPropertySource;

</span><span class="fold-block">@SpringBootTest
@Testcontainers
class MyIntegrationTests {

    @Container
    static Neo4jContainer&lt;?&gt; neo4j = new Neo4jContainer&lt;&gt;("neo4j:4.2");

    @Test
    void myTest() {
        // ...
    }

    @DynamicPropertySource
    static void neo4jProperties(DynamicPropertyRegistry registry) {
        registry.add("spring.neo4j.uri", neo4j::getBoltUrl);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The above configuration allows Neo4j-related beans in the application to communicate with Neo4j running inside the Testcontainers-managed Docker container.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.build" translation-origin="off"><a class="anchor" href="howto.html#howto.build"></a>16. Build</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot includes build plugins for Maven and Gradle.
This section answers common questions about these plugins.</p>
</div>
<div class="sect2">
<h3 id="howto.build.generate-info" translation-origin="off"><a class="anchor" href="howto.html#howto.build.generate-info"></a>16.1. Generate Build Information</h3>
<div class="paragraph">
<p translation-origin="off">Both the Maven plugin and the Gradle plugin allow generating build information containing the coordinates, name, and version of the project.
The plugins can also be configured to add additional properties through configuration.
When such a file is present, Spring Boot auto-configures a <code>BuildProperties</code> bean.</p>
</div>
<div class="paragraph">
<p translation-origin="off">To generate build information with Maven, add an execution for the <code>build-info</code> goal, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;2.6.3&lt;/version&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;build-info&lt;/goal&gt;
                    &lt;/goals&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">See the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#goals-build-info">Spring Boot Maven Plugin documentation</a> for more details.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">The following example does the same with Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">springBoot {
    buildInfo()
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">See the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/gradle-plugin/reference/htmlsingle/#integrating-with-actuator-build-info">Spring Boot Gradle Plugin documentation</a> for more details.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.generate-git-info" translation-origin="off"><a class="anchor" href="howto.html#howto.build.generate-git-info"></a>16.2. Generate Git Information</h3>
<div class="paragraph">
<p translation-origin="off">Both Maven and Gradle allow generating a <code>git.properties</code> file containing information about the state of your <code>git</code> source code repository when the project was built.</p>
</div>
<div class="paragraph">
<p translation-origin="off">For Maven users, the <code>spring-boot-starter-parent</code> POM includes a pre-configured plugin to generate a <code>git.properties</code> file.
To use it, add the following declaration for the <a href="https://github.com/git-commit-id/git-commit-id-maven-plugin"><code>Git Commit Id Plugin</code></a> to your POM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;pl.project13.maven&lt;/groupId&gt;
            &lt;artifactId&gt;git-commit-id-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Gradle users can achieve the same result by using the <a href="https://plugins.gradle.org/plugin/com.gorylenko.gradle-git-properties"><code>gradle-git-properties</code></a> plugin, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">plugins {
    id "com.gorylenko.gradle-git-properties" version "2.2.4"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Both the Maven and Gradle plugins allow the properties that are included in <code>git.properties</code> to be configured.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off">The commit time in <code>git.properties</code> is expected to match the following format: <code>yyyy-MM-dd’T’HH:mm:ssZ</code>.
This is the default format for both plugins listed above.
Using this format lets the time be parsed into a <code>Date</code> and its format, when serialized to JSON, to be controlled by Jackson’s date serialization configuration settings.</p>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.customize-dependency-versions" translation-origin="off"><a class="anchor" href="howto.html#howto.build.customize-dependency-versions"></a>16.3. Customize Dependency Versions</h3>
<div class="paragraph">
<p translation-origin="off">The <code>spring-boot-dependencies</code> POM manages the versions of common dependencies.
The Spring Boot plugins for Maven and Gradle allow these managed dependency versions to be customized using build properties.</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<p translation-origin="off">Each Spring Boot release is designed and tested against this specific set of third-party dependencies.
Overriding versions may cause compatibility issues.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">To override dependency versions with Maven, see <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#using">this section</a> of the Maven plugin’s documentation.</p>
</div>
<div class="paragraph">
<p translation-origin="off">To override dependency versions in Gradle, see <a href="https://docs.spring.io/spring-boot/docs/2.6.3/gradle-plugin/reference/htmlsingle/#managing-dependencies-dependency-management-plugin-customizing">this section</a> of the Gradle plugin’s documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.create-an-executable-jar-with-maven" translation-origin="off"><a class="anchor" href="howto.html#howto.build.create-an-executable-jar-with-maven"></a>16.4. Create an Executable JAR with Maven</h3>
<div class="paragraph">
<p translation-origin="off">The <code>spring-boot-maven-plugin</code> can be used to create an executable “fat” JAR.
If you use the <code>spring-boot-starter-parent</code> POM, you can declare the plugin and your jars are repackaged as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">If you do not use the parent POM, you can still use the plugin.
However, you must additionally add an <code>&lt;executions&gt;</code> section, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;{spring-boot-version}&lt;/version&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;repackage&lt;/goal&gt;
                    &lt;/goals&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">See the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#repackage">plugin documentation</a> for full usage details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.use-a-spring-boot-application-as-dependency" translation-origin="off"><a class="anchor" href="howto.html#howto.build.use-a-spring-boot-application-as-dependency"></a>16.5. Use a Spring Boot Application as a Dependency</h3>
<div class="paragraph">
<p translation-origin="off">Like a war file, a Spring Boot application is not intended to be used as a dependency.
If your application contains classes that you want to share with other projects, the recommended approach is to move that code into a separate module.
The separate module can then be depended upon by your application and other projects.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If you cannot rearrange your code as recommended above, Spring Boot’s Maven and Gradle plugins must be configured to produce a separate artifact that is suitable for use as a dependency.
The executable archive cannot be used as a dependency as the <a href="executable-jar.html#executable-jar.nested-jars.jar-structure">executable jar format</a> packages application classes in <code>BOOT-INF/classes</code>.
This means that they cannot be found when the executable jar is used as a dependency.</p>
</div>
<div class="paragraph">
<p translation-origin="off">To produce the two artifacts, one that can be used as a dependency and one that is executable, a classifier must be specified.
This classifier is applied to the name of the executable archive, leaving the default archive for use as a dependency.</p>
</div>
<div class="paragraph">
<p translation-origin="off">To configure a classifier of <code>exec</code> in Maven, you can use the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;classifier&gt;exec&lt;/classifier&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.extract-specific-libraries-when-an-executable-jar-runs" translation-origin="off"><a class="anchor" href="howto.html#howto.build.extract-specific-libraries-when-an-executable-jar-runs"></a>16.6. Extract Specific Libraries When an Executable Jar Runs</h3>
<div class="paragraph">
<p translation-origin="off">Most nested libraries in an executable jar do not need to be unpacked in order to run.
However, certain libraries can have problems.
For example, JRuby includes its own nested jar support, which assumes that the <code>jruby-complete.jar</code> is always directly available as a file in its own right.</p>
</div>
<div class="paragraph">
<p translation-origin="off">To deal with any problematic libraries, you can flag that specific nested jars should be automatically unpacked when the executable jar first runs.
Such nested jars are written beneath the temporary directory identified by the <code>java.io.tmpdir</code> system property.</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<p translation-origin="off">Care should be taken to ensure that your operating system is configured so that it will not delete the jars that have been unpacked to the temporary directory while the application is still running.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">For example, to indicate that JRuby should be flagged for unpacking by using the Maven Plugin, you would add the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;requiresUnpack&gt;
                    &lt;dependency&gt;
                        &lt;groupId&gt;org.jruby&lt;/groupId&gt;
                        &lt;artifactId&gt;jruby-complete&lt;/artifactId&gt;
                    &lt;/dependency&gt;
                &lt;/requiresUnpack&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.create-a-nonexecutable-jar" translation-origin="off"><a class="anchor" href="howto.html#howto.build.create-a-nonexecutable-jar"></a>16.7. Create a Non-executable JAR with Exclusions</h3>
<div class="paragraph">
<p translation-origin="off">Often, if you have an executable and a non-executable jar as two separate build products, the executable version has additional configuration files that are not needed in a library jar.
For example, the <code>application.yml</code> configuration file might be excluded from the non-executable JAR.</p>
</div>
<div class="paragraph">
<p translation-origin="off">In Maven, the executable jar must be the main artifact and you can add a classified jar for the library, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
            &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;id&gt;lib&lt;/id&gt;
                    &lt;phase&gt;package&lt;/phase&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;jar&lt;/goal&gt;
                    &lt;/goals&gt;
                    &lt;configuration&gt;
                        &lt;classifier&gt;lib&lt;/classifier&gt;
                        &lt;excludes&gt;
                            &lt;exclude&gt;application.yml&lt;/exclude&gt;
                        &lt;/excludes&gt;
                    &lt;/configuration&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.remote-debug-maven" translation-origin="off"><a class="anchor" href="howto.html#howto.build.remote-debug-maven"></a>16.8. Remote Debug a Spring Boot Application Started with Maven</h3>
<div class="paragraph">
<p translation-origin="off">To attach a remote debugger to a Spring Boot application that was started with Maven, you can use the <code>jvmArguments</code> property of the <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/">maven plugin</a>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">See <a href="https://docs.spring.io/spring-boot/docs/2.6.3/maven-plugin/reference/htmlsingle/#run-example-debug">this example</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib" translation-origin="off"><a class="anchor" href="howto.html#howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib"></a>16.9. Build an Executable Archive from Ant without Using spring-boot-antlib</h3>
<div class="paragraph">
<p translation-origin="off">To build with Ant, you need to grab dependencies, compile, and then create a jar or war archive.
To make it executable, you can either use the <code>spring-boot-antlib</code> module or you can follow these instructions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p translation-origin="off">If you are building a jar, package the application’s classes and resources in a nested <code>BOOT-INF/classes</code> directory.
If you are building a war, package the application’s classes in a nested <code>WEB-INF/classes</code> directory as usual.</p>
</li>
<li>
<p translation-origin="off">Add the runtime dependencies in a nested <code>BOOT-INF/lib</code> directory for a jar or <code>WEB-INF/lib</code> for a war.
Remember <strong>not</strong> to compress the entries in the archive.</p>
</li>
<li>
<p translation-origin="off">Add the <code>provided</code> (embedded container) dependencies in a nested <code>BOOT-INF/lib</code> directory for a jar or <code>WEB-INF/lib-provided</code> for a war.
Remember <strong>not</strong> to compress the entries in the archive.</p>
</li>
<li>
<p translation-origin="off">Add the <code>spring-boot-loader</code> classes at the root of the archive (so that the <code>Main-Class</code> is available).</p>
</li>
<li>
<p translation-origin="off">Use the appropriate launcher (such as <code>JarLauncher</code> for a jar file) as a <code>Main-Class</code> attribute in the manifest and specify the other properties it needs as manifest entries — principally, by setting a <code>Start-Class</code> property.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p translation-origin="off">The following example shows how to build an executable archive with Ant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;target name="build" depends="compile"&gt;
    &lt;jar destfile="target/${ant.project.name}-${spring-boot.version}.jar" compress="false"&gt;
        &lt;mappedresources&gt;
            &lt;fileset dir="target/classes" /&gt;
            &lt;globmapper from="*" to="BOOT-INF/classes/*"/&gt;
        &lt;/mappedresources&gt;
        &lt;mappedresources&gt;
            &lt;fileset dir="src/main/resources" erroronmissingdir="false"/&gt;
            &lt;globmapper from="*" to="BOOT-INF/classes/*"/&gt;
        &lt;/mappedresources&gt;
        &lt;mappedresources&gt;
            &lt;fileset dir="${lib.dir}/runtime" /&gt;
            &lt;globmapper from="*" to="BOOT-INF/lib/*"/&gt;
        &lt;/mappedresources&gt;
        &lt;zipfileset src="${lib.dir}/loader/spring-boot-loader-jar-${spring-boot.version}.jar" /&gt;
        &lt;manifest&gt;
            &lt;attribute name="Main-Class" value="org.springframework.boot.loader.JarLauncher" /&gt;
            &lt;attribute name="Start-Class" value="${start-class}" /&gt;
        &lt;/manifest&gt;
    &lt;/jar&gt;
&lt;/target&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto.traditional-deployment" translation-origin="off"><a class="anchor" href="howto.html#howto.traditional-deployment"></a>17. Traditional Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p translation-origin="off">Spring Boot supports traditional deployment as well as more modern forms of deployment.
This section answers common questions about traditional deployment.</p>
</div>
<div class="sect2">
<h3 id="howto.traditional-deployment.war" translation-origin="off"><a class="anchor" href="howto.html#howto.traditional-deployment.war"></a>17.1. Create a Deployable War File</h3>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<p translation-origin="off">Because Spring WebFlux does not strictly depend on the servlet API and applications are deployed by default on an embedded Reactor Netty server, War deployment is not supported for WebFlux applications.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">The first step in producing a deployable war file is to provide a <code>SpringBootServletInitializer</code> subclass and override its <code>configure</code> method.
Doing so makes use of Spring Framework’s servlet 3.0 support and lets you configure your application when it is launched by the servlet container.
Typically, you should update your application’s main class to extend <code>SpringBootServletInitializer</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(MyApplication.class);
    }

    public static void main(String[] args) {
        SpringApplication.run(MyApplication.class, args);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The next step is to update your build configuration such that your project produces a war file rather than a jar file.
If you use Maven and <code>spring-boot-starter-parent</code> (which configures Maven’s war plugin for you), all you need to do is to modify <code>pom.xml</code> to change the packaging to war, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;packaging&gt;war&lt;/packaging&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">If you use Gradle, you need to modify <code>build.gradle</code> to apply the war plugin to the project, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">apply plugin: 'war'</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">The final step in the process is to ensure that the embedded servlet container does not interfere with the servlet container to which the war file is deployed.
To do so, you need to mark the embedded servlet container dependency as being provided.</p>
</div>
<div class="paragraph">
<p translation-origin="off">If you use Maven, the following example marks the servlet container (Tomcat, in this case) as being provided:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;!-- ... --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
        &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;!-- ... --&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">If you use Gradle, the following example marks the servlet container (Tomcat, in this case) as being provided:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">dependencies {
    // ...
    providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat'
    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="提示"></i>
</td>
<td class="content">
<p translation-origin="off"><code>providedRuntime</code> is preferred to Gradle’s <code>compileOnly</code> configuration.
Among other limitations, <code>compileOnly</code> dependencies are not on the test classpath, so any web-based integration tests fail.</p>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">If you use the <a href="build-tool-plugins.html#build-tool-plugins">Spring Boot build tools</a>, marking the embedded servlet container dependency as provided produces an executable war file with the provided dependencies packaged in a <code>lib-provided</code> directory.
This means that, in addition to being deployable to a servlet container, you can also run your application by using <code>java -jar</code> on the command line.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.traditional-deployment.convert-existing-application" translation-origin="off"><a class="anchor" href="howto.html#howto.traditional-deployment.convert-existing-application"></a>17.2. Convert an Existing Application to Spring Boot</h3>
<div class="paragraph">
<p translation-origin="off">To convert an existing non-web Spring application to a Spring Boot application, replace the code that creates your <code>ApplicationContext</code> and replace it with calls to <code>SpringApplication</code> or <code>SpringApplicationBuilder</code>.
Spring MVC web applications are generally amenable to first creating a deployable war application and then migrating it later to an executable war or jar.
See the <a href="https://spring.io/guides/gs/convert-jar-to-war/">Getting Started Guide on Converting a jar to a war</a>.</p>
</div>
<div class="paragraph">
<p translation-origin="off">To create a deployable war by extending <code>SpringBootServletInitializer</code> (for example, in a class called <code>Application</code>) and adding the Spring Boot <code>@SpringBootApplication</code> annotation, use code similar to that shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        // Customize the application or call application.sources(...) to add sources
        // Since our example is itself a @Configuration class (via @SpringBootApplication)
        // we actually do not need to override this method.
        return application;
    }


}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">Remember that, whatever you put in the <code>sources</code> is merely a Spring <code>ApplicationContext</code>.
Normally, anything that already works should work here.
There might be some beans you can remove later and let Spring Boot provide its own defaults for them, but it should be possible to get something working before you need to do that.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Static resources can be moved to <code>/public</code> (or <code>/static</code> or <code>/resources</code> or <code>/META-INF/resources</code>) in the classpath root.
The same applies to <code>messages.properties</code> (which Spring Boot automatically detects in the root of the classpath).</p>
</div>
<div class="paragraph">
<p translation-origin="off">Vanilla usage of Spring <code>DispatcherServlet</code> and Spring Security should require no further changes.
If you have other features in your application (for instance, using other servlets or filters), you may need to add some configuration to your <code>Application</code> context, by replacing those elements from the <code>web.xml</code>, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off">A <code>@Bean</code> of type <code>Servlet</code> or <code>ServletRegistrationBean</code> installs that bean in the container as if it were a <code>&lt;servlet/&gt;</code> and <code>&lt;servlet-mapping/&gt;</code> in <code>web.xml</code>.</p>
</li>
<li>
<p translation-origin="off">A <code>@Bean</code> of type <code>Filter</code> or <code>FilterRegistrationBean</code> behaves similarly (as a <code>&lt;filter/&gt;</code> and <code>&lt;filter-mapping/&gt;</code>).</p>
</li>
<li>
<p translation-origin="off">An <code>ApplicationContext</code> in an XML file can be added through an <code>@ImportResource</code> in your <code>Application</code>.
Alternatively, cases where annotation configuration is heavily used already can be recreated in a few lines as <code>@Bean</code> definitions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">Once the war file is working, you can make it executable by adding a <code>main</code> method to your <code>Application</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public static void main(String[] args) {
    SpringApplication.run(MyApplication.class, args);
}
</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p translation-origin="off">If you intend to start your application as a war or as an executable application, you need to share the customizations of the builder in a method that is both available to the <code>SpringBootServletInitializer</code> callback and in the <code>main</code> method in a class similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.Banner;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {
        return customizerBuilder(builder);
    }

    public static void main(String[] args) {
        customizerBuilder(new SpringApplicationBuilder()).run(args);
    }

    private static SpringApplicationBuilder customizerBuilder(SpringApplicationBuilder builder) {
        return builder.sources(MyApplication.class).bannerMode(Banner.Mode.OFF);
    }

}
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p translation-origin="off">Applications can fall into more than one category:</p>
</div>
<div class="ulist">
<ul>
<li>
<p translation-origin="off">Servlet 3.0+ applications with no <code>web.xml</code>.</p>
</li>
<li>
<p translation-origin="off">Applications with a <code>web.xml</code>.</p>
</li>
<li>
<p translation-origin="off">Applications with a context hierarchy.</p>
</li>
<li>
<p translation-origin="off">Applications without a context hierarchy.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p translation-origin="off">All of these should be amenable to translation, but each might require slightly different techniques.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Servlet 3.0+ applications might translate pretty easily if they already use the Spring Servlet 3.0+ initializer support classes.
Normally, all the code from an existing <code>WebApplicationInitializer</code> can be moved into a <code>SpringBootServletInitializer</code>.
If your existing application has more than one <code>ApplicationContext</code> (for example, if it uses <code>AbstractDispatcherServletInitializer</code>) then you might be able to combine all your context sources into a single <code>SpringApplication</code>.
The main complication you might encounter is if combining does not work and you need to maintain the context hierarchy.
See the <a href="howto.html#howto.application.context-hierarchy">entry on building a hierarchy</a> for examples.
An existing parent context that contains web-specific features usually needs to be broken up so that all the <code>ServletContextAware</code> components are in the child context.</p>
</div>
<div class="paragraph">
<p translation-origin="off">Applications that are not already Spring applications might be convertible to Spring Boot applications, and the previously mentioned guidance may help.
However, you may yet encounter problems.
In that case, we suggest <a href="https://stackoverflow.com/questions/tagged/spring-boot">asking questions on Stack Overflow with a tag of <code>spring-boot</code></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="howto.traditional-deployment.weblogic" translation-origin="off"><a class="anchor" href="howto.html#howto.traditional-deployment.weblogic"></a>17.3. Deploying a WAR to WebLogic</h3>
<div class="paragraph">
<p translation-origin="off">To deploy a Spring Boot application to WebLogic, you must ensure that your servlet initializer <strong>directly</strong> implements <code>WebApplicationInitializer</code> (even if you extend from a base class that already implements it).</p>
</div>
<div class="paragraph">
<p translation-origin="off">A typical initializer for WebLogic should resemble the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;
import org.springframework.web.WebApplicationInitializer;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication extends SpringBootServletInitializer implements WebApplicationInitializer {

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p translation-origin="off">If you use Logback, you also need to tell WebLogic to prefer the packaged version rather than the version that was pre-installed with the server.
You can do so by adding a <code>WEB-INF/weblogic.xml</code> file with the following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wls:weblogic-web-app
    xmlns:wls="http://xmlns.oracle.com/weblogic/weblogic-web-app"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
        https://java.sun.com/xml/ns/javaee/ejb-jar_3_0.xsd
        http://xmlns.oracle.com/weblogic/weblogic-web-app
        https://xmlns.oracle.com/weblogic/weblogic-web-app/1.4/weblogic-web-app.xsd"&gt;
    &lt;wls:container-descriptor&gt;
        &lt;wls:prefer-application-packages&gt;
            &lt;wls:package-name&gt;org.slf4j&lt;/wls:package-name&gt;
        &lt;/wls:prefer-application-packages&gt;
    &lt;/wls:container-descriptor&gt;
&lt;/wls:weblogic-web-app&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
最后更新于 2022-01-20 14:11:26 UTC
</div>
</div>
</div>
</div>
</div>
<script data-cfasync="false" src="../../../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>if (window.parent == window) {(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-2728886-23', 'auto', {'siteSpeedSampleRate': 100});ga('send', 'pageview');}</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/v652eace1692a40cfa3763df669d7439c1639079717194" integrity="sha512-Gi7xpJR8tSkrpF7aordPZQlW2DLtzUlZcumS8dMQjwDHEnw9I7ZLyiOj/6tZStRBGtGgN6ceN6cMH8z7etPGlw==" data-cf-beacon="{&quot;rayId&quot;:&quot;6d1fded6f88f7c65&quot;,&quot;token&quot;:&quot;bffcb8a918ae4755926f76178bfbd26b&quot;,&quot;version&quot;:&quot;2021.12.0&quot;,&quot;si&quot;:100}" crossorigin="anonymous"></script>


</body></html>
